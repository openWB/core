const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardView-BdPINJqC.js","assets/DashboardCard-DS7AgUYm.js","assets/vendor-inkline-S9CBmrTS.js","assets/vendor-Bzn5cd2Y.js","assets/vendor-inkline-BxOXWZNy.css","assets/DashboardCard-Cy_vzq6d.css","assets/ChargePointPlugBadge-CaZ8nk6N.js","assets/vendor-fortawesome-CfiBAnfT.js","assets/ChargePointPlugBadge-HWp2u3dG.css","assets/DashboardView-BYiJMWFT.css","assets/EnergyFlowView-CC3L0OJk.js","assets/ChargeModeModal-D1UJpAHo.js","assets/ChargeModeModal-CGs_z8ao.css","assets/EnergyFlowView-BOyDZ-Ju.css","assets/ChargePointsView-DngxMDSm.js","assets/ChargePointsView-XaNtEpcq.css","assets/StatusView-DWDOduFq.js"])))=>i.map(i=>d[i]);
import{e as P,k as f,j as V,x as k,F as S,o as p,i as W,H as F,l as C,q as c,p as h,f as w,s,A as D,I as E,z as A,R as H,J as R,K as U,L as z,M as G,N as K}from"./vendor-Bzn5cd2Y.js";import{_ as b,I as J,c as Y}from"./vendor-inkline-S9CBmrTS.js";import{l as $,f as L,a as q,F as O,b as Z,c as Q}from"./vendor-fortawesome-CfiBAnfT.js";(function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0})}function t(o){if(o.ep)return;o.ep=!0;const n=function(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}(o);fetch(o.href,n)}})();const X=b({name:"DateTime",data:()=>({dateTimeInterval:"",date:"",time:""}),mounted(){this.update(),this.dateTimeInterval=setInterval(this.update,1e3)},beforeUnmount(){clearInterval(this.dateTimeInterval)},methods:{update(){const e=new Date;this.date=e.toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"2-digit",day:"2-digit"}),this.time=e.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},[["render",function(e,t,o,n,a,i){return p(),P(S,null,[f(k(a.time),1),V(e.$slots,"default",{},()=>[t[0]||(t[0]=W("br",null,null,-1))]),f(k(a.date),1)],64)}]]),B=F("mqtt",{state:()=>({settings:{localIp:void 0,localBranch:void 0,localCommit:void 0,localVersion:void 0,parentChargePoint1:void 0,parentChargePoint2:void 0},topics:{},chartData:{}}),getters:{getChargePointFilter:e=>{let t=[];return e.settings.parentChargePoint1!==void 0&&t.push(e.settings.parentChargePoint1),e.settings.parentChargePoint2!==void 0&&t.push(e.settings.parentChargePoint2),t},getWildcardIndexList:e=>(t,o=!1)=>{let n=t;o||(n="^"+t.replaceAll("/","\\/").replaceAll("+","[^+/]+").replaceAll("#","[^#/]+")+"$");let a=Object.keys(e.topics).filter(i=>i.match(n));return a.forEach((i,r,l)=>{l[r]=parseInt(i.match(/(?:\/)([0-9]+)(?=\/)*/g)[0].replace(/[^0-9]+/g,""))}),a},getWildcardTopics:e=>(t,o=!1)=>{let n=t;return o||(n="^"+t.replaceAll("/","\\/").replaceAll("+","[^+/]+").replaceAll("#","[^#/]+")+"$"),Object.keys(e.topics).filter(a=>a.match(n)).reduce((a,i)=>({...a,[i]:e.topics[i]}),{})},getObjectIds:e=>t=>function o(n){let a=[];return n!==void 0&&n.forEach(i=>{i.type==t&&a.push(i.id),a=[...a,...o(i.children)]}),a}(e.topics["openWB/counter/get/hierarchy"]),getValueBool:e=>(t,o=!1)=>{let n=e.topics[t];return n!==void 0?n:o},getValueString:e=>(t,o="W",n="",a=!0,i=!1,r="---",l=void 0)=>{var g=!1,d=e.topics[t];if(d===void 0||l!==void 0&&d[l]===void 0)m=r;else{l!==void 0&&(d=d[l]),i&&(d*=-1);for(var m=d.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}),u=d;a&&(u>999||u<-999);)switch(u/=1e3,g=!0,n){case"":n="k";break;case"k":n="M";break;case"M":n="G"}m=u.toLocaleString(void 0,{minimumFractionDigits:g?2:0,maximumFractionDigits:g?2:0})}return{textValue:`${m} ${n}${o}`,value:d,unit:o,scaledValue:u,scaledUnit:`${n}${o}`}},getChartData:e=>t=>e.chartData[t]===void 0?[]:e.chartData[t],getDisplayStandby:e=>e.topics["openWB/optional/int_display/standby"],getThemeConfiguration:e=>{if("openWB/optional/int_display/theme"in e.topics&&e.topics["openWB/optional/int_display/theme"]!==void 0&&"configuration"in e.topics["openWB/optional/int_display/theme"])return e.topics["openWB/optional/int_display/theme"].configuration},getDefaultView:e=>{if(e.getThemeConfiguration){const t={dashboard:e.getThemeConfiguration.enable_dashboard_view,"energy-flow":e.getThemeConfiguration.enable_energy_flow_view,"charge-points":e.getThemeConfiguration.enable_charge_points_view,status:e.getThemeConfiguration.enable_status_view};if(e.getThemeConfiguration.default_view!==void 0&&t[e.getThemeConfiguration.default_view]===!0)return e.getThemeConfiguration.default_view;for(const[o,n]of Object.entries(t))if(n)return o}},getDefaultViewTimeout:e=>e.getThemeConfiguration?e.getThemeConfiguration.default_view_timeout:0,getDashboardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_view,getEnergyFlowEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_energy_flow_view,getChargePointsEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_charge_points_view,getStateEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_status_view,getGridCardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_card_grid,getHomeCardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_card_home_consumption,getBatteryCardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_card_battery_sum,getChargePointsCardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_card_charge_point_sum,getPvCardEnabled:e=>!e.getThemeConfiguration||e.getThemeConfiguration.enable_dashboard_card_inverter_sum,getLockChanges:e=>!e.getThemeConfiguration||e.getThemeConfiguration.lock_changes,getSimpleChargePointView:e=>!!e.getThemeConfiguration&&e.getThemeConfiguration.simple_charge_point_view,getGridId(e){let t=e.topics["openWB/counter/get/hierarchy"];if(t!==void 0&&Object.keys(t).length>0){let o=Object.keys(e.topics["openWB/counter/get/hierarchy"])[0];if(e.topics["openWB/counter/get/hierarchy"][o].type=="counter")return e.topics["openWB/counter/get/hierarchy"][o].id}},getGridPower:e=>(t="textValue")=>{let o=e.getGridId;if(o===void 0)return"---";let n=e.getValueString(`openWB/counter/${o}/get/power`,"W");return Object.hasOwnProperty.call(n,t)?n[t]:t=="object"?n:void 0},getGridPowerChartData(e){let t=e.getGridId;return t===void 0?[]:e.getChartData(`openWB/counter/${t}/get/power`)},getHomePower:e=>(t="textValue")=>{let o=e.getValueString("openWB/counter/set/home_consumption","W");return Object.hasOwnProperty.call(o,t)?o[t]:t=="object"?o:void 0},getHomePowerChartData:e=>e.getChartData("openWB/counter/set/home_consumption"),getBatteryConfigured:e=>e.getValueBool("openWB/bat/config/configured"),getBatteryPower:e=>(t="textValue")=>{let o=e.getValueString("openWB/bat/get/power","W");return Object.hasOwnProperty.call(o,t)?o[t]:t=="object"?o:void 0},getBatteryPowerChartData:e=>e.getChartData("openWB/bat/get/power"),getBatterySoc:e=>(t="textValue")=>{let o=e.getValueString("openWB/bat/get/soc","%","",!1);return Object.hasOwnProperty.call(o,t)?o[t]:t=="object"?o:void 0},getBatterySocChartData:e=>e.getChartData("openWB/bat/get/soc"),getPvConfigured:e=>e.getValueBool("openWB/pv/config/configured"),getPvPower:e=>(t="textValue")=>{var o=e.getValueString("openWB/pv/get/power","W","",!0,!0);return Object.hasOwnProperty.call(o,t)?o[t]:t=="object"?o:void 0},getPvPowerChartData:e=>e.getChartData("openWB/pv/get/power").map(t=>-1*t),getChargePointSumPower:e=>(t="textValue")=>{var o=e.getValueString("openWB/chargepoint/get/power","W");return Object.hasOwnProperty.call(o,t)?o[t]:t=="object"?o:void 0},getChargePointSumPowerChartData:e=>e.getChartData("openWB/chargepoint/get/power"),getChargePointIds(e){let t=e.getObjectIds("cp"),o=this.getChargePointFilter;return o.length>0?t.filter(n=>o.includes(n)):t},getChargePointName:e=>t=>e.topics[`openWB/chargepoint/${t}/config`]!==void 0?e.topics[`openWB/chargepoint/${t}/config`].name:"---",getChargePointPower:e=>(t,o="textValue")=>{var n=e.getValueString(`openWB/chargepoint/${t}/get/power`,"W");return Object.hasOwnProperty.call(n,o)?n[o]:o=="object"?n:void 0},getChargePointImportedSincePlugged:e=>t=>({energy:e.getValueString(`openWB/chargepoint/${t}/set/log`,"Wh","",!0,!1,"---","imported_since_plugged").textValue,range:e.getValueString(`openWB/chargepoint/${t}/set/log`,"m","k",!1,!1,"---","range_charged").textValue}),getChargePointPowerChartData:e=>t=>e.getChartData(`openWB/chargepoint/${t}/get/power`),getChargePointSetCurrent:e=>(t,o="textValue")=>{let n=e.getValueString(`openWB/chargepoint/${t}/set/current`,"A");return Object.hasOwnProperty.call(n,o)?n[o]:o=="object"?n:void 0},getChargePointPhasesInUse:e=>t=>{const o=["/","①","②","③"],n=e.topics[`openWB/chargepoint/${t}/get/phases_in_use`];return n!==void 0&&n>=0&&n<o.length?o[e.topics[`openWB/chargepoint/${t}/get/phases_in_use`]]:"?"},getChargePointPlugState:e=>t=>e.getValueBool(`openWB/chargepoint/${t}/get/plug_state`),getChargePointChargeState:e=>t=>e.getValueBool(`openWB/chargepoint/${t}/get/charge_state`),getChargePointManualLock:e=>t=>e.getValueBool(`openWB/chargepoint/${t}/set/manual_lock`),getChargepointTagState:e=>t=>[void 0,null,""].includes(e.topics[`openWB/chargepoint/${t}/set/rfid`])?[void 0,null,""].includes(e.topics[`openWB/chargepoint/${t}/get/rfid`])?0:1:2,getChargePointConnectedVehicleConfig:e=>t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/config`],getChargePointConnectedVehicleChargeMode:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.translateChargeMode(e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.selected)},getChargePointConnectedVehiclePriority:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).prio},getChargePointConnectedVehicleInfo:e=>t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`],getChargePointConnectedVehicleId:e=>t=>{if(e.getChargePointConnectedVehicleInfo(t))return e.getChargePointConnectedVehicleInfo(t).id},getChargePointConnectedVehicleChargeTemplateIndex:e=>t=>{if(e.getChargePointConnectedVehicleConfig(t))return e.getChargePointConnectedVehicleConfig(t).charge_template},getChargePointConnectedVehicleChargeTemplate:e=>t=>e.topics[`openWB/chargepoint/${t}/set/charge_template`],getChargePointConnectedVehicleEvTemplate:e=>t=>{if(e.getChargePointConnectedVehicleConfig(t))return e.getChargePointConnectedVehicleConfig(t).ev_template},getChargePointConnectedVehicleName:e=>t=>{if(e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`])return e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`].name},getChargePointConnectedVehicleSoc:e=>t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/soc`],getChargePointConnectedVehicleTimeChargingActive:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).time_charging.active},getChargePointConnectedVehicleTimeChargingRunning:e=>t=>{let o=e.getChargePointConnectedVehicleConfig(t).time_charging_in_use;return o!==void 0&&o},getChargePointConnectedVehicleInstantChargingCurrent:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.current},getChargePointConnectedVehicleInstantChargingLimit:e=>t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.limit:{selected:void 0},getChargePointConnectedVehicleInstantChargingPhases:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.phases_to_use},getChargePointConnectedVehiclePvChargingFeedInLimit:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.feed_in_limit},getChargePointConnectedVehiclePvChargingMinCurrent:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_current},getChargePointConnectedVehiclePvChargingPhases:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.phases_to_use},getChargePointConnectedVehiclePvChargingLimit:e=>t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.limit:{selected:void 0},getChargePointConnectedVehiclePvChargingMinSoc:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_soc},getChargePointConnectedVehiclePvChargingMinSocCurrent:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_soc_current},getChargePointConnectedVehiclePvChargingMinSocPhases:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.phases_to_use_min_soc},getChargePointConnectedVehicleEcoChargingCurrent:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.current},getChargePointConnectedVehicleEcoChargingPhases:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.phases_to_use},getChargePointConnectedVehicleEcoChargingLimit:e=>t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.limit:{selected:void 0},getChargePointConnectedVehicleEcoChargingMaxPrice:e=>t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return 1e5*e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.max_price},getChargePointConnectedVehicleScheduledChargingPlans:e=>t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.scheduled_charging.plans:{},getChargePointConnectedVehicleTimeChargingPlans:e=>t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).time_charging.plans:{},getVehicleList:e=>e.getWildcardTopics("openWB/vehicle/+/name"),getVehicleName:e=>t=>e.topics[`openWB/vehicle/${t}/name`],getVehicleSocConfigured:e=>t=>e.topics[`openWB/vehicle/${t}/soc_module/config`].type!=null,getVehicleSocIsManual:e=>t=>e.topics[`openWB/vehicle/${t}/soc_module/config`].type=="manual",getVehicleFaultState:e=>t=>e.topics[`openWB/vehicle/${t}/get/fault_state`]?e.topics[`openWB/vehicle/${t}/get/fault_state`]:0,getSystemTime(e){if(e.topics["openWB/system/time"])return new Date(1e3*e.topics["openWB/system/time"]).toLocaleString()},getSystemIp:e=>e.settings.localIp!==void 0?e.settings.localIp:e.topics["openWB/system/ip_address"]?e.topics["openWB/system/ip_address"]:void 0,getSystemVersion:e=>e.settings.localVersion!==void 0?e.settings.localVersion:e.topics["openWB/system/version"]?e.topics["openWB/system/version"]:void 0,getSystemBranch:e=>e.settings.localBranch!==void 0?e.settings.localBranch:e.topics["openWB/system/current_branch"]?e.topics["openWB/system/current_branch"]:void 0,getSystemCurrentCommit:e=>e.settings.localCommit!==void 0?e.settings.localCommit:e.topics["openWB/system/current_commit"]?e.topics["openWB/system/current_commit"]:void 0,getRfidEnabled(){return this.getValueBool("openWB/optional/rfid/active")},getEtConfigured:e=>e.topics["openWB/optional/et/provider"]!==void 0&&e.topics["openWB/optional/et/provider"].type!==null,getEtPrices:e=>e.topics["openWB/optional/et/get/prices"]},actions:{updateSetting(e,t){e in this.settings&&(this.settings[e]=t)},initTopic(e,t=void 0){e.includes("#")||e.includes("+")||this.addTopic(e,t)},addTopic(e,t){this.topics[e]=t},removeTopic(e){e.includes("#")||e.includes("+")?Object.keys(this.getWildcardTopics(e)).forEach(t=>{delete this.topics[t]}):delete this.topics[e]},updateTopic(e,t,o=void 0){return e in this.topics?(o!=null?(n=this.topics[e],i=t,(a=o).split(".").reduce((r,l,g)=>r[l]=a.split(".").length===++g?i:r[l]||{},n)):this.topics[e]=t,this.topics[e]):void 0;var n,a,i},updateChartData(){for(const[e,t]of Object.entries(this.topics))(e.endsWith("home_consumption")||e.endsWith("power")||e.endsWith("soc"))&&(this.chartData[e]===void 0&&(this.chartData[e]=[]),t!=null&&(this.chartData[e].push(t),this.chartData[e].slice(-128)))},updateState(e,t,o=void 0){return this.updateTopic(e,t,o)},chargeModeList(){var e=[{id:"instant_charging"},{id:"pv_charging"},{id:"scheduled_charging"},{id:"eco_charging"},{id:"stop"}];return e.forEach(t=>{t.label=this.translateChargeMode(t.id).label,t.class=this.translateChargeMode(t.id).class}),e},translateChargeMode(e){switch(e){case"instant_charging":return{mode:e,label:"Sofort",class:"danger"};case"pv_charging":return{mode:e,label:"PV",class:"success"};case"scheduled_charging":return{mode:e,label:"Ziel",class:"primary"};case"time_charging":return{mode:e,label:"Zeit",class:"warning"};case"eco_charging":return{mode:e,label:"Eco",class:"secondary"};case"stop":return{mode:e,label:"Stop",class:"dark"};default:return{mode:e,label:e,class:e}}},checkChangesLockCode(e){return!(!this.getThemeConfiguration||this.getThemeConfiguration.lock_changes_code!=e)},formatDate:(e,t={year:"numeric",month:"2-digit",day:"2-digit"})=>new Date(e).toLocaleDateString(void 0,t),formatDateRange(e,t="-"){const o={year:"numeric",month:"2-digit",day:"2-digit"};let n={day:"2-digit"};const a=new Date(e[0]),i=new Date(e[1]);return a.getFullYear()==i.getFullYear()?(t=`.${t}`,a.getMonth()!=i.getMonth()&&(n.month=o.month)):n=o,`${this.formatDate(e[0],n)}${t}${this.formatDate(e[1],o)}`},formatWeeklyScheduleDays(e){const t=["Mo","Di","Mi","Do","Fr","Sa","So"];let o=[],n=null;return e.forEach((a,i)=>{a?n===null&&(n=i):n!==null&&(n===i-1?o.push(t[n]):o.push(`${t[n]}-${t[i-1]}`),n=null)}),n!==null&&(n===e.length-1?o.push(t[n]):o.push(`${t[n]}-${t[e.length-1]}`)),o.join(", ")}}}),ee=b({name:"NavBar",components:{NavItem:b({name:"NavItem",props:{to:{type:Object,required:!0}}},[["render",function(e,t,o,n,a,i){const r=h("i-nav-item");return p(),C(r,{to:o.to,"active-class":"-active",class:"_border _border-color:primary _text-align:center"},{default:c(()=>[V(e.$slots,"default",{},void 0,!0)]),_:3},8,["to"])}],["__scopeId","data-v-1db6ae73"]])},data:()=>({mqttStore:B()})},[["render",function(e,t,o,n,a,i){const r=h("nav-item"),l=h("i-nav");return p(),C(l,{vertical:"",class:"_align-items:stretch",size:"lg"},{default:c(()=>[a.mqttStore.getDashboardEnabled?(p(),C(r,{key:0,to:{name:"dashboard"}},{default:c(()=>t[0]||(t[0]=[f(" Übersicht ",-1)])),_:1,__:[0]})):w("",!0),a.mqttStore.getEnergyFlowEnabled?(p(),C(r,{key:1,to:{name:"energy-flow"}},{default:c(()=>t[1]||(t[1]=[f(" Energiefluss ",-1)])),_:1,__:[1]})):w("",!0),a.mqttStore.getChargePointsEnabled&&a.mqttStore.getChargePointIds.length>0?(p(),C(r,{key:2,to:{name:"charge-points"}},{default:c(()=>t[2]||(t[2]=[f(" Ladepunkte ",-1)])),_:1,__:[2]})):w("",!0),a.mqttStore.getStateEnabled?(p(),C(r,{key:3,to:{name:"status"}},{default:c(()=>t[3]||(t[3]=[f(" Status ",-1)])),_:1,__:[3]})):w("",!0)]),_:1})}]]);$.add(L,q);const te=b({name:"NumberPad",components:{FontAwesomeIcon:O},emits:["key:digit","key:clear","key:delete"],data:()=>({buttonRows:[[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"}],[{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"}],[{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"}]]}),methods:{emitDigit(e){this.$emit("key:digit",e)},emitClear(){this.$emit("key:clear")},emitDelete(){this.$emit("key:delete")}}},[["render",function(e,t,o,n,a,i){const r=h("i-button"),l=h("i-column"),g=h("i-row"),d=h("FontAwesomeIcon"),m=h("i-container");return p(),C(m,null,{default:c(()=>[(p(!0),P(S,null,D(a.buttonRows,u=>(p(),C(g,{key:u,center:"",class:"_padding-bottom:1"},{default:c(()=>[(p(!0),P(S,null,D(u,_=>(p(),C(l,{key:_.value,class:"pin-button-column"},{default:c(()=>[s(r,{size:"lg",class:"pin-button",onClick:v=>i.emitDigit(_.value)},{default:c(()=>[f(k(_.label),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:2},1024))),128)),s(g,{center:""},{default:c(()=>[s(l,{class:"pin-button-column"},{default:c(()=>[s(r,{size:"lg",class:"pin-button",onClick:t[0]||(t[0]=u=>i.emitClear())},{default:c(()=>[s(d,{"fixed-width":"",icon:["fas","fa-eraser"]})]),_:1})]),_:1}),s(l,{class:"pin-button-column"},{default:c(()=>[s(r,{size:"lg",class:"pin-button",onClick:t[1]||(t[1]=u=>i.emitDigit("0"))},{default:c(()=>t[3]||(t[3]=[f(" 0 ",-1)])),_:1,__:[3]})]),_:1}),s(l,{class:"pin-button-column"},{default:c(()=>[s(r,{size:"lg",class:"pin-button",onClick:t[2]||(t[2]=u=>i.emitDelete())},{default:c(()=>[s(d,{"fixed-width":"",icon:["fas","fa-delete-left"]})]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-4e2103db"]]),oe=b({name:"CodeInputModal",components:{NumberPad:te},props:{modelValue:{type:Boolean,required:!0},backgroundColor:{type:String,default:"warning"},placeholderCharacter:{type:String,default:"*",validator:e=>e.length==1},inputVisible:{type:Boolean,default:!1},minLength:{type:Number,default:4},maxLength:{type:Number,default:4}},emits:["update:modelValue","update:inputValue"],data(){return{number:"",modalBackground:this.backgroundColor}},computed:{placeholder(){return this.placeholderCharacter.repeat(this.minLength)},enableSubmit(){return this.number.length>=this.minLength&&this.number.length<=this.maxLength}},watch:{modelValue(e,t){e===!1&&t===!0&&this.clear()}},methods:{abort(){this.$emit("update:modelValue",!1)},addDigit(e){this.number.length<this.maxLength&&(this.number+=e)},removeDigit(){this.number=this.number.slice(0,-1)},clear(){this.number=""},submit(){this.$emit("update:inputValue",this.number)},success(e="success"){this.modalBackground=e,setTimeout(()=>{this.$emit("update:modelValue",!1),this.modalBackground=this.backgroundColor},500)},error(e="danger"){this.modalBackground=e,setTimeout(()=>{this.clear(),this.modalBackground=this.backgroundColor},2e3)}}},[["render",function(e,t,o,n,a,i){const r=h("i-input"),l=h("i-column"),g=h("i-row"),d=h("NumberPad"),m=h("i-container"),u=h("i-button"),_=h("i-modal");return p(),C(E,{to:"body"},[s(_,{"model-value":o.modelValue,color:a.modalBackground,"onUpdate:modelValue":t[4]||(t[4]=v=>e.$emit("update:modelValue",v))},{header:c(()=>[V(e.$slots,"header",{},()=>[t[5]||(t[5]=f(" **HEADER** ",-1))])]),footer:c(()=>[s(m,null,{default:c(()=>[s(g,null,{default:c(()=>[s(l,null,{default:c(()=>[s(u,{color:"danger",onClick:i.abort},{default:c(()=>[V(e.$slots,"abort",{},()=>[t[6]||(t[6]=f(" Zurück ",-1))])]),_:3},8,["onClick"])]),_:3}),s(l,{class:"_text-align:right"},{default:c(()=>[i.enableSubmit?(p(),C(u,{key:0,color:"success",onClick:i.submit},{default:c(()=>[V(e.$slots,"submit",{},()=>[t[7]||(t[7]=f(" OK ",-1))])]),_:3},8,["onClick"])):w("",!0)]),_:3})]),_:3})]),_:3})]),default:c(()=>[s(m,null,{default:c(()=>[s(g,{center:"",class:"_padding-bottom:1"},{default:c(()=>[s(l,null,{default:c(()=>[s(r,{modelValue:a.number,"onUpdate:modelValue":t[0]||(t[0]=v=>a.number=v),placeholder:i.placeholder,readonly:"",size:"lg",type:o.inputVisible?"text":"password",class:"_text-align:center"},null,8,["modelValue","placeholder","type"])]),_:1})]),_:1}),s(d,{"onKey:digit":t[1]||(t[1]=v=>i.addDigit(v)),"onKey:clear":t[2]||(t[2]=v=>i.clear()),"onKey:delete":t[3]||(t[3]=v=>i.removeDigit(v))})]),_:1})]),_:3},8,["model-value","color"])])}]]);$.add(Z,Q,L,q);const ne={key:0,class:"_padding-left:1"},x="/openWB/web/display/themes/cards/openWB_logo_dark.png",ie=b({name:"OpenwbDisplayCardsApp",components:{RouterView:H,DateTime:X,NavBar:ee,LockNavItem:b({name:"LockNavItem",components:{FontAwesomeIcon:O,CodeInputModal:oe},props:{},data:()=>({mqttStore:B(),modalPinEntryVisible:!1,modalPinEntryColor:"warning",code:"",countdown:0,countdownInterval:void 0,events:["mousemove","touchmove","wheel","click"]}),computed:{changesLocked:{get(){return this.mqttStore.settings.changesLocked},set(e){this.mqttStore.settings.changesLocked=e}},timer(){return Math.trunc(this.countdown/60).toString()+":"+(this.countdown%60).toString().padStart(2,"0")}},mounted(){this.changesLocked=!0},methods:{toggleChangesLock(){this.changesLocked?this.unlockChanges():this.lockChanges()},unlockChanges(){this.modalPinEntryVisible=!0},checkUnlockCode(e){this.mqttStore.checkChangesLockCode(e)?(this.$refs.lockInput.success("success"),this.changesLocked=!1,this.mqttStore.getDisplayStandby>0&&(this.countdown=this.mqttStore.getDisplayStandby,this.countdownInterval=setInterval(this.updateCountdown,1e3),this.events.forEach(t=>{document.addEventListener(t,this.handleDocumentEvent,{passive:!0})}))):this.$refs.lockInput.error("danger")},lockChanges(){this.changesLocked=!0,this.events.forEach(e=>{document.removeEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.countdownInterval!==void 0&&(clearInterval(this.countdownInterval),this.countdownInterval=void 0)},updateCountdown(){this.countdown-=1,this.countdown<1&&this.lockChanges()},handleDocumentEvent(){this.countdown=this.mqttStore.getDisplayStandby}}},[["render",function(e,t,o,n,a,i){const r=h("FontAwesomeIcon"),l=h("i-button"),g=h("CodeInputModal");return p(),P(S,null,[a.mqttStore.getLockChanges?(p(),C(l,{key:0,class:"_padding-left:0 _padding-right:0 _margin-bottom:1",size:"lg",block:"",color:i.changesLocked?"danger":"success",onClick:t[0]||(t[0]=d=>i.toggleChangesLock())},{default:c(()=>[s(r,{"fixed-width":"",icon:i.changesLocked?["fas","fa-lock"]:["fas","fa-lock-open"],class:A(i.changesLocked?"_color:danger-80":"_color:success-80")},null,8,["icon","class"]),!i.changesLocked&&a.countdownInterval?(p(),P("span",ne,k(i.timer),1)):w("",!0)]),_:1},8,["color"])):w("",!0),s(g,{ref:"lockInput",modelValue:a.modalPinEntryVisible,"onUpdate:modelValue":t[1]||(t[1]=d=>a.modalPinEntryVisible=d),"min-length":4,"max-length":10,"onUpdate:inputValue":i.checkUnlockCode},{header:c(()=>t[2]||(t[2]=[f(" Bitte den PIN zur Freigabe von Änderungen eingeben. ",-1)])),_:1},8,["modelValue","onUpdate:inputValue"])],64)}]]),TouchBlocker:b({name:"TouchBlocker",data:()=>({mqttStore:B(),show:!1,touchBlockerCountdown:void 0,touchBlockerCountdownInterval:void 0,defaultViewCountdown:void 0,defaultViewCountdownInterval:void 0,events:["mousemove","touchmove","wheel","click"],eventHandlerSetup:!1}),computed:{configuredDisplayStandby(){if(this.mqttStore.getDisplayStandby!==0&&this.mqttStore.getDisplayStandby!==void 0)return this.mqttStore.getDisplayStandby},configuredDefaultViewTimeout(){if(this.mqttStore.getDefaultViewTimeout!==0&&this.mqttStore.getDefaultViewTimeout!==void 0)return this.mqttStore.getDefaultViewTimeout},touchBlockerTimeout(){return Math.max(this.configuredDisplayStandby-3,1)},defaultViewTimeout(){return this.configuredDefaultViewTimeout}},mounted(){this.setupEventHandler(),this.setupTouchBlockerTimeout(),this.setupDefaultViewTimeout()},unmounted(){this.clearEventHandler(),this.clearTouchBlockerTimeout(),this.clearDefaultViewTimeout()},methods:{handleTouchBlockerClick(e){e===!1&&(this.show=!1,this.setupEventHandler(),this.setupTouchBlockerTimeout(),this.setupDefaultViewTimeout())},setupEventHandler(){this.eventHandlerSetup||(this.events.forEach(e=>{document.addEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.eventHandlerSetup=!0)},clearEventHandler(){this.eventHandlerSetup&&(this.events.forEach(e=>{document.removeEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.eventHandlerSetup=!1)},setupTouchBlockerTimeout(){this.touchBlockerCountdownCountdownInterval===void 0&&(this.touchBlockerCountdownCountdownInterval=setInterval(this.updateTouchBlockerCountdown,1e3))},clearTouchBlockerTimeout(){this.touchBlockerCountdownCountdownInterval!==void 0&&(clearInterval(this.touchBlockerCountdownCountdownInterval),this.touchBlockerCountdownCountdownInterval=void 0)},updateTouchBlockerCountdown(){this.touchBlockerCountdown===void 0?this.touchBlockerCountdown=this.touchBlockerTimeout:(this.touchBlockerCountdown-=1,this.touchBlockerCountdown<1&&this.showTouchBlocker())},setupDefaultViewTimeout(){this.defaultViewCountdownInterval===void 0&&this.mqttStore.getDefaultView!==this.$route.name&&this.defaultViewTimeout!==void 0&&(this.defaultViewCountdownInterval=setInterval(this.updateDefaultViewCountdown,1e3))},clearDefaultViewTimeout(){this.defaultViewCountdownInterval!==void 0&&(clearInterval(this.defaultViewCountdownInterval),this.defaultViewCountdownInterval=void 0)},updateDefaultViewCountdown(){this.defaultViewCountdown===void 0&&this.defaultViewTimeout!==void 0?this.defaultViewCountdown=this.defaultViewTimeout:this.$route.name===this.mqttStore.getDefaultView?this.clearDefaultViewTimeout():(this.defaultViewCountdown-=1,this.defaultViewCountdown<1&&this.showDefaultView())},handleDocumentEvent(){this.touchBlockerCountdown=this.touchBlockerTimeout,this.defaultViewCountdown=this.defaultViewTimeout,this.setupDefaultViewTimeout(),this.show=!1},showTouchBlocker(){this.show=!0,this.clearTouchBlockerTimeout()},showDefaultView(){this.clearDefaultViewTimeout(),this.$route.name!==this.mqttStore.getDefaultView&&this.$router.push({name:this.mqttStore.getDefaultView})}}},[["render",function(e,t,o,n,a,i){const r=h("IModal");return p(),C(E,{to:"body"},[s(r,{class:"touch-blocker",size:"sm",color:"dark","model-value":a.show,"onUpdate:modelValue":t[0]||(t[0]=l=>i.handleTouchBlockerClick(l))},{default:c(()=>t[1]||(t[1]=[W("img",{class:"logo",src:x},null,-1),W("p",null," Bitte das Display berühren. ",-1)])),_:1,__:[1]},8,["model-value"])])}],["__scopeId","data-v-2d58d6dd"]])},data:()=>({client:{connected:!1},connection:{protocol:location.protocol=="https:"?"wss":"ws",host:location.hostname,port:parseInt(location.port)||(location.protocol=="https:"?443:80),endpoint:"/ws",connectTimeout:4e3,reconnectPeriod:4e3},mqttTopicsToSubscribe:["openWB/bat/config/configured","openWB/bat/get/power","openWB/bat/get/soc","openWB/chargepoint/+/config","openWB/chargepoint/+/get/charge_state","openWB/chargepoint/+/get/connected_vehicle/+","openWB/chargepoint/+/set/charge_template","openWB/chargepoint/+/set/charge_template/chargemode/scheduled_charging/plans/+","openWB/chargepoint/+/set/charge_template/time_charging/plans/+","openWB/chargepoint/+/get/phases_in_use","openWB/chargepoint/+/get/plug_state","openWB/chargepoint/+/get/power","openWB/chargepoint/+/get/rfid","openWB/chargepoint/+/set/current","openWB/chargepoint/+/set/manual_lock","openWB/chargepoint/+/set/log","openWB/chargepoint/+/set/rfid","openWB/chargepoint/get/power","openWB/counter/+/get/power","openWB/counter/get/hierarchy","openWB/counter/set/home_consumption","openWB/optional/et/provider","openWB/optional/et/get/prices","openWB/optional/int_display/theme","openWB/optional/int_display/standby","openWB/optional/rfid/active","openWB/pv/config/configured","openWB/pv/get/power","openWB/system/current_branch","openWB/system/current_commit","openWB/system/ip_address","openWB/system/time","openWB/system/version","openWB/vehicle/+/get/fault_state","openWB/vehicle/+/name","openWB/vehicle/+/soc_module/config"],mqttStore:B(),chartInterval:"",clearConsoleHandler:void 0}),computed:{changesLocked(){return this.mqttStore.getLockChanges&&this.mqttStore.settings.changesLocked}},created(){this.createConnection()},mounted(){let e=window.location.search;if(e!=""){let n=new URLSearchParams(e);if(n.has("data")){let a=JSON.parse(n.get("data"));Object.entries(a).forEach(([i,r])=>{i.startsWith("parentChargePoint")?this.mqttStore.updateSetting(i,parseInt(r)):this.mqttStore.updateSetting(i,r)})}}this.doSubscribe(this.mqttTopicsToSubscribe),this.chartInterval=setInterval(this.mqttStore.updateChartData,5e3);const t=new Date,o=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0).getTime()-t.getTime();this.clearConsoleHandler=setTimeout(()=>this.clearConsole(),o)},beforeUnmount(){this.doUnsubscribe(this.mqttTopicsToSubscribe),clearInterval(this.chartInterval),clearTimeout(this.clearConsoleHandler)},methods:{clearConsole(){this.clearConsoleHandler=setTimeout(()=>this.clearConsole(),864e5)},createConnection(){const{protocol:e,host:t,port:o,endpoint:n,...a}=this.connection,i=`${e}://${t}:${o}${n}`;try{this.client=R.connect(i,a)}catch{}this.client.on("connect",()=>{}),this.client.on("error",r=>{}),this.client.on("message",(r,l)=>{if(l.toString().length>0){let g;try{g=JSON.parse(l.toString())}catch{g=l.toString()}this.mqttStore.addTopic(r,g)}else this.mqttStore.removeTopic(r)})},doSubscribe(e){e.forEach(t=>{this.mqttStore.initTopic(t)}),this.client.subscribe(e,{},t=>{})},doUnsubscribe(e){e.forEach(t=>{this.mqttStore.removeTopic(t)}),this.client.unsubscribe(e,t=>{})},doPublish(e,t,o=!0,n=2){let a={qos:n,retain:o};this.client.publish(e,JSON.stringify(t),a,i=>{})},sendTopicToBroker(e,t=void 0){let o=e.replace("openWB/","openWB/set/");t===void 0&&(t=this.mqttStore.topics[e]),this.doPublish(o,t)},sendCommand(e){this.doPublish("openWB/set/command/"+this.client.options.clientId+"/todo",e,!1)},sendSystemCommand(e,t={}){this.sendCommand({command:e,data:t})}}},[["render",function(e,t,o,n,a,i){const r=h("DateTime"),l=h("i-column"),g=h("i-row"),d=h("i-container"),m=h("LockNavItem"),u=h("NavBar"),_=h("TouchBlocker"),v=h("i-layout-aside"),j=h("RouterView"),M=h("i-layout-content"),N=h("i-layout");return p(),C(N,{vertical:""},{default:c(()=>[s(v,{class:"_position:fixed"},{default:c(()=>[s(d,{fluid:"",class:"_margin-bottom:1"},{default:c(()=>[s(g,{center:""},{default:c(()=>[s(l,null,{default:c(()=>[s(r)]),_:1})]),_:1})]),_:1}),s(m),s(u,{"changes-locked":i.changesLocked},null,8,["changes-locked"]),s(_)]),_:1}),s(M,null,{default:c(()=>[s(j,{"changes-locked":i.changesLocked},null,8,["changes-locked"])]),_:1})]),_:1})}],["__scopeId","data-v-6f8bc44f"]]),I={},T=function(e,t,o){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),r=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if((l=function(u){return"/openWB/web/display/themes/cards/"+u}(l))in I)return;I[l]=!0;const g=l.endsWith(".css"),d=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const m=document.createElement("link");return m.rel=g?"stylesheet":"modulepreload",g||(m.as="script"),m.crossOrigin="",m.href=l,r&&m.setAttribute("nonce",r),document.head.appendChild(m),g?new Promise((u,_)=>{m.addEventListener("load",u),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))}):void 0}))}function a(i){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=i,window.dispatchEvent(r),!r.defaultPrevented)throw i}return n.then(i=>{for(const r of i||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})},ae=b({name:"WelcomeView",data:()=>({mqttStore:B()}),mounted(){setTimeout(this.selectFirstRoute,3e3)},methods:{selectFirstRoute(){this.mqttStore.getDefaultView&&this.$router.push({name:this.mqttStore.getDefaultView})}}},[["render",function(e,t,o,n,a,i){const r=h("i-card"),l=h("i-column"),g=h("i-row"),d=h("i-container");return p(),C(d,null,{default:c(()=>[s(g,{center:"",middle:""},{default:c(()=>[s(l,null,{default:c(()=>[s(r,{color:"primary"},{header:c(()=>t[0]||(t[0]=[f(" Cards Theme ",-1)])),default:c(()=>[t[1]||(t[1]=W("img",{class:"logo",src:x},null,-1))]),_:1,__:[1]})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-e364c277"]]),re=U({history:z("/openWB/web/display/themes/cards/"),routes:[{path:"/",name:"welcome",component:ae},{path:"/Dashboard",name:"dashboard",component:()=>T(()=>import("./DashboardView-BdPINJqC.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))},{path:"/EnergyFlow",name:"energy-flow",component:()=>T(()=>import("./EnergyFlowView-CC3L0OJk.js"),__vite__mapDeps([10,1,2,3,4,5,11,12,7,13]))},{path:"/ChargePoints",name:"charge-points",component:()=>T(()=>import("./ChargePointsView-DngxMDSm.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,11,12,15]))},{path:"/Status",name:"status",component:()=>T(()=>import("./StatusView-DWDOduFq.js"),__vite__mapDeps([16,7,3,2,4,1,5]))}]}),y=G(ie);y.use(K()),y.use(re),y.use(J,{colorMode:"dark",components:Y}),y.mount("#app");export{oe as C,te as N,B as u};
