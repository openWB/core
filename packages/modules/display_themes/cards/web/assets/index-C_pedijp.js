const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardView-QM7fZc3o.js","assets/DashboardCard-DLhWU61X.js","assets/vendor-ELON-1B6.js","assets/vendor-inkline-Vr05PGFJ.js","assets/vendor-inkline-D4WCJBWE.css","assets/DashboardCard-B-II5etE.css","assets/ChargePointPlugBadge-BWqpAuQc.js","assets/vendor-fortawesome-DMNGE2-K.js","assets/ChargePointPlugBadge-C9uUTXDh.css","assets/DashboardView-BY6vqdxu.css","assets/EnergyFlowView-Bts5x4gm.js","assets/ChargeModeModal-Dw7cgLgR.js","assets/EnergyFlowView-DZYEiDRA.css","assets/ChargePointsView-BerB3hzG.js","assets/ChargePointsView-3NMKIbkE.css","assets/StatusView-BCJE8foI.js"])))=>i.map(i=>d[i]);
import{o as p,e as k,k as f,x as T,f as P,j as B,F as S,H as N,l as u,n as _,q as a,i as v,A as E,s,I as D,z as F,R as j,J as R,G as z,K as H,L as G,M as K,N as J,V as Y}from"./vendor-ELON-1B6.js";import{_ as V,I as Z,c as Q}from"./vendor-inkline-Vr05PGFJ.js";import{l as I,f as q,a as A,F as L,b as X,c as ee,d as te,e as ne,g as oe,h as re,i as ie}from"./vendor-fortawesome-DMNGE2-K.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const ae={name:"DateTime",data(){return{dateTimeInterval:"",date:"",time:""}},mounted(){this.update(),this.dateTimeInterval=setInterval(this.update,1e3)},beforeUnmount(){clearInterval(this.dateTimeInterval)},methods:{update(){const e=new Date,t={weekday:"short",year:"numeric",month:"2-digit",day:"2-digit"},n={hour:"2-digit",minute:"2-digit",second:"2-digit"};this.date=e.toLocaleDateString(void 0,t),this.time=e.toLocaleTimeString(void 0,n)}}};function se(e,t,n,i,r,o){return p(),k(S,null,[f(T(r.time),1),P(e.$slots,"default",{},()=>[t[0]||(t[0]=B("br",null,null,-1))]),f(T(r.date),1)],64)}const le=V(ae,[["render",se],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/DateTime.vue"]]),y=N("mqtt",{state:()=>({settings:{localIp:void 0,localBranch:void 0,localCommit:void 0,localVersion:void 0,parentChargePoint1:void 0,parentChargePoint2:void 0,hideLogin:!1},topics:{},chartData:{}}),getters:{getChargePointFilter:e=>{let t=[];return e.settings.parentChargePoint1!==void 0&&t.push(e.settings.parentChargePoint1),e.settings.parentChargePoint2!==void 0&&t.push(e.settings.parentChargePoint2),t},getWildcardIndexList:e=>(t,n=!1)=>{let i=t;n||(i="^"+t.replaceAll("/","\\/").replaceAll("+","[^+/]+").replaceAll("#","[^#/]+")+"$");let r=Object.keys(e.topics).filter(o=>o.match(i));return r.forEach((o,l,c)=>{c[l]=parseInt(o.match(/(?:\/)([0-9]+)(?=\/)*/g)[0].replace(/[^0-9]+/g,""))}),r},getWildcardTopics:e=>(t,n=!1)=>{let i=t;return n||(i="^"+t.replaceAll("/","\\/").replaceAll("+","[^+/]+").replaceAll("#","[^#/]+")+"$"),Object.keys(e.topics).filter(r=>r.match(i)).reduce((r,o)=>({...r,[o]:e.topics[o]}),{})},getObjectIds:e=>t=>{function n(i){let r=[];return i!==void 0&&i.forEach(o=>{o.type==t&&r.push(o.id),r=[...r,...n(o.children)]}),r}return n(e.topics["openWB/counter/get/hierarchy"])},getValueBool:e=>(t,n=!1)=>{let i=e.topics[t];return i!==void 0?i:(console.info("topic not found! using default",t,n),n)},getValueString:e=>(t,n="W",i="",r=!0,o=!1,l="---",c=void 0)=>{var g=!1,d=e.topics[t];if(d===void 0||c!==void 0&&d[c]===void 0)console.warn("topic not found! using default",t,l),m=l;else{c!==void 0&&(d=d[c]),o&&(d*=-1);for(var m=d.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}),h=d;r&&(h>999||h<-999);)switch(h=h/1e3,g=!0,i){case"":i="k";break;case"k":i="M";break;case"M":i="G";break}m=h.toLocaleString(void 0,{minimumFractionDigits:g?2:0,maximumFractionDigits:g?2:0})}return{textValue:`${m} ${i}${n}`,value:d,unit:n,scaledValue:h,scaledUnit:`${i}${n}`}},getChartData:e=>t=>e.chartData[t]===void 0?[]:e.chartData[t],getDisplayStandby:e=>e.topics["openWB/optional/int_display/standby"],getThemeConfiguration:e=>{if("openWB/optional/int_display/theme"in e.topics&&e.topics["openWB/optional/int_display/theme"]!==void 0&&"configuration"in e.topics["openWB/optional/int_display/theme"])return e.topics["openWB/optional/int_display/theme"].configuration},getDefaultView:e=>{if(e.getThemeConfiguration){const t={dashboard:e.getThemeConfiguration.enable_dashboard_view,"energy-flow":e.getThemeConfiguration.enable_energy_flow_view,"charge-points":e.getThemeConfiguration.enable_charge_points_view,status:e.getThemeConfiguration.enable_status_view};if(e.getThemeConfiguration.default_view!==void 0){if(t[e.getThemeConfiguration.default_view]===!0)return e.getThemeConfiguration.default_view;console.warn(`default view '${e.getThemeConfiguration.default_view}' is not enabled, check your configuration!`)}for(const[n,i]of Object.entries(t))if(i)return n}},getDefaultViewTimeout:e=>e.getThemeConfiguration?e.getThemeConfiguration.default_view_timeout:0,getDashboardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_view:!0},getEnergyFlowEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_energy_flow_view:!0},getChargePointsEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_charge_points_view:!0},getStateEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_status_view:!0},getGridCardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_card_grid:!0},getHomeCardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_card_home_consumption:!0},getBatteryCardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_card_battery_sum:!0},getChargePointsCardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_card_charge_point_sum:!0},getPvCardEnabled(e){return e.getThemeConfiguration?e.getThemeConfiguration.enable_dashboard_card_inverter_sum:!0},getLockChanges(e){return e.getThemeConfiguration?e.getThemeConfiguration.lock_changes:!0},getSimpleChargePointView(e){return e.getThemeConfiguration?e.getThemeConfiguration.simple_charge_point_view:!1},getAccessAllowed(e){return e.topics["openWB/system/security/access_allowed"]===void 0?!1:e.topics["openWB/system/security/access_allowed"]===!0},getGridId(e){let t=e.topics["openWB/counter/get/hierarchy"];if(t!==void 0&&Object.keys(t).length>0){let n=Object.keys(e.topics["openWB/counter/get/hierarchy"])[0];if(console.debug("getGridId",n,e.topics["openWB/counter/get/hierarchy"][n]),e.topics["openWB/counter/get/hierarchy"][n].type=="counter")return e.topics["openWB/counter/get/hierarchy"][n].id}},getGridPower(e){return(t="textValue")=>{let n=e.getGridId;if(n===void 0)return"---";let i=e.getValueString(`openWB/counter/${n}/get/power`,"W");if(Object.hasOwnProperty.call(i,t))return i[t];if(t=="object")return i;console.error("returnType not found!",t,i)}},getGridPowerChartData(e){let t=e.getGridId;return t===void 0?[]:e.getChartData(`openWB/counter/${t}/get/power`)},getHomePower(e){return(t="textValue")=>{let n=e.getValueString("openWB/counter/set/home_consumption","W");if(Object.hasOwnProperty.call(n,t))return n[t];if(t=="object")return n;console.error("returnType not found!",t,n)}},getHomePowerChartData(e){return e.getChartData("openWB/counter/set/home_consumption")},getBatteryConfigured(e){return e.getValueBool("openWB/bat/config/configured")},getBatteryPower(e){return(t="textValue")=>{let n=e.getValueString("openWB/bat/get/power","W");if(Object.hasOwnProperty.call(n,t))return n[t];if(t=="object")return n;console.error("returnType not found!",t,n)}},getBatteryPowerChartData(e){return e.getChartData("openWB/bat/get/power")},getBatterySoc(e){return(t="textValue")=>{let n=e.getValueString("openWB/bat/get/soc","%","",!1);if(Object.hasOwnProperty.call(n,t))return n[t];if(t=="object")return n;console.error("returnType not found!",t,n)}},getBatterySocChartData(e){return e.getChartData("openWB/bat/get/soc")},getBatteryMode(e){return e.topics["openWB/general/chargemode_config/pv_charging/bat_mode"]},getPvConfigured(e){return e.getValueBool("openWB/pv/config/configured")},getPvPower(e){return(t="textValue")=>{var n=e.getValueString("openWB/pv/get/power","W","");if(Object.hasOwnProperty.call(n,t))return n[t];if(t=="object")return n;console.error("returnType not found!",t,n)}},getPvPowerChartData(e){return e.getChartData("openWB/pv/get/power").map(t=>t*-1)},getChargePointSumPower(e){return(t="textValue")=>{var n=e.getValueString("openWB/chargepoint/get/power","W");if(Object.hasOwnProperty.call(n,t))return n[t];if(t=="object")return n;console.error("returnType not found!",t,n)}},getChargePointSumPowerChartData(e){return e.getChartData("openWB/chargepoint/get/power")},getChargePointIds(e){let t=e.getObjectIds("cp").filter(i=>e.accessChargePointAllowed(i)),n=this.getChargePointFilter;return n.length>0?(console.debug("charge points are filtered!",t,n),t.filter(i=>n.includes(i))):t},accessChargePointAllowed(e){return t=>e.getChargePointName(t)!==void 0},getChargePointName(e){return t=>{if(e.topics[`openWB/chargepoint/${t}/config`]!==void 0)return e.topics[`openWB/chargepoint/${t}/config`].name}},getChargePointPower(e){return(t,n="textValue")=>{var i=e.getValueString(`openWB/chargepoint/${t}/get/power`,"W");if(Object.hasOwnProperty.call(i,n))return i[n];if(n=="object")return i;console.error("returnType not found!",n,i)}},getChargePointImportedSincePlugged(e){return t=>({energy:e.getValueString(`openWB/chargepoint/${t}/set/log`,"Wh","",!0,!1,"---","imported_since_plugged").textValue,range:e.getValueString(`openWB/chargepoint/${t}/set/log`,"m","k",!1,!1,"---","range_charged").textValue})},getChargePointPowerChartData(e){return t=>e.getChartData(`openWB/chargepoint/${t}/get/power`)},getChargePointSetCurrent(e){return(t,n="textValue")=>{let i=e.getValueString(`openWB/chargepoint/${t}/set/current`,"A");if(Object.hasOwnProperty.call(i,n))return i[n];if(n=="object")return i;console.error("returnType not found!",n,i)}},getChargePointPhasesInUse(e){return t=>{const n=["/","①","②","③"],i=e.topics[`openWB/chargepoint/${t}/get/phases_in_use`];return i!==void 0&&i>=0&&i<n.length?n[e.topics[`openWB/chargepoint/${t}/get/phases_in_use`]]:(console.warn("topic not found!",`openWB/chargepoint/${t}/get/phases_in_use`),"?")}},getChargePointPlugState(e){return t=>e.getValueBool(`openWB/chargepoint/${t}/get/plug_state`)},getChargePointChargeState(e){return t=>e.getValueBool(`openWB/chargepoint/${t}/get/charge_state`)},getChargePointManualLock(e){return t=>e.getValueBool(`openWB/chargepoint/${t}/set/manual_lock`)},getChargepointTagState(e){return t=>{if([void 0,null,""].includes(e.topics[`openWB/chargepoint/${t}/set/rfid`])){if(![void 0,null,""].includes(e.topics[`openWB/chargepoint/${t}/get/rfid`]))return 1}else return 2;return 0}},getChargePointConnectedVehicleConfig(e){return t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/config`]},getChargePointConnectedVehicleChargeMode(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.translateChargeMode(e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.selected)}},getChargePointConnectedVehiclePriority(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).prio}},getChargePointConnectedVehicleInfo(e){return t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`]},getChargePointConnectedVehicleId(e){return t=>{if(e.getChargePointConnectedVehicleInfo(t))return e.getChargePointConnectedVehicleInfo(t).id}},getChargePointConnectedVehicleChargeTemplateIndex(e){return t=>{if(e.getChargePointConnectedVehicleConfig(t))return e.getChargePointConnectedVehicleConfig(t).charge_template}},getChargePointConnectedVehicleChargeTemplate(e){return t=>e.topics[`openWB/chargepoint/${t}/set/charge_template`]},getChargePointConnectedVehicleEvTemplate(e){return t=>{if(e.getChargePointConnectedVehicleConfig(t))return e.getChargePointConnectedVehicleConfig(t).ev_template}},getChargePointConnectedVehicleName(e){return t=>{if(e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`])return e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/info`].name}},getChargePointConnectedVehicleSoc(e){return t=>e.topics[`openWB/chargepoint/${t}/get/connected_vehicle/soc`]},getChargePointConnectedVehicleTimeChargingActive(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).time_charging.active}},getChargePointConnectedVehicleTimeChargingRunning(e){return t=>{let n=e.getChargePointConnectedVehicleConfig(t).time_charging_in_use;return n!==void 0?n:!1}},getChargePointConnectedVehicleInstantChargingCurrent(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.current}},getChargePointConnectedVehicleInstantChargingLimit(e){return t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.limit:{selected:void 0}},getChargePointConnectedVehicleInstantChargingPhases(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.instant_charging.phases_to_use}},getChargePointConnectedVehiclePvChargingFeedInLimit(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.feed_in_limit}},getChargePointConnectedVehiclePvChargingMinCurrent(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_current}},getChargePointConnectedVehiclePvChargingPhases(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.phases_to_use}},getChargePointConnectedVehiclePvChargingLimit(e){return t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.limit:{selected:void 0}},getChargePointConnectedVehiclePvChargingMinSoc(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_soc}},getChargePointConnectedVehiclePvChargingMinSocCurrent(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.min_soc_current}},getChargePointConnectedVehiclePvChargingMinSocPhases(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.pv_charging.phases_to_use_min_soc}},getChargePointConnectedVehicleEcoChargingCurrent(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.current}},getChargePointConnectedVehicleEcoChargingPhases(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.phases_to_use}},getChargePointConnectedVehicleEcoChargingLimit(e){return t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.limit:{selected:void 0}},getChargePointConnectedVehicleEcoChargingMaxPrice(e){return t=>{if(e.getChargePointConnectedVehicleChargeTemplate(t))return e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.eco_charging.max_price*1e5}},getChargePointConnectedVehicleScheduledChargingPlans(e){return t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).chargemode.scheduled_charging.plans:{}},getChargePointConnectedVehicleTimeChargingPlans(e){return t=>e.getChargePointConnectedVehicleChargeTemplate(t)?e.getChargePointConnectedVehicleChargeTemplate(t).time_charging.plans:{}},getVehicleList(e){return Object.keys(e.getWildcardTopics("openWB/vehicle/+/info")).map(t=>parseInt(t.split("/")[2]))},getVehicleName(e){return t=>e.topics[`openWB/vehicle/${t}/name`]},getVehicleInfo(e){return t=>e.topics[`openWB/vehicle/${t}/info`]},getVehicleSocConfigured(e){return t=>e.topics[`openWB/vehicle/${t}/soc_module/config`]?.type!=null},getVehicleSocIsManual(e){return t=>e.topics[`openWB/vehicle/${t}/soc_module/config`]?.type=="manual"},getVehicleFaultState(e){return t=>e.topics[`openWB/vehicle/${t}/get/fault_state`]?e.topics[`openWB/vehicle/${t}/get/fault_state`]:0},getSystemTime(e){if(e.topics["openWB/system/time"])return new Date(e.topics["openWB/system/time"]*1e3).toLocaleString()},getSystemIp(e){if(e.settings.localIp!==void 0)return e.settings.localIp;if(e.topics["openWB/system/ip_address"])return e.topics["openWB/system/ip_address"]},getSystemVersion(e){if(e.settings.localVersion!==void 0)return e.settings.localVersion;if(e.topics["openWB/system/version"])return e.topics["openWB/system/version"]},getSystemBranch(e){if(e.settings.localBranch!==void 0)return e.settings.localBranch;if(e.topics["openWB/system/current_branch"])return e.topics["openWB/system/current_branch"]},getSystemCurrentCommit(e){if(e.settings.localCommit!==void 0)return e.settings.localCommit;if(e.topics["openWB/system/current_commit"])return e.topics["openWB/system/current_commit"]},getRfidEnabled(){return this.getValueBool("openWB/optional/rfid/active")},getEtConfigured(e){return e.topics["openWB/optional/ep/configured"]!==void 0?e.topics["openWB/optional/ep/configured"]:!1},getEtPrices(e){return e.topics["openWB/optional/ep/get/prices"]}},actions:{updateSetting(e,t){e in this.settings&&(this.settings[e]=t)},initTopic(e,t=void 0){e.includes("#")||e.includes("+")?console.debug("skipping init of wildcard topic:",e):this.addTopic(e,t)},addTopic(e,t){console.debug("addTopic",e,t),this.topics[e]=t},removeTopic(e){e.includes("#")||e.includes("+")?(console.debug("expanding wildcard topic for removal:",e),Object.keys(this.getWildcardTopics(e)).forEach(t=>{console.debug("removing wildcardTopic:",t),delete this.topics[t]})):delete this.topics[e]},updateTopic(e,t,n=void 0){const i=(r,o,l)=>o.split(".").reduce((c,g,d)=>c[g]=o.split(".").length===++d?l:c[g]||{},r);if(e in this.topics)return n!=null?i(this.topics[e],n,t):this.topics[e]=t,this.topics[e];console.debug("topic not found: ",e)},updateChartData(){for(const[e,t]of Object.entries(this.topics))(e.endsWith("home_consumption")||e.endsWith("power")||e.endsWith("soc"))&&(this.chartData[e]===void 0&&(this.chartData[e]=[]),t!=null&&(this.chartData[e].push(t),this.chartData[e].slice(-128)))},updateState(e,t,n=void 0){return console.debug("updateState:",e,t,n),this.updateTopic(e,t,n)},chargeModeList(){var e=[{id:"instant_charging"},{id:"pv_charging"},{id:"scheduled_charging"},{id:"eco_charging"},{id:"stop"}];return e.forEach(t=>{t.label=this.translateChargeMode(t.id).label,t.class=this.translateChargeMode(t.id).class}),e},translateChargeMode(e){switch(e){case"instant_charging":return{mode:e,label:"Sofort",class:"danger"};case"pv_charging":return{mode:e,label:"PV",class:"success"};case"scheduled_charging":return{mode:e,label:"Ziel",class:"primary"};case"time_charging":return{mode:e,label:"Zeit",class:"warning"};case"eco_charging":return{mode:e,label:"Eco",class:"secondary"};case"stop":return{mode:e,label:"Stop",class:"dark"};default:return console.warn("unknown charge mode:",e),{mode:e,label:e,class:e}}},checkChangesLockCode(e){return!!(this.getThemeConfiguration&&this.getThemeConfiguration.lock_changes_code==e)},formatDate(e,t={year:"numeric",month:"2-digit",day:"2-digit"}){return new Date(e).toLocaleDateString(void 0,t)},formatDateRange(e,t="-"){const n={year:"numeric",month:"2-digit",day:"2-digit"};let i={day:"2-digit"};const r=new Date(e[0]),o=new Date(e[1]);return r.getFullYear()==o.getFullYear()?(t=`.${t}`,r.getMonth()!=o.getMonth()&&(i.month=n.month)):i=n,`${this.formatDate(e[0],i)}${t}${this.formatDate(e[1],n)}`},formatWeeklyScheduleDays(e){const t=["Mo","Di","Mi","Do","Fr","Sa","So"];let n=[],i=null;return e.forEach((r,o)=>{r?i===null&&(i=o):i!==null&&(i===o-1?n.push(t[i]):n.push(`${t[i]}-${t[o-1]}`),i=null)}),i!==null&&(i===e.length-1?n.push(t[i]):n.push(`${t[i]}-${t[e.length-1]}`)),n.join(", ")}}}),ce={name:"NavItem",props:{to:{type:Object,required:!0}}};function ue(e,t,n,i,r,o){const l=u("i-nav-item");return p(),_(l,{to:n.to,"active-class":"-active",class:"_border _border-color:primary _text-align:center"},{default:a(()=>[P(e.$slots,"default",{},void 0,!0)]),_:3},8,["to"])}const de=V(ce,[["render",ue],["__scopeId","data-v-079bc5e0"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/NavItem.vue"]]),ge={name:"NavBar",components:{NavItem:de},data(){return{mqttStore:y()}},computed:{accessAllowed(){return this.mqttStore.getAccessAllowed}}};function he(e,t,n,i,r,o){const l=u("nav-item"),c=u("i-nav");return o.accessAllowed?(p(),_(c,{key:0,vertical:"",class:"_align-items:stretch",size:"lg"},{default:a(()=>[r.mqttStore.getDashboardEnabled?(p(),_(l,{key:0,to:{name:"dashboard"}},{default:a(()=>[...t[0]||(t[0]=[f(" Übersicht ",-1)])]),_:1})):v("",!0),r.mqttStore.getEnergyFlowEnabled?(p(),_(l,{key:1,to:{name:"energy-flow"}},{default:a(()=>[...t[1]||(t[1]=[f(" Energiefluss ",-1)])]),_:1})):v("",!0),r.mqttStore.getChargePointsEnabled&&r.mqttStore.getChargePointIds.length>0?(p(),_(l,{key:2,to:{name:"charge-points"}},{default:a(()=>[...t[2]||(t[2]=[f(" Ladepunkte ",-1)])]),_:1})):v("",!0),r.mqttStore.getStateEnabled?(p(),_(l,{key:3,to:{name:"status"}},{default:a(()=>[...t[3]||(t[3]=[f(" Status ",-1)])]),_:1})):v("",!0)]),_:1})):v("",!0)}const me=V(ge,[["render",he],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/NavBar.vue"]]);I.add(q,A);const pe={name:"NumberPad",components:{FontAwesomeIcon:L},emits:["key:digit","key:clear","key:delete"],data(){return{buttonRows:[[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"}],[{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"}],[{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"}]]}},methods:{emitDigit(e){this.$emit("key:digit",e)},emitClear(){this.$emit("key:clear")},emitDelete(){this.$emit("key:delete")}}};function fe(e,t,n,i,r,o){const l=u("i-button"),c=u("i-column"),g=u("i-row"),d=u("FontAwesomeIcon"),m=u("i-container");return p(),_(m,null,{default:a(()=>[(p(!0),k(S,null,E(r.buttonRows,h=>(p(),_(g,{key:h,center:"",class:"_padding-bottom:1"},{default:a(()=>[(p(!0),k(S,null,E(h,C=>(p(),_(c,{key:C.value,class:"pin-button-column"},{default:a(()=>[s(l,{size:"lg",class:"pin-button",onClick:b=>o.emitDigit(C.value)},{default:a(()=>[f(T(C.label),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:2},1024))),128)),s(g,{center:""},{default:a(()=>[s(c,{class:"pin-button-column"},{default:a(()=>[s(l,{size:"lg",class:"pin-button",onClick:t[0]||(t[0]=h=>o.emitClear())},{default:a(()=>[s(d,{"fixed-width":"",icon:["fas","fa-eraser"]})]),_:1})]),_:1}),s(c,{class:"pin-button-column"},{default:a(()=>[s(l,{size:"lg",class:"pin-button",onClick:t[1]||(t[1]=h=>o.emitDigit("0"))},{default:a(()=>[...t[3]||(t[3]=[f(" 0 ",-1)])]),_:1})]),_:1}),s(c,{class:"pin-button-column"},{default:a(()=>[s(l,{size:"lg",class:"pin-button",onClick:t[2]||(t[2]=h=>o.emitDelete())},{default:a(()=>[s(d,{"fixed-width":"",icon:["fas","fa-delete-left"]})]),_:1})]),_:1})]),_:1})]),_:1})}const Ce=V(pe,[["render",fe],["__scopeId","data-v-f10bd21b"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/NumberPad.vue"]]),_e={name:"CodeInputModal",components:{NumberPad:Ce},props:{modelValue:{type:Boolean,required:!0},backgroundColor:{type:String,default:"warning"},placeholderCharacter:{type:String,default:"*",validator(e){return e.length==1}},inputVisible:{type:Boolean,default:!1},minLength:{type:Number,default:4},maxLength:{type:Number,default:4}},emits:["update:modelValue","update:inputValue"],data(){return{number:"",modalBackground:this.backgroundColor}},computed:{placeholder(){return this.placeholderCharacter.repeat(this.minLength)},enableSubmit(){return this.number.length>=this.minLength&&this.number.length<=this.maxLength}},watch:{modelValue(e,t){e===!1&&t===!0&&this.clear()}},methods:{abort(){this.$emit("update:modelValue",!1)},addDigit(e){this.number.length<this.maxLength&&(this.number+=e)},removeDigit(){this.number=this.number.slice(0,-1)},clear(){this.number=""},submit(){this.$emit("update:inputValue",this.number)},success(e="success"){this.modalBackground=e,setTimeout(()=>{this.$emit("update:modelValue",!1),this.modalBackground=this.backgroundColor},500)},error(e="danger"){this.modalBackground=e,setTimeout(()=>{this.clear(),this.modalBackground=this.backgroundColor},2e3)}}};function we(e,t,n,i,r,o){const l=u("i-input"),c=u("i-column"),g=u("i-row"),d=u("NumberPad"),m=u("i-container"),h=u("i-button"),C=u("i-modal");return p(),_(D,{to:"body"},[s(C,{"model-value":n.modelValue,color:r.modalBackground,"onUpdate:modelValue":t[4]||(t[4]=b=>e.$emit("update:modelValue",b))},{header:a(()=>[P(e.$slots,"header",{},()=>[t[5]||(t[5]=f(" **HEADER** ",-1))])]),footer:a(()=>[s(m,null,{default:a(()=>[s(g,null,{default:a(()=>[s(c,null,{default:a(()=>[s(h,{color:"danger",onClick:o.abort},{default:a(()=>[P(e.$slots,"abort",{},()=>[t[6]||(t[6]=f(" Zurück ",-1))])]),_:3},8,["onClick"])]),_:3}),s(c,{class:"_text-align:right"},{default:a(()=>[o.enableSubmit?(p(),_(h,{key:0,color:"success",onClick:o.submit},{default:a(()=>[P(e.$slots,"submit",{},()=>[t[7]||(t[7]=f(" OK ",-1))])]),_:3},8,["onClick"])):v("",!0)]),_:3})]),_:3})]),_:3})]),default:a(()=>[s(m,null,{default:a(()=>[s(g,{center:"",class:"_padding-bottom:1"},{default:a(()=>[s(c,null,{default:a(()=>[s(l,{modelValue:r.number,"onUpdate:modelValue":t[0]||(t[0]=b=>r.number=b),placeholder:o.placeholder,readonly:"",size:"lg",type:n.inputVisible?"text":"password",class:"_text-align:center"},null,8,["modelValue","placeholder","type"])]),_:1})]),_:1}),s(d,{"onKey:digit":t[1]||(t[1]=b=>o.addDigit(b)),"onKey:clear":t[2]||(t[2]=b=>o.clear()),"onKey:delete":t[3]||(t[3]=b=>o.removeDigit(b))})]),_:1})]),_:3},8,["model-value","color"])])}const be=V(_e,[["render",we],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/CodeInputModal.vue"]]);I.add(X,ee,q,A);const ve={name:"LockNavItem",components:{FontAwesomeIcon:L,CodeInputModal:be},props:{},data(){return{mqttStore:y(),modalPinEntryVisible:!1,modalPinEntryColor:"warning",code:"",countdown:0,countdownInterval:void 0,events:["mousemove","touchmove","wheel","click"]}},computed:{changesLocked:{get(){return this.mqttStore.settings.changesLocked},set(e){this.mqttStore.settings.changesLocked=e}},timer(){return Math.trunc(this.countdown/60).toString()+":"+(this.countdown%60).toString().padStart(2,"0")}},mounted(){this.changesLocked=!0},methods:{toggleChangesLock(){this.changesLocked?this.unlockChanges():this.lockChanges()},unlockChanges(){this.modalPinEntryVisible=!0},checkUnlockCode(e){this.mqttStore.checkChangesLockCode(e)?(this.$refs.lockInput.success("success"),this.changesLocked=!1,this.mqttStore.getDisplayStandby>0&&(this.countdown=this.mqttStore.getDisplayStandby,this.countdownInterval=setInterval(this.updateCountdown,1e3),this.events.forEach(t=>{document.addEventListener(t,this.handleDocumentEvent,{passive:!0})}))):(console.warn("check unlock code failed!"),this.$refs.lockInput.error("danger"))},lockChanges(){this.changesLocked=!0,this.events.forEach(e=>{document.removeEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.countdownInterval!==void 0&&(clearInterval(this.countdownInterval),this.countdownInterval=void 0)},updateCountdown(){this.countdown-=1,this.countdown<1&&this.lockChanges()},handleDocumentEvent(){this.countdown=this.mqttStore.getDisplayStandby}}},Ve={key:0,class:"_padding-left:1"};function Be(e,t,n,i,r,o){const l=u("FontAwesomeIcon"),c=u("i-button"),g=u("CodeInputModal");return p(),k(S,null,[r.mqttStore.getLockChanges?(p(),_(c,{key:0,class:"_padding-left:0 _padding-right:0 _margin-bottom:1",size:"lg",block:"",color:o.changesLocked?"danger":"success",onClick:t[0]||(t[0]=d=>o.toggleChangesLock())},{default:a(()=>[s(l,{"fixed-width":"",icon:o.changesLocked?["fas","fa-lock"]:["fas","fa-lock-open"],class:F(o.changesLocked?"_color:danger-80":"_color:success-80")},null,8,["icon","class"]),!o.changesLocked&&r.countdownInterval?(p(),k("span",Ve,T(o.timer),1)):v("",!0)]),_:1},8,["color"])):v("",!0),s(g,{ref:"lockInput",modelValue:r.modalPinEntryVisible,"onUpdate:modelValue":t[1]||(t[1]=d=>r.modalPinEntryVisible=d),"min-length":4,"max-length":10,"onUpdate:inputValue":o.checkUnlockCode},{header:a(()=>[...t[2]||(t[2]=[f(" Bitte den PIN zur Freigabe von Änderungen eingeben. ",-1)])]),_:1},8,["modelValue","onUpdate:inputValue"])],64)}const ke=V(ve,[["render",Be],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/LockNavItem.vue"]]),U="/openWB/web/display/themes/cards/openWB_logo_dark.png",ye={name:"TouchBlocker",data(){return{mqttStore:y(),show:!1,touchBlockerCountdown:void 0,touchBlockerCountdownInterval:void 0,defaultViewCountdown:void 0,defaultViewCountdownInterval:void 0,events:["mousemove","touchmove","wheel","click"],eventHandlerSetup:!1}},computed:{configuredDisplayStandby(){if(!(this.mqttStore.getDisplayStandby===0||this.mqttStore.getDisplayStandby===void 0))return this.mqttStore.getDisplayStandby},configuredDefaultViewTimeout(){if(!(this.mqttStore.getDefaultViewTimeout===0||this.mqttStore.getDefaultViewTimeout===void 0))return this.mqttStore.getDefaultViewTimeout},touchBlockerTimeout(){return Math.max(this.configuredDisplayStandby-3,1)},defaultViewTimeout(){return this.configuredDefaultViewTimeout}},mounted(){this.setupEventHandler(),this.setupTouchBlockerTimeout(),this.setupDefaultViewTimeout()},unmounted(){this.clearEventHandler(),this.clearTouchBlockerTimeout(),this.clearDefaultViewTimeout()},methods:{handleTouchBlockerClick(e){e===!1&&(this.show=!1,this.setupEventHandler(),this.setupTouchBlockerTimeout(),this.setupDefaultViewTimeout())},setupEventHandler(){this.eventHandlerSetup||(this.events.forEach(e=>{document.addEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.eventHandlerSetup=!0)},clearEventHandler(){this.eventHandlerSetup&&(this.events.forEach(e=>{document.removeEventListener(e,this.handleDocumentEvent,{passive:!0})}),this.eventHandlerSetup=!1)},setupTouchBlockerTimeout(){this.touchBlockerCountdownCountdownInterval===void 0&&(this.touchBlockerCountdownCountdownInterval=setInterval(this.updateTouchBlockerCountdown,1e3))},clearTouchBlockerTimeout(){this.touchBlockerCountdownCountdownInterval!==void 0&&(clearInterval(this.touchBlockerCountdownCountdownInterval),this.touchBlockerCountdownCountdownInterval=void 0)},updateTouchBlockerCountdown(){this.touchBlockerCountdown===void 0?this.touchBlockerCountdown=this.touchBlockerTimeout:(this.touchBlockerCountdown-=1,this.touchBlockerCountdown<1&&this.showTouchBlocker())},setupDefaultViewTimeout(){this.defaultViewCountdownInterval===void 0&&this.mqttStore.getDefaultView!==this.$route.name&&this.defaultViewTimeout!==void 0&&(this.defaultViewCountdownInterval=setInterval(this.updateDefaultViewCountdown,1e3))},clearDefaultViewTimeout(){this.defaultViewCountdownInterval!==void 0&&(clearInterval(this.defaultViewCountdownInterval),this.defaultViewCountdownInterval=void 0)},updateDefaultViewCountdown(){this.defaultViewCountdown===void 0&&this.defaultViewTimeout!==void 0?this.defaultViewCountdown=this.defaultViewTimeout:this.$route.name===this.mqttStore.getDefaultView?this.clearDefaultViewTimeout():(this.defaultViewCountdown-=1,this.defaultViewCountdown<1&&this.showDefaultView())},handleDocumentEvent(){this.touchBlockerCountdown=this.touchBlockerTimeout,this.defaultViewCountdown=this.defaultViewTimeout,this.setupDefaultViewTimeout(),this.show=!1},showTouchBlocker(){this.show=!0,this.clearTouchBlockerTimeout()},showDefaultView(){console.log("switching to default view:",this.mqttStore.getDefaultView),this.clearDefaultViewTimeout(),this.$route.name!==this.mqttStore.getDefaultView&&this.$router.push({name:this.mqttStore.getDefaultView})}}};function Pe(e,t,n,i,r,o){const l=u("IModal");return p(),_(D,{to:"body"},[s(l,{class:"touch-blocker",size:"sm",color:"dark","model-value":r.show,"onUpdate:modelValue":t[0]||(t[0]=c=>o.handleTouchBlockerClick(c))},{default:a(()=>[...t[1]||(t[1]=[B("img",{class:"logo",src:U},null,-1),B("p",null," Bitte das Display berühren. ",-1)])]),_:1},8,["model-value"])])}const Te=V(ye,[["render",Pe],["__scopeId","data-v-a61b7071"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/TouchBlocker.vue"]]);I.add(te,ne,oe,re,ie);const Se={name:"UserIndicator",components:{FontAwesomeIcon:L},props:{},data(){return{mqttStore:y(),username:null,showLoginModal:!1,showLogoutModal:!1,loginUser:"",loginPassword:"",showPassword:!1}},computed:{loggedInUser(){return this.$cookies.get("mqtt")?.split(":")[0]||null},userManagementActive(){return this.mqttStore.topics["openWB/system/security/user_management_active"]!==!1},accessAllowed(){return this.mqttStore.getAccessAllowed},anonymousAccessAllowed(){return this.accessAllowed&&this.loggedInUser===null},enableLogin(){return this.loginUser.trim()!==""&&this.loginPassword.trim()!==""},hideLogin(){return this.mqttStore.settings.hideLogin===!0}},mounted(){},methods:{dummy(e){console.info("dummy method called with event:",e)},handleLogin(e){console.info("handleLogin called with value:",e),this.showLoginModal=!1,e&&this.loginUser.trim()!==""&&this.loginPassword.trim()!==""?(this.$cookies.set("mqtt",this.loginUser.trim()+":"+this.loginPassword.trim()),window.location.reload()):(this.loginUser="",this.loginPassword="")},handleLogout(e){if(console.info("handleLogout called with value:",e),this.showLogoutModal=!1,e){this.$cookies.remove("mqtt");const t=window.location.href.split("#")[0];window.history.replaceState({},document.title,t),window.location.reload()}}}},We={class:"buttonContent"},De={class:"username"};function Ie(e,t,n,i,r,o){const l=u("FontAwesomeIcon"),c=u("i-button"),g=u("i-row"),d=u("i-input"),m=u("i-column"),h=u("i-form-group"),C=u("i-form"),b=u("i-modal");return p(),k(S,null,[o.userManagementActive&&!o.hideLogin?(p(),_(c,{key:0,class:"_padding-left:0 _padding-right:0 _margin-bottom:1",size:"lg",block:"",title:o.loggedInUser?`${o.loggedInUser} Abmelden`:"Anmelden",color:o.loggedInUser?"success":"danger",onClick:t[0]||(t[0]=w=>o.loggedInUser?r.showLogoutModal=!0:r.showLoginModal=!0)},{default:a(()=>[B("div",We,[o.loggedInUser?(p(),_(l,{key:0,icon:["fas","circle-user"],class:"_flex-shrink:0",size:"lg"})):v("",!0),B("div",De,T(o.loggedInUser||"Anmelden"),1),s(l,{class:"text-light px-2 _flex-shrink:0",icon:o.loggedInUser?["fas","arrow-right-from-bracket"]:["fas","arrow-right-to-bracket"],size:"lg"},null,8,["icon"])])]),_:1},8,["title","color"])):v("",!0),(p(),_(D,{to:"body"},[s(b,{modelValue:r.showLoginModal,"onUpdate:modelValue":t[6]||(t[6]=w=>r.showLoginModal=w),class:"modal-vehicle-select",size:"lg"},{header:a(()=>[s(l,{class:"text-light clickable px-2",icon:["fas","arrow-right-to-bracket"],size:"lg"}),t[10]||(t[10]=f(" Anmelden ",-1))]),footer:a(()=>[s(g,{around:""},{default:a(()=>[s(c,{disabled:!o.enableLogin,outline:!o.enableLogin,color:"success",onClick:t[1]||(t[1]=w=>o.handleLogin(!0))},{default:a(()=>[...t[11]||(t[11]=[f(" Anmelden ",-1)])]),_:1},8,["disabled","outline"]),s(c,{color:"secondary",onClick:t[2]||(t[2]=w=>o.handleLogin(!1))},{default:a(()=>[...t[12]||(t[12]=[f(" Abbrechen ",-1)])]),_:1})]),_:1})]),default:a(()=>[s(C,null,{default:a(()=>[s(h,null,{default:a(()=>[s(g,{class:"_margin-bottom:1"},{default:a(()=>[s(m,null,{default:a(()=>[s(d,{modelValue:r.loginUser,"onUpdate:modelValue":t[3]||(t[3]=w=>r.loginUser=w),size:"lg",placeholder:"Benutzer"},{prepend:a(()=>[B("span",null,[s(l,{icon:["fas","circle-user"],size:"lg"})])]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(g,null,{default:a(()=>[s(m,null,{default:a(()=>[s(d,{modelValue:r.loginPassword,"onUpdate:modelValue":t[5]||(t[5]=w=>r.loginPassword=w),size:"lg",type:r.showPassword?"text":"password",placeholder:"Passwort"},{prepend:a(()=>[B("span",null,[s(l,{icon:["fas","lock"],size:"lg"})])]),suffix:a(()=>[s(l,{icon:["fas",r.showPassword?"eye":"eye-slash"],size:"lg",onClick:t[4]||(t[4]=w=>r.showPassword=!r.showPassword)},null,8,["icon"])]),_:1},8,["modelValue","type"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(b,{modelValue:r.showLogoutModal,"onUpdate:modelValue":t[9]||(t[9]=w=>r.showLogoutModal=w),class:"modal-vehicle-select",size:"lg"},{header:a(()=>[s(l,{class:"text-light clickable px-2",icon:["fas","arrow-right-from-bracket"],size:"lg"}),t[13]||(t[13]=f(" Abmelden ",-1))]),footer:a(()=>[s(g,{around:""},{default:a(()=>[s(c,{color:"success",onClick:t[7]||(t[7]=w=>o.handleLogout(!0))},{default:a(()=>[...t[14]||(t[14]=[f(" Abmelden ",-1)])]),_:1}),s(c,{color:"secondary",onClick:t[8]||(t[8]=w=>o.handleLogout(!1))},{default:a(()=>[...t[15]||(t[15]=[f(" Abbrechen ",-1)])]),_:1})]),_:1})]),default:a(()=>[t[16]||(t[16]=B("p",null," Willst Du Dich wirklich abmelden? ",-1))]),_:1},8,["modelValue"])]))],64)}const Le=V(Se,[["render",Ie],["__scopeId","data-v-e976ed67"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/components/UserIndicator.vue"]]),Ee={name:"OpenwbDisplayCardsApp",components:{RouterView:j,DateTime:le,NavBar:me,LockNavItem:ke,TouchBlocker:Te,UserIndicator:Le},data(){return{client:{connected:!1},connection:{protocol:location.protocol=="https:"?"wss":"ws",protocolVersion:5,host:location.hostname,port:parseInt(location.port)||(location.protocol=="https:"?443:80),path:"/ws",connectTimeout:4e3,reconnectPeriod:4e3,resubscribe:!0,properties:{requestResponseInformation:!0,requestProblemInformation:!0}},mqttTopicsToSubscribe:["openWB/bat/config/configured","openWB/bat/get/power","openWB/bat/get/soc","openWB/chargepoint/+/config","openWB/chargepoint/+/get/charge_state","openWB/chargepoint/+/get/connected_vehicle/+","openWB/chargepoint/+/set/charge_template","openWB/chargepoint/+/set/charge_template/chargemode/scheduled_charging/plans/+","openWB/chargepoint/+/set/charge_template/time_charging/plans/+","openWB/chargepoint/+/get/phases_in_use","openWB/chargepoint/+/get/plug_state","openWB/chargepoint/+/get/power","openWB/chargepoint/+/get/rfid","openWB/chargepoint/+/set/current","openWB/chargepoint/+/set/manual_lock","openWB/chargepoint/+/set/log","openWB/chargepoint/+/set/rfid","openWB/chargepoint/get/power","openWB/counter/+/get/power","openWB/counter/get/hierarchy","openWB/counter/set/home_consumption","openWB/general/chargemode_config/pv_charging/bat_mode","openWB/optional/ep/configured","openWB/optional/ep/get/prices","openWB/optional/int_display/theme","openWB/optional/int_display/standby","openWB/optional/rfid/active","openWB/pv/config/configured","openWB/pv/get/power","openWB/system/current_branch","openWB/system/current_commit","openWB/system/ip_address","openWB/system/time","openWB/system/version","openWB/system/security/user_management_active","openWB/system/security/access_allowed","openWB/vehicle/+/get/fault_state","openWB/vehicle/+/name","openWB/vehicle/+/info","openWB/vehicle/+/soc_module/config"],mqttStore:y(),chartInterval:"",clearConsoleHandler:void 0}},computed:{changesLocked(){return this.mqttStore.getLockChanges&&this.mqttStore.settings.changesLocked}},created(){this.createConnection()},mounted(){let e=window.location.search;if(e!=""){let r=new URLSearchParams(e);if(r.has("data")){let o=JSON.parse(r.get("data"));Object.entries(o).forEach(([l,c])=>{l.startsWith("parentChargePoint")?this.mqttStore.updateSetting(l,parseInt(c)):this.mqttStore.updateSetting(l,c)})}if(r.has("hide_login")){const o=r.get("hide_login");console.debug("hide_login from url param:",o),this.mqttStore.updateSetting("hideLogin",o==="1")}}this.doSubscribe(this.mqttTopicsToSubscribe),this.chartInterval=setInterval(this.mqttStore.updateChartData,5e3);const t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0).getTime()-t.getTime();console.debug("clear console in",i,"ms"),this.clearConsoleHandler=setTimeout(()=>this.clearConsole(),i)},beforeUnmount(){this.doUnsubscribe(this.mqttTopicsToSubscribe),clearInterval(this.chartInterval),clearTimeout(this.clearConsoleHandler)},methods:{clearConsole(){console.clear(),console.debug("console cleared at",new Date),this.clearConsoleHandler=setTimeout(()=>this.clearConsole(),1440*60*1e3)},createConnection(){const{protocol:e,host:t,port:n,path:i,...r}=this.connection,o=`${e}://${t}:${n}${i}`,[l,c]=this.$cookies.get("mqtt")?.split(":")||[null,null];l&&c||console.debug("Anonymous mqtt connection (no cookie set)"),(this.nodeEnv!=="production"||e=="wss")&&l&&c&&(console.debug("Using mqtt credentials from cookie:",l,"/",c),r.username=l,r.password=c,l==="admin"&&c==="openwb"&&console.warn("Using default mqtt credentials! This is insecure and not recommended for production systems.")),console.debug("connecting to broker:",o);try{this.client=R.connect(o,r)}catch(g){console.error("mqtt.connect error",g)}this.client.on("connect",()=>{console.debug("Connection succeeded! ClientId: ",this.client.options.clientId)}),this.client.on("error",g=>{console.error("Connection failed",g)}),this.client.on("message",(g,d)=>{if(console.debug(`Received message "${d}" from topic "${g}"`),d.toString().length>0){let m;try{m=JSON.parse(d.toString())}catch(h){console.debug("Json parsing failed, fallback to string: ",g,h),m=d.toString()}this.mqttStore.addTopic(g,m)}else this.mqttStore.removeTopic(g)})},doSubscribe(e){e.forEach(t=>{this.mqttStore.initTopic(t)}),this.client.subscribe(e,{},t=>{if(t){console.error("Subscribe to topics error",t);return}})},doUnsubscribe(e){e.forEach(t=>{this.mqttStore.removeTopic(t)}),this.client.unsubscribe(e,t=>{t&&console.error("Unsubscribe error",t)})},doPublish(e,t,n=!0,i=2){console.debug("doPublish",e,t);let r={qos:i,retain:n};this.client.publish(e,JSON.stringify(t),r,o=>{o&&console.error("Publish error",o)})},sendTopicToBroker(e,t=void 0){let n=e.replace("openWB/","openWB/set/");t===void 0&&(t=this.mqttStore.topics[e]),this.doPublish(n,t)},sendCommand(e){this.doPublish("openWB/set/command/"+this.client.options.clientId+"/todo",e,!1)},sendSystemCommand(e,t={}){this.sendCommand({command:e,data:t})}}};function $e(e,t,n,i,r,o){const l=u("DateTime"),c=u("i-column"),g=u("i-row"),d=u("i-container"),m=u("UserIndicator"),h=u("LockNavItem"),C=u("NavBar"),b=u("TouchBlocker"),w=u("i-layout-aside"),M=u("RouterView"),O=u("i-layout-content"),x=u("i-layout");return p(),_(x,{vertical:""},{default:a(()=>[s(w,{class:"_position:fixed"},{default:a(()=>[s(d,{fluid:"",class:"_margin-bottom:1"},{default:a(()=>[s(g,{center:""},{default:a(()=>[s(c,null,{default:a(()=>[s(l)]),_:1})]),_:1})]),_:1}),s(m),s(h),s(C,{"changes-locked":o.changesLocked},null,8,["changes-locked"]),s(b)]),_:1}),s(O,null,{default:a(()=>[s(M,{"changes-locked":o.changesLocked},null,8,["changes-locked"])]),_:1})]),_:1})}const qe=V(Ee,[["render",$e],["__scopeId","data-v-7a7a37b1"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/App.vue"]]),Ae="modulepreload",Ue=function(e){return"/openWB/web/display/themes/cards/"+e},$={},W=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let g=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");r=g(n.map(d=>{if(d=Ue(d),d in $)return;$[d]=!0;const m=d.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const C=document.createElement("link");if(C.rel=m?"stylesheet":Ae,m||(C.as="script"),C.crossOrigin="",C.href=d,c&&C.setAttribute("nonce",c),document.head.appendChild(C),m)return new Promise((b,w)=>{C.addEventListener("load",b),C.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},Me={name:"WelcomeView",data(){return{mqttStore:y()}},computed:{accessAllowed(){return this.mqttStore.getAccessAllowed}},mounted(){setTimeout(this.selectFirstRoute,3e3)},methods:{selectFirstRoute(){if(this.mqttStore.getDefaultView){if(this.accessAllowed===!1){console.warn("access not allowed, staying on welcome view");return}this.$router.push({name:this.mqttStore.getDefaultView})}else console.warn("no router view enabled, check your configuration!")}}};function Oe(e,t,n,i,r,o){const l=u("i-card"),c=u("i-column"),g=u("i-row"),d=u("i-container");return p(),_(d,null,{default:a(()=>[s(g,{center:"",middle:""},{default:a(()=>[s(c,null,{default:a(()=>[s(l,{color:"primary"},z({header:a(()=>[t[0]||(t[0]=f(" Cards Theme ",-1))]),default:a(()=>[t[2]||(t[2]=B("img",{class:"logo",src:U},null,-1))]),_:2},[o.accessAllowed?void 0:{name:"footer",fn:a(()=>[t[1]||(t[1]=f(" Bitte anmelden. ",-1))]),key:"0"}]),1024)]),_:1})]),_:1})]),_:1})}const xe=V(Me,[["render",Oe],["__scopeId","data-v-0939a750"],["__file","/var/www/html/openWB/packages/modules/display_themes/cards/source/src/views/WelcomeView.vue"]]),Ne=H({history:G("/openWB/web/display/themes/cards/"),routes:[{path:"/",name:"welcome",component:xe},{path:"/Dashboard",name:"dashboard",component:()=>W(()=>import("./DashboardView-QM7fZc3o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))},{path:"/EnergyFlow",name:"energy-flow",component:()=>W(()=>import("./EnergyFlowView-Bts5x4gm.js"),__vite__mapDeps([10,1,2,3,4,5,11,7,12]))},{path:"/ChargePoints",name:"charge-points",component:()=>W(()=>import("./ChargePointsView-BerB3hzG.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,11,14]))},{path:"/Status",name:"status",component:()=>W(()=>import("./StatusView-BCJE8foI.js"),__vite__mapDeps([15,7,2,3,4,1,5]))}]}),Fe=K(qe).use(J()).use(Ne).use(Z,{colorMode:"dark",components:Q}).use(Y,{expire:"30d",path:"/",domain:"",secure:!0,sameSite:"Lax"});Fe.mount("#app");export{be as C,Ce as N,y as u};
