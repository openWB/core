var pa=Object.defineProperty;var ga=(t,e,a)=>e in t?pa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var d=(t,e,a)=>ga(t,typeof e!="symbol"?e+"":e,a);import{m as ma,r as H,a as se,M as ht,d as V,c as y,o as h,n as oe,b as S,e as r,f as re,g as fe,h as g,s as Se,i as Ze,j as zt,k as _,w as k,l as W,p as T,u,t as P,q as Nt,v as Ft,x as va,F as ce,y as ke,z as Ge,A as wt,B as Te,C as Jt,D as pt,E as st,G as Ne,H as nt,I as kt,J as fa,K as qe,L as Rt,N as ya,O as ba,P as et,Q as Fe,R as _a,S as wa,T as it,U as Ht,V as mt,W as ka}from"./vendor-DTwSGpnw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();function ot(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Yt(t,e=1,a=!1){let n;if(t>1e6&&(a=!0,t=t/1e3),t>=1e3&&e<4){switch(e){case 0:n=Math.round(t/1e3);break;case 1:n=(Math.round(t/100)/10).toFixed(1);break;case 2:n=(Math.round(t/10)/100).toFixed(2);break;case 3:n=(Math.round(t)/1e3).toFixed(3);break;default:n=Math.round(t/100)/10;break}return n.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function Sa(t){return t.toLocaleTimeString(["de-DE"],{hour:"numeric",minute:"2-digit"})}function xa(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}const Ma=0,qt={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clean:!1,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},lt={topic:"",qos:Ma};let ge;const{host:Pa,port:Ca,endpoint:$a,...Qt}=qt,Ia=`${Qt.protocol}://${Pa}:${Ca}${$a}`;try{ge=ma.connect(Ia,Qt),ge.on("connect",()=>{console.info("MQTT connection successful.")}),ge.on("disconnect",()=>{console.info("MQTT disconnected")}),ge.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}async function Ba(t){await Zt(),ge?ge.on("message",t):console.error("MqttRegister: MQTT client not available")}async function We(t){lt.topic=t;const{topic:e,qos:a}=lt;await Zt(),ge.subscribe(e,{qos:a},n=>{if(n){console.error("MQTT Subscription error: "+n);return}})}function je(t){lt.topic=t;const{topic:e}=lt;ge.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}async function St(t,e){let n=ge.connected,o=0;for(;!n&&o<10;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Xt(100),n=ge.connected,o+=1;if(o<10)try{ge.publish(t,e,{qos:0},i=>{i&&console.warn("MQTT publish error: ",i),console.info("MQTT publish: Message sent: ["+t+"]("+e+")")})}catch(i){console.warn("MQTT publish: caught error: "+i)}else console.error("MQTT publish: Lost connection to MQTT server. Please reload the page")}function Mt(){return qt.clientId}const Ot=20;async function Zt(){let t=ge.connected,e=0;for(;!t&&e<Ot;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Xt(100),t=ge.connected,e+=1;return new Promise((a,n)=>{e<Ot?a(!0):n(!1)})}function Xt(t){return new Promise(e=>setTimeout(e,t))}class Oa{constructor(e){d(this,"id");d(this,"name","Ladepunkt");d(this,"icon","Ladepunkt");d(this,"type","");d(this,"ev",0);d(this,"template",0);d(this,"connectedPhases",0);d(this,"phase_1",0);d(this,"autoPhaseSwitchHw",!1);d(this,"controlPilotInterruptionHw",!1);d(this,"isEnabled",!0);d(this,"isPluggedIn",!1);d(this,"isCharging",!1);d(this,"_isLocked",!1);d(this,"_connectedVehicle",0);d(this,"chargeTemplate",0);d(this,"evTemplate",0);d(this,"_chargeMode","pv_charging");d(this,"_hasPriority",!1);d(this,"currentPlan","");d(this,"averageConsumption",0);d(this,"vehicleName","");d(this,"rangeCharged",0);d(this,"rangeUnit","");d(this,"counter",0);d(this,"dailyYield",0);d(this,"energyPv",0);d(this,"energyBat",0);d(this,"pvPercentage",0);d(this,"faultState",0);d(this,"faultStr","");d(this,"phasesInUse",0);d(this,"power",0);d(this,"chargedSincePlugged",0);d(this,"stateStr","");d(this,"current",0);d(this,"currents",[0,0,0]);d(this,"phasesToUse",0);d(this,"isSocConfigured",!0);d(this,"isSocManual",!1);d(this,"waitingForSoc",!1);d(this,"color","white");d(this,"_timedCharging",!1);d(this,"_instantChargeLimitMode","");d(this,"_instantTargetCurrent",0);d(this,"_instantTargetSoc",0);d(this,"_instantMaxEnergy",0);d(this,"_pvFeedInLimit",!1);d(this,"_pvMinCurrent",0);d(this,"_pvMaxSoc",101);d(this,"_pvMinSoc",0);d(this,"_pvMinSocCurrent",0);d(this,"_etActive",!1);d(this,"_etMaxPrice",20);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,Y("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,Y("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get soc(){return J[this.connectedVehicle]?J[this.connectedVehicle].soc:0}set soc(e){J[this.connectedVehicle]&&(J[this.connectedVehicle].soc=e)}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,Y("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,Y("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get timedCharging(){return ue[this.chargeTemplate]?ue[this.chargeTemplate].time_charging.active:!1}set timedCharging(e){ue[this.chargeTemplate].time_charging.active=e,Y("cpTimedCharging",e,this.chargeTemplate)}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,Y("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,Y("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,Y("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,Y("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,Y("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,Y("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,Y("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,Y("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,Y("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}get realCurrent(){switch(this.phasesInUse){case 0:return 0;case 1:return this.currents[0];case 2:return(this.currents[0]+this.currents[1])/2;case 3:return(this.currents[0]+this.currents[1]+this.currents[2])/3;default:return 0}}get etActive(){return J[this.connectedVehicle]?J[this.connectedVehicle].etActive:!1}set etActive(e){J[this.connectedVehicle]&&(J[this.connectedVehicle].etActive=e)}get etMaxPrice(){return J[this.connectedVehicle].etMaxPrice??0}set etMaxPrice(e){Y("cpEtMaxPrice",Math.round(e*10)/1e6,this.id)}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class Ta{constructor(e){d(this,"id");d(this,"name","");d(this,"_chargeTemplateId",0);d(this,"_evTemplateId",0);d(this,"tags",[]);d(this,"config",{});d(this,"soc",0);d(this,"range",0);d(this,"_etActive",!1);d(this,"_etMaxPrice",20);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,Y("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,Y("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}get etActive(){return ue[this.chargeTemplateId]?ue[this.chargeTemplateId].et.active:!1}set etActive(e){ue[this.chargeTemplateId]&&Y("priceCharging",e,this.chargeTemplateId)}get etMaxPrice(){if(ue[this.chargeTemplateId]&&ue[this.chargeTemplateId].et.active)return ue[this.chargeTemplateId].et.max_price*1e5}get chargepoint(){for(const e of Object.values(w))if(e.connectedVehicle==this.id)return e}}var _e=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(_e||{});const w=H({}),J=H({}),ue=H({}),Je=H({}),Re=H({}),Va=H({});function Aa(t){t in w||(w[t]=new Oa(t),w[t].color="var(--color-cp"+(Object.values(w).length-1)+")")}function La(){Object.keys(w).forEach(t=>{delete w[parseInt(t)]})}const Da={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpTimedCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",cpTimedPlanActive:"openWB/set/vehicle/template/charge_template/%/time_charging/plans/@/active",cpScheduledPlanActive:"openWB/set/vehicle/template/charge_template/%/chargemode/scheduled_charging/plans/@/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_mode",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",cpEtMaxPrice:"openWB/set/vehicle/template/charge_template/%/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control",socUpdate:"openWB/set/vehicle/%/get/force_soc_update",setSoc:"openWB/set/vehicle/%/soc_module/calculated_soc_state/manual_soc",priceCharging:"openWB/set/vehicle/template/charge_template/%/et/active"};function Y(t,e,a=0,n=void 0){if(isNaN(a)){console.warn("Invalid index");return}let o=Da[t];if(!o){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpEtMaxPrice":case"cpPvMinSocCurrent":o=o.replace("%",w[a].chargeTemplate.toString());break;default:o=o.replace("%",String(a)),n!=null&&(o=o.replace("@",String(n)))}switch(typeof e){case"number":St(o,JSON.stringify(+e));break;default:St(o,JSON.stringify(e))}}function Ee(t,e={}){console.log("send command "+t+" "+JSON.stringify(e)),St(`openWB/set/command/${Mt()}/todo`,JSON.stringify({command:t,data:e}))}class Ea{constructor(){d(this,"batterySoc",0);d(this,"isBatteryConfigured",!0);d(this,"chargeMode","0");d(this,"_pvBatteryPriority","ev_mode");d(this,"displayLiveGraph",!0);d(this,"isEtEnabled",!0);d(this,"etMaxPrice",0);d(this,"etCurrentPrice",0);d(this,"cpDailyExported",0);d(this,"evuId",0);d(this,"etProvider","");d(this,"ipAddress","");d(this,"systemTime",0);d(this,"version","");d(this,"versionDetails","");d(this,"devBranch","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,Y("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const Wa=[["EV","ev_mode"],["Speicher","bat_mode"],["MinSoc","min_soc_bat_mode"]],le=H({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""},cp1:{name:"Ladepunkt",color:"var(--color-cp1)",icon:"Ladepunkt"},cp2:{name:"Ladepunkt",color:"var(--color-cp2)",icon:"Ladepunkt"},cp3:{name:"Ladepunkt",color:"var(--color-cp3)",icon:"Ladepunkt"},cp4:{name:"Ladepunkt",color:"var(--color-cp4)",icon:"Ladepunkt"},cp5:{name:"Ladepunkt",color:"var(--color-cp5)",icon:"Ladepunkt"},cp6:{name:"Ladepunkt",color:"var(--color-cp6)",icon:"Ladepunkt"},cp7:{name:"Ladepunkt",color:"var(--color-cp7)",icon:"Ladepunkt"},cp8:{name:"Ladepunkt",color:"var(--color-cp8)",icon:"Ladepunkt"},sh1:{name:"Gerät",color:"var(--color-sh1)",icon:"Gerät"},sh2:{name:"Gerät",color:"var(--color-sh2)",icon:"Gerät"},sh3:{name:"Gerät",color:"var(--color-sh3)",icon:"Gerät"},sh4:{name:"Gerät",color:"var(--color-sh4)",icon:"Gerät"},sh5:{name:"Gerät",color:"var(--color-sh5)",icon:"Gerät"},sh6:{name:"Gerät",color:"var(--color-sh6)",icon:"Gerät"},sh7:{name:"Gerät",color:"var(--color-sh7)",icon:"Gerät"},sh8:{name:"Gerät",color:"var(--color-sh8)",icon:"Gerät"},sh9:{name:"Gerät",color:"var(--color-sh9)",icon:"Gerät"}});class Kt{constructor(){d(this,"_items",{});this.addItem("evuIn"),this.addItem("pv"),this.addItem("batOut"),this.addItem("evuOut"),this.addItem("charging"),this.addItem("devices"),this.addItem("batIn"),this.addItem("house")}get items(){return this._items}keys(){return Object.keys(this._items)}values(){return Object.values(this._items)}addItem(e){this._items[e]=Ie(e)}setEnergy(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energy=a}setEnergyPv(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyPv=a}setEnergyBat(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyBat=a}setPvPercentage(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].pvPercentage=a}calculateHouseEnergy(){this._items.house.energy=this._items.evuIn.energy+this._items.pv.energy+this._items.batOut.energy-this._items.evuOut.energy-this._items.batIn.energy-this._items.charging.energy-this._items.devices.energy}}let M=new Kt;function Pt(){M=new Kt}const N=H({evuIn:Ie("evuIn"),pv:Ie("pv"),batOut:Ie("batOut")}),A=H({evuOut:Ie("evuOut"),charging:Ie("charging"),devices:Ie("devices"),batIn:Ie("batIn"),house:Ie("house")}),R=H(new Ea);se("");const ct=se(!1);function Ie(t){return{name:le[t]?le[t].name:"item",power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:le[t]?le[t].color:"var(--color-charging)",icon:le[t]?le[t].icon:""}}const te=H({active:!1,locked:!0,usePin:!1,code:"",timeout:60,localCpOnly:!1});function Ue(){te.usePin&&te.locked?new ht("#numberpad").toggle():(te.locked=!1,setTimeout(()=>{te.locked=!0},te.timeout*1e3))}function Ga(t){return t==te.code}const Tt=se(new Date),ja={class:"scaled"},Ua=V({__name:"DisplayButton",props:{icon:{},bgcolor:{},color:{}},emits:["click"],setup(t,{emit:e}){const a=t,n=e;function o(){n("click",!0)}return(i,s)=>(h(),y("div",{style:oe({"background-color":a.bgcolor?a.bgcolor:"var(--color-bg)",color:a.color?a.color:"var(--color-title)"}),class:"displaybutton rounded-pill",type:"button",onClick:o},[a.icon?(h(),y("span",{key:0,class:re(["fas me-2 scaled",a.icon])},null,2)):S("",!0),r("span",ja,[fe(i.$slots,"default",{},void 0)])],4))}}),F=(t,e)=>{const a=t.__vccOpts||t;for(const[n,o]of e)a[n]=o;return a},be=F(Ua,[["__scopeId","data-v-0f8aebee"]]);class za{constructor(e){d(this,"id");d(this,"name","Gerät");d(this,"power",0);d(this,"status","off");d(this,"energy",0);d(this,"runningTime",0);d(this,"configured",!1);d(this,"_showInGraph",!0);d(this,"color","white");d(this,"canSwitch",!1);d(this,"countAsHouse",!1);d(this,"energyPv",0);d(this,"energyBat",0);d(this,"pvPercentage",0);d(this,"tempConfigured",0);d(this,"temp",[300,300,300]);d(this,"on",!1);d(this,"isAutomatic",!0);d(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,Z()}setShowInGraph(e){this._showInGraph=e}}const ne=H(new Map);function ea(t){t in ne?console.info("Duplicate sh device message: "+t):(ne.set(t,new za(t)),ne.get(t).color="var(--color-sh"+ne.size+")")}class Na{constructor(){d(this,"graphToShow","powermeter");d(this,"cpToShow",0);d(this,"displayLocked",!0);d(this,"_showRelativeArcs",!1);d(this,"showTodayGraph",!0);d(this,"_graphPreference","live");d(this,"_usageStackOrder",0);d(this,"_displayMode","dark");d(this,"_showGrid",!1);d(this,"_smartHomeColors","normal");d(this,"_decimalPlaces",1);d(this,"_showQuickAccess",!0);d(this,"_simpleCpList",!1);d(this,"_shortCpList","no");d(this,"_showAnimations",!0);d(this,"_preferWideBoxes",!1);d(this,"_maxPower",4e3);d(this,"_fluidDisplay",!1);d(this,"_showClock","no");d(this,"_showButtonBar",!0);d(this,"_showCounters",!1);d(this,"_showVehicles",!1);d(this,"_showPrices",!1);d(this,"_debug",!1);d(this,"isEtEnabled",!1);d(this,"etPrice",20.5);d(this,"showRightButton",!0);d(this,"showLeftButton",!0);d(this,"animationDuration",300);d(this,"animationDelay",100);d(this,"zoomGraph",!1);d(this,"parentChargePoint1");d(this,"parentChargePoint2")}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,Z()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,Z()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,Z()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,Ja(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,Z()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,Z()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,At(e),Z()}setSmartHomeColors(e){this._smartHomeColors=e,At(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,Z()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,Z()}setSimpleCpList(e){this._simpleCpList=e}get shortCpList(){return this._shortCpList}set shortCpList(e){this._shortCpList=e,Z()}setShortCpList(e){this._shortCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,Z()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,Z()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,Z()}setMaxPower(e){this._maxPower=e}get fluidDisplay(){return this._fluidDisplay}set fluidDisplay(e){this._fluidDisplay=e,Z()}setFluidDisplay(e){this._fluidDisplay=e}get showClock(){return this._showClock}set showClock(e){this._showClock=e,Z()}setShowClock(e){this._showClock=e}get debug(){return this._debug}set debug(e){this._debug=e,Z()}setDebug(e){this._debug=e}get showButtonBar(){return this._showButtonBar}set showButtonBar(e){this._showButtonBar=e,Z()}setShowButtonBar(e){this._showButtonBar=e}get showCounters(){return this._showCounters}set showCounters(e){this._showCounters=e,Z()}setShowCounters(e){this._showCounters=e}get showVehicles(){return this._showVehicles}set showVehicles(e){this._showVehicles=e,Z()}setShowVehicles(e){this._showVehicles=e}get showPrices(){return this._showPrices}set showPrices(e){this._showPrices=e,Z()}setShowPrices(e){this._showPrices=e}}const b=H(new Na),Ae=H({localIp:void 0,localBranch:void 0,localCommit:void 0,localVersion:void 0,parentChargePoint1:void 0,parentChargePoint2:void 0}),Fa=992,xt=H({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function Vt(){xt.x=document.documentElement.clientWidth,xt.y=document.documentElement.clientHeight}g(()=>xt.x>=Fa);const ze={pv_charging:{mode:_e.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},instant_charging:{mode:_e.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"},scheduled_charging:{mode:_e.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},standby:{mode:_e.standby,name:"Standby",color:"var(--color-axis)",icon:"fa-pause"},stop:{mode:_e.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"}};function Z(){Ra()}function Ja(t){const e=Se("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),Z()}function At(t){const e=Se("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}function Ra(){const t={};t.hideSH=[...ne.values()].filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=b.graphPreference=="live",t.displayM=b.displayMode,t.stackO=b.usageStackOrder,t.showGr=b.showGrid,t.decimalP=b.decimalPlaces,t.smartHomeC=b.smartHomeColors,t.relPM=b.showRelativeArcs,t.maxPow=b.maxPower,t.showQA=b.showQuickAccess,t.simpleCP=b.simpleCpList,t.shortCP=b.shortCpList,t.animation=b.showAnimations,t.wideB=b.preferWideBoxes,t.fluidD=b.fluidDisplay,t.clock=b.showClock,t.showButtonBar=b.showButtonBar,t.showCounters=b.showCounters,t.showVehicles=b.showVehicles,t.showPrices=b.showPrices,t.debug=b.debug,document.cookie="openWBColorTheme="+JSON.stringify(t)+";max-age=16000000;samesite=strict"}const Ha={class:"navigation"},Ya={class:"graphbuttons"},qa={class:"cpbuttons"},Qa={class:"timedisplay ms-4"},Za=V({__name:"NavigationBar",setup(t){let e;function a(){let l=Object.values(w).length;b.cpToShow=(b.cpToShow+1)%l}function n(){let l=Object.values(w).length;b.cpToShow=((b.cpToShow-1)%l+l)%l}function o(){b.graphToShow="powermeter"}function i(){b.graphToShow="powergraph"}function s(){b.graphToShow="energymeter"}function c(){te.locked?Ue():new ht("#statuspage").toggle()}return Ze(()=>{e=setInterval(()=>{Tt.value=new Date},1e3)}),zt(()=>{clearInterval(e)}),(l,m)=>(h(),y("div",Ha,[r("span",Ya,[m[3]||(m[3]=r("span",{class:"brand me-4"},"openWB",-1)),_(be,{icon:"fa-chart-pie",onClick:o},{default:k(()=>m[0]||(m[0]=[W("Leistung")])),_:1}),_(be,{icon:"fa-chart-line",onClick:i},{default:k(()=>m[1]||(m[1]=[W("Verlauf")])),_:1}),_(be,{icon:"fa-chart-column",onClick:s},{default:k(()=>m[2]||(m[2]=[W("Energie")])),_:1})]),_(be,{icon:"fa-rectangle-list",onClick:c},{default:k(()=>m[4]||(m[4]=[W("Status")])),_:1}),r("span",qa,[Object.values(u(w)).length>1?(h(),T(be,{key:0,color:"var(--color-cp0)",onClick:n},{default:k(()=>m[5]||(m[5]=[r("span",{class:"fas fa-arrow-left px-2"},null,-1),r("span",{class:"fas fa-charging-station pe-2"},null,-1)])),_:1})):S("",!0),_(be,{bgcolor:u(te).locked?"var(--color-evu)":"var(--color-pv)",onClick:u(Ue)},{default:k(()=>m[6]||(m[6]=[r("span",{class:"fas fa-lock px-4"},null,-1)])),_:1},8,["bgcolor","onClick"]),Object.values(u(w)).length>1?(h(),T(be,{key:1,color:"var(--color-cp0)",onClick:a},{default:k(()=>m[7]||(m[7]=[r("span",{class:"fas fa-charging-station px-2"},null,-1),r("span",{class:"fas fa-arrow-right pe-2"},null,-1)])),_:1})):S("",!0),r("span",Qa,P(u(Sa)(u(Tt))),1)])]))}}),Xa=F(Za,[["__scopeId","data-v-6d0b9541"]]),Ka=["origin"],en=V({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let n={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},o=N;o["zz-empty"]=n;const i=Object.values(N).length-1,s=Nt().value(m=>m.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),c=Ft().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),l=Se("g#pmSourceArc");return l.selectAll("*").remove(),l.selectAll("sources").data(s(Object.values(o))).enter().append("path").attr("d",c).attr("fill",m=>m.data.color).attr("stroke",(m,v)=>v==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmSourceArc.vue"});return va(()=>{let n=N.pv.power+N.evuIn.power+N.batOut.power;n>b.maxPower&&(b.maxPower=n)}),(n,o)=>(h(),y("g",{id:"pmSourceArc",origin:a.value},null,8,Ka))}}),tn=["origin"],an=V({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let n={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const o=[A.evuOut,A.charging].concat([...ne.values()].filter(m=>m.configured&&!m.countAsHouse).sort((m,v)=>v.power-m.power)).concat([A.batIn,A.house]).concat(n),i=o.length-1,s=Nt().value(m=>m.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),c=Ft().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),l=Se("g#pmUsageArc");return l.selectAll("*").remove(),l.selectAll("consumers").data(s(o)).enter().append("path").attr("d",c).attr("fill",m=>m.data.color).attr("stroke",(m,v)=>v==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmUsageArc.vue"});return(n,o)=>(h(),y("g",{id:"pmUsageArc",origin:a.value},null,8,tn))}}),ta=V({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>ot(e.watt,b.decimalPlaces));return(n,o)=>P(a.value)}}),nn={key:0,id:"pmLabel"},on=["x","y","fill","text-anchor"],rn=22,xe=V({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),n=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),o=g(()=>!e.data||e.data.power>0),i=g(()=>e.labeltext?"":"fas");return(s,c)=>o.value?(h(),y("g",nn,[r("text",{x:s.x,y:s.y,fill:n.value,"text-anchor":s.anchor,"font-size":rn,class:"pmLabel"},[r("tspan",{class:re(i.value)},P(a.value),3),r("tspan",null,[s.data!==void 0?(h(),T(ta,{key:0,watt:s.data.power},null,8,["watt"])):S("",!0)])],8,on)])):S("",!0)}}),sn={},ln={class:"p-2 m-0 cont"},cn={class:"wb-widget m-0 pb-2 shadow"},un={class:"header mt-4 mx-2"},dn={class:"titles"},hn={class:"title"},pn={class:"subtitle"},gn={class:"buttons"},mn={class:"wb-subwidget mx-2"},vn={key:0},fn={class:"wb-subwidget mx-2"};function yn(t,e){return h(),y("div",ln,[r("div",cn,[r("div",un,[r("div",dn,[r("div",hn,[fe(t.$slots,"title",{},()=>[e[0]||(e[0]=r("div",{class:"p-0"},"(title goes here)",-1))])]),r("div",pn,[fe(t.$slots,"subtitle",{},void 0)])]),r("div",gn,[fe(t.$slots,"buttons",{},void 0)])]),r("div",mn,[fe(t.$slots,"default",{},void 0)]),t.$slots.footer!=null?(h(),y("div",vn,[e[1]||(e[1]=r("hr",{class:"grid-col-12"},null,-1)),r("div",fn,[fe(t.$slots,"footer",{},void 0)])])):S("",!0)])])}const gt=F(sn,[["render",yn],["__scopeId","data-v-e8292acd"]]);class bn{constructor(){d(this,"active",!1);d(this,"etPriceList",new Map);d(this,"etProvider","");d(this,"etMaxPrice",0)}get etCurrentPriceString(){const[e]=X.etPriceList.values();return(Math.round(e*10)/10).toFixed(1)+" ct"}}const X=H(new bn),_n={class:"grid-col-12"},wn={id:"powermeter",class:"powermeter p-0 m-0 align-self-stretch"},kn=["viewBox"],Sn=["transform"],xn={transform:"scale(0.9294,1)"},Mn=["x"],Pe=500,Ce=20,Lt=1,Pn=V({__name:"PowerMeter",setup(t){const e=Pe,a=Math.PI/40,n=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],o=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],i=g(()=>Pe/2-Ce),s=g(()=>{let D="",G=Object.values(N).filter(Q=>Q.power>0);return G.length==1&&G[0].name=="PV"?D="Aktueller Verbrauch: ":D="Bezug/Verbrauch: ",D+ot(A.house.power+A.charging.power+A.devices.power+A.batIn.power,b.decimalPlaces)}),c=g(()=>{let D=N.pv.power+N.evuIn.power+N.batOut.power;return b.maxPower>D?ot(b.maxPower,b.decimalPlaces):ot(D,b.decimalPlaces)}),l=g(()=>Object.values(w)),m=g(()=>{let D=0;return b.showRelativeArcs&&(D=b.maxPower-(N.pv.power+N.evuIn.power+N.batOut.power)),D<0?0:D}),v=g(()=>[A.evuOut,A.charging,A.devices,A.batIn,A.house].filter(D=>D.power>0)),$=g(()=>n[v.value.length-1]);function f(D){return o[$.value[D]]}function I(D){return Math.round(l.value[D].soc)}function j(D){return D.length>12?D.slice(0,11)+".":D}const ie=g(()=>{const[D]=X.etPriceList.values();return Math.round(D*10)/10});return(D,G)=>(h(),T(gt,null,{title:k(()=>G[0]||(G[0]=[W(" Aktuelle Leistung ")])),default:k(()=>[r("div",_n,[r("figure",wn,[(h(),y("svg",{viewBox:"0 0 "+Pe+" "+u(e)},[r("g",{transform:"translate("+Pe/2+","+u(e)/2+")"},[r("g",xn,[_(en,{radius:i.value,"corner-radius":Lt,"circle-gap-size":a,"empty-power":m.value},null,8,["radius","empty-power"]),_(an,{"sh-device":u(ne),radius:i.value,"corner-radius":Lt,"circle-gap-size":a,"empty-power":m.value},null,8,["sh-device","radius","empty-power"]),_(xe,{x:0,y:-u(e)/10*2,data:u(N).pv,props:u(le).pv,anchor:"middle",config:u(b)},null,8,["y","data","props","config"]),_(xe,{x:0,y:-u(e)/10*3,data:u(N).evuIn,props:u(le).evuIn,anchor:"middle",config:u(b)},null,8,["y","data","props","config"]),_(xe,{x:0,y:-u(e)/10,data:u(N).batOut,props:u(le).batOut,anchor:"middle",config:u(b)},null,8,["y","data","props","config"]),u(X).active?(h(),T(xe,{key:0,x:0,y:-u(e)/10,data:u(N).batOut,props:u(le).batOut,anchor:"middle",config:u(b)},null,8,["y","data","props","config"])):S("",!0),(h(!0),y(ce,null,ke(v.value,(Q,B)=>(h(),T(xe,{key:B,x:f(B).x,y:f(B).y,data:Q,labelicon:Q.icon,labelcolor:Q.color,anchor:"middle",config:u(b)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),l.value.length>0&&u(J)[l.value[0].connectedVehicle]?(h(),T(xe,{key:1,x:-Pe/2-Ce/4+10,y:-u(e)/2+Ce+5,labeltext:j(u(J)[l.value[0].connectedVehicle].name)+": "+I(0)+"%",labelcolor:l.value[0].color,anchor:"start",config:u(b)},null,8,["x","y","labeltext","labelcolor","config"])):S("",!0),l.value.length>1&&u(J)[l.value[1].connectedVehicle]?(h(),T(xe,{key:2,x:Pe/2+Ce/4-10,y:-u(e)/2+Ce+5,labeltext:j(u(J)[l.value[1].connectedVehicle].name)+": "+I(1)+"%",labelcolor:l.value[1].color,anchor:"end",config:u(b)},null,8,["x","y","labeltext","labelcolor","config"])):S("",!0),u(R).batterySoc>0?(h(),T(xe,{key:3,x:-Pe/2-Ce/4+10,y:u(e)/2-Ce+15,labeltext:"Speicher: "+u(R).batterySoc+"%",labelcolor:u(A).batIn.color,anchor:"start",config:u(b)},null,8,["x","y","labeltext","labelcolor","config"])):S("",!0),u(X).active?(h(),T(xe,{key:4,x:Pe/2+Ce/4-10,y:u(e)/2-Ce+15,value:ie.value,labeltext:u(X).etCurrentPriceString,labelcolor:"var(--color-charging)",anchor:"end",config:u(b)},null,8,["x","y","value","labeltext","config"])):S("",!0),_(xe,{x:0,y:0,labeltext:s.value,labelcolor:"var(--color-fg)",anchor:"middle",config:u(b)},null,8,["labeltext","config"]),u(b).showRelativeArcs?(h(),y("text",{key:5,x:Pe/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+P(c.value),9,Mn)):S("",!0)])],8,Sn)],8,kn))])])]),_:1}))}}),$e=500,Ve=500,E={top:10,right:20,bottom:10,left:25},Ct=["charging","house","batIn","devices"];class Cn{constructor(){d(this,"data",[]);d(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const p=H(new Cn);let ut=!0,Qe=!0;function Dt(){ut=!1}function Et(){Qe=!1}function $n(t){Qe=t}function Xe(t){p.data=t}const K=H({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){p.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),We(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[],Vn(),ct.value=!0},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),je(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)We(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)je(this.refreshTopicPrefix+t)},subscribeUpdates(){We(this.updateTopic)},unsubscribeUpdates(){je(this.updateTopic)}}),q=H({topic:"openWB/log/daily/#",date:new Date,activate(){if(p.graphMode=="day"||p.graphMode=="today"){p.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");We(this.topic),Ee("getDailyLog",{day:t})}},deactivate(){je(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),Be=H({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");p.data=[],We(this.topic),Ee("getMonthlyLog",{month:t})},deactivate(){je(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){const t=new Date;t.getFullYear()==this.year?this.month-1<t.getMonth()&&(this.month=this.month+1):(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1)),this.activate()},getDate(){return new Date(this.year,this.month)}}),Le=H({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();p.data=[],We(this.topic),Ee("getYearlyLog",{year:t})},deactivate(){je(this.topic)},back(){this.year-=1,this.activate()},forward(){this.year<new Date().getFullYear()&&(this.year=this.year+1,this.activate())},getDate(){return new Date(this.year,this.month)}});function ae(t=!1){switch(p.graphMode==""?In(b.graphPreference):p.graphMode=="live"?b.graphPreference="live":b.graphPreference="today",t||(ut=!0,Qe=!0),p.graphMode){case"live":q.deactivate(),Be.deactivate(),Le.deactivate(),K.activate();break;case"today":K.deactivate(),Be.deactivate(),Le.deactivate(),q.activate();break;case"day":K.deactivate(),Be.deactivate(),Le.deactivate(),q.activate();break;case"month":K.deactivate(),q.deactivate(),Le.deactivate(),Be.activate();break;case"year":K.deactivate(),q.deactivate(),Be.deactivate(),Le.activate();break}}function In(t){p.graphMode=t}function Bn(t,e){e[t]>0&&(M.items[t].energyPv+=1e3/12*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),M.items[t].energyBat+=1e3/12*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}function On(t,e){e[t]>0&&(M.items[t].energyPv+=1e3*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),M.items[t].energyBat+=1e3*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}const Tn=["evuIn","pv","batIn","evuOut"],He=se(!1);function $t(t,e){Object.entries(t).length>0?(He.value=!1,Object.entries(t.counter).forEach(([a,n])=>{(e.length==0||e.includes(a))&&(M.items.evuIn.energy+=n.energy_imported,M.items.evuOut.energy+=n.energy_exported)}),M.items.pv.energy=t.pv.all.energy_exported,t.bat.all&&(M.items.batIn.energy=t.bat.all.energy_imported,M.items.batOut.energy=t.bat.all.energy_exported),Object.entries(t.cp).forEach(([a,n])=>{a=="all"?M.setEnergy("charging",n.energy_imported):M.setEnergy(a,n.energy_imported)}),M.setEnergy("devices",0),Object.entries(t.sh).forEach(([a,n])=>{M.setEnergy(a,n.energy_imported);const o=a.substring(2);ne.get(+o).countAsHouse||(M.items.devices.energy+=n.energy_imported)}),t.hc&&t.hc.all?M.setEnergy("house",t.hc.all.energy_imported):M.calculateHouseEnergy(),M.keys().map(a=>{Tn.includes(a)||(M.setPvPercentage(a,Math.round((M.items[a].energyPv+M.items[a].energyBat)/M.items[a].energy*100)),Ct.includes(a)&&(A[a].energy=M.items[a].energy,A[a].energyPv=M.items[a].energyPv,A[a].energyBat=M.items[a].energyBat,A[a].pvPercentage=M.items[a].pvPercentage))}),p.graphMode=="today"&&(Object.values(w).map(a=>{const n=M.items["cp"+a.id];n&&(a.energyPv=n.energyPv,a.energyBat=n.energyBat,a.pvPercentage=n.pvPercentage)}),ne.forEach(a=>{const n=M.items["sh"+a.id];n&&(a.energy=n.energy,a.energyPv=n.energyPv,a.energyBat=n.energyBat,a.pvPercentage=n.pvPercentage)}))):He.value=!0,ct.value=!0}function Vn(){M.keys().map(t=>{Ct.includes(t)&&(A[t].energy=M.items[t].energy,A[t].energyPv=0,A[t].energyBat=0,A[t].pvPercentage=0)}),Object.values(w).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0}),ne.forEach(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0})}const Me=g(()=>{const t=Ge(p.data,e=>e.date);return t[1]?wt().domain(Array.from({length:t[1]},(e,a)=>a+1)).paddingInner(.4).range([0,$e-E.left-2]):wt().range([0,0])});function It(){switch(p.graphMode){case"live":p.graphMode="today",b.showRightButton=!0,ae();break;case"today":p.graphMode="day",q.date=new Date,q.back(),ae();break;case"day":q.back(),ae();break;case"month":Be.back();break;case"year":Le.back();break}}function aa(){const t=new Date;switch(p.graphMode){case"live":break;case"today":p.graphMode="live",b.showRightButton=!1,ae();break;case"day":q.forward(),q.date.getDate()==t.getDate()&&q.date.getMonth()==t.getMonth()&&q.date.getFullYear()==t.getFullYear()&&(p.graphMode="today"),ae();break;case"month":Be.forward();break;case"year":Le.forward();break}}function na(){switch(p.graphMode){case"live":It();break;case"day":case"today":p.graphMode="month",ae();break;case"month":p.graphMode="year",ae();break}}function oa(){switch(p.graphMode){case"year":p.graphMode="month",ae();break;case"month":p.graphMode="today",ae();break;case"today":case"day":p.graphMode="live",ae();break}}function An(t){if(p.graphMode=="day"||p.graphMode=="today"){q.setDate(t);const e=new Date;q.date.getDate()==e.getDate()&&q.date.getMonth()==e.getMonth()&&q.date.getFullYear()==e.getFullYear()?p.graphMode="today":p.graphMode="day",ae()}}const Ln=["origin","transform"],Dn=V({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)"};var n,o;const i=b.showAnimations?b.animationDuration:0,s=b.showAnimations?b.animationDelay:0,c=g(()=>{const x=Se("g#pgSourceGraph");p.graphMode=="month"||p.graphMode=="year"?B(x):Q(x),x.selectAll(".axis").remove();const C=x.append("g").attr("class","axis");return C.call(ie.value),C.selectAll(".tick").attr("font-size",12),C.selectAll(".tick line").attr("stroke",G.value).attr("stroke-width",D.value),C.select(".domain").attr("stroke","var(--color-bg)"),"pgSourceGraph.vue"}),l=g(()=>p.graphMode=="month"||p.graphMode=="year"?["evuIn","batOut","selfUsage","evuOut"]:["selfUsage","evuOut","batOut","evuIn"]),m=g(()=>Te().domain([0,p.data.length-1]).range([0,e.width])),v=g(()=>Jt().keys(l.value)),$=g(()=>v.value(p.data)),f=g(()=>Te().range([e.height-10,0]).domain(p.graphMode=="year"?[0,Math.ceil(I.value[1]*10)/10]:[0,Math.ceil(I.value[1])])),I=g(()=>{let x=Ge(p.data,C=>Math.max(C.pv+C.evuIn+C.batOut,C.selfUsage+C.evuOut));return x[0]!=null&&x[1]!=null?(p.graphMode=="year"&&(x[0]=x[0]/1e3,x[1]=x[1]/1e3),x):[0,0]}),j=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),ie=g(()=>pt(f.value).tickSizeInner(j.value).ticks(4).tickFormat(x=>(x==0?"":Math.round(x*10)/10).toLocaleString(void 0))),D=g(()=>b.showGrid?"0.5":"1"),G=g(()=>b.showGrid?"var(--color-grid)":"var(--color-bg)");function Q(x){const C=st().x((L,de)=>m.value(de)).y(f.value(0)),U=st().x((L,de)=>m.value(de)).y0(L=>f.value(p.graphMode=="year"?L[0]/1e3:L[0])).y1(L=>f.value(p.graphMode=="year"?L[1]/1e3:L[1]));ut?(x.selectAll("*").remove(),n=x.selectAll(".sourceareas").data($.value).enter().append("path").attr("fill",(L,de)=>a[l.value[de]]).attr("d",L=>C(L)),n.transition().duration(i).delay(s).ease(Ne).attr("d",L=>U(L)),Dt()):n.data($.value).transition().duration(0).ease(Ne).attr("d",L=>U(L))}function B(x){ut?(x.selectAll("*").remove(),o=x.selectAll(".sourcebar").data($.value).enter().append("g").attr("fill",(C,U)=>a[l.value[U]]).selectAll("rect").data(C=>C).enter().append("rect").attr("x",(C,U)=>Me.value(p.data[U].date)??0).attr("y",()=>f.value(0)).attr("height",0).attr("width",Me.value.bandwidth()),o.transition().duration(i).delay(s).ease(Ne).attr("height",C=>p.graphMode=="year"?f.value(C[0]/1e3)-f.value(C[1]/1e3):f.value(C[0])-f.value(C[1])).attr("y",C=>p.graphMode=="year"?f.value(C[1]/1e3):f.value(C[1])),Dt()):(x.selectAll("*").remove(),o=x.selectAll(".sourcebar").data($.value).enter().append("g").attr("fill",(C,U)=>a[l.value[U]]).selectAll("rect").data(C=>C).enter().append("rect").attr("x",(C,U)=>Me.value(p.data[U].date)??0).attr("y",C=>p.graphMode=="year"?f.value(C[1]/1e3):f.value(C[1])).attr("width",Me.value.bandwidth()).attr("height",C=>p.graphMode=="year"?f.value(C[0]/1e3)-f.value(C[1]/1e3):f.value(C[0])-f.value(C[1])))}return(x,C)=>(h(),y("g",{id:"pgSourceGraph",origin:c.value,transform:"translate("+x.margin.left+","+x.margin.top+")"},null,8,Ln))}}),En=["origin","transform"],Wn=V({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn"],["charging","devices","house","batIn"],["devices","charging","house","batIn"]],n={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var o,i;const s=b.showAnimations?b.animationDuration:0,c=b.showAnimations?b.animationDelay:0,l=g(()=>{const B=Se("g#pgUsageGraph");p.graphMode=="month"||p.graphMode=="year"?Q(B):G(B),B.selectAll(".axis").remove();const x=B.append("g").attr("class","axis");return x.call(D.value),x.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),b.showGrid?x.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):x.selectAll(".tick line").attr("stroke","var(--color-bg)"),x.select(".domain").attr("stroke","var(--color-bg)"),"pgUsageGraph.vue"}),m=g(()=>Jt().keys(I.value)),v=g(()=>m.value(p.data)),$=g(()=>Te().domain([0,p.data.length-1]).range([0,e.width])),f=g(()=>Te().range([e.height+10,2*e.height]).domain(p.graphMode=="year"?[0,Math.ceil(j.value[1]*10)/10]:[0,Math.ceil(j.value[1])])),I=g(()=>{if(p.graphMode!="today"&&p.graphMode!="day")return a[e.stackOrder];{const B=a[e.stackOrder].slice(),x=B.indexOf("charging");B.splice(x,1);const C=/cp\d+/;let U=[];return p.data.length>0&&(U=Object.keys(p.data[0]).reduce((L,de)=>(de.match(C)&&L.push(de),L),[])),U.map((L,de)=>{B.splice(x+de,0,L),n[L]="var(--color-cp"+de+")"}),B}}),j=g(()=>{let B=Ge(p.data,x=>x.house+x.charging+x.batIn+x.devices);return B[0]!=null&&B[1]!=null?(p.graphMode=="year"&&(B[0]=B[0]/1e3,B[1]=B[1]/1e3),B):[0,0]}),ie=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),D=g(()=>pt(f.value).tickSizeInner(ie.value).ticks(4).tickFormat(B=>(B==0?"":Math.round(B*10)/10).toLocaleString(void 0)));function G(B){const x=st().x((U,L)=>$.value(L)).y(f.value(0)),C=st().x((U,L)=>$.value(L)).y0(U=>f.value(U[0])).y1(U=>f.value(U[1]));b.showAnimations?Qe?(B.selectAll("*").remove(),o=B.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",U=>x(U)).attr("fill",(U,L)=>n[I.value[L]]),o.transition().duration(300).delay(100).ease(Ne).attr("d",U=>C(U)),Et()):(B.selectAll("*").remove(),B.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",U=>C(U)).attr("fill",(U,L)=>n[I.value[L]])):(B.selectAll("*").remove(),B.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",U=>C(U)).attr("fill",(U,L)=>n[I.value[L]]))}function Q(B){Qe?(B.selectAll("*").remove(),i=B.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(x,C)=>n[a[e.stackOrder][C]]).selectAll("rect").data(x=>x).enter().append("rect").attr("x",(x,C)=>Me.value(p.data[C].date)??0).attr("y",()=>f.value(0)).attr("height",0).attr("width",Me.value.bandwidth()),i.transition().duration(s).delay(c).ease(Ne).attr("y",x=>p.graphMode=="year"?f.value(x[0]/1e3):f.value(x[0])).attr("height",x=>p.graphMode=="year"?f.value(x[1]/1e3)-f.value(x[0]/1e3):f.value(x[1])-f.value(x[0])),Et()):(B.selectAll("*").remove(),i=B.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(x,C)=>n[a[e.stackOrder][C]]).selectAll("rect").data(x=>x).enter().append("rect").attr("x",(x,C)=>Me.value(p.data[C].date)??0).attr("y",x=>p.graphMode=="year"?f.value(x[0]/1e3):f.value(x[0])).attr("height",x=>p.graphMode=="year"?f.value(x[1]/1e3)-f.value(x[0]/1e3):f.value(x[1])-f.value(x[0])).attr("width",Me.value.bandwidth()))}return(B,x)=>(h(),y("g",{id:"pgUsageGraph",origin:l.value,transform:"translate("+B.margin.left+","+B.margin.top+")"},null,8,En))}}),Gn=["transform"],jn=["origin","transform"],Un=["origin","transform"],zn={key:0},Nn=["width","height"],Fn={key:1},Jn=["y","width","height"],vt=12,Rn=V({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>nt(c.value).ticks(4).tickSizeInner(s.value).tickFormat(kt("%H:%M"))),n=g(()=>fa(c.value).ticks(4).tickSizeInner(s.value+3).tickFormat(kt(""))),o=g(()=>nt(Me.value).ticks(4).tickSizeInner(s.value).tickFormat(v=>v.toString())),i=g(()=>nt(Me.value).ticks(4).tickSizeInner(s.value).tickFormat(()=>"")),s=g(()=>p.graphMode!=="month"&&p.graphMode!=="year"?b.showGrid?-(e.height/2-7):-10:0),c=g(()=>{let v=Ge(p.data,$=>$.date);return v[0]&&v[1]?qe().domain(v).range([0,e.width]):qe().range([0,0])}),l=g(()=>{let v=Se("g#PGXAxis");return v.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?v.call(o.value):v.call(a.value),v.selectAll(".tick > text").attr("fill",($,f)=>f>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",vt),b.showGrid?v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),v.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",vt).text(p.graphMode=="year"?"MW":"kW").attr("text-anchor","start"),"PGXAxis.vue"}),m=g(()=>{let v=Se("g#PGXAxis2");return v.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?v.call(i.value):v.call(n.value),v.selectAll(".tick > text").attr("fill",($,f)=>f>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",vt),b.showGrid?(v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),v.select(".domain").attr("stroke","var(--color-bg)")):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),"PGXAxis2.vue"});return(v,$)=>(h(),y("g",{transform:"translate("+v.margin.left+","+v.margin.top+")"},[r("g",{id:"PGXAxis",class:"axis",origin:l.value,transform:"translate(0,"+(v.height/2-6)+")"},null,8,jn),r("g",{id:"PGXAxis2",class:"axis",origin:m.value,transform:"translate(0,"+(v.height/2+10)+")"},null,8,Un),u(b).showGrid?(h(),y("g",zn,[r("rect",{x:"0",y:"0",width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Nn)])):S("",!0),u(b).showGrid?(h(),y("g",Fn,[r("rect",{x:"0",y:v.height/2+10,width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Jn)])):S("",!0)],8,Gn))}}),Hn=["d"],Yn=["d","stroke"],qn=["x","y","text-anchor"],ft=V({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>{let f=Ge(p.data,I=>I.date);return f[0]&&f[1]?qe().domain(f).range([0,e.width]):qe().range([0,0])}),n=g(()=>Te().range([e.height-10,0]).domain([0,100])),o=g(()=>Rt().x(j=>a.value(j.date)).y(j=>n.value(e.order==2?j.batSoc:j["soc"+m.value.connectedVehicle])??n.value(0))(p.data)??""),i=g(()=>e.order==2?"Speicher":m.value.connectedVehicle),s=g(()=>e.order==2?"Speicher":m.value.vehicleName),c=g(()=>{switch(e.order){case 0:return"var(--color-cp1)";case 1:return"var(--color-cp2)";case 2:return"var(--color-battery)";default:return"red"}}),l=g(()=>{switch(e.order){case 0:return e.width-3;case 1:return 3;case 2:return e.width/2;default:return 0}}),m=g(()=>{const f=e.order==2?0:e.order;return Object.values(w)[f]}),v=g(()=>{if(p.data.length>0){let f;switch(e.order){case 0:return f=p.data.length-1,n.value(p.data[f]["soc"+i.value]+2);case 1:return f=0,n.value(p.data[f]["soc"+i.value]+2);case 2:return f=Math.round(p.data.length/2),n.value(p.data[f].batSoc+2);default:return 0}}else return 0}),$=g(()=>{switch(e.order){case 0:return"end";case 1:return"start";case 2:return"middle";default:return"middle"}});return(f,I)=>(h(),y(ce,null,[r("path",{class:"soc-baseline",d:o.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,Hn),r("path",{class:"soc-dashes",d:o.value,stroke:c.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,Yn),r("text",{class:"cpname",x:l.value,y:v.value,style:oe({fill:c.value,fontSize:10}),"text-anchor":$.value},P(s.value),13,qn)],64))}}),Qn=["transform"],Zn=V({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Te().range([e.height-10,0]).domain([0,100])),n=g(()=>ya(a.value).ticks(5).tickFormat(i=>i.toString()+"%"));function o(){let i=Se("g#PGSocAxis");i.call(n.value),i.selectAll(".tick").attr("font-size",12),i.selectAll(".tick line").attr("stroke","var(--color-bg)"),i.select(".domain").attr("stroke","var(--color-bg)")}return Ze(()=>{o()}),(i,s)=>(h(),y("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(i.width-20)+",0)"},null,8,Qn))}}),Xn={class:"btn-group m-0",role:"group","aria-label":"radiobar"},Kn=["id","value"],eo=V({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=e,o=g({get(){return a.modelValue},set(c){n("update:modelValue",c)}});function i(c){let l=a.options[c].color?a.options[c].color:"var(--color-fg)";return a.options[c].active?{color:"var(--color-bg)",background:l}:{color:l}}function s(c){let l=c.target;for(;l&&!l.value&&l.parentElement;)l=l.parentElement;l.value&&(o.value=l.value)}return(c,l)=>(h(),y("div",null,[r("div",Xn,[(h(!0),y(ce,null,ke(c.options,(m,v)=>(h(),y("button",{id:"radio-"+m.value,key:v,class:re(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",m.value==o.value?"active":""]),value:m.value,style:oe(i(v)),onClick:s},[r("span",{style:oe(i(v)),class:"scaled d-flex flex-column pt-2"},[m.icon?(h(),y("i",{key:0,class:re(["fa-solid",m.icon])},null,2)):S("",!0),W(" "+P(m.text),1)],4)],14,Kn))),128))])]))}}),ra=F(eo,[["__scopeId","data-v-270067ed"]]),to={key:0,class:"fa-solid fa-xl fa-chevron-circle-down p-1",style:{color:"var(--color-bg)"}},ao=V({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean},ignoreLive:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=se(0),n=g(()=>{switch(p.graphMode){case"live":return e.ignoreLive?"heute":`${K.duration} min`;case"today":return"heute";case"day":return q.date.getDate()+"."+(q.date.getMonth()+1)+".";case"month":return xa(Be.month-1,Be.year);case"year":return Le.year.toString();default:return"???"}}),o=["live","today","day","month","year"],i=["Live","Heute","Tag","Monat","Jahr"],s=g({get(){return p.graphMode},set(D){switch(D){case"day":m();break;case"today":v();break;case"live":l();break;case"month":$();break;case"year":f()}}});function c(){a.value+=1,a.value>1&&(a.value=0)}function l(){p.graphMode!="live"&&(p.graphMode="live",ae())}function m(){p.graphMode!="day"&&p.graphMode!="today"&&(p.graphMode="day",ae())}function v(){p.graphMode!="today"&&(p.graphMode="today",An(new Date),ae())}function $(){p.graphMode!="month"&&(p.graphMode="month",ae())}function f(){p.graphMode!="year"&&(p.graphMode="year",ae())}const I=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),j=g(()=>a.value==1?"justify-content-between":"justify-content-end"),ie=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(D,G)=>(h(),y("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:oe(I.value)},[a.value==2?(h(),T(ra,{key:0,id:"pgm2",modelValue:s.value,"onUpdate:modelValue":G[0]||(G[0]=Q=>s.value=Q),class:"m-2",options:o.map((Q,B)=>({text:i[B],value:Q,color:"var(--color-menu)",active:Q==u(p).graphMode}))},null,8,["modelValue","options"])):S("",!0),a.value==1?(h(),y("span",{key:1,type:"button",class:re(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:G[1]||(G[1]=Q=>D.$emit("shiftUp"))},G[6]||(G[6]=[r("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)]),2)):S("",!0),r("div",{class:re(["d-flex align-items-center",ie.value])},[a.value==1?(h(),y("span",{key:0,type:"button",class:re(["p-1",{disabled:!e.showLeftButton}]),onClick:G[2]||(G[2]=Q=>D.$emit("shiftLeft"))},G[7]||(G[7]=[r("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)]),2)):S("",!0),a.value<2?(h(),y("span",{key:1,type:"button",class:"btn-outline-secondary p-2 px-3 badge rounded-pill datebadge",onClick:c},P(n.value),1)):S("",!0),a.value==1?(h(),y("span",{key:2,id:"graphRightButton",type:"button",class:re(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:G[3]||(G[3]=Q=>D.$emit("shiftRight"))},null,2)):S("",!0)],2),r("div",{class:re(["d-flex align-items-center",j.value])},[a.value==1?(h(),y("span",to)):S("",!0),a.value==1?(h(),y("span",{key:1,id:"graphLeftButton",type:"button",class:re(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:G[4]||(G[4]=Q=>D.$emit("shiftDown"))},null,2)):S("",!0),a.value>0?(h(),y("span",{key:2,type:"button",class:"p-1",onClick:G[5]||(G[5]=Q=>a.value=0)},G[8]||(G[8]=[r("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)]))):S("",!0)],2)],4))}}),sa=F(ao,[["__scopeId","data-v-7fd067cd"]]),no={class:"d-flex justify-content-end"},oo={class:"grid-col-12"},ro=["viewBox"],so=["transform"],io=2,lo="Leistung / Ladestand ",co=V({__name:"PowerGraph",setup(t){function e(){let a=b.usageStackOrder+1;a>io&&(a=0),b.usageStackOrder=a,$n(!0)}return(a,n)=>(h(),T(gt,null,{title:k(()=>[W(P(lo))]),buttons:k(()=>[r("div",no,[_(sa,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!1,onShiftLeft:u(It),onShiftRight:u(aa),onShiftUp:u(na),onShiftDown:u(oa)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])])]),default:k(()=>[r("div",oo,[r("figure",{id:"powergraph",class:"p-0 m-0 align-self-stretch",onClick:e},[(h(),y("svg",{viewBox:"0 0 "+u($e)+" "+u(Ve)},[_(Dn,{width:u($e)-u(E).left-2*u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E)},null,8,["width","height","margin"]),_(Wn,{width:u($e)-u(E).left-2*u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E),"stack-order":u(b).usageStackOrder},null,8,["width","height","margin","stack-order"]),_(Rn,{width:u($e)-u(E).left-2*u(E).right,height:u(Ve)-u(E).top-u(E).bottom,margin:u(E),"graph-data":u(p)},null,8,["width","height","margin","graph-data"]),r("g",{transform:"translate("+u(E).left+","+u(E).top+")"},[(u(p).graphMode=="day"||u(p).graphMode=="today"||u(p).graphMode=="live")&&Object.values(u(w)).length>0?(h(),T(ft,{key:0,width:u($e)-u(E).left-2*u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E),order:0},null,8,["width","height","margin"])):S("",!0),(u(p).graphMode=="day"||u(p).graphMode=="today"||u(p).graphMode=="live")&&Object.values(u(w)).length>1?(h(),T(ft,{key:1,width:u($e)-u(E).left-2*u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E),order:1},null,8,["width","height","margin"])):S("",!0),["day","today","live"].includes(u(p).graphMode)&&u(R).isBatteryConfigured?(h(),T(ft,{key:2,width:u($e)-u(E).left-2*u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E),order:2},null,8,["width","height","margin"])):S("",!0),["day","today","live"].includes(u(p).graphMode)?(h(),T(Zn,{key:3,width:u($e)-u(E).left-u(E).right,height:(u(Ve)-u(E).top-u(E).bottom)/2,margin:u(E)},null,8,["width","height","margin"])):S("",!0)],8,so)],8,ro))])])]),_:1}))}}),uo=F(co,[["__scopeId","data-v-ba892fa4"]]),ho=["id"],po=["x","width","height","fill"],go=["x","width","height"],mo=["x","y","width","height"],vo=V({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),n=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(i,s)=>(h(),y("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[r("rect",{class:"bar",x:e.xScale(i.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:i.item.color},null,8,po),r("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:n.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,go),r("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:n.value,width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-battery)","fill-opacity":"66%"},null,8,mo)],8,ho))}}),fo={id:"emBargraph"},yo=V({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?N:M.items,c=(p.graphMode=="live"||p.graphMode=="day"?A:M.items).evuOut.energy,l=i.pv.energy;return Math.round((l-c)/l*100)}else if(o.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?N:M.items,s=p.graphMode=="live"||p.graphMode=="day"?A:M.items,c=s.evuOut.energy,l=i.evuIn.energy,m=i.pv.energy,v=i.batOut.energy,$=s.batIn.energy;return Math.round((m+v-c-$)/(m+v+l-c-$)*100)}else return o.pvPercentage}function n(o){return o.name=="PV"?"Eigen":"Aut"}return(o,i)=>(h(),y("g",fo,[(h(!0),y(ce,null,ke(e.plotdata,(s,c)=>(h(),y("g",{key:c},[_(vo,{item:s,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":n(s),autarchy:a(s)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),i[0]||(i[0]=r("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1))]))}}),bo=["origin"],_o=V({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>pt(e.yScale).tickFormat(o=>o>0?(o/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),n=g(()=>{const o=Se("g#emYAxis");return o.attr("class","axis").call(a.value),o.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),o.selectAll(".tick").attr("font-size",e.fontsize),b.showGrid?o.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):o.selectAll(".tick line").attr("stroke","var(--color-bg)"),o.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(o,i)=>(h(),y("g",{id:"emYAxis",class:"axis",origin:n.value},null,8,bo))}}),wo=["id"],ko=["x","y","font-size"],So=["x","y","font-size","fill"],xo=["x","y","font-size","fill"],Mo=V({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),n=g(()=>{let l=16,m=e.barcount;return m<=5?l=16:m==6?l=14:m>6&&m<=8?l=13:m==9?l=11:m==10?l=10:l=9,l}),o=g(()=>{let l=12,m=e.barcount;return m<=5?l=12:m==6?l=11:m>6&&m<=8||m==9?l=8:m==10?l=7:l=6,l});function i(l,m){return m.length>o.value?m.substring(0,o.value)+".":m}function s(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function c(){return"var(--color-pv)"}return(l,m)=>(h(),y("g",{id:"barlabel-"+e.item.name},[r("text",{x:e.xScale(l.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":n.value,"text-anchor":"middle",fill:"var(--color-menu)"},P(u(Yt)(l.item.energy,u(b).decimalPlaces,!1)),9,ko),r("text",{x:e.xScale(l.item.name)+e.xScale.bandwidth()/2,y:e.yScale(l.item.energy)-10,"font-size":n.value-2,"text-anchor":"middle",fill:c()},P(s()),9,So),r("text",{x:e.xScale(l.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":n.value,"text-anchor":"middle",fill:l.item.color,class:re(l.item.icon.length<=2?"fas":"")},P(i(l.item.name,l.item.icon)),11,xo)],8,wo))}}),Po={id:"emBarLabels"},Co=V({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?N:M.items,c=(p.graphMode=="live"||p.graphMode=="day"?A:M.items).evuOut.energy,l=i.pv.energy;return Math.round((l-c)/l*100)}else if(o.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?N:M.items,s=p.graphMode=="live"||p.graphMode=="day"?A:M.items,c=s.evuOut.energy,l=i.evuIn.energy,m=i.pv.energy,v=i.batOut.energy,$=s.batIn.energy;return m+v-c-$>0?Math.round((m+v-c-$)/(m+v+l-c-$)*100):0}else return o.pvPercentage}function n(o){return o.name=="PV"?"Eigen":"Aut"}return(o,i)=>(h(),y("g",Po,[(h(!0),y(ce,null,ke(e.plotdata,(s,c)=>(h(),y("g",{key:c},[_(Mo,{item:s,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":n(s),autarchy:a(s)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),$o={class:"grid-col-12"},Io={id:"energymeter",class:"energymeter p-0 m-0 align-self-stretch"},Bo={viewBox:"0 0 500 500"},Oo=["transform"],To=["x"],Vo={key:0},Wt=500,yt=500,Gt=12,Ao="Energie",Lo=V({__name:"EnergyMeter",setup(t){const e={top:25,bottom:30,left:25,right:0},a=g(()=>{let s=Object.values(N),c=i.value,l=M.values(),m=[];switch(b.debug&&(console.debug("----------------------- source summary -----------------"),console.debug(N),console.debug("----------------------- usage details ------------------"),console.debug(i.value),console.debug("----------------------- historic summary ---------------"),console.debug(M),console.debug("--------------------------------------------------------")),ct.value==!0&&(ct.value=!1),p.graphMode){default:case"live":case"today":m=s.concat(c).filter(v=>v.energy>0);break;case"day":case"month":case"year":l.length==0?He.value=!0:(He.value=!1,m=l.filter(v=>v.energy>0))}return m}),n=g(()=>wt().range([0,Wt-e.left-e.right]).domain(a.value.map(s=>s.name)).padding(.4)),o=g(()=>Te().range([yt-e.bottom-e.top,15]).domain([0,ba(a.value,s=>s.energy)])),i=g(()=>{const s=Object.values(w).length,c=[...ne.values()].filter(l=>l.configured).length;return[A.evuOut,A.devices,A.charging].concat(s>1?Object.values(w).map(l=>l.toPowerItem()):[]).concat(c>1?[...ne.values()].filter(l=>l.configured&&l.showInGraph):[]).concat([A.batIn,A.house])});return(s,c)=>(h(),T(gt,null,{title:k(()=>[W(P(Ao))]),buttons:k(()=>[_(sa,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!0,onShiftLeft:u(It),onShiftRight:u(aa),onShiftUp:u(na),onShiftDown:u(oa)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:k(()=>[r("div",$o,[r("figure",Io,[(h(),y("svg",Bo,[r("g",{transform:"translate("+e.left+","+e.top+")"},[_(yo,{plotdata:a.value,"x-scale":n.value,"y-scale":o.value,height:yt,margin:e},null,8,["plotdata","x-scale","y-scale"]),_(_o,{"y-scale":o.value,width:Wt,fontsize:Gt,config:u(b)},null,8,["y-scale","config"]),r("text",{x:-e.left,y:"-15",fill:"var(--color-axis)","font-size":Gt},P(u(p).graphMode=="year"?"MWh":"kWh"),9,To),_(Co,{plotdata:a.value,"x-scale":n.value,"y-scale":o.value,height:yt,margin:e,config:u(b)},null,8,["plotdata","x-scale","y-scale","config"])],8,Oo)]))])]),u(He)?(h(),y("p",Vo,"No data")):S("",!0)]),_:1}))}}),Do=F(Lo,[["__scopeId","data-v-35f92695"]]),Eo=["id"],Wo={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},Go={class:"modal-content"},jo={class:"modal-header"},Uo={class:"modal-title scaled"},zo={class:"modal-body"},No=V({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return(a,n)=>(h(),y("div",{id:e.modalId,class:"modal fade"},[r("div",Wo,[r("div",Go,[r("div",jo,[r("h3",Uo,[fe(a.$slots,"title",{},void 0)]),n[0]||(n[0]=r("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[r("i",{class:"fa-solid fa-lg fa-circle-check m-0 p-0"})],-1))]),r("div",zo,[fe(a.$slots,"default",{},void 0)]),n[1]||(n[1]=r("div",{class:"modal-footer"},null,-1))])])],8,Eo))}}),bt=F(No,[["__scopeId","data-v-dff8d7c2"]]),Fo={class:"digit scaled",type:"button"},Jo=V({__name:"PadButton",props:{modelValue:{},color:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=se(!1);function o(){n.value=!0,s("update:modelValue",a.modelValue),setTimeout(()=>{n.value=!1},300)}const i=g(()=>n.value?{"background-color":"white",color:"black"}:{"background-color":a.color??"var(--color-axis)"}),s=e;return(c,l)=>(h(),y("div",{class:"padbutton",style:oe(i.value),onClick:o},[r("span",Fo,[fe(c.$slots,"default",{},void 0)])],4))}}),tt=F(Jo,[["__scopeId","data-v-cc256a6f"]]),Ro={class:"numberpad"},Ho={class:"codedisplay scaled"},Yo={class:"numberentry"},qo=V({__name:"NumberPad",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const n=se(t.modelValue),o=e,i=g(()=>n.value.length==0?"Bitte geben Sie die PIN ein":"*".repeat(n.value.length));function s(c){c==-1?n.value=n.value.slice(0,-1):c==-2?(o("update:modelValue",n.value),n.value=""):n.value=n.value+c.toString()}return(c,l)=>(h(),y("div",Ro,[r("p",Ho,P(i.value),1),r("div",Yo,[(h(),y(ce,null,ke(9,m=>_(tt,{key:m,"model-value":m,"onUpdate:modelValue":s},{default:k(()=>[W(P(m),1)]),_:2},1032,["model-value"])),64)),_(tt,{"model-value":0,"onUpdate:modelValue":s},{default:k(()=>l[0]||(l[0]=[W("0")])),_:1}),_(tt,{"model-value":-1,color:"var(--color-devices)","onUpdate:modelValue":s},{default:k(()=>l[1]||(l[1]=[r("span",{class:"fas fa-delete-left"},null,-1)])),_:1}),_(tt,{"model-value":-2,color:"var(--color-devices)","data-bs-dismiss":"modal","onUpdate:modelValue":s},{default:k(()=>l[2]||(l[2]=[r("span",{class:"fas fa-circle-check"},null,-1)])),_:1})])]))}}),Qo=F(qo,[["__scopeId","data-v-63c8fa5c"]]),Zo={class:"statustable"},Xo={key:0,class:"controlbuttons d-flex justify-content-between p-5"},Ko={key:1,class:"confirmationBox rounded m-5 p-5 d-flex flex-column align-items-center"},er={class:"d-flex justify-content-between mt-3"},tr={key:2,class:"confirmationBox rounded m-5 p-5 d-flex flex-column align-items-center"},ar={class:"d-flex justify-content-between mt-3"},nr={key:3,class:"confirmationBox rounded m-5 p-5 d-flex flex-column align-items-center"},or={key:4,class:"confirmationBox rounded m-5 p-5 d-flex flex-column align-items-center"},rr=V({__name:"StatusPage",setup(t){let e=se(0);function a(){e.value=4,Ae.parentChargePoint1!==void 0?(console.log("Shutting down secondary charge point: ",Ae.parentChargePoint1),Ee("chargepointShutdown",{chargePoint:Ae.parentChargePoint1})):(console.log("Shutting down primary system"),Ee("systemShutdown"))}function n(){e.value=3,Ae.parentChargePoint1!==void 0?(console.log("Rebooting secondary charge point:",Ae.parentChargePoint1),Ee("chargepointReboot",{chargePoint:Ae.parentChargePoint1})):(console.log("Rebooting primary system"),Ee("systemReboot"))}function o(){location.reload()}return(i,s)=>(h(),y(ce,null,[r("div",Zo,[s[7]||(s[7]=r("span",{class:"header"},"IP-Adresse:",-1)),r("span",null,P(u(R).ipAddress),1),s[8]||(s[8]=r("span",{class:"header"},"Systemzeit:",-1)),r("span",null,P(new Date(u(R).systemTime*1e3).toLocaleString(void 0)),1),s[9]||(s[9]=r("span",{class:"header"},"Version:",-1)),r("span",null,P(u(R).version),1),s[10]||(s[10]=r("span",{class:"header"},"Version (Details):",-1)),r("span",null,P(u(R).versionDetails),1),s[11]||(s[11]=r("span",{class:"header"},"Entwicklungszweig:",-1)),r("span",null,P(u(R).devBranch),1)]),u(e)==0?(h(),y("div",Xo,[r("button",{class:"btn controlbutton",style:{"background-color":"var(--color-battery)"},onClick:s[0]||(s[0]=c=>o())},s[12]||(s[12]=[r("i",{class:"fa-solid fa-rotate-left"},null,-1),W(" Display neu laden ")])),r("button",{class:"btn controlbutton",style:{"background-color":"var(--color-evu)"},onClick:s[1]||(s[1]=c=>et(e)?e.value=1:e=1)},s[13]||(s[13]=[r("i",{class:"fa-solid fa-power-off"},null,-1),W(" openWB neu starten ")])),r("button",{class:"btn controlbutton",style:{"background-color":"var(--color-evu)"},onClick:s[2]||(s[2]=c=>et(e)?e.value=2:e=2)},s[14]||(s[14]=[r("i",{class:"fa-solid fa-power-off"},null,-1),W(" openWB abschalten ")]))])):S("",!0),u(e)==1?(h(),y("div",Ko,[s[15]||(s[15]=r("span",{class:"confirmTitle"},"Neustart",-1)),s[16]||(s[16]=r("span",{class:"confirmQuestion"},"Die openWB jetzt neu starten?",-1)),r("div",er,[r("button",{class:"btn cancelButton mx-3 px-3",onClick:s[3]||(s[3]=c=>et(e)?e.value=0:e=0)}," Abbrechen "),r("button",{class:"btn confirmButton mx-3 px-3",onClick:s[4]||(s[4]=c=>n())}," Neustart ")])])):S("",!0),u(e)==2?(h(),y("div",tr,[s[17]||(s[17]=r("span",{class:"confirmTitle"},"Abschalten",-1)),s[18]||(s[18]=r("span",{class:"confirmQuestion"},"Die openWB jetzt abschalten?",-1)),r("div",ar,[r("button",{class:"btn cancelButton mx-3 px-3",onClick:s[5]||(s[5]=c=>et(e)?e.value=0:e=0)}," Abbrechen "),r("button",{class:"btn confirmButton mx-3 px-3",onClick:s[6]||(s[6]=c=>a())}," Abschalten ")])])):S("",!0),u(e)==3?(h(),y("div",nr,s[19]||(s[19]=[r("span",{class:"confirmTitle"},"Die openWB startet jetzt neu. Bitte warten.",-1)]))):S("",!0),u(e)==4?(h(),y("div",or,s[20]||(s[20]=[r("span",{class:"confirmTitle"},"Die openWB wird heruntergefahren. Zum Starten die Stromversorgung aus- und wieder einschalten.",-1)]))):S("",!0)],64))}}),sr=F(rr,[["__scopeId","data-v-74ffcddc"]]),ir={class:"d-flex align-items-baseline m-0 p-0 scaled"},lr={class:"ms-1 mb-2 p-0 pt-2 d-flex justify-content-stretch align-items-center"},cr={class:"justify-content-stretch d-flex"},ur=V({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},iconcolor:{},fullwidth:{type:Boolean}},setup(t){const e=t;return(a,n)=>(h(),y(ce,null,[r("span",ir,[e.icon?(h(),y("i",{key:0,class:re(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon]),style:oe({color:e.iconcolor?e.iconcolor:"var(--color-charging)"})},null,6)):S("",!0),W(" "+P(a.title),1)]),r("div",lr,[r("span",cr,[fe(a.$slots,"default",{},void 0)])])],64))}}),ee=F(ur,[["__scopeId","data-v-45020119"]]),dr={class:"rangewidget d-flex flex-column"},hr={class:"rangeslider d-flex flex-fill justify-content-between align-items-center"},pr={class:"d-flex flex-fill flex-column justify-content-center m-0 p-0"},gr={key:0,id:"rangeIndicator",class:"rangeIndicator"},mr={viewBox:"0 0 100 2"},vr=["width"],fr=["x","width"],yr=["x","width"],br=["id","min","max","step"],_r={class:"d-flex justify-content-between align-items-center"},wr={class:"minlabel ps-4"},kr={class:"valuelabel"},Sr={class:"maxlabel pe-4"},xr=V({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},decimals:{},showSubrange:{type:Boolean},subrangeMin:{},subrangeMax:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=a.decimals??0,o=e,i=g({get(){return Math.round(a.modelValue*Math.pow(10,n))/Math.pow(10,n)},set(f){o("update:modelValue",f)}});function s(){i.value>a.min&&(i.value=Math.round((i.value-a.step)*Math.pow(10,n))/Math.pow(10,n))}function c(){i.value<a.max&&(i.value=Math.round((i.value+a.step)*Math.pow(10,n))/Math.pow(10,n))}const l=g(()=>Te().domain([a.min,a.max]).range([0,100])),m=g(()=>l.value(a.subrangeMin?a.subrangeMin:0)),v=g(()=>a.subrangeMin&&a.subrangeMax?l.value(a.subrangeMax)-l.value(a.subrangeMin):0),$=g(()=>a.subrangeMax&&a.max?l.value(a.max)-l.value(a.subrangeMax):0);return(f,I)=>(h(),y("span",dr,[r("span",hr,[r("span",{type:"button",class:"minusButton",onClick:s},I[1]||(I[1]=[r("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)])),r("div",pr,[a.showSubrange?(h(),y("figure",gr,[(h(),y("svg",mr,[r("g",null,[r("rect",{class:"below",x:0,y:"0",width:m.value,height:"2",rx:"1",ry:"1",fill:"var(--color-evu)"},null,8,vr),r("rect",{class:"bar",x:m.value,y:"0",width:v.value,height:"2",rx:"1",ry:"1",fill:"var(--color-charging)"},null,8,fr),r("rect",{class:"above",x:m.value+v.value,y:"0",width:$.value,height:"2",rx:"1",ry:"1",fill:"var(--color-pv)"},null,8,yr)])]))])):S("",!0),Fe(r("input",{id:f.id,"onUpdate:modelValue":I[0]||(I[0]=j=>i.value=j),type:"range",class:"form-range flex-fill",min:f.min,max:f.max,step:f.step},null,8,br),[[_a,i.value,void 0,{number:!0}]])]),r("span",{type:"button",class:"plusButton",onClick:c},I[2]||(I[2]=[r("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)]))]),r("span",_r,[r("span",wr,P(f.min),1),r("span",kr,P(i.value)+" "+P(f.unit),1),r("span",Sr,P(f.max),1)])]))}}),Oe=F(xr,[["__scopeId","data-v-41dc3794"]]),Mr=["id","value"],Pr=V({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=e,o=g({get(){return a.modelValue},set(c){n("update:modelValue",c)}});function i(c){return a.options[c][2]?{color:a.options[c][2]}:{color:"var(--color-fg)"}}function s(c){let l=c.target;for(;l&&!l.value&&l.parentElement;)l=l.parentElement;l.value&&(o.value=l.value)}return(c,l)=>(h(),y("div",null,[(h(!0),y(ce,null,ke(c.options,(m,v)=>(h(),y("button",{id:"radio-"+m[1],key:v,class:re(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",m[1]==o.value?"active":""]),value:m[1],style:oe(i(v)),onClick:s},[r("span",{style:oe(i(v)),class:"scaled"},[m[3]?(h(),y("i",{key:0,class:re(["fa-solid",m[3]])},null,2)):S("",!0),W(" "+P(m[0]),1)],4)],14,Mr))),128))]))}}),rt=F(Pr,[["__scopeId","data-v-005a14a9"]]),Cr={class:"instantsettings"},$r={key:0},Ir=V({__name:"CPConfigInstant",props:{chargepointId:{}},setup(t){const e=t,a=g(()=>w[e.chargepointId]),n=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}],o=g({get(){return a.value.instantMaxEnergy/1e3},set(i){a.value.instantMaxEnergy=i*1e3}});return(i,s)=>(h(),y("div",Cr,[_(ee,{title:"Stromstärke",icon:"fa-bolt",fullwidth:!0},{default:k(()=>[_(Oe,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":s[0]||(s[0]=c=>a.value.instantTargetCurrent=c),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(h(),y("hr",$r)):S("",!0),_(ee,{title:"Begrenzung",icon:"fa-hand",fullwidth:!0},{default:k(()=>[_(rt,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":s[1]||(s[1]=c=>a.value.instantChargeLimitMode=c),options:n.map(c=>[c.name,c.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(h(),T(ee,{key:1,title:"Maximaler SoC",icon:"fa-sliders",fullwidth:!0},{default:k(()=>[_(Oe,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":s[2]||(s[2]=c=>a.value.instantTargetSoc=c),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):S("",!0),a.value.instantChargeLimitMode=="amount"?(h(),T(ee,{key:2,title:"Zu ladende Energie",icon:"fa-sliders",fullwidth:!0},{default:k(()=>[_(Oe,{id:"maxEnergy",modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=c=>o.value=c),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):S("",!0)]))}}),Br=F(Ir,[["__scopeId","data-v-6c87e539"]]),Or={class:"form-check form-switch d-flex align-items-center justify-content-center"},Tr=V({__name:"SwitchInput",props:{modelValue:{type:Boolean},onColor:{},offColor:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=e,o=g({get(){return a.modelValue},set(i){n("update:modelValue",i)}});return(i,s)=>(h(),y("div",Or,[Fe(r("input",{"onUpdate:modelValue":s[0]||(s[0]=c=>o.value=c),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[wa,o.value]])]))}}),we=F(Tr,[["__scopeId","data-v-547e6de4"]]),Vr={class:"pvsettings pt-2"},Ar=V({__name:"CPConfigPv",props:{chargepointId:{}},setup(t){const e=t,a=g(()=>w[e.chargepointId]),n=g({get(){return a.value.pvMinCurrent>5},set(s){s?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),o=g({get(){return a.value.pvMinSoc>0},set(s){s?a.value.pvMinSoc=50:a.value.pvMinSoc=0}}),i=g({get(){return a.value.pvMaxSoc<=100},set(s){s?a.value.pvMaxSoc=100:a.value.pvMaxSoc=101}});return(s,c)=>(h(),y("div",Vr,[_(ee,{title:"Ladestand begrenzen",icon:"fa-battery-three-quarters",fullwidth:!0},{default:k(()=>[_(we,{id:"limitSoc",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=l=>i.value=l)},null,8,["modelValue"])]),_:1}),i.value?(h(),T(ee,{key:0,title:"...auf maximal...",icon:"fa-battery-three-quarters",fullwidth:!0},{default:k(()=>[_(Oe,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":c[1]||(c[1]=l=>a.value.pvMaxSoc=l),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):S("",!0),_(ee,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:k(()=>[_(we,{modelValue:a.value.pvFeedInLimit,"onUpdate:modelValue":c[2]||(c[2]=l=>a.value.pvFeedInLimit=l)},null,8,["modelValue"])]),_:1}),_(ee,{title:"Mindest-Ladestand",icon:"fa-battery-half",fullwidth:!0},{default:k(()=>[_(we,{modelValue:o.value,"onUpdate:modelValue":c[3]||(c[3]=l=>o.value=l)},null,8,["modelValue"])]),_:1}),o.value?(h(),T(ee,{key:1,title:"...bis SoC",fullwidth:!0},{default:k(()=>[_(Oe,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":c[4]||(c[4]=l=>a.value.pvMinSoc=l),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):S("",!0),o.value?(h(),T(ee,{key:2,title:"...mit Ladestrom",fullwidth:!0},{default:k(()=>[_(Oe,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":c[5]||(c[5]=l=>a.value.pvMinSocCurrent=l),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):S("",!0),_(ee,{title:"Minimaler Ladestrom",icon:"fa-bolt",fullwidth:!0},{default:k(()=>[_(we,{modelValue:n.value,"onUpdate:modelValue":c[6]||(c[6]=l=>n.value=l)},null,8,["modelValue"])]),_:1}),n.value?(h(),T(ee,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:k(()=>[_(Oe,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":c[7]||(c[7]=l=>a.value.pvMinCurrent=l),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):S("",!0)]))}}),Lr=F(Ar,[["__scopeId","data-v-908e4b46"]]),Dr={class:"d-flex flex-column p-3"},Er={key:0,class:"warning p-5"},Wr={class:"table table-dark"},Gr=V({__name:"CPConfigScheduled",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,n=g(()=>Je[a.chargeTemplateId]?Object.values(Je[a.chargeTemplateId]):[]);function o(c){console.log(`update ${c}`),Y("cpScheduledPlanActive",n.value[c].active,a.chargeTemplateId,c)}function i(c){return n.value[c].time}function s(c){return{"font-weight":n.value[c].active?"bold":"regular"}}return(c,l)=>(h(),y("div",Dr,[l[1]||(l[1]=r("div",{class:"subtitle mb-4"},"Pläne für Zielladen:",-1)),n.value.length==0?(h(),y("div",Er," Es sind noch keine Pläne definiert. Pläne für das Zielladen können in der Web-App festgelegt werden. ")):S("",!0),r("table",Wr,[l[0]||(l[0]=r("thead",null,[r("tr",null,[r("th"),r("th",null,"Startzeit"),r("th",null,"SoC-Ziel"),r("th",null,"SoC-Limit"),r("th",null,"Wiederholung")])],-1)),r("tbody",null,[(h(!0),y(ce,null,ke(n.value,(m,v)=>(h(),y("tr",{key:v,style:oe(s(v))},[r("td",null,[_(we,{modelValue:m.active,"onUpdate:modelValue":[$=>m.active=$,$=>o(v)]},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,P(i(v)),1),r("td",null,P(m.limit.soc_scheduled)+"%",1),r("td",null,P(m.limit.soc_limit)+"%",1),r("td",null,P(e[m.frequency.selected]),1)],4))),128))])])]))}}),jr=F(Gr,[["__scopeId","data-v-09a476b7"]]),Ur={class:"d-flex flex-column p-3"},zr={key:0,class:"warning p-5"},Nr={class:"table table-dark"},Fr=V({__name:"CPConfigTimed",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,n=g(()=>Re[a.chargeTemplateId]?Object.values(Re[a.chargeTemplateId])??[]:[]);function o(s){console.log(`update ${s}`),Y("cpTimedPlanActive",n.value[s].active,a.chargeTemplateId,s)}function i(s){return{"font-weight":n.value[s].active?"bold":"regular"}}return(s,c)=>(h(),y("div",Ur,[c[1]||(c[1]=r("div",{class:"subtitle mb-4"},"Zeitpläne:",-1)),n.value.length==0?(h(),y("div",zr," Es sind noch keine Pläne definiert. Zeitpläne können in der Web-App festgelegt werden. ")):S("",!0),r("table",Nr,[c[0]||(c[0]=r("thead",null,[r("tr",null,[r("th"),r("th",null,"Von"),r("th",null,"Bis"),r("th",null,"Ladestrom"),r("th",null,"Wiederholung")])],-1)),r("tbody",null,[(h(!0),y(ce,null,ke(n.value,(l,m)=>(h(),y("tr",{key:m,style:oe(i(m))},[r("td",null,[_(we,{modelValue:l.active,"onUpdate:modelValue":[v=>l.active=v,v=>o(m)]},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,P(l.time[0]),1),r("td",null,P(l.time[1]),1),r("td",null,P(l.current)+"A",1),r("td",null,P(e[l.frequency.selected]),1)],4))),128))])])]))}}),Jr=F(Fr,[["__scopeId","data-v-93a76758"]]),Rr={class:"chargesettings pt-2"},Hr={key:2,class:"grid-col-2 my-2"},Yr=V({__name:"CPChargeConfig",props:{chargepointId:{}},setup(t){const e=t,a=g(()=>w[e.chargepointId]),n=g({get:()=>a.value.connectedVehicle,set:s=>{w[a.value.id].connectedVehicle=s}}),o=g({get:()=>a.value.etActive,set:s=>{w[a.value.id].etActive=s}}),i=g({get:()=>a.value.timedCharging,set:s=>{w[a.value.id].timedCharging=s}});return(s,c)=>(h(),y("div",Rr,[Object.keys(u(J)).length>1?(h(),T(ee,{key:0,title:"Fahrzeug wechseln",icon:"fa-car",fullwidth:!0},{default:k(()=>[_(rt,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=l=>n.value=l),modelModifiers:{number:!0},options:Object.values(u(J)).map(l=>[l.name,l.id])},null,8,["modelValue","options"])]),_:1})):S("",!0),Object.keys(u(ue)).length>1?(h(),T(ee,{key:1,title:"Ladeprofil",icon:"fa-sliders",iconcolor:"var(--color-pv)"},{default:k(()=>[u(J)[n.value]?(h(),T(rt,{key:0,modelValue:u(J)[n.value].chargeTemplateId,"onUpdate:modelValue":c[1]||(c[1]=l=>u(J)[n.value].chargeTemplateId=l),modelModifiers:{number:!0},options:Object.keys(u(ue)).map(l=>[u(ue)[+l].name,l])},null,8,["modelValue","options"])):S("",!0)]),_:1})):S("",!0),c[7]||(c[7]=r("hr",{class:"grid-col-2 my-2"},null,-1)),_(ee,{title:"Priorität",icon:"fa-star",iconcolor:"var(--color-evu)",fullwidth:!0},{default:k(()=>[_(we,{modelValue:a.value.hasPriority,"onUpdate:modelValue":c[2]||(c[2]=l=>a.value.hasPriority=l)},null,8,["modelValue"])]),_:1}),_(ee,{title:"Zeitplan aktivieren",icon:"fa-clock",iconcolor:"var(--color-battery)"},{default:k(()=>[_(we,{modelValue:i.value,"onUpdate:modelValue":c[3]||(c[3]=l=>i.value=l)},null,8,["modelValue"])]),_:1}),_(ee,{title:"Sperren",icon:"fa-lock",iconcolor:"var(--color-evu)",fullwidth:!0},{default:k(()=>[_(we,{modelValue:a.value.isLocked,"onUpdate:modelValue":c[4]||(c[4]=l=>a.value.isLocked=l)},null,8,["modelValue"])]),_:1}),_(ee,{title:"Strompreisbasiert laden",icon:"fa-coins",iconcolor:"var(--color-battery)"},{default:k(()=>[_(we,{modelValue:o.value,"onUpdate:modelValue":c[5]||(c[5]=l=>o.value=l)},null,8,["modelValue"])]),_:1}),u(R).isBatteryConfigured?(h(),y("hr",Hr)):S("",!0),u(R).isBatteryConfigured?(h(),T(ee,{key:3,title:"PV-Priorität (global)",icon:"fa-car-battery",iconcolor:"var(--color-battery)",fullwidth:!0},{default:k(()=>[_(rt,{modelValue:u(R).pvBatteryPriority,"onUpdate:modelValue":c[6]||(c[6]=l=>u(R).pvBatteryPriority=l),options:u(Wa)},null,8,["modelValue","options"])]),_:1})):S("",!0)]))}}),qr=F(Yr,[["__scopeId","data-v-1cad71ed"]]),Qr={class:"digit scaled",type:"button"},Zr=V({__name:"PadButtonSmall",props:{modelValue:{},color:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,n=se(!1);function o(){n.value=!0,s("update:modelValue",a.modelValue),setTimeout(()=>{n.value=!1},300)}const i=g(()=>n.value?{"background-color":"white",color:"black"}:{"background-color":a.color??"var(--color-axis)"}),s=e;return(c,l)=>(h(),y("div",{class:"padbutton",style:oe(i.value),onClick:o},[r("span",Qr,[fe(c.$slots,"default",{},void 0)])],4))}}),De=F(Zr,[["__scopeId","data-v-c4e8b67a"]]),Xr={class:"numberpad"},Kr={class:"codedisplay scaled px-3 py-1 mb-4"},es={class:"numberentry"},ts=V({__name:"PricePad",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const n=se(t.modelValue),o=e;function i(s){s==-1?n.value=n.value.slice(0,-1):s==-2?(o("update:modelValue",n.value),n.value=""):s==-3?n.value.indexOf(".")==-1&&(n.value=n.value+"."):n.value=n.value+s.toString()}return(s,c)=>(h(),y("div",Xr,[r("p",Kr,P(n.value)+" ct",1),r("div",es,[(h(),y(ce,null,ke(3,l=>_(De,{key:l,"model-value":l,"onUpdate:modelValue":i},{default:k(()=>[W(P(l),1)]),_:2},1032,["model-value"])),64)),_(De,{"model-value":-2,color:"var(--color-devices)","onUpdate:modelValue":i},{default:k(()=>c[0]||(c[0]=[r("span",{class:"fas fa-circle-check"},null,-1)])),_:1}),(h(),y(ce,null,ke([4,5,6],l=>_(De,{key:l,"model-value":l,"onUpdate:modelValue":i},{default:k(()=>[W(P(l),1)]),_:2},1032,["model-value"])),64)),_(De,{"model-value":-1,color:"var(--color-devices)","onUpdate:modelValue":i},{default:k(()=>c[1]||(c[1]=[r("span",{class:"fas fa-delete-left"},null,-1)])),_:1}),(h(),y(ce,null,ke([7,8,9],l=>_(De,{key:l,"model-value":l,"onUpdate:modelValue":i},{default:k(()=>[W(P(l),1)]),_:2},1032,["model-value"])),64)),c[4]||(c[4]=r("div",null,null,-1)),c[5]||(c[5]=r("div",null,null,-1)),_(De,{"model-value":0,"onUpdate:modelValue":i},{default:k(()=>c[2]||(c[2]=[W("0")])),_:1}),_(De,{"model-value":-3,"onUpdate:modelValue":i},{default:k(()=>c[3]||(c[3]=[W(",")])),_:1})])]))}}),as=F(ts,[["__scopeId","data-v-2cdf4e9c"]]),ns={class:"pricesettings"},os={class:"grapharea"},rs={id:"pricechart"},ss={viewBox:"0 0 400 300"},is=["id","origin","transform"],ls={class:"controlarea"},cs={class:"pt-1 pb-2 d-flex justify-content-between"},us={key:1,class:"sliderarea"},_t=400,jt=250,Ut=12,ds=V({__name:"PriceChart",props:{chargePointId:{},globalview:{type:Boolean}},setup(t){const e=t,a=g(()=>w[e.chargePointId]),n=se(!1),o=se(!1);let i=a.value?se(a.value.etMaxPrice):se(0);const s=g({get(){return i.value},set(O){i.value=O,n.value=!0}}),c=g({get(){return(Math.round(i.value*10)/10).toString()},set(O){s.value=parseFloat(O)??s.value,o.value=!1}});function l(){a.value&&(a.value.etMaxPrice=s.value),n.value=!1}const m=se(!1),v={top:0,bottom:15,left:20,right:15},$=g(()=>{let O=[];return X.etPriceList.size>0&&X.etPriceList.forEach((z,me)=>{O.push([me,z])}),O}),f=g(()=>$.value.length>1?(_t-v.left-v.right)/$.value.length-1:0),I=g(()=>n.value?{background:"var(--color-charging)",color:"var(--color-fg)"}:{background:"var(--color-menu)"});function j(){o.value=!o.value}const ie=g(()=>{let O=Ge($.value,z=>z[0]);return O[1]&&(O[1]=new Date(O[1]),O[1].setTime(O[1].getTime()+36e5)),qe().range([v.left,_t-v.right]).domain(O)}),D=g(()=>{let O=Ge($.value,z=>z[1]);return O[0]=O[0]?Math.floor(O[0]-1):0,O[1]=O[1]?Math.floor(O[1]+1):0,O}),G=g(()=>Te().range([jt-v.bottom,0]).domain(D.value)),Q=g(()=>{const O=Rt(),z=[[v.left,G.value(s.value)],[_t-v.right-1,G.value(s.value)]];return O(z)}),B=g(()=>nt(ie.value).ticks($.value.length).tickSize(5).tickSizeInner(-250).tickFormat(O=>O.getHours()%6==0?kt("%H:%M")(O):"")),x=g(()=>pt(G.value).ticks(6).tickSizeInner(-365).tickFormat(O=>O.toString())),C=g(()=>{m.value==!0;const O=Se("g#"+U.value);O.selectAll("*").remove(),O.selectAll("bar").data($.value).enter().append("g").append("rect").attr("class","bar").attr("x",ye=>ie.value(ye[0])).attr("y",ye=>G.value(ye[1])).attr("width",f.value).attr("height",ye=>G.value(D.value[0])-G.value(ye[1])).attr("fill",ye=>ye[1]<=s.value?"var(--color-charging)":"var(--color-axis)");const me=O.append("g").attr("class","axis").call(B.value);me.attr("transform","translate(0,"+(jt-v.bottom)+")"),me.selectAll(".tick").attr("font-size",Ut).attr("color","var(--color-bg)"),me.selectAll(".tick line").attr("stroke","var(--color-bg)").attr("stroke-width",ye=>ye.getHours()%6==0?"2":"0.5"),me.select(".domain").attr("stroke","var(--color-bg");const Ke=O.append("g").attr("class","axis").call(x.value);return Ke.attr("transform","translate("+v.left+",0)"),Ke.selectAll(".tick").attr("font-size",Ut).attr("color","var(--color-bg)"),Ke.selectAll(".tick line").attr("stroke","var(--color-bg)").attr("stroke-width",ye=>ye%5==0?"2":"0.5"),Ke.select(".domain").attr("stroke","var(--color-bg)"),O.append("path").attr("d",Q.value).attr("stroke","yellow"),"PriceChart.vue"}),U=g(()=>a.value?"priceChartCanvas"+a.value.id:"priceChartCanvasGlobal"),L=g(()=>{let O=[];return X.etPriceList.forEach(z=>{O.push(z)}),O.sort((z,me)=>z-me)});function de(){let O=L.value[0];for(let z of L.value){if(z>=s.value)break;O=z}s.value=O}function ha(){let O=L.value[0];for(let z of L.value)if(z>s.value){O=z;break}else O=z;s.value=O}return Ze(()=>{m.value=!m.value}),(O,z)=>(h(),y("div",ns,[r("div",os,[r("p",null,"Anbieter: "+P(u(X).etProvider),1),r("figure",rs,[(h(),y("svg",ss,[r("g",{id:U.value,origin:C.value,transform:"translate("+v.top+","+v.right+")"},null,8,is)]))])]),r("div",ls,[r("span",cs,[r("button",{type:"button",class:"btn btn-lg keypadbutton me-3",onClick:j},z[2]||(z[2]=[r("i",{class:"fa fa-xl fa-keyboard"},null,-1)])),o.value?S("",!0):(h(),y("button",{key:0,type:"button",class:"btn btn-lg confirmbutton",style:oe(I.value),"data-bs-dismiss":"modal",onClick:l}," Bestätigen ",4))]),o.value?(h(),T(as,{key:0,modelValue:c.value,"onUpdate:modelValue":z[0]||(z[0]=me=>c.value=me),decimals:1,class:"mb-3"},null,8,["modelValue"])):(h(),y("div",us,[_(Oe,{id:"etmaxprice",modelValue:s.value,"onUpdate:modelValue":z[1]||(z[1]=me=>s.value=me),min:Math.floor(L.value[0]-1),max:Math.ceil(L.value[L.value.length-1]+1),step:.1,decimals:1,"show-subrange":!0,"subrange-min":L.value[0],"subrange-max":L.value[L.value.length-1],unit:"ct"},null,8,["modelValue","min","max","subrange-min","subrange-max"]),r("div",{class:"d-flex justify-content-between pb-2 pt-0 mt-0"},[r("button",{type:"button",class:"btn jumpbutton",onClick:de},z[3]||(z[3]=[r("i",{class:"fa fa-xl fa-arrow-left"},null,-1)])),r("button",{type:"button",class:"btn jumpbutton",onClick:ha},z[4]||(z[4]=[r("i",{class:"fa fa-xl fa-arrow-right"},null,-1)]))])]))])]))}}),hs=F(ds,[["__scopeId","data-v-e948cbfd"]]),ps={class:"m-0 mt-1 p-0 grid-col-12 tabarea"},gs={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},ms=["id","data-bs-target"],vs=["id","data-bs-target"],fs=["id","data-bs-target"],ys=["id","data-bs-target"],bs=["id","data-bs-target"],_s=["id","data-bs-target"],ws={id:"settingsPanes",class:"tab-content mt-2"},ks=["id"],Ss=["id"],xs=["id"],Ms=["id"],Ps=["id"],Cs=["id"],$s=V({__name:"SettingsPage",props:{chargepoint:{}},setup(t){const e=t,a=g(()=>ue[e.chargepoint.chargeTemplate]),n=g(()=>e.chargepoint.id);return(o,i)=>(h(),y("div",ps,[r("nav",gs,[r("a",{id:"chSettings"+n.value,class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+n.value},i[0]||(i[0]=[r("i",{class:"fa-solid fa-charging-station"},null,-1),W(" Allgemein ")]),8,ms),r("a",{id:"inSettings"+n.value,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+n.value},i[1]||(i[1]=[r("i",{class:"fa-solid fa-lg fa-bolt"},null,-1),W(" Sofort ")]),8,vs),r("a",{id:"phvSettings"+n.value,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+n.value},i[2]||(i[2]=[r("i",{class:"fa-solid fa-solar-panel me-1"},null,-1),W(" PV ")]),8,fs),r("a",{id:"scSettings"+n.value,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+n.value},i[3]||(i[3]=[r("i",{class:"fa-solid fa-bullseye me-1"},null,-1),W(" Zielladen ")]),8,ys),r("a",{id:"tmSettings"+n.value,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+n.value},i[4]||(i[4]=[r("i",{class:"fa-solid fa-clock"},null,-1),W(" Zeitpläne ")]),8,bs),u(X).active?(h(),y("a",{key:0,id:"prSettings"+n.value,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#priceSettings"+n.value},i[5]||(i[5]=[r("i",{class:"fa-solid fa-coins"},null,-1),W(" Strompreis ")]),8,_s)):S("",!0)]),r("div",ws,[r("div",{id:"chargeSettings"+n.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[_(qr,{"chargepoint-id":n.value},null,8,["chargepoint-id"])],8,ks),r("div",{id:"instantSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[_(Br,{"chargepoint-id":n.value},null,8,["chargepoint-id"])],8,Ss),r("div",{id:"pvSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[_(Lr,{"chargepoint-id":n.value},null,8,["chargepoint-id"])],8,xs),r("div",{id:"scheduledSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[a.value!=null?(h(),T(jr,{key:0,"charge-template-id":e.chargepoint.chargeTemplate},null,8,["charge-template-id"])):S("",!0)],8,Ms),r("div",{id:"timeSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[a.value!=null?(h(),T(Jr,{key:0,"charge-template-id":e.chargepoint.chargeTemplate},null,8,["charge-template-id"])):S("",!0)],8,Ps),u(X).active?(h(),y("div",{key:0,id:"priceSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"price-tab"},[u(X).active?(h(),T(hs,{key:0,"charge-point-id":e.chargepoint.id},null,8,["charge-point-id"])):S("",!0)],8,Cs)):S("",!0)])]))}}),Is=F($s,[["__scopeId","data-v-0f0881fb"]]);function Bs(t,e){t=="openWB/graph/boolDisplayLiveGraph"?R.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?Os(t,e):t=="openWB/graph/lastlivevaluesJson"?Ts(t,e):t=="openWB/graph/config/duration"&&(K.duration=JSON.parse(e))}function Os(t,e){if(!K.initialized){let a=[];const n=e.toString().split(`
`);n.length>1?a=n.map(s=>JSON.parse(s)):a=[];const o=t.match(/(\d+)$/g),i=o?o[0]:"";i!=""&&typeof K.rawDataPacks[+i-1]>"u"&&(K.rawDataPacks[+i-1]=a,K.initCounter++)}if(K.initCounter==16){const a=[];K.unsubscribeRefresh(),K.initialized=!0,K.rawDataPacks.map(n=>{n.map(o=>{const i=ia(o);a.push(i)})}),Xe(a),K.subscribeUpdates()}}function Ts(t,e){const a=JSON.parse(e),n=ia(a);K.graphRefreshCounter++,Xe(p.data.concat(n)),K.graphRefreshCounter>60&&K.activate()}function ia(t){const e=Object.values(w).length>0?Object.values(w)[0].connectedVehicle:0,a=Object.values(w).length>1?Object.values(w)[1].connectedVehicle:1,n="ev"+e+"-soc",o="ev"+a+"-soc",i={};i.date=Vs(t.time).valueOf(),+t.grid>0?(i.evuIn=+t.grid,i.evuOut=0):+t.grid<=0?(i.evuIn=0,i.evuOut=-t.grid):(i.evuIn=0,i.evuOut=0),+t["pv-all"]>=0?(i.pv=+t["pv-all"],i.inverter=0):(i.pv=0,i.inverter=-t["pv-all"]),i.house=+t["house-power"],+t["bat-all-power"]>0?(i.batOut=0,i.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(i.batOut=-t["bat-all-power"],i.batIn=0):(i.batOut=0,i.batIn=0),t["bat-all-soc"]?i.batSoc=+t["bat-all-soc"]:i.batSoc=0,t[n]&&(i["soc"+e]=+t[n]),t[o]&&(i["soc"+a]=+t[o]),i.charging=+t["charging-all"];for(let s=0;s<10;s++){const c="cp"+s;i[c]=+(t[c+"-power"]??0)}return i.selfUsage=i.pv-i.evuOut,i.selfUsage<0&&(i.selfUsage=0),i.devices=0,i}function Vs(t){const e=new Date(Date.now()),a=864e5;let n=new Date;const o=it("%H:%M:%S")(t);return o&&(n=o,n.setDate(e.getDate()),n.setMonth(e.getMonth()),n.setFullYear(e.getFullYear()),n.getHours()>e.getHours()&&(n=new Date(n.getTime()-a))),n}const As=["evuIn","pv","batIn","evuOut"];let dt=[];function Ls(t,e){const a=JSON.parse(e).entries,n=JSON.parse(e).totals;Pt(),dt=[],Ct.map(i=>{M.setEnergyPv(i,0),M.setEnergyBat(i,0)});const o=Ds(a);Xe(o),$t(n,dt),b.debug&&(console.debug("---------------------------------------- Graph Data ---------------------------"),console.debug("--- Incoming graph data:"),console.debug(a),console.debug("data to be displayed:"),console.debug(o),console.debug("-------------------------------------------------------------------------------")),p.graphMode=="today"&&setTimeout(()=>q.activate(),3e5)}function Ds(t){const e=[];let a={};return t.map(n=>{a=Es(n);const o=a;e.push(o)}),e}function Es(t){const e={};if(p.graphMode=="day"||p.graphMode=="today")if(typeof t.date=="number")e.date=new Date(+t.date*1e3).getTime();else{const n=it("%H:%M")(t.date);n&&(n.setMonth(q.date.getMonth()),n.setDate(q.date.getDate()),n.setFullYear(q.date.getFullYear()),e.date=n.getTime())}else if(typeof t.date=="string"){const n=it("%Y%m%d")(t.date);n&&(e.date=n.getDate())}return e.evuOut=0,e.evuIn=0,Object.entries(t.counter).forEach(([n,o])=>{o.grid&&(e.evuOut+=o.power_exported,e.evuIn+=o.power_imported,dt.includes(n)||dt.push(n))}),e.evuOut==0&&e.evuIn==0&&Object.entries(t.counter).forEach(n=>{e.evuOut+=n[1].power_exported,e.evuIn+=n[1].power_imported}),e.pv=t.pv.all.power_exported,Object.entries(t.bat).length>0?(e.batIn=t.bat.all.power_imported,e.batOut=t.bat.all.power_exported,e.batSoc=t.bat.all.soc??0):(e.batIn=0,e.batOut=0,e.batSoc=0),Object.entries(t.cp).forEach(([n,o])=>{n!="all"?(e[n]=o.power_imported,M.keys().includes(n)||M.addItem(n)):e.charging=o.power_imported}),Object.entries(t.ev).forEach(([n,o])=>{n!="all"&&(e["soc"+n.substring(2)]=o.soc)}),e.devices=0,Object.entries(t.sh).forEach(([n,o])=>{n!="all"&&(e[n]=o.power_imported??0,e.devices+=o.power_imported??0,M.keys().includes(n)||M.addItem(n))}),e.selfUsage=e.pv-e.evuOut,t.hc&&t.hc.all?e.house=t.hc.all.power_imported:e.house=e.evuIn+e.batOut+e.pv-e.evuOut-e.charging-e.devices-e.batOut,e.evuIn+e.batOut+e.pv>0?M.keys().filter(n=>!As.includes(n)).map(n=>{Bn(n,e)}):Object.keys(e).map(n=>{e[n+"Pv"]=0,e[n+"Bat"]=0}),e}let at={};const Bt=["charging","house","batIn","devices"],Ws=["evuIn","pv","batIn","evuOut"];let Ye=[];function Gs(t,e){const a=JSON.parse(e).entries,n=JSON.parse(e).totals;Pt(),Ye=[],Bt.map(o=>{M.items[o].energyPv=0,M.items[o].energyBat=0}),a.length>0&&Xe(la(a)),$t(n,[])}function js(t,e){const a=JSON.parse(e).entries,n=JSON.parse(e).totals;Pt(),Ye=[],Bt.forEach(o=>{M.items[o].energyPv=0,M.items[o].energyBat=0}),Xe(la(a)),$t(n,[])}function la(t){const e=[];let a={};return at={},t.map(n=>{a=Us(n),e.push(a),Object.keys(a).forEach(o=>{o!="date"&&(a[o]<0&&(console.warn(`Negative energy value for ${o} in row ${a.date}. Ignoring the value.`),a[o]=0),at[o]?at[o]+=a[o]:at[o]=a[o])})}),e}function Us(t){const e={},a=it("%Y%m%d")(t.date);a&&(e.date=p.graphMode=="month"?a.getDate():a.getMonth()+1),e.evuOut=0,e.evuIn=0;let n=0,o=0;return Object.entries(t.counter).forEach(([s,c])=>{n+=c.energy_exported,o+=c.energy_imported,c.grid&&(e.evuOut+=c.energy_exported,e.evuIn+=c.energy_imported,Ye.includes(s)||Ye.push(s))}),Ye.length==0&&(e.evuOut=n,e.evuIn=o),e.pv=t.pv.all.energy_exported,Object.entries(t.bat).length>0?(t.bat.all.energy_imported>=0?e.batIn=t.bat.all.energy_imported:(console.warn("ignoring negative value for batIn on day "+e.date),e.batIn=0),t.bat.all.energy_exported>=0?e.batOut=t.bat.all.energy_exported:(console.warn("ignoring negative value for batOut on day "+e.date),e.batOut=0)):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([s,c])=>{s!="all"?(M.keys().includes(s)||M.addItem(s),e[s]=c.energy_imported):e.charging=c.energy_imported}),Object.entries(t.ev).forEach(([s,c])=>{s!="all"&&(e["soc-"+s]=c.soc)}),e.devices=Object.entries(t.sh).reduce((s,c)=>(M.keys().includes(c[0])||M.addItem(c[0]),c[1].energy_imported>=0?s+=c[1].energy_imported:console.warn(`Negative energy value for device ${c[0]} in row ${e.date}. Ignoring this value`),s),0),e.house=e.pv+e.evuIn+e.batOut-e.evuOut-e.batIn-e.charging,e.selfUsage=e.pv-e.evuOut,e.evuIn+e.batOut+e.pv>0?M.keys().filter(s=>!Ws.includes(s)).map(s=>{On(s,e)}):Bt.map(s=>{e[s+"Pv"]=0,e[s+"Bat"]=0}),e}class zs{constructor(e){d(this,"id");d(this,"dailyYieldExport",0);d(this,"dailyYieldImport",0);d(this,"exported",0);d(this,"faultState",0);d(this,"faultStr","");d(this,"imported",0);d(this,"power",0);d(this,"soc",0);this.id=e}}class Ns{constructor(){d(this,"dailyExport",0);d(this,"dailyImport",0);d(this,"exported",0);d(this,"imported",0);d(this,"power",0);d(this,"soc",0)}}const he=H({});H(new Ns);function Fs(t){t in he?console.info("Duplicate battery message: "+t):he[t]=new zs(t)}function Js(){Object.keys(he).forEach(t=>{delete he[parseInt(t)]})}function Rs(t,e){const a=Hs(t);if(a&&!(a in he)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?R.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(A.batIn.power=+e,N.batOut.power=0):(A.batIn.power=0,N.batOut.power=-e):t=="openWB/bat/get/soc"?R.batterySoc=+e:t=="openWB/bat/get/daily_exported"?N.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?A.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?he[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?he[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?he[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?he[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?he[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?he[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?he[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(he[a].soc=+e))}function Hs(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch(a){console.warn("Parser error in getIndex for topic "+t+" : "+a)}}function Ys(t,e){if(t=="openWB/optional/et/provider")JSON.parse(e).type==null?X.active=!1:(X.active=!0,X.etProvider=JSON.parse(e).name);else if(t=="openWB/optional/et/get/prices"){const a=JSON.parse(e);X.etPriceList=new Map,Object.keys(a).map(n=>{X.etPriceList.set(new Date(+n*1e3),a[n]*1e5)})}}function qs(t,e){const a=ca(t);if(a&&!(a in w)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?A.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(A.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")R.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(w[a]){const n=JSON.parse(e);w[a].name=n.name,w[a].icon=n.name,le["cp"+a]?(le["cp"+a].name=n.name,le["cp"+a].icon=n.name):le["cp"+a]={name:n.name,icon:n.name,color:"var(--color-charging)"}}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))w[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))w[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))w[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))w[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))w[a].dailyYield=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))w[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))w[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))w[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))w[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))w[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))w[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/currents/i))w[a].currents=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const n=JSON.parse(e);w[a].chargedSincePlugged=n.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const n=JSON.parse(e);w[a].soc=n.soc,w[a].waitingForSoc=!1,w[a].rangeCharged=n.range_charged,w[a].rangeUnit=n.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const n=JSON.parse(e);w[a].vehicleName=String(n.name),w[a].updateConnectedVehicle(+n.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const n=JSON.parse(e);switch(n.chargemode){case"instant_charging":w[a].updateChargeMode(_e.instant_charging);break;case"pv_charging":w[a].updateChargeMode(_e.pv_charging);break;case"scheduled_charging":w[a].updateChargeMode(_e.scheduled_charging);break;case"standby":w[a].updateChargeMode(_e.standby);break;case"stop":w[a].updateChargeMode(_e.stop);break}w[a].chargeTemplate=n.charge_template,w[a].averageConsumption=n.average_consumption}}}function Qs(t,e){const a=ca(t);if(a!=null){if(!(a in J)){const n=new Ta(a);J[a]=n}if(t.match(/^openwb\/vehicle\/[0-9]+\/name$/i))Object.values(w).forEach(n=>{n.connectedVehicle==a&&(n.vehicleName=JSON.parse(e))}),J[a].name=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i))J[a].soc=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i))isNaN(+e)?J[a].range=0:J[a].range=+e;else if(t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i))J[a].updateChargeTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i))J[a].updateEvTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/soc_module\/config$/i)){const n=JSON.parse(e);Object.values(w).forEach(o=>{o.connectedVehicle==a&&(o.isSocConfigured=n.type!==null,o.isSocManual=n.type=="manual")})}}}function Zs(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const n=+a[0],o=JSON.parse(e);ue[n]=o,Xs(n,o)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),n=t.match(/[0-9]+$/i);if(a&&n){const o=+a[0].replace(/[^0-9]+/g,""),i=+n[0],s=JSON.parse(e);o in Re||(Re[o]=[]),Re[o][i]=s}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/chargemode\/scheduled_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),n=t.match(/[0-9]+$/i);if(a&&n){const o=+a[0].replace(/[^0-9]+/g,""),i=+n[0],s=JSON.parse(e);o in Je||(Je[o]=[]),Je[o][i]=s}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const n=+a[0],o=JSON.parse(e);Va[n]=o}}}function Xs(t,e){Object.values(w).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function ca(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch(a){console.warn("Parser error in getIndex for topic "+t+" : "+a)}}function Ks(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?ei(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&ti(t,e)}function ei(t,e){const a=ua(t);if(a==null)return;ne.has(a)||ea(a);const n=ne.get(a);t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?n.configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?(n.name=e.toString(),n.icon=e.toString(),le["sh"+a].name=e.toString(),le["sh"+a].icon=e.toString()):t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?n.isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canSwitch$/i)?n.canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_homeConsumtion$/i)?n.countAsHouse=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(n.tempConfigured=+e)}function ti(t,e){const a=ua(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}ne.has(a)||ea(a);const n=ne.get(a);if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))n.power=+e,ai("power");else if(!t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Wh$/i)){if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))n.runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))n.temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))n.temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))n.temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:n.status="off";break;case 11:n.status="on";break;case 20:n.status="detection";break;case 30:n.status="timeout";break;default:n.status="off"}}}function ai(t){switch(t){case"power":A.devices.power=[...ne.values()].filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.power,0);break;case"energy":A.devices.energy=[...ne.values()].filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function ua(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch(a){console.warn("Parser error in getIndex for topic "+t+" : "+a)}}class ni{constructor(e){d(this,"id");d(this,"name","Zähler");d(this,"power",0);d(this,"energy_imported",0);d(this,"energy_exported",0);d(this,"grid",!1);d(this,"type","counter");d(this,"color","var(--color-evu)");d(this,"energyPv",0);d(this,"energyBat",0);d(this,"pvPercentage",0);d(this,"icon","");this.id=e}}const ve=H({});function oi(t,e){if(t in ve)console.info("Duplicate counter message: "+t);else switch(ve[t]=new ni(t),ve[t].type=e,e){case"counter":ve[t].color="var(--color-evu)";break;case"inverter":ve[t].color="var(--color-pv)";break;case"cp":ve[t].color="var(--color-charging)";break;case"bat":ve[t].color="var(--color-bat)";break}}const ri=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#","openWB/command/"+Mt()+"/#","openWB/optional/int_display/#"];function si(){Ba(ii),ri.forEach(t=>{We(t)}),ae()}function ii(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?li(t,a):t.match(/^openwb\/counter\//i)?ci(t,a):t.match(/^openwb\/bat\//i)?Rs(t,a):t.match(/^openwb\/pv\//i)?ui(t,a):t.match(/^openwb\/chargepoint\//i)?qs(t,a):t.match(/^openwb\/vehicle\/template\//i)?Zs(t,a):t.match(/^openwb\/vehicle\//i)?Qs(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?di(t,a):t.match(/^openwb\/graph\//i)?Bs(t,a):t.match(/^openwb\/log\/daily\//i)?Ls(t,a):t.match(/^openwb\/log\/monthly\//i)?Gs(t,a):t.match(/^openwb\/log\/yearly\//i)?js(t,a):t.match(/^openwb\/optional\/et\//i)?Ys(t,a):t.match(/^openwb\/system\//i)?pi(t,a):t.match(/^openwb\/LegacySmartHome\//i)?Ks(t,a):t.match(/^openwb\/command\//i)?gi(t,a):t.match(/^openwb\/optional\//i)&&mi(t,a)}function li(t,e){const a=t.split("/"),n=+a[2];if(n==R.evuId?hi(t,e):a[3]=="config",a[3]=="get"&&n in ve)switch(a[4]){case"power":ve[n].power=+e;break;case"config":break;case"fault_str":break;case"fault_state":break;case"power_factors":break;case"imported":break;case"exported":break;case"frequency":break;case"daily_imported":ve[n].energy_imported=+e;break;case"daily_exported":ve[n].energy_exported=+e;break}}function ci(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){La(),Js();for(const n of a)n.type=="counter"&&(R.evuId=n.id);da(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?A.house.power=+e:t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(A.house.energy=+e)}function da(t){switch(t.type){case"counter":oi(t.id,t.type);break;case"cp":Aa(t.id);break;case"bat":Fs(t.id);break}t.children.forEach(e=>da(e))}function ui(t,e){switch(t){case"openWB/pv/get/power":N.pv.power=-e;break;case"openWB/pv/get/daily_exported":N.pv.energy=+e;break}}function di(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_mode":R.updatePvBatteryPriority(JSON.parse(e));break}}function hi(t,e){switch(t.split("/")[4]){case"power":+e>0?(N.evuIn.power=+e,A.evuOut.power=0):(N.evuIn.power=0,A.evuOut.power=-e);break;case"daily_imported":N.evuIn.energy=+e;break;case"daily_exported":A.evuOut.energy=+e;break}}function pi(t,e){if(t.match(/^openWB\/system\/device\/[0-9]+\/component\/[0-9]+\/config$/i)){const a=JSON.parse(e);a.type=="counter"&&(ve[a.id].name=a.name)}else t.match(/^openWB\/system\/ip_address$/i)?R.ipAddress=JSON.parse(e):t.match(/^openWB\/system\/time$/i)?R.systemTime=JSON.parse(e):t.match(/^openWB\/system\/version$/i)?R.version=JSON.parse(e):t.match(/^openWB\/system\/current_commit$/i)?R.versionDetails=JSON.parse(e):t.match(/^openWB\/system\/current_branch$/i)&&(R.devBranch=JSON.parse(e))}function gi(t,e){const a=t.split("/");if(t.match(/^openWB\/command\/[a-z]+\/error$/i)&&a[2]==Mt()){const n=JSON.parse(e);console.error(`Error message from openWB: 
Command: ${n.command}
Data: JSON.stringify(err.data)
Error:
 ${n.error}`)}}function mi(t,e){if(t.match(/^openwb\/optional\/int_display\/active$/i))te.active=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/only_local_charge_points$/i))te.localCpOnly=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/theme$/i)){const a=JSON.parse(e);te.usePin=a.configuration.lock_changes,te.code=a.configuration.lock_changes_code}}const vi={class:"d-flex flex-column align-items-center justify-content-start infoitem"},fi=V({__name:"InfoItem",props:{heading:{},small:{type:Boolean}},setup(t){const e=t,a=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-small)"}),n=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-normal)"}),o=g(()=>e.small?"mt-0":"mt-1");return(i,s)=>(h(),y("span",vi,[r("span",{class:re(["d-flex heading scaled",o.value]),style:oe(a.value)},P(e.heading),7),r("span",{class:"d-flex my-0 me-0 align-items-center content scaled",style:oe(n.value)},[fe(i.$slots,"default",{},void 0)],4)]))}}),pe=F(fi,[["__scopeId","data-v-9215fd9b"]]),yi=V({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Yt(e.wattH,b.decimalPlaces));return(n,o)=>(h(),y("span",null,P(a.value),1))}}),bi=V({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=12?"fa-battery-empty":e.soc<38?"fa-battery-quarter":e.soc<63?"fa-battery-half":e.soc<89?"fa-battery-three-quarters":"fa-battery-full");return(n,o)=>(h(),y("span",null,[r("i",{class:re(["fa batIcon",a.value])},null,2),W(" "+P(Math.round(n.soc)+"%"),1)]))}}),_i=F(bi,[["__scopeId","data-v-fc156cd3"]]),wi={class:"vehicleinfo justify-content-left"},ki={class:"titleline mb-3"},Si={class:"carname d-flex justify-content-left align-items-center px-2"},xi={key:0,class:"ms-2 me-0 fa-solid fa-xs fa-star ps-1"},Mi={key:1,class:"ms-2 me-0 fa-solid fa-xs fa-coins ps-0"},Pi={key:0,class:"socEditor rounded mt-2 d-flex flex-column align-items-center grid-col-12 grid-left"},Ci={class:"d-flex justify-content-stretch align-items-center"},$i={class:"infoline"},Ii={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},Bi={class:"infoline"},Oi={class:"maxprice"},Ti={key:1},Vi=V({__name:"CPVehicle",props:{chargepoint:{}},setup(t){const e=t,a=se(e.chargepoint),n=se(!1);function o(){Y("setSoc",i.value,e.chargepoint.connectedVehicle),n.value=!1}const i=g({get(){return e.chargepoint.soc},set(f){w[e.chargepoint.id].soc=f}}),s=g(()=>e.chargepoint.soc),c=g({get(){return e.chargepoint.chargeMode},set(f){te.locked?Ue():w[e.chargepoint.id].chargeMode=f}}),l=g(()=>{const[f]=X.etPriceList.values();return(Math.round(f*10)/10).toFixed(1)});function m(f=""){if(te.locked)Ue();else{new ht("#settingspage").toggle();let ie=f;if(f=="")switch(e.chargepoint.chargeMode){case"instant_charging":ie="#inSettings";break;case"pv_charging":ie="#phvSettings";break;case"scheduled_charging":ie="#scSettings";break;default:ie="#chSettings"}const D=document.querySelector(ie+e.chargepoint.id);if(D){var I=new Ht(D);I.show()}else console.error("no element found")}}function v(){te.locked?Ue():n.value=!n.value}const $=g(()=>e.chargepoint.etMaxPrice>=+l.value?{color:"var(--color-charging)"}:{color:"var(--color-menu)"});return(f,I)=>(h(),y("div",wi,[r("div",ki,[_(be,{onClick:I[0]||(I[0]=j=>m("#chSettings"))},{default:k(()=>[r("div",Si,[I[5]||(I[5]=r("i",{class:"fa-solid fa-sm fa-car me-3"},null,-1)),W(" "+P(f.chargepoint.vehicleName)+" ",1),f.chargepoint.hasPriority?(h(),y("span",xi)):S("",!0),f.chargepoint.etActive?(h(),y("span",Mi)):S("",!0)])]),_:1})]),n.value?(h(),y("div",Pi,[I[6]||(I[6]=r("span",{class:"d-flex m-1 p-0 socEditTitle"},"Ladestand einstellen:",-1)),r("span",Ci,[r("span",null,[_(Oe,{id:"manualSoc",modelValue:i.value,"onUpdate:modelValue":I[1]||(I[1]=j=>i.value=j),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])])]),r("span",{type:"button",class:"fa-solid d-flex fa-lg m-3 me-1 mb-4 align-self-end fa-circle-check",onClick:o})])):S("",!0),r("div",$i,[f.chargepoint.isSocConfigured?(h(),T(pe,{key:0,heading:"Ladestand:",class:"grid-col-4 grid-left"},{default:k(()=>[_(_i,{soc:s.value,class:"me-2"},null,8,["soc"]),f.chargepoint.isSocManual?(h(),T(be,{key:0,onClick:v},{default:k(()=>I[7]||(I[7]=[r("i",{class:"fa-solid fa-sm fas fa-edit py-0 px-3 mt-3",style:{color:"var(--color-fg)"}},null,-1)])),_:1})):S("",!0)]),_:1})):S("",!0),f.chargepoint.isSocConfigured?(h(),T(pe,{key:1,heading:"Reichweite:",class:"grid-col-4"},{default:k(()=>[W(P(u(J)[e.chargepoint.connectedVehicle]?Math.round(u(J)[e.chargepoint.connectedVehicle].range):0)+" km ",1)]),_:1})):S("",!0),_(pe,{heading:"Zeitplan:",class:"grid-col-4 grid-right"},{default:k(()=>[f.chargepoint.timedCharging?(h(),y("span",Ii)):S("",!0),W(" "+P(e.chargepoint.timedCharging?"Ja":"Nein"),1)]),_:1})]),r("div",Bi,[u(X).active?(h(),T(pe,{key:0,heading:"Preisladen:",class:"grid-col-4 grid-left"},{default:k(()=>[_(we,{modelValue:a.value.etActive,"onUpdate:modelValue":I[2]||(I[2]=j=>a.value.etActive=j)},null,8,["modelValue"])]),_:1})):S("",!0),u(X).active?(h(),T(pe,{key:1,heading:"max. Preis:",class:"grid-col-4"},{default:k(()=>[a.value.etActive?(h(),T(be,{key:0,onClick:I[3]||(I[3]=j=>m("#prSettings"))},{default:k(()=>[r("span",Oi,P(e.chargepoint.etActive?(Math.round(e.chargepoint.etMaxPrice*10)/10).toFixed(1)+" ct":"-"),1)]),_:1})):(h(),y("span",Ti,"-"))]),_:1})):S("",!0),u(X).active?(h(),T(pe,{key:2,heading:"akt. Preis:",class:"grid-col-4 grid-right"},{default:k(()=>[r("span",{style:oe($.value)},P(l.value)+" ct ",5)]),_:1})):S("",!0)]),_(ra,{id:"chargemode-"+f.chargepoint.name,modelValue:c.value,"onUpdate:modelValue":I[4]||(I[4]=j=>c.value=j),class:"chargemodes mx-3 mt-4 mb-0",options:Object.keys(u(ze)).map(j=>({text:u(ze)[j].name,value:j,color:u(ze)[j].color,icon:u(ze)[j].icon,active:u(ze)[j].mode==f.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])]))}}),Ai=F(Vi,[["__scopeId","data-v-e2bd6528"]]),Li={class:"subgrid"},Di={class:"targetCurrent"},Ei=V({__name:"CPChargePoint",props:{chargepoint:{}},setup(t){const e=t,a=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),n=g(()=>(Math.round(e.chargepoint.realCurrent*10)/10).toLocaleString(void 0)+" A"),o=g(()=>{const v=e.chargepoint.rangeCharged,$=e.chargepoint.chargedSincePlugged,f=e.chargepoint.dailyYield;return $>0?Math.round(v/$*f).toString()+" "+e.chargepoint.rangeUnit:"0 km"}),i=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),s=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),c=g(()=>{let v="";return e.chargepoint.isLocked?v="fa-lock":e.chargepoint.isCharging?v=" fa-bolt":e.chargepoint.isPluggedIn&&(v="fa-plug"),"fa "+v}),l=g(()=>({color:e.chargepoint.color}));function m(){if(te.locked)Ue();else{new ht("#settingspage").toggle();let f="";switch(e.chargepoint.chargeMode){case"instant_charging":f="#inSettings";break;case"pv_charging":f="#phvSettings";break;case"scheduled_charging":f="#scSettings";break;default:f="#chSettings"}const I=document.querySelector(f+e.chargepoint.id);if(I){var v=new Ht(I);v.show()}else console.error("no element found")}}return(v,$)=>(h(),T(gt,null,{title:k(()=>[r("span",{style:oe(l.value)},[$[0]||($[0]=r("span",{class:"fa-solid fa-charging-station"}," ",-1)),W(" "+P(e.chargepoint.name),1)],4)]),buttons:k(()=>[_(be,{color:"var(--color-cp0)",icon:"fa-edit",onClick:m},{default:k(()=>$[1]||($[1]=[W(" Einstellungen")])),_:1})]),footer:k(()=>[_(Ai,{chargepoint:e.chargepoint},null,8,["chargepoint"])]),default:k(()=>[r("div",Li,[_(pe,{heading:"Status:",class:"grid-col-4 grid-left"},{default:k(()=>[r("span",{style:oe({color:s.value})},[r("i",{class:re(c.value)},null,2),W(" "+P(i.value),1)],4)]),_:1}),_(pe,{heading:"Geladen:",class:"grid-col-4"},{default:k(()=>[_(yi,{"watt-h":v.chargepoint.dailyYield},null,8,["watt-h"])]),_:1}),_(pe,{heading:"gel. Reichw.:",class:"grid-col-4 grid-right"},{default:k(()=>[W(P(o.value),1)]),_:1}),e.chargepoint.power>0?(h(),T(pe,{key:0,heading:"Leistung:",class:"grid-col-3 grid-left"},{default:k(()=>[_(ta,{watt:e.chargepoint.power},null,8,["watt"])]),_:1})):S("",!0),e.chargepoint.power>0?(h(),T(pe,{key:1,heading:"Strom:",class:"grid-col-3"},{default:k(()=>[W(P(n.value),1)]),_:1})):S("",!0),e.chargepoint.power>0?(h(),T(pe,{key:2,heading:"Phasen:",class:"grid-col-3"},{default:k(()=>[W(P(e.chargepoint.phasesInUse),1)]),_:1})):S("",!0),e.chargepoint.power>0?(h(),T(pe,{key:3,heading:"Sollstrom:",class:"grid-col-3 grid-right"},{default:k(()=>[r("span",Di,P(a.value),1)]),_:1})):S("",!0)])]),_:1}))}}),Wi=F(Ei,[["__scopeId","data-v-06522231"]]),Gi={class:"content"},ji={class:"leftside"},Ui={class:"rightside"},zi={class:"settingstitle"},Ni=V({__name:"DisplayTheme",setup(t){function e(n){Ga(n)&&(te.locked=!1,setTimeout(()=>{te.locked=!0},te.timeout*1e3))}Ze(()=>{window.addEventListener("resize",Vt),window.addEventListener("focus",a),si()}),zt(()=>{window.removeEventListener("focus",a),window.removeEventListener("resize",Vt)});function a(){document.hasFocus()&&ae()}return(n,o)=>(h(),y(ce,null,[r("div",Gi,[r("div",ji,[Fe(_(Pn,null,null,512),[[mt,u(b).graphToShow=="powermeter"]]),Fe(r("div",null,[_(uo)],512),[[mt,u(b).graphToShow=="powergraph"]]),Fe(r("div",null,[_(Do)],512),[[mt,u(b).graphToShow=="energymeter"]])]),r("div",Ui,[Object.values(u(w)).length>u(b).cpToShow?(h(),T(Wi,{key:0,chargepoint:Object.values(u(w))[u(b).cpToShow]},null,8,["chargepoint"])):S("",!0)])]),_(bt,{"modal-id":"numberpad"},{title:k(()=>o[0]||(o[0]=[W("Code")])),default:k(()=>[_(Qo,{"model-value":"","onUpdate:modelValue":e})]),_:1}),_(bt,{"modal-id":"statuspage"},{title:k(()=>o[1]||(o[1]=[r("span",{class:"statustitle"},"Systemstatus",-1)])),default:k(()=>[_(sr)]),_:1}),Object.values(u(w)).length>u(b).cpToShow?(h(),T(bt,{key:0,"modal-id":"settingspage"},{title:k(()=>[r("span",zi,"Einstellungen für "+P(Object.values(u(w))[u(b).cpToShow].vehicleName)+" an Ladepunkt "+P(Object.values(u(w))[u(b).cpToShow].name),1)]),default:k(()=>[_(Is,{chargepoint:Object.values(u(w))[u(b).cpToShow]},null,8,["chargepoint"])]),_:1})):S("",!0)],64))}}),Fi=F(Ni,[["__scopeId","data-v-9b3643f1"]]),Ji={class:"fixeddisplay"},Ri=V({__name:"App",setup(t){return Ze(()=>{console.log("on mounted");let e=window.location.search;if(e!=""){console.debug("search",e);let a=new URLSearchParams(e);if(a.has("data")){let n=JSON.parse(a.get("data"));Object.entries(n).forEach(([o,i])=>{console.log("updateSetting",o,i),o.startsWith("parentChargePoint")?Ae[o]=parseInt(i):Ae[o]=i})}}}),(e,a)=>(h(),y("div",Ji,[_(Fi),_(Xa)]))}}),Hi=F(Ri,[["__scopeId","data-v-f43b9e47"]]),Yi=ka(Hi);Yi.mount("#app");
