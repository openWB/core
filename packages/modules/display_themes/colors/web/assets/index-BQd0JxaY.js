var wa=Object.defineProperty;var ka=(t,e,a)=>e in t?wa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var l=(t,e,a)=>ka(t,typeof e!="symbol"?e+"":e,a);import{m as Sa,r as Q,a as ee,M as Ut,d as O,o as d,c as f,n as K,b as k,e as ve,f as ne,g,s as ye,h as Ne,i as xa,j as s,t as x,u as r,k as y,w as S,l as U,p as le,q as ce,v as Ft,x as Jt,y as Ma,z as L,F as X,A as ge,B as Ge,C as _t,D as Le,E as Rt,G as dt,H as nt,I as Fe,J as at,K as yt,L as $a,N as qe,O as bt,P as Pa,Q as Ca,R as We,S as Ht,T as rt,U as Ia,V as pt,W as Ba}from"./vendor-_Lfn2Asz.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();function ot(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Yt(t,e=1,a=!1){let o;if(t>1e6&&(a=!0,t=t/1e3),t>=1e3&&e<4){switch(e){case 0:o=Math.round(t/1e3);break;case 1:o=(Math.round(t/100)/10).toFixed(1);break;case 2:o=(Math.round(t/10)/100).toFixed(2);break;case 3:o=(Math.round(t)/1e3).toFixed(3);break;default:o=Math.round(t/100)/10;break}return o.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function Oa(t){return t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}function Ta(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}const Va=0,qt={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clean:!1,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},st={topic:"",qos:Va};let me;const{host:La,port:Aa,endpoint:Da,...Qt}=qt,Ga=`${Qt.protocol}://${La}:${Aa}${Da}`;try{me=Sa.connect(Ga,Qt),me.on("connect",()=>{console.info("MQTT connection successful.")}),me.on("disconnect",()=>{console.info("MQTT disconnected")}),me.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}async function Ea(t){await Zt(),me?me.on("message",t):console.error("MqttRegister: MQTT client not available")}async function De(t){st.topic=t;const{topic:e,qos:a}=st;await Zt(),me.subscribe(e,{qos:a},o=>{if(o){console.error("MQTT Subscription error: "+o);return}})}function ze(t){st.topic=t;const{topic:e}=st;me.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}async function wt(t,e){let o=me.connected,n=0;for(;!o&&n<10;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Xt(100),o=me.connected,n+=1;if(n<10)try{me.publish(t,e,{qos:0},i=>{i&&console.warn("MQTT publish error: ",i),console.info("MQTT publish: Message sent: ["+t+"]("+e+")")})}catch(i){console.warn("MQTT publish: caught error: "+i)}else console.error("MQTT publish: Lost connection to MQTT server. Please reload the page")}function Mt(){return qt.clientId}const Tt=20;async function Zt(){let t=me.connected,e=0;for(;!t&&e<Tt;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Xt(100),t=me.connected,e+=1;return new Promise((a,o)=>{e<Tt?a(!0):o(!1)})}function Xt(t){return new Promise(e=>setTimeout(e,t))}class Wa{constructor(e){l(this,"id");l(this,"name","Ladepunkt");l(this,"icon","Ladepunkt");l(this,"type","");l(this,"ev",0);l(this,"template",0);l(this,"connectedPhases",0);l(this,"phase_1",0);l(this,"autoPhaseSwitchHw",!1);l(this,"controlPilotInterruptionHw",!1);l(this,"isEnabled",!0);l(this,"isPluggedIn",!1);l(this,"isCharging",!1);l(this,"_isLocked",!1);l(this,"_connectedVehicle",0);l(this,"chargeTemplate",0);l(this,"evTemplate",0);l(this,"_chargeMode","pv_charging");l(this,"_hasPriority",!1);l(this,"currentPlan","");l(this,"averageConsumption",0);l(this,"vehicleName","");l(this,"rangeCharged",0);l(this,"rangeUnit","");l(this,"counter",0);l(this,"dailyYield",0);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"phasesInUse",0);l(this,"power",0);l(this,"chargedSincePlugged",0);l(this,"stateStr","");l(this,"current",0);l(this,"currents",[0,0,0]);l(this,"phasesToUse",0);l(this,"isSocConfigured",!0);l(this,"isSocManual",!1);l(this,"waitingForSoc",!1);l(this,"color","white");l(this,"_timedCharging",!1);l(this,"_instantChargeLimitMode","");l(this,"_instantTargetCurrent",0);l(this,"_instantTargetSoc",0);l(this,"_instantMaxEnergy",0);l(this,"_pvFeedInLimit",!1);l(this,"_pvMinCurrent",0);l(this,"_pvMaxSoc",0);l(this,"_pvMinSoc",0);l(this,"_pvMinSocCurrent",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,te("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,te("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get soc(){return W[this.connectedVehicle]?W[this.connectedVehicle].soc:0}set soc(e){W[this.connectedVehicle]&&(W[this.connectedVehicle].soc=e)}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,te("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,te("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get timedCharging(){return de[this.chargeTemplate]?de[this.chargeTemplate].time_charging.active:!1}set timedCharging(e){de[this.chargeTemplate].time_charging.active=e,te("cpTimedCharging",e,this.chargeTemplate)}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,te("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,te("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,te("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,te("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,te("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,te("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,te("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,te("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,te("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}get realCurrent(){switch(this.phasesInUse){case 0:return 0;case 1:return this.currents[0];case 2:return(this.currents[0]+this.currents[1])/2;case 3:return(this.currents[0]+this.currents[1]+this.currents[2])/3;default:return 0}}get etActive(){return W[this.connectedVehicle]?W[this.connectedVehicle].etActive:!1}set etActive(e){W[this.connectedVehicle]&&(W[this.connectedVehicle].etActive=e)}get etMaxPrice(){return W[this.connectedVehicle].etMaxPrice??0}set etMaxPrice(e){console.log("Setting et max price needs to be implemented"),te("cpEtMaxPrice",Math.round(e*10)/1e6,this.id)}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class za{constructor(e){l(this,"id");l(this,"name","");l(this,"_chargeTemplateId",0);l(this,"_evTemplateId",0);l(this,"tags",[]);l(this,"config",{});l(this,"soc",0);l(this,"range",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,te("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,te("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}get etActive(){return de[this.chargeTemplateId]?de[this.chargeTemplateId].et.active:!1}set etActive(e){de[this.chargeTemplateId]&&te("priceCharging",e,this.chargeTemplateId)}get etMaxPrice(){if(de[this.chargeTemplateId]&&de[this.chargeTemplateId].et.active)return de[this.chargeTemplateId].et.max_price*1e5}get chargepoint(){for(const e of Object.values(P))if(e.connectedVehicle==this.id)return e}}var _e=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(_e||{});const P=Q({}),W=Q({}),de=Q({}),Je=Q({}),Re=Q({}),kt=Q({});function ja(t){t in P||(P[t]=new Wa(t),P[t].color="var(--color-cp"+(Object.values(P).length-1)+")")}function Na(){Object.keys(P).forEach(t=>{delete P[parseInt(t)]})}const Ua={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpTimedCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",cpEtMaxPrice:"openWB/set/vehicle/template/charge_template/%/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control",socUpdate:"openWB/set/vehicle/%/get/force_soc_update",setSoc:"openWB/set/vehicle/%/soc_module/calculated_soc_state/manual_soc",priceCharging:"openWB/set/vehicle/template/charge_template/%/et/active"};function te(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let o=Ua[t];if(!o){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpEtMaxPrice":case"cpPvMinSocCurrent":o=o.replace("%",P[a].chargeTemplate.toString());break;default:o=o.replace("%",String(a))}switch(typeof e){case"number":wt(o,JSON.stringify(+e));break;default:wt(o,JSON.stringify(e))}}function $t(t){wt("openWB/set/command/"+Mt()+"/todo",JSON.stringify(t))}class Fa{constructor(){l(this,"batterySoc",0);l(this,"isBatteryConfigured",!0);l(this,"chargeMode","0");l(this,"_pvBatteryPriority","ev_mode");l(this,"displayLiveGraph",!0);l(this,"isEtEnabled",!0);l(this,"etMaxPrice",0);l(this,"etCurrentPrice",0);l(this,"cpDailyExported",0);l(this,"evuId",0);l(this,"etProvider","");l(this,"ipAddress","");l(this,"systemTime","");l(this,"version","");l(this,"versionDetails","");l(this,"devBranch","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,te("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const Ja=[["EV","ev_mode"],["Speicher","bat_mode"],["MinSoc","min_soc_bat_mode"]],ie=Q({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""},cp1:{name:"Ladepunkt",color:"var(--color-cp1)",icon:"Ladepunkt"},cp2:{name:"Ladepunkt",color:"var(--color-cp2)",icon:"Ladepunkt"},cp3:{name:"Ladepunkt",color:"var(--color-cp3)",icon:"Ladepunkt"},cp4:{name:"Ladepunkt",color:"var(--color-cp4)",icon:"Ladepunkt"},cp5:{name:"Ladepunkt",color:"var(--color-cp5)",icon:"Ladepunkt"},cp6:{name:"Ladepunkt",color:"var(--color-cp6)",icon:"Ladepunkt"},cp7:{name:"Ladepunkt",color:"var(--color-cp7)",icon:"Ladepunkt"},cp8:{name:"Ladepunkt",color:"var(--color-cp8)",icon:"Ladepunkt"},sh1:{name:"Gerät",color:"var(--color-sh1)",icon:"Gerät"},sh2:{name:"Gerät",color:"var(--color-sh2)",icon:"Gerät"},sh3:{name:"Gerät",color:"var(--color-sh3)",icon:"Gerät"},sh4:{name:"Gerät",color:"var(--color-sh4)",icon:"Gerät"},sh5:{name:"Gerät",color:"var(--color-sh5)",icon:"Gerät"},sh6:{name:"Gerät",color:"var(--color-sh6)",icon:"Gerät"},sh7:{name:"Gerät",color:"var(--color-sh7)",icon:"Gerät"},sh8:{name:"Gerät",color:"var(--color-sh8)",icon:"Gerät"},sh9:{name:"Gerät",color:"var(--color-sh9)",icon:"Gerät"}});class Kt{constructor(){l(this,"_items",{});this.addItem("evuIn"),this.addItem("pv"),this.addItem("batOut"),this.addItem("evuOut"),this.addItem("charging"),this.addItem("devices"),this.addItem("batIn"),this.addItem("house")}get items(){return this._items}keys(){return Object.keys(this._items)}values(){return Object.values(this._items)}addItem(e){this._items[e]=Ce(e)}setEnergy(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energy=a}setEnergyPv(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyPv=a}setEnergyBat(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyBat=a}setPvPercentage(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].pvPercentage=a}calculateHouseEnergy(){this._items.house.energy=this._items.evuIn.energy+this._items.pv.energy+this._items.batOut.energy-this._items.evuOut.energy-this._items.batIn.energy-this._items.charging.energy-this._items.devices.energy}}let I=new Kt;function Pt(){I=new Kt}const z=Q({evuIn:Ce("evuIn"),pv:Ce("pv"),batOut:Ce("batOut")}),B=Q({evuOut:Ce("evuOut"),charging:Ce("charging"),devices:Ce("devices"),batIn:Ce("batIn"),house:Ce("house")}),q=Q(new Fa);ee("");const it=ee(!1);function Ce(t){return{name:ie[t]?ie[t].name:"item",power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:ie[t]?ie[t].color:"var(--color-charging)",icon:ie[t]?ie[t].icon:""}}const ue=Q({active:!1,locked:!0,usePin:!1,code:"",timeout:60,localCpOnly:!1});function St(){ue.usePin&&ue.locked?new Ut("#numberpad").toggle():ue.locked=!1}function Ra(t){return t==ue.code}function Ha(){B.house.power=B.house.power-B.devices.power}const Vt=ee(new Date),Ya=O({__name:"DisplayButton",props:{icon:{},bgcolor:{},color:{}},emits:["click"],setup(t,{emit:e}){const a=t,o=e;function n(){o("click",!0)}return(i,c)=>(d(),f("div",{style:ne({"background-color":a.bgcolor?a.bgcolor:"var(--color-fg)",color:a.color?a.color:"var(--color-bg)"}),class:"mybutton",onClick:n},[a.icon?(d(),f("span",{key:0,class:K(["fas me-2",a.icon])},null,2)):k("",!0),ve(i.$slots,"default",{},void 0,!0)],4))}}),F=(t,e)=>{const a=t.__vccOpts||t;for(const[o,n]of e)a[o]=n;return a},Be=F(Ya,[["__scopeId","data-v-433930f8"]]);class qa{constructor(e){l(this,"id");l(this,"name","Gerät");l(this,"power",0);l(this,"status","off");l(this,"energy",0);l(this,"runningTime",0);l(this,"configured",!1);l(this,"_showInGraph",!0);l(this,"color","white");l(this,"canSwitch",!1);l(this,"countAsHouse",!1);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"tempConfigured",0);l(this,"temp",[300,300,300]);l(this,"on",!1);l(this,"isAutomatic",!0);l(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,Z()}setShowInGraph(e){this._showInGraph=e}}const E=Q({});function ea(t){t in E?console.info("Duplicate sh device message: "+t):(E[t]=new qa(t),E[t].color="var(--color-sh"+Object.values(E).length+")")}class Qa{constructor(){l(this,"graphToShow","powermeter");l(this,"cpToShow",0);l(this,"displayLocked",!0);l(this,"_showRelativeArcs",!1);l(this,"showTodayGraph",!0);l(this,"_graphPreference","live");l(this,"_usageStackOrder",0);l(this,"_displayMode","dark");l(this,"_showGrid",!1);l(this,"_smartHomeColors","normal");l(this,"_decimalPlaces",1);l(this,"_showQuickAccess",!0);l(this,"_simpleCpList",!1);l(this,"_shortCpList","no");l(this,"_showAnimations",!0);l(this,"_preferWideBoxes",!1);l(this,"_maxPower",4e3);l(this,"_fluidDisplay",!1);l(this,"_showClock","no");l(this,"_showButtonBar",!0);l(this,"_showCounters",!1);l(this,"_showVehicles",!1);l(this,"_showPrices",!1);l(this,"_debug",!1);l(this,"isEtEnabled",!1);l(this,"etPrice",20.5);l(this,"showRightButton",!0);l(this,"showLeftButton",!0);l(this,"animationDuration",300);l(this,"animationDelay",100);l(this,"zoomGraph",!1)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,Z()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,Z()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,Z()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,eo(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,Z()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,Z()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,Lt(e),Z()}setSmartHomeColors(e){this._smartHomeColors=e,Lt(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,Z()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,Z()}setSimpleCpList(e){this._simpleCpList=e}get shortCpList(){return this._shortCpList}set shortCpList(e){this._shortCpList=e,Z()}setShortCpList(e){this._shortCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,Z()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,Z()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,Z()}setMaxPower(e){this._maxPower=e}get fluidDisplay(){return this._fluidDisplay}set fluidDisplay(e){this._fluidDisplay=e,Z()}setFluidDisplay(e){this._fluidDisplay=e}get showClock(){return this._showClock}set showClock(e){this._showClock=e,Z()}setShowClock(e){this._showClock=e}get debug(){return this._debug}set debug(e){this._debug=e,Z()}setDebug(e){this._debug=e}get showButtonBar(){return this._showButtonBar}set showButtonBar(e){this._showButtonBar=e,Z()}setShowButtonBar(e){this._showButtonBar=e}get showCounters(){return this._showCounters}set showCounters(e){this._showCounters=e,Z()}setShowCounters(e){this._showCounters=e}get showVehicles(){return this._showVehicles}set showVehicles(e){this._showVehicles=e,Z()}setShowVehicles(e){this._showVehicles=e}get showPrices(){return this._showPrices}set showPrices(e){this._showPrices=e,Z()}setShowPrices(e){this._showPrices=e}}const v=Q(new Qa),Za=992,xt=Q({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function Xa(){xt.x=document.documentElement.clientWidth,xt.y=document.documentElement.clientHeight}const Ka=g(()=>xt.x>=Za),Ie={stop:{mode:_e.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:_e.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:_e.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:_e.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:_e.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function Z(){to()}function eo(t){const e=ye("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),Z()}function Lt(t){const e=ye("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}const Pe={chargemode:"Der Lademodus für das Fahrzeug an diesem Ladepunkt",vehicle:"Das Fahrzeug, das an diesem Ladepounkt geladen wird",locked:"Für das Laden sperren",priority:"Fahrzeuge mit Priorität werden bevorzugt mit mehr Leistung geladen, falls verfügbar",timeplan:"Das Laden nach Zeitplan für dieses Fahrzeug aktivieren",minsoc:"Immer mindestens bis zum eingestellten Ladestand laden. Wenn notwendig mit Netzstrom.",minpv:"Durchgehend mit mindestens dem eingestellten Strom laden. Wenn notwendig mit Netzstrom.",pricebased:"Laden bei dynamischem Stromtarif, wenn eingestellter Maximalpreis unterboten wird."};function to(){const t={};t.hideSH=Object.values(E).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=v.graphPreference=="live",t.displayM=v.displayMode,t.stackO=v.usageStackOrder,t.showGr=v.showGrid,t.decimalP=v.decimalPlaces,t.smartHomeC=v.smartHomeColors,t.relPM=v.showRelativeArcs,t.maxPow=v.maxPower,t.showQA=v.showQuickAccess,t.simpleCP=v.simpleCpList,t.shortCP=v.shortCpList,t.animation=v.showAnimations,t.wideB=v.preferWideBoxes,t.fluidD=v.fluidDisplay,t.clock=v.showClock,t.showButtonBar=v.showButtonBar,t.showCounters=v.showCounters,t.showVehicles=v.showVehicles,t.showPrices=v.showPrices,t.debug=v.debug,document.cookie="openWBColorTheme="+JSON.stringify(t)+";max-age=16000000;samesite=strict"}const Ze=t=>(le("data-v-7cc502dd"),t=t(),ce(),t),ao={class:"navigation"},oo={class:"graphbuttons"},no={class:"timedisplay"},ro={class:"cpbuttons"},so=Ze(()=>s("span",{class:"fas fa-arrow-left px-2"},null,-1)),io=Ze(()=>s("span",{class:"fas fa-charging-station pe-2"},null,-1)),lo=Ze(()=>s("span",{class:"fas fa-lock px-4"},null,-1)),co=Ze(()=>s("span",{class:"fas fa-charging-station px-2"},null,-1)),uo=Ze(()=>s("span",{class:"fas fa-arrow-right pe-2"},null,-1)),ho=O({__name:"NavigationBar",setup(t){let e;function a(){let h=Object.values(P).length;v.cpToShow=(v.cpToShow+1)%h}function o(){let h=Object.values(P).length;v.cpToShow=((v.cpToShow-1)%h+h)%h}function n(){v.graphToShow="powermeter"}function i(){v.graphToShow="powergraph"}function c(){v.graphToShow="energymeter"}return Ne(()=>{e=setInterval(()=>{Vt.value=new Date},1e3)}),xa(()=>{clearInterval(e)}),(h,u)=>(d(),f("div",ao,[s("span",oo,[s("span",no,x(r(Oa)(r(Vt))),1),y(Be,{icon:"fa-chart-pie",onClick:n},{default:S(()=>[U("Leistung")]),_:1}),y(Be,{icon:"fa-chart-line",onClick:i},{default:S(()=>[U("Verlauf")]),_:1}),y(Be,{icon:"fa-chart-column",onClick:c},{default:S(()=>[U("Energie")]),_:1})]),y(Be,{"data-bs-toggle":"modal","data-bs-target":"#statuspage"},{default:S(()=>[U("Status")]),_:1}),s("span",ro,[y(Be,{color:"var(--color-charging)",onClick:o},{default:S(()=>[so,io]),_:1}),y(Be,{bgcolor:r(ue).locked?"var(--color-evu)":"var(--color-pv)",onClick:r(St)},{default:S(()=>[lo]),_:1},8,["bgcolor","onClick"]),y(Be,{color:"var(--color-charging)",onClick:a},{default:S(()=>[co,uo]),_:1})])]))}}),po=F(ho,[["__scopeId","data-v-7cc502dd"]]),go=["origin"],mo=O({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},n=z;n["zz-empty"]=o;const i=Object.values(z).length-1,c=Ft().value(m=>m.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),h=Jt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),u=ye("g#pmSourceArc");return u.selectAll("*").remove(),u.selectAll("sources").data(c(Object.values(n))).enter().append("path").attr("d",h).attr("fill",m=>m.data.color).attr("stroke",(m,_)=>_==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmSourceArc.vue"});return Ma(()=>{let o=z.pv.power+z.evuIn.power+z.batOut.power;o>v.maxPower&&(v.maxPower=o)}),(o,n)=>(d(),f("g",{id:"pmSourceArc",origin:a.value},null,8,go))}}),fo=["origin"],vo=O({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const n=[B.evuOut,B.charging].concat(Object.values(E).filter(m=>m.configured&&!m.countAsHouse).sort((m,_)=>_.power-m.power)).concat([B.batIn,B.house]).concat(o),i=n.length-1,c=Ft().value(m=>m.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),h=Jt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),u=ye("g#pmUsageArc");return u.selectAll("*").remove(),u.selectAll("consumers").data(c(n)).enter().append("path").attr("d",h).attr("fill",m=>m.data.color).attr("stroke",(m,_)=>_==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmUsageArc.vue"});return(o,n)=>(d(),f("g",{id:"pmUsageArc",origin:a.value},null,8,fo))}}),ta=O({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>ot(e.watt,v.decimalPlaces));return(o,n)=>x(a.value)}}),_o={key:0,id:"pmLabel"},yo=["x","y","fill","text-anchor"],bo=22,be=O({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),o=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),n=g(()=>!e.data||e.data.power>0),i=g(()=>e.labeltext?"":"fas");return(c,h)=>n.value?(d(),f("g",_o,[s("text",{x:c.x,y:c.y,fill:o.value,"text-anchor":c.anchor,"font-size":bo,class:"pmLabel"},[s("tspan",{class:K(i.value)},x(a.value),3),s("tspan",null,[c.data!==void 0?(d(),L(ta,{key:0,watt:c.data.power},null,8,["watt"])):k("",!0)])],8,yo)])):k("",!0)}}),wo={class:"wb-widget p-0 m-0 shadow"},ko={class:"d-flex justify-content-between"},So={class:"m-4 me-0 mb-0"},xo=s("div",{class:"p-0"},"(title goes here)",-1),Mo={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},$o={class:"px-4 pt-4 pb-2 wb-subwidget"},Po={class:"row"},Co={class:"col m-0 p-0"},Io={class:"container-fluid m-0 p-0"},Bo={key:0},Oo=s("hr",null,null,-1),To={class:"px-4 py-2 wb-subwidget"},Vo={class:"row"},Lo={class:"col"},Ao={class:"container-fluid m-0 p-0"},ut=O({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&v.preferWideBoxes?"col-lg-6":"col-lg-4");return(o,n)=>(d(),f("div",{class:K(["p-2 m-0 d-flex",a.value])},[s("div",wo,[s("div",ko,[s("h3",So,[ve(o.$slots,"title",{},()=>[xo]),ve(o.$slots,"subtitle")]),s("div",Mo,[ve(o.$slots,"buttons")])]),s("div",$o,[s("div",Po,[s("div",Co,[s("div",Io,[ve(o.$slots,"default")])])])]),o.$slots.footer!=null?(d(),f("div",Bo,[Oo,s("div",To,[s("div",Vo,[s("div",Lo,[s("div",Ao,[ve(o.$slots,"footer")])])])])])):k("",!0)])],2))}});class Do{constructor(){l(this,"active",!1);l(this,"etPriceList",new Map);l(this,"etProvider","");l(this,"etMaxPrice",0)}get etCurrentPriceString(){const[e]=oe.etPriceList.values();return(Math.round(e*10)/10).toFixed(1)+" ct"}}const oe=Q(new Do),Go={id:"powermeter",class:"p-0 m-0"},Eo=["viewBox"],Wo=["transform"],zo={transform:"scale(0.9294,1)"},jo=["x"],xe=500,Me=20,At=1,No=O({__name:"PowerMeter",setup(t){const e=xe,a=Math.PI/40,o=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],n=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],i=g(()=>xe/2-Me),c=g(()=>{let M="",N=Object.values(z).filter(D=>D.power>0);return N.length==1&&N[0].name=="PV"?M="Aktueller Verbrauch: ":M="Bezug/Verbrauch: ",M+ot(B.house.power+B.charging.power+B.devices.power+B.batIn.power,v.decimalPlaces)}),h=g(()=>{let M=z.pv.power+z.evuIn.power+z.batOut.power;return v.maxPower>M?ot(v.maxPower,v.decimalPlaces):ot(M,v.decimalPlaces)}),u=g(()=>Object.values(P)),m=g(()=>{let M=0;return v.showRelativeArcs&&(M=v.maxPower-(z.pv.power+z.evuIn.power+z.batOut.power)),M<0?0:M}),_=g(()=>[B.evuOut,B.charging,B.devices,B.batIn,B.house].filter(M=>M.power>0)),T=g(()=>o[_.value.length-1]);function C(M){return n[T.value[M]]}function j(M){return Math.round(u.value[M].soc)}function J(M){return M.length>12?M.slice(0,11)+".":M}const Y=g(()=>{const[M]=oe.etPriceList.values();return Math.round(M*10)/10});return(M,N)=>(d(),L(ut,{"full-width":!0},{title:S(()=>[U(" Aktuelle Leistung ")]),default:S(()=>[s("figure",Go,[(d(),f("svg",{viewBox:"0 0 "+xe+" "+r(e)},[s("g",{transform:"translate("+xe/2+","+r(e)/2+")"},[s("g",zo,[y(mo,{radius:i.value,"corner-radius":At,"circle-gap-size":a,"empty-power":m.value},null,8,["radius","empty-power"]),y(vo,{"sh-device":r(E),radius:i.value,"corner-radius":At,"circle-gap-size":a,"empty-power":m.value},null,8,["sh-device","radius","empty-power"]),y(be,{x:0,y:-r(e)/10*2,data:r(z).pv,props:r(ie).pv,anchor:"middle",config:r(v)},null,8,["y","data","props","config"]),y(be,{x:0,y:-r(e)/10*3,data:r(z).evuIn,props:r(ie).evuIn,anchor:"middle",config:r(v)},null,8,["y","data","props","config"]),y(be,{x:0,y:-r(e)/10,data:r(z).batOut,props:r(ie).batOut,anchor:"middle",config:r(v)},null,8,["y","data","props","config"]),r(oe).active?(d(),L(be,{key:0,x:0,y:-r(e)/10,data:r(z).batOut,props:r(ie).batOut,anchor:"middle",config:r(v)},null,8,["y","data","props","config"])):k("",!0),(d(!0),f(X,null,ge(_.value,(D,$)=>(d(),L(be,{key:$,x:C($).x,y:C($).y,data:D,labelicon:D.icon,labelcolor:D.color,anchor:"middle",config:r(v)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),u.value.length>0&&r(W)[u.value[0].connectedVehicle]?(d(),L(be,{key:1,x:-xe/2-Me/4+10,y:-r(e)/2+Me+5,labeltext:J(r(W)[u.value[0].connectedVehicle].name)+": "+j(0)+"%",labelcolor:u.value[0].color,anchor:"start",config:r(v)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),u.value.length>1&&r(W)[u.value[1].connectedVehicle]?(d(),L(be,{key:2,x:xe/2+Me/4-10,y:-r(e)/2+Me+5,labeltext:J(r(W)[u.value[1].connectedVehicle].name)+": "+j(1)+"%",labelcolor:u.value[1].color,anchor:"end",config:r(v)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),r(q).batterySoc>0?(d(),L(be,{key:3,x:-xe/2-Me/4+10,y:r(e)/2-Me+15,labeltext:"Speicher: "+r(q).batterySoc+"%",labelcolor:r(B).batIn.color,anchor:"start",config:r(v)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),r(oe).active?(d(),L(be,{key:4,x:xe/2+Me/4-10,y:r(e)/2-Me+15,value:Y.value,labeltext:r(oe).etCurrentPriceString,labelcolor:"var(--color-charging)",anchor:"end",config:r(v)},null,8,["x","y","value","labeltext","config"])):k("",!0),y(be,{x:0,y:0,labeltext:c.value,labelcolor:"var(--color-fg)",anchor:"middle",config:r(v)},null,8,["labeltext","config"]),r(v).showRelativeArcs?(d(),f("text",{key:5,x:xe/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+x(h.value),9,jo)):k("",!0)])],8,Wo)],8,Eo))])]),_:1}))}}),we=500,$e=500,G={top:10,right:20,bottom:10,left:25},Ct=["charging","house","batIn","devices"];class Uo{constructor(){l(this,"data",[]);l(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const p=Q(new Uo);let lt=!0,Qe=!0;function Dt(){lt=!1}function Gt(){Qe=!1}function Fo(t){Qe=t}function Xe(t){p.data=t}const ae=Q({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){p.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),De(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[],qo(),it.value=!0},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),ze(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)De(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)ze(this.refreshTopicPrefix+t)},subscribeUpdates(){De(this.updateTopic)},unsubscribeUpdates(){ze(this.updateTopic)}}),H=Q({topic:"openWB/log/daily/#",date:new Date,activate(){if(p.graphMode=="day"||p.graphMode=="today"){p.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");De(this.topic),$t({command:"getDailyLog",data:{day:t}})}},deactivate(){ze(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),ke=Q({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");p.data=[],De(this.topic),$t({command:"getMonthlyLog",data:{month:t}})},deactivate(){ze(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){const t=new Date;t.getFullYear()==this.year?this.month-1<t.getMonth()&&(this.month=this.month+1):(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1)),this.activate()},getDate(){return new Date(this.year,this.month)}}),Oe=Q({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();p.data=[],De(this.topic),$t({command:"getYearlyLog",data:{year:t}})},deactivate(){ze(this.topic)},back(){this.year-=1,this.activate()},forward(){this.year<new Date().getFullYear()&&(this.year=this.year+1,this.activate())},getDate(){return new Date(this.year,this.month)}});function re(t=!1){switch(p.graphMode==""?Jo(v.graphPreference):p.graphMode=="live"?v.graphPreference="live":v.graphPreference="today",t||(lt=!0,Qe=!0),p.graphMode){case"live":H.deactivate(),ke.deactivate(),Oe.deactivate(),ae.activate();break;case"today":ae.deactivate(),ke.deactivate(),Oe.deactivate(),H.activate();break;case"day":ae.deactivate(),ke.deactivate(),Oe.deactivate(),H.activate();break;case"month":ae.deactivate(),H.deactivate(),Oe.deactivate(),ke.activate();break;case"year":ae.deactivate(),H.deactivate(),ke.deactivate(),Oe.activate();break}}function Jo(t){p.graphMode=t}function Ro(t,e){e[t]>0&&(I.items[t].energyPv+=1e3/12*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),I.items[t].energyBat+=1e3/12*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}function Ho(t,e){e[t]>0&&(I.items[t].energyPv+=1e3*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),I.items[t].energyBat+=1e3*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}const Yo=["evuIn","pv","batIn","evuOut"],He=ee(!1);function It(t,e){Object.entries(t).length>0?(He.value=!1,Object.entries(t.counter).forEach(([a,o])=>{(e.length==0||e.includes(a))&&(I.items.evuIn.energy+=o.energy_imported,I.items.evuOut.energy+=o.energy_exported)}),I.items.pv.energy=t.pv.all.energy_exported,t.bat.all&&(I.items.batIn.energy=t.bat.all.energy_imported,I.items.batOut.energy=t.bat.all.energy_exported),Object.entries(t.cp).forEach(([a,o])=>{a=="all"?I.setEnergy("charging",o.energy_imported):I.setEnergy(a,o.energy_imported)}),I.setEnergy("devices",0),Object.entries(t.sh).forEach(([a,o])=>{I.setEnergy(a,o.energy_imported);const n=a.substring(2);E[+n].countAsHouse||(I.items.devices.energy+=o.energy_imported)}),t.hc&&t.hc.all?I.setEnergy("house",t.hc.all.energy_imported):I.calculateHouseEnergy(),I.keys().map(a=>{Yo.includes(a)||(I.setPvPercentage(a,Math.round((I.items[a].energyPv+I.items[a].energyBat)/I.items[a].energy*100)),Ct.includes(a)&&(B[a].energy=I.items[a].energy,B[a].energyPv=I.items[a].energyPv,B[a].energyBat=I.items[a].energyBat,B[a].pvPercentage=I.items[a].pvPercentage))}),p.graphMode=="today"&&(Object.values(P).map(a=>{const o=I.items["cp"+a.id];o&&(a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}),Object.values(E).map(a=>{const o=I.items["sh"+a.id];o&&(a.energy=o.energy,a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}))):He.value=!0,it.value=!0}function qo(){I.keys().map(t=>{Ct.includes(t)&&(B[t].energy=I.items[t].energy,B[t].energyPv=0,B[t].energyBat=0,B[t].pvPercentage=0)}),Object.values(P).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0}),Object.values(E).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0})}const Se=g(()=>{const t=Ge(p.data,e=>e.date);return t[1]?_t().domain(Array.from({length:t[1]},(e,a)=>a+1)).paddingInner(.4).range([0,we-G.left-2]):_t().range([0,0])});function Bt(){switch(p.graphMode){case"live":p.graphMode="today",v.showRightButton=!0,re();break;case"today":p.graphMode="day",H.date=new Date,H.back(),re();break;case"day":H.back(),re();break;case"month":ke.back();break;case"year":Oe.back();break}}function aa(){const t=new Date;switch(p.graphMode){case"live":break;case"today":p.graphMode="live",v.showRightButton=!1,re();break;case"day":H.forward(),H.date.getDate()==t.getDate()&&H.date.getMonth()==t.getMonth()&&H.date.getFullYear()==t.getFullYear()&&(p.graphMode="today"),re();break;case"month":ke.forward();break;case"year":Oe.forward();break}}function oa(){switch(p.graphMode){case"live":Bt();break;case"day":case"today":p.graphMode="month",re();break;case"month":p.graphMode="year",re();break}}function na(){switch(p.graphMode){case"year":p.graphMode="month",re();break;case"month":p.graphMode="today",re();break;case"today":case"day":p.graphMode="live",re();break}}function Et(t){if(p.graphMode=="day"||p.graphMode=="today"){H.setDate(t);const e=new Date;H.date.getDate()==e.getDate()&&H.date.getMonth()==e.getMonth()&&H.date.getFullYear()==e.getFullYear()?p.graphMode="today":p.graphMode="day",re()}}const Qo=["origin","transform"],Zo=O({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)"};var o,n;const i=v.showAnimations?v.animationDuration:0,c=v.showAnimations?v.animationDelay:0,h=g(()=>{const w=ye("g#pgSourceGraph");p.graphMode=="month"||p.graphMode=="year"?$(w):D(w),w.selectAll(".axis").remove();const b=w.append("g").attr("class","axis");return b.call(Y.value),b.selectAll(".tick").attr("font-size",12),b.selectAll(".tick line").attr("stroke",N.value).attr("stroke-width",M.value),b.select(".domain").attr("stroke","var(--color-bg)"),"pgSourceGraph.vue"}),u=g(()=>p.graphMode=="month"||p.graphMode=="year"?["evuIn","batOut","selfUsage","evuOut"]:["selfUsage","evuOut","batOut","evuIn"]),m=g(()=>Le().domain([0,p.data.length-1]).range([0,e.width])),_=g(()=>Rt().keys(u.value)),T=g(()=>_.value(p.data)),C=g(()=>Le().range([e.height-10,0]).domain(p.graphMode=="year"?[0,Math.ceil(j.value[1]*10)/10]:[0,Math.ceil(j.value[1])])),j=g(()=>{let w=Ge(p.data,b=>Math.max(b.pv+b.evuIn+b.batOut,b.selfUsage+b.evuOut));return w[0]!=null&&w[1]!=null?(p.graphMode=="year"&&(w[0]=w[0]/1e3,w[1]=w[1]/1e3),w):[0,0]}),J=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),Y=g(()=>dt(C.value).tickSizeInner(J.value).ticks(4).tickFormat(w=>(w==0?"":Math.round(w*10)/10).toLocaleString(void 0))),M=g(()=>v.showGrid?"0.5":"1"),N=g(()=>v.showGrid?"var(--color-grid)":"var(--color-bg)");function D(w){const b=nt().x((A,se)=>m.value(se)).y(C.value(0)),V=nt().x((A,se)=>m.value(se)).y0(A=>C.value(p.graphMode=="year"?A[0]/1e3:A[0])).y1(A=>C.value(p.graphMode=="year"?A[1]/1e3:A[1]));lt?(w.selectAll("*").remove(),o=w.selectAll(".sourceareas").data(T.value).enter().append("path").attr("fill",(A,se)=>a[u.value[se]]).attr("d",A=>b(A)),o.transition().duration(i).delay(c).ease(Fe).attr("d",A=>V(A)),Dt()):o.data(T.value).transition().duration(0).ease(Fe).attr("d",A=>V(A))}function $(w){lt?(w.selectAll("*").remove(),n=w.selectAll(".sourcebar").data(T.value).enter().append("g").attr("fill",(b,V)=>a[u.value[V]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,V)=>Se.value(p.data[V].date)??0).attr("y",()=>C.value(0)).attr("height",0).attr("width",Se.value.bandwidth()),n.transition().duration(i).delay(c).ease(Fe).attr("height",b=>p.graphMode=="year"?C.value(b[0]/1e3)-C.value(b[1]/1e3):C.value(b[0])-C.value(b[1])).attr("y",b=>p.graphMode=="year"?C.value(b[1]/1e3):C.value(b[1])),Dt()):(w.selectAll("*").remove(),n=w.selectAll(".sourcebar").data(T.value).enter().append("g").attr("fill",(b,V)=>a[u.value[V]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,V)=>Se.value(p.data[V].date)??0).attr("y",b=>p.graphMode=="year"?C.value(b[1]/1e3):C.value(b[1])).attr("width",Se.value.bandwidth()).attr("height",b=>p.graphMode=="year"?C.value(b[0]/1e3)-C.value(b[1]/1e3):C.value(b[0])-C.value(b[1])))}return(w,b)=>(d(),f("g",{id:"pgSourceGraph",origin:h.value,transform:"translate("+w.margin.left+","+w.margin.top+")"},null,8,Qo))}}),Xo=["origin","transform"],Ko=O({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn"],["charging","devices","house","batIn"],["devices","charging","house","batIn"]],o={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var n,i;const c=v.showAnimations?v.animationDuration:0,h=v.showAnimations?v.animationDelay:0,u=g(()=>{const $=ye("g#pgUsageGraph");p.graphMode=="month"||p.graphMode=="year"?D($):N($),$.selectAll(".axis").remove();const w=$.append("g").attr("class","axis");return w.call(M.value),w.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),v.showGrid?w.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):w.selectAll(".tick line").attr("stroke","var(--color-bg)"),w.select(".domain").attr("stroke","var(--color-bg)"),"pgUsageGraph.vue"}),m=g(()=>Rt().keys(j.value)),_=g(()=>m.value(p.data)),T=g(()=>Le().domain([0,p.data.length-1]).range([0,e.width])),C=g(()=>Le().range([e.height+10,2*e.height]).domain(p.graphMode=="year"?[0,Math.ceil(J.value[1]*10)/10]:[0,Math.ceil(J.value[1])])),j=g(()=>{if(p.graphMode!="today"&&p.graphMode!="day")return a[e.stackOrder];{const $=a[e.stackOrder].slice(),w=$.indexOf("charging");$.splice(w,1);const b=/cp\d+/;let V=[];return p.data.length>0&&(V=Object.keys(p.data[0]).reduce((A,se)=>(se.match(b)&&A.push(se),A),[])),V.map((A,se)=>{$.splice(w+se,0,A),o[A]="var(--color-cp"+se+")"}),$}}),J=g(()=>{let $=Ge(p.data,w=>w.house+w.charging+w.batIn+w.devices);return $[0]!=null&&$[1]!=null?(p.graphMode=="year"&&($[0]=$[0]/1e3,$[1]=$[1]/1e3),$):[0,0]}),Y=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),M=g(()=>dt(C.value).tickSizeInner(Y.value).ticks(4).tickFormat($=>($==0?"":Math.round($*10)/10).toLocaleString(void 0)));function N($){const w=nt().x((V,A)=>T.value(A)).y(C.value(0)),b=nt().x((V,A)=>T.value(A)).y0(V=>C.value(V[0])).y1(V=>C.value(V[1]));v.showAnimations?Qe?($.selectAll("*").remove(),n=$.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",V=>w(V)).attr("fill",(V,A)=>o[j.value[A]]),n.transition().duration(300).delay(100).ease(Fe).attr("d",V=>b(V)),Gt()):($.selectAll("*").remove(),$.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",V=>b(V)).attr("fill",(V,A)=>o[j.value[A]])):($.selectAll("*").remove(),$.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",V=>b(V)).attr("fill",(V,A)=>o[j.value[A]]))}function D($){Qe?($.selectAll("*").remove(),i=$.selectAll(".usagebar").data(_.value).enter().append("g").attr("fill",(w,b)=>o[a[e.stackOrder][b]]).selectAll("rect").data(w=>w).enter().append("rect").attr("x",(w,b)=>Se.value(p.data[b].date)??0).attr("y",()=>C.value(0)).attr("height",0).attr("width",Se.value.bandwidth()),i.transition().duration(c).delay(h).ease(Fe).attr("y",w=>p.graphMode=="year"?C.value(w[0]/1e3):C.value(w[0])).attr("height",w=>p.graphMode=="year"?C.value(w[1]/1e3)-C.value(w[0]/1e3):C.value(w[1])-C.value(w[0])),Gt()):($.selectAll("*").remove(),i=$.selectAll(".usagebar").data(_.value).enter().append("g").attr("fill",(w,b)=>o[a[e.stackOrder][b]]).selectAll("rect").data(w=>w).enter().append("rect").attr("x",(w,b)=>Se.value(p.data[b].date)??0).attr("y",w=>p.graphMode=="year"?C.value(w[0]/1e3):C.value(w[0])).attr("height",w=>p.graphMode=="year"?C.value(w[1]/1e3)-C.value(w[0]/1e3):C.value(w[1])-C.value(w[0])).attr("width",Se.value.bandwidth()))}return($,w)=>(d(),f("g",{id:"pgUsageGraph",origin:u.value,transform:"translate("+$.margin.left+","+$.margin.top+")"},null,8,Xo))}}),en=["transform"],tn=["origin","transform"],an=["origin","transform"],on={key:0},nn=["width","height"],rn={key:1},sn=["y","width","height"],gt=12,ln=O({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>at(h.value).ticks(4).tickSizeInner(c.value).tickFormat(yt("%H:%M"))),o=g(()=>$a(h.value).ticks(4).tickSizeInner(c.value+3).tickFormat(yt(""))),n=g(()=>at(Se.value).ticks(4).tickSizeInner(c.value).tickFormat(_=>_.toString())),i=g(()=>at(Se.value).ticks(4).tickSizeInner(c.value).tickFormat(()=>"")),c=g(()=>p.graphMode!=="month"&&p.graphMode!=="year"?v.showGrid?-(e.height/2-7):-10:0),h=g(()=>{let _=Ge(p.data,T=>T.date);return _[0]&&_[1]?qe().domain(_).range([0,e.width]):qe().range([0,0])}),u=g(()=>{let _=ye("g#PGXAxis");return _.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?_.call(n.value):_.call(a.value),_.selectAll(".tick > text").attr("fill",(T,C)=>C>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",gt),v.showGrid?_.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):_.selectAll(".tick line").attr("stroke","var(--color-bg)"),_.select(".domain").attr("stroke","var(--color-bg)"),_.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",gt).text(p.graphMode=="year"?"MW":"kW").attr("text-anchor","start"),"PGXAxis.vue"}),m=g(()=>{let _=ye("g#PGXAxis2");return _.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?_.call(i.value):_.call(o.value),_.selectAll(".tick > text").attr("fill",(T,C)=>C>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",gt),v.showGrid?(_.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),_.select(".domain").attr("stroke","var(--color-bg)")):_.selectAll(".tick line").attr("stroke","var(--color-bg)"),_.select(".domain").attr("stroke","var(--color-bg)"),"PGXAxis2.vue"});return(_,T)=>(d(),f("g",{transform:"translate("+_.margin.left+","+_.margin.top+")"},[s("g",{id:"PGXAxis",class:"axis",origin:u.value,transform:"translate(0,"+(_.height/2-6)+")"},null,8,tn),s("g",{id:"PGXAxis2",class:"axis",origin:m.value,transform:"translate(0,"+(_.height/2+10)+")"},null,8,an),r(v).showGrid?(d(),f("g",on,[s("rect",{x:"0",y:"0",width:_.width,height:_.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,nn)])):k("",!0),r(v).showGrid?(d(),f("g",rn,[s("rect",{x:"0",y:_.height/2+10,width:_.width,height:_.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,sn)])):k("",!0)],8,en))}}),cn=["d"],dn=["d","stroke"],un=["x","y","text-anchor"],mt=O({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>{let T=Ge(p.data,C=>C.date);return T[0]&&T[1]?qe().domain(T).range([0,e.width]):qe().range([0,0])}),o=g(()=>Le().range([e.height-10,0]).domain([0,100])),n=g(()=>{let C=bt().x(j=>a.value(j.date)).y(j=>o.value(e.order==2?j.batSoc:j["soc"+u.value.connectedVehicle])??o.value(0))(p.data);return C||""}),i=g(()=>e.order==2?"Speicher":u.value.vehicleName),c=g(()=>{switch(e.order){case 0:return"var(--color-cp1)";case 1:return"var(--color-cp2)";case 2:return"var(--color-battery)";default:return"red"}}),h=g(()=>{switch(e.order){case 0:return e.width-3;case 1:return 3;case 2:return e.width/2;default:return 0}}),u=g(()=>{const T=e.order==2?0:e.order;return Object.values(P)[T]}),m=g(()=>{if(p.data.length>0){let T;switch(e.order){case 0:return T=p.data.length-1,o.value(p.data[T]["soc"+u.value.connectedVehicle]+2);case 1:return T=0,o.value(p.data[T]["soc"+u.value.connectedVehicle]+2);case 2:return T=Math.round(p.data.length/2),o.value(p.data[T].batSoc+2);default:return 0}}else return 0}),_=g(()=>{switch(e.order){case 0:return"end";case 1:return"start";case 2:return"middle";default:return"middle"}});return(T,C)=>(d(),f(X,null,[s("path",{class:"soc-baseline",d:n.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,cn),s("path",{class:"soc-dashes",d:n.value,stroke:c.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,dn),s("text",{class:"cpname",x:h.value,y:m.value,style:ne({fill:c.value,fontSize:10}),"text-anchor":_.value},x(i.value),13,un)],64))}}),hn=["transform"],pn=O({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Le().range([e.height-10,0]).domain([0,100])),o=g(()=>Pa(a.value).ticks(5).tickFormat(i=>i.toString()+"%"));function n(){let i=ye("g#PGSocAxis");i.call(o.value),i.selectAll(".tick").attr("font-size",12),i.selectAll(".tick line").attr("stroke","var(--color-bg)"),i.select(".domain").attr("stroke","var(--color-bg)")}return Ne(()=>{n()}),(i,c)=>(d(),f("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(i.width-20)+",0)"},null,8,hn))}}),gn=t=>(le("data-v-7b8949f3"),t=t(),ce(),t),mn={class:"d-flex align-self-top justify-content-center align-items-center"},fn={class:"input-group input-group-xs"},vn={key:0,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},_n={class:"dropdown-menu"},yn={class:"table optiontable"},bn=["onClick"],wn={key:1,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},kn={class:"dropdown-menu"},Sn={class:"table optiontable"},xn=["onClick"],Mn={key:2,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},$n={class:"dropdown-menu"},Pn={class:"table optiontable"},Cn=["onClick"],In=gn(()=>s("span",{class:"fa-solid fa-circle-check"},null,-1)),Bn=[In],On=O({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=new Date().getFullYear();let n=Array.from({length:10},(j,J)=>o-J);const i=ee(!0),c=e,h=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],u=ee(a.modelValue.getDate()),m=ee(a.modelValue.getMonth()),_=ee(a.modelValue.getFullYear()),T=g(()=>{const J=new Date(_.value,m.value,1).getDay();let Y=0;switch(m.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:Y=31;break;case 4:case 6:case 9:case 11:Y=30;break;case 2:Math.trunc(_.value/4)*4==_.value&&(Y=29)}let M=[],N=[0,0,0,0,0,0,0],D=J;for(let $=0;$<Y;$++)N[D]=$+1,D==6?(M.push(N),N=[0,0,0,0,0,0,0],D=0):D++;return D<8&&M.push(N),M});function C(){c("update:modelValue",new Date(_.value,m.value,u.value)),i.value=!1}return(j,J)=>(d(),f("span",mn,[s("div",fn,[a.mode=="day"||a.mode=="today"?(d(),f("button",vn,x(u.value),1)):k("",!0),s("div",_n,[s("table",yn,[(d(!0),f(X,null,ge(T.value,(Y,M)=>(d(),f("tr",{key:M,class:""},[(d(!0),f(X,null,ge(Y,(N,D)=>(d(),f("td",{key:D},[N!=0?(d(),f("span",{key:0,type:"button",class:"btn optionbutton",onClick:$=>u.value=N},x(N),9,bn)):k("",!0)]))),128))]))),128))])]),a.mode!="year"&&a.mode!="live"?(d(),f("button",wn,x(m.value+1),1)):k("",!0),s("div",kn,[s("table",Sn,[(d(),f(X,null,ge(h,(Y,M)=>s("tr",{key:M,class:""},[(d(!0),f(X,null,ge(Y,(N,D)=>(d(),f("td",{key:D,class:"p-0 m-0"},[s("span",{type:"button",class:"btn btn-sm optionbutton",onClick:$=>m.value=N},x(N+1),9,xn)]))),128))])),64))])]),a.mode!="live"?(d(),f("button",Mn,x(_.value),1)):k("",!0),s("div",$n,[s("table",Pn,[(d(!0),f(X,null,ge(r(n),(Y,M)=>(d(),f("tr",{key:M,class:""},[s("td",null,[s("span",{type:"button",class:"btn optionbutton",onClick:N=>_.value=Y},x(Y),9,Cn)])]))),128))])]),a.mode!="live"?(d(),f("button",{key:3,class:"button-outline-secondary",type:"button",onClick:C},Bn)):k("",!0)])]))}}),Tn=F(On,[["__scopeId","data-v-7b8949f3"]]),Vn={class:"btn-group m-0",role:"group","aria-label":"radiobar"},Ln=["id","value"],An=O({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(h){o("update:modelValue",h)}});function i(h){let u=a.options[h].color?a.options[h].color:"var(--color-fg)";return a.options[h].active?{color:"var(--color-bg)",background:u}:{color:u}}function c(h){let u=h.target;for(;u&&!u.value&&u.parentElement;)u=u.parentElement;u.value&&(n.value=u.value)}return(h,u)=>(d(),f("div",null,[s("div",Vn,[(d(!0),f(X,null,ge(h.options,(m,_)=>(d(),f("button",{id:"radio-"+m.value,key:_,class:K(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",m.value==n.value?"active":""]),value:m.value,style:ne(i(_)),onClick:c},[s("span",{style:ne(i(_))},[m.icon?(d(),f("i",{key:0,class:K(["fa-solid",m.icon])},null,2)):k("",!0),U(" "+x(m.text),1)],4)],14,Ln))),128))])]))}}),ra=F(An,[["__scopeId","data-v-20cf8590"]]),ht=t=>(le("data-v-a73ca9f4"),t=t(),ce(),t),Dn=ht(()=>s("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Gn=[Dn],En=ht(()=>s("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Wn=[En],zn=ht(()=>s("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),jn=[zn],Nn=ht(()=>s("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),Un=[Nn],Fn=O({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean},ignoreLive:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=ee(0),o=g(()=>{switch(p.graphMode){case"live":return e.ignoreLive?"heute":`${ae.duration} min`;case"today":return"heute";case"day":return H.date.getDate()+"."+(H.date.getMonth()+1)+".";case"month":return Ta(ke.month-1,ke.year);case"year":return Oe.year.toString();default:return"???"}}),n=["live","today","day","month","year"],i=["Live","Heute","Tag","Monat","Jahr"],c=g({get(){return p.graphMode},set(D){switch(D){case"day":T();break;case"today":C();break;case"live":_();break;case"month":j();break;case"year":J()}}}),h=g(()=>{switch(p.graphMode){case"live":case"today":return H.getDate();case"month":return ke.getDate();default:return H.getDate()}});function u(D){Et(D)}function m(){a.value+=1,a.value>2&&(a.value=0)}function _(){p.graphMode!="live"&&(p.graphMode="live",re())}function T(){p.graphMode!="day"&&p.graphMode!="today"&&(p.graphMode="day",re())}function C(){p.graphMode!="today"&&(p.graphMode="today",Et(new Date),re())}function j(){p.graphMode!="month"&&(p.graphMode="month",re())}function J(){p.graphMode!="year"&&(p.graphMode="year",re())}const Y=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),M=g(()=>a.value==1?"justify-content-between":"justify-content-end"),N=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(D,$)=>(d(),f("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:ne(Y.value)},[a.value==2?(d(),L(ra,{key:0,id:"pgm2",modelValue:c.value,"onUpdate:modelValue":$[0]||($[0]=w=>c.value=w),class:"m-2",options:n.map((w,b)=>({text:i[b],value:w,color:"var(--color-menu)",active:w==r(p).graphMode}))},null,8,["modelValue","options"])):k("",!0),a.value==1?(d(),f("span",{key:1,type:"button",class:K(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:$[1]||($[1]=w=>D.$emit("shiftUp"))},Gn,2)):k("",!0),s("div",{class:K(["d-flex align-items-center",N.value])},[a.value==1?(d(),f("span",{key:0,type:"button",class:K(["p-1",{disabled:!e.showLeftButton}]),onClick:$[2]||($[2]=w=>D.$emit("shiftLeft"))},Wn,2)):k("",!0),a.value<2?(d(),f("span",{key:1,type:"button",class:"btn-outline-secondary p-2 px-3 badge rounded-pill datebadge",onClick:m},x(o.value),1)):k("",!0),a.value==2?(d(),L(Tn,{key:2,"model-value":h.value,mode:r(p).graphMode,"onUpdate:modelValue":u},null,8,["model-value","mode"])):k("",!0),a.value==1?(d(),f("span",{key:3,id:"graphRightButton",type:"button",class:K(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:$[3]||($[3]=w=>D.$emit("shiftRight"))},null,2)):k("",!0)],2),s("div",{class:K(["d-flex align-items-center",M.value])},[a.value==1?(d(),f("span",{key:0,type:"button",class:"p-1",onClick:m},jn)):k("",!0),a.value==1?(d(),f("span",{key:1,id:"graphLeftButton",type:"button",class:K(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:$[4]||($[4]=w=>D.$emit("shiftDown"))},null,2)):k("",!0),a.value>0?(d(),f("span",{key:2,type:"button",class:"p-1",onClick:$[5]||($[5]=w=>a.value=0)},Un)):k("",!0)],2)],4))}}),sa=F(Fn,[["__scopeId","data-v-a73ca9f4"]]),ia=t=>(le("data-v-bb5945e3"),t=t(),ce(),t),Jn={class:"d-flex justify-content-end"},Rn=ia(()=>s("span",{class:"fa-solid fa-lg ps-1 fa-magnifying-glass"},null,-1)),Hn=[Rn],Yn=["viewBox"],qn=["transform"],Qn={id:"button"},Zn=["x","y"],Xn=ia(()=>s("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},x(""),-1)),Kn=[Xn],er=2,tr="Leistung / Ladestand ",ar=O({__name:"PowerGraph",setup(t){function e(){let o=v.usageStackOrder+1;o>er&&(o=0),v.usageStackOrder=o,Fo(!0)}function a(){v.zoomGraph=!v.zoomGraph}return(o,n)=>(d(),L(ut,{"full-width":!0},{title:S(()=>[U(x(tr))]),buttons:S(()=>[s("div",Jn,[y(sa,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!1,onShiftLeft:r(Bt),onShiftRight:r(aa),onShiftUp:r(oa),onShiftDown:r(na)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"]),r(Ka)?(d(),f("span",{key:0,type:"button",class:"ms-1 p-0 pt-1",onClick:a},Hn)):k("",!0)])]),default:S(()=>[s("figure",{id:"powergraph",class:"p-0 m-0",onClick:e},[(d(),f("svg",{viewBox:"0 0 "+r(we)+" "+r($e)},[y(Zo,{width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G)},null,8,["width","height","margin"]),y(Ko,{width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),"stack-order":r(v).usageStackOrder},null,8,["width","height","margin","stack-order"]),y(ln,{width:r(we)-r(G).left-2*r(G).right,height:r($e)-r(G).top-r(G).bottom,margin:r(G),"graph-data":r(p)},null,8,["width","height","margin","graph-data"]),s("g",{transform:"translate("+r(G).left+","+r(G).top+")"},[(r(p).graphMode=="day"||r(p).graphMode=="today"||r(p).graphMode=="live")&&Object.values(r(P)).length>0?(d(),L(mt,{key:0,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:0},null,8,["width","height","margin"])):k("",!0),(r(p).graphMode=="day"||r(p).graphMode=="today"||r(p).graphMode=="live")&&Object.values(r(P)).length>1?(d(),L(mt,{key:1,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:1},null,8,["width","height","margin"])):k("",!0),(r(p).graphMode=="day"||r(p).graphMode=="today")&&r(q).isBatteryConfigured?(d(),L(mt,{key:2,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:2},null,8,["width","height","margin"])):k("",!0),r(p).graphMode=="day"||r(p).graphMode=="today"?(d(),L(pn,{key:3,width:r(we)-r(G).left-r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G)},null,8,["width","height","margin"])):k("",!0)],8,qn),s("g",Qn,[s("text",{x:r(we),y:r($e)-10,color:"var(--color-menu)","text-anchor":"end"},Kn,8,Zn)])],8,Yn))])]),_:1}))}}),or=F(ar,[["__scopeId","data-v-bb5945e3"]]),nr=["id"],rr=["x","width","height","fill"],sr=["x","width","height"],ir=["x","y","width","height"],lr=O({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),n=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(i,c)=>(d(),f("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[s("rect",{class:"bar",x:e.xScale(i.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:i.item.color},null,8,rr),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,sr),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:o.value,width:e.xScale.bandwidth()*2/3,height:n.value,fill:"var(--color-battery)","fill-opacity":"66%"},null,8,ir)],8,nr))}}),cr={id:"emBargraph"},dr=s("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),ur=O({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(n){if(n.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?z:I.items,h=(p.graphMode=="live"||p.graphMode=="day"?B:I.items).evuOut.energy,u=i.pv.energy;return Math.round((u-h)/u*100)}else if(n.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?z:I.items,c=p.graphMode=="live"||p.graphMode=="day"?B:I.items,h=c.evuOut.energy,u=i.evuIn.energy,m=i.pv.energy,_=i.batOut.energy,T=c.batIn.energy;return Math.round((m+_-h-T)/(m+_+u-h-T)*100)}else return n.pvPercentage}function o(n){return n.name=="PV"?"Eigen":"Aut"}return(n,i)=>(d(),f("g",cr,[(d(!0),f(X,null,ge(e.plotdata,(c,h)=>(d(),f("g",{key:h},[y(lr,{item:c,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(c),autarchy:a(c)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),dr]))}}),hr=["origin"],pr=O({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>dt(e.yScale).tickFormat(n=>n>0?(n/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),o=g(()=>{const n=ye("g#emYAxis");return n.attr("class","axis").call(a.value),n.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),n.selectAll(".tick").attr("font-size",e.fontsize),v.showGrid?n.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):n.selectAll(".tick line").attr("stroke","var(--color-bg)"),n.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(n,i)=>(d(),f("g",{id:"emYAxis",class:"axis",origin:o.value},null,8,hr))}}),gr=["id"],mr=["x","y","font-size"],fr=["x","y","font-size","fill"],vr=["x","y","font-size","fill"],_r=O({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),o=g(()=>{let u=16,m=e.barcount;return m<=5?u=16:m==6?u=14:m>6&&m<=8?u=13:m==9?u=11:m==10?u=10:u=9,u}),n=g(()=>{let u=12,m=e.barcount;return m<=5?u=12:m==6?u=11:m>6&&m<=8||m==9?u=8:m==10?u=7:u=6,u});function i(u,m){return m.length>n.value?m.substring(0,n.value)+".":m}function c(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function h(){return"var(--color-pv)"}return(u,m)=>(d(),f("g",{id:"barlabel-"+e.item.name},[s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":o.value,"text-anchor":"middle",fill:"var(--color-menu)"},x(r(Yt)(u.item.energy,r(v).decimalPlaces,!1)),9,mr),s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.yScale(u.item.energy)-10,"font-size":o.value-2,"text-anchor":"middle",fill:h()},x(c()),9,fr),s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":o.value,"text-anchor":"middle",fill:u.item.color,class:K(u.item.icon.length<=2?"fas":"")},x(i(u.item.name,u.item.icon)),11,vr)],8,gr))}}),yr={id:"emBarLabels"},br=O({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(n){if(n.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?z:I.items,h=(p.graphMode=="live"||p.graphMode=="day"?B:I.items).evuOut.energy,u=i.pv.energy;return Math.round((u-h)/u*100)}else if(n.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?z:I.items,c=p.graphMode=="live"||p.graphMode=="day"?B:I.items,h=c.evuOut.energy,u=i.evuIn.energy,m=i.pv.energy,_=i.batOut.energy,T=c.batIn.energy;return m+_-h-T>0?Math.round((m+_-h-T)/(m+_+u-h-T)*100):0}else return n.pvPercentage}function o(n){return n.name=="PV"?"Eigen":"Aut"}return(n,i)=>(d(),f("g",yr,[(d(!0),f(X,null,ge(e.plotdata,(c,h)=>(d(),f("g",{key:h},[y(_r,{item:c,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(c),autarchy:a(c)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),wr={id:"energymeter",class:"p-0 m-0"},kr={viewBox:"0 0 500 500"},Sr=["transform"],xr=["x"],Mr={key:0},Wt=500,ft=500,zt=12,$r="Energie",Pr=O({__name:"EnergyMeter",setup(t){const e={top:25,bottom:30,left:25,right:0},a=g(()=>{let c=Object.values(z),h=i.value,u=I.values(),m=[];switch(v.debug&&(console.debug("----------------------- source summary -----------------"),console.debug(z),console.debug("----------------------- usage details ------------------"),console.debug(i.value),console.debug("----------------------- historic summary ---------------"),console.debug(I),console.debug("--------------------------------------------------------")),it.value==!0&&(it.value=!1),p.graphMode){default:case"live":case"today":m=c.concat(h).filter(_=>_.energy>0);break;case"day":case"month":case"year":u.length==0?He.value=!0:(He.value=!1,m=u.filter(_=>_.energy>0))}return m}),o=g(()=>_t().range([0,Wt-e.left-e.right]).domain(a.value.map(c=>c.name)).padding(.4)),n=g(()=>Le().range([ft-e.bottom-e.top,15]).domain([0,Ca(a.value,c=>c.energy)])),i=g(()=>{const c=Object.values(P).length,h=Object.values(E).filter(u=>u.configured).length;return[B.evuOut,B.devices,B.charging].concat(c>1?Object.values(P).map(u=>u.toPowerItem()):[]).concat(h>1?Object.values(E).filter(u=>u.configured&&u.showInGraph):[]).concat([B.batIn,B.house])});return(c,h)=>(d(),L(ut,{"full-width":!0},{title:S(()=>[U(x($r))]),buttons:S(()=>[y(sa,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!0,onShiftLeft:r(Bt),onShiftRight:r(aa),onShiftUp:r(oa),onShiftDown:r(na)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:S(()=>[s("figure",wr,[(d(),f("svg",kr,[s("g",{transform:"translate("+e.left+","+e.top+")"},[y(ur,{plotdata:a.value,"x-scale":o.value,"y-scale":n.value,height:ft,margin:e},null,8,["plotdata","x-scale","y-scale"]),y(pr,{"y-scale":n.value,width:Wt,fontsize:zt,config:r(v)},null,8,["y-scale","config"]),s("text",{x:-e.left,y:"-15",fill:"var(--color-axis)","font-size":zt},x(r(p).graphMode=="year"?"MWh":"kWh"),9,xr),y(br,{plotdata:a.value,"x-scale":o.value,"y-scale":n.value,height:ft,margin:e,config:r(v)},null,8,["plotdata","x-scale","y-scale","config"])],8,Sr)]))]),r(He)?(d(),f("p",Mr,"No data")):k("",!0)]),_:1}))}}),la=t=>(le("data-v-de56bb17"),t=t(),ce(),t),Cr=["id"],Ir={class:"modal-dialog modal-lg modal-fullscreen-sm-down"},Br={class:"modal-content"},Or={class:"modal-header"},Tr={class:"modal-title"},Vr=la(()=>s("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[s("i",{class:"fa-solid fa-lg fa-circle-check m-0 p-0"})],-1)),Lr={class:"modal-body",style:{"background-color":"var(--color-fg)"}},Ar=la(()=>s("div",{class:"modal-footer"},null,-1)),Dr=O({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return Ne(()=>{}),(a,o)=>(d(),f("div",{id:e.modalId,class:"modal fade"},[s("div",Ir,[s("div",Br,[s("div",Or,[s("h3",Tr,[ve(a.$slots,"title",{},void 0,!0)]),Vr]),s("div",Lr,[ve(a.$slots,"default",{},void 0,!0)]),Ar])])],8,Cr))}}),vt=F(Dr,[["__scopeId","data-v-de56bb17"]]),Gr={class:"digit",type:"button"},Er=O({__name:"PadButton",props:{modelValue:{},color:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=ee(!1);function n(){o.value=!0,c("update:modelValue",a.modelValue),setTimeout(()=>{o.value=!1},300)}const i=g(()=>o.value?{"background-color":"white",color:"black"}:{"background-color":a.color??"black"}),c=e;return(h,u)=>(d(),f("div",{class:"padbutton",style:ne(i.value),onClick:n},[s("span",Gr,[ve(h.$slots,"default",{},void 0,!0)])],4))}}),et=F(Er,[["__scopeId","data-v-d100237f"]]),ca=t=>(le("data-v-9812d661"),t=t(),ce(),t),Wr={class:"numberpad"},zr={class:"codedisplay"},jr={class:"numberentry"},Nr=ca(()=>s("span",{class:"fas fa-delete-left"},null,-1)),Ur=ca(()=>s("span",{class:"fas fa-circle-check"},null,-1)),Fr=O({__name:"NumberPad",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const o=ee(t.modelValue),n=e,i=g(()=>o.value.length==0?"Bitte geben Sie den PIN ein":"*".repeat(o.value.length));function c(h){h==-1?o.value=o.value.slice(0,-1):h==-2?(n("update:modelValue",o.value),o.value=""):o.value=o.value+h.toString()}return(h,u)=>(d(),f("div",Wr,[s("p",zr,x(i.value),1),s("div",jr,[(d(),f(X,null,ge(9,m=>y(et,{key:m,"model-value":m,"onUpdate:modelValue":c},{default:S(()=>[U(x(m),1)]),_:2},1032,["model-value"])),64)),y(et,{"model-value":0,"onUpdate:modelValue":c},{default:S(()=>[U("0")]),_:1}),y(et,{"model-value":-1,color:"var(--color-devices)","onUpdate:modelValue":c},{default:S(()=>[Nr]),_:1}),y(et,{"model-value":-2,color:"var(--color-devices)","data-bs-dismiss":"modal","onUpdate:modelValue":c},{default:S(()=>[Ur]),_:1})])]))}}),Jr=F(Fr,[["__scopeId","data-v-9812d661"]]),Ke=t=>(le("data-v-871ca405"),t=t(),ce(),t),Rr={class:"statustable"},Hr=Ke(()=>s("span",null,"IP-Adresse:",-1)),Yr=Ke(()=>s("span",null,"Systemzeit:",-1)),qr=Ke(()=>s("span",null,"Version:",-1)),Qr=Ke(()=>s("span",null,"Version (Details):",-1)),Zr=Ke(()=>s("span",null,"Entwicklungszweig:",-1)),Xr=O({__name:"StatusPage",setup(t){return(e,a)=>(d(),f("div",Rr,[Hr,s("span",null,x(r(q).ipAddress),1),Yr,s("span",null,x(new Date(r(q).systemTime*1e3).toLocaleString(void 0)),1),qr,s("span",null,x(r(q).version),1),Qr,s("span",null,x(r(q).versionDetails),1),Zr,s("span",null,x(r(q).devBranch),1)]))}}),Kr=F(Xr,[["__scopeId","data-v-871ca405"]]),es={class:"configitem subgrid"},ts={class:"d-flex align-items-baseline m-0 p-0 grid-col-6"},as={class:"ms-1 mb-2 p-0 pt-2 d-flex justify-content-stretch align-items-center grid-col-6"},os={class:"justify-content-stretch d-flex"},ns=O({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t;return(a,o)=>(d(),f("div",es,[s("span",ts,[e.icon?(d(),f("i",{key:0,class:K(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):k("",!0),U(" "+x(a.title),1)]),s("div",as,[s("span",os,[ve(a.$slots,"default",{},void 0,!0)])])]))}}),R=F(ns,[["__scopeId","data-v-d3cedd29"]]),rs=["id","value"],ss=O({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(h){o("update:modelValue",h)}});function i(h){return a.options[h][2]?{color:a.options[h][2]}:{color:"var(--color-bg)"}}function c(h){let u=h.target;for(;u&&!u.value&&u.parentElement;)u=u.parentElement;u.value&&(n.value=u.value)}return(h,u)=>(d(),f("div",null,[(d(!0),f(X,null,ge(h.options,(m,_)=>(d(),f("button",{id:"radio-"+m[1],key:_,class:K(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",m[1]==n.value?"active":""]),value:m[1],style:ne(i(_)),onClick:c},[s("span",{style:ne(i(_))},[m[3]?(d(),f("i",{key:0,class:K(["fa-solid",m[3]])},null,2)):k("",!0),U(" "+x(m[0]),1)],4)],14,rs))),128))]))}}),je=F(ss,[["__scopeId","data-v-4d4ff52f"]]),is={class:"form-check form-switch"},Te=O({__name:"SwitchInput",props:{modelValue:{type:Boolean},onColor:{},offColor:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(c){o("update:modelValue",c)}}),i=g(()=>n.value?{"background-color":"green"}:{"background-color":"white"});return(c,h)=>(d(),f("div",is,[We(s("input",{"onUpdate:modelValue":h[0]||(h[0]=u=>n.value=u),class:"form-check-input",type:"checkbox",role:"switch",style:ne(i.value)},null,4),[[Ht,n.value]])]))}}),ls=t=>(le("data-v-84acfdfa"),t=t(),ce(),t),cs={class:"settingslist"},ds=ls(()=>s("hr",{class:"grid-col-12"},null,-1)),us=O({__name:"SettingsPage",props:{chargepoint:{}},setup(t){const e=t,a=g({get:()=>e.chargepoint.etActive,set:n=>{P[e.chargepoint.id].etActive=n}}),o=g({get:()=>e.chargepoint.timedCharging,set:n=>{P[e.chargepoint.id].timedCharging=n}});return(n,i)=>(d(),f("div",cs,[r(q).isBatteryConfigured?(d(),L(R,{key:0,title:"PV-Priorität (global)",icon:"fa-car-battery",infotext:"Priority during PV production",fullwidth:!0},{default:S(()=>[y(je,{modelValue:r(q).pvBatteryPriority,"onUpdate:modelValue":i[0]||(i[0]=c=>r(q).pvBatteryPriority=c),options:r(Ja)},null,8,["modelValue","options"])]),_:1})):k("",!0),ds,y(R,{title:"Strompreisbasiert laden",icon:"fa-coins",infotext:"Settings"},{default:S(()=>[y(Te,{modelValue:a.value,"onUpdate:modelValue":i[1]||(i[1]=c=>a.value=c)},null,8,["modelValue"])]),_:1}),y(R,{title:"Zeitplan aktivieren",icon:"fa-coins",infotext:"Settings"},{default:S(()=>[y(Te,{modelValue:o.value,"onUpdate:modelValue":i[2]||(i[2]=c=>o.value=c)},null,8,["modelValue"])]),_:1})]))}}),hs=F(us,[["__scopeId","data-v-84acfdfa"]]);function ps(t,e){t=="openWB/graph/boolDisplayLiveGraph"?q.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?gs(t,e):t=="openWB/graph/lastlivevaluesJson"?ms(t,e):t=="openWB/graph/config/duration"&&(ae.duration=JSON.parse(e))}function gs(t,e){if(!ae.initialized){let a=[];const o=e.toString().split(`
`);o.length>1?a=o.map(c=>JSON.parse(c)):a=[];const n=t.match(/(\d+)$/g),i=n?n[0]:"";i!=""&&typeof ae.rawDataPacks[+i-1]>"u"&&(ae.rawDataPacks[+i-1]=a,ae.initCounter++)}if(ae.initCounter==16){const a=[];ae.unsubscribeRefresh(),ae.initialized=!0,ae.rawDataPacks.map(o=>{o.map(n=>{const i=da(n);a.push(i)})}),Xe(a),ae.subscribeUpdates()}}function ms(t,e){const a=JSON.parse(e),o=da(a);ae.graphRefreshCounter++,Xe(p.data.concat(o)),ae.graphRefreshCounter>60&&ae.activate()}function da(t){const e={};e.date=fs(t.time).valueOf(),+t.grid>0?(e.evuIn=+t.grid,e.evuOut=0):+t.grid<=0?(e.evuIn=0,e.evuOut=-t.grid):(e.evuIn=0,e.evuOut=0),+t["pv-all"]>=0?(e.pv=+t["pv-all"],e.inverter=0):(e.pv=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,t["ev0-soc"]&&(e.soc0=+t["ev0-soc"]),t["ev1-soc"]&&(e.soc1=+t["ev1-soc"]),e.charging=+t["charging-all"];for(let a=0;a<10;a++){const o="cp"+a;e[o]=+(t[o+"-power"]??0)}return e.selfUsage=e.pv-e.evuOut,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function fs(t){const e=new Date(Date.now()),a=864e5;let o=new Date;const n=rt("%H:%M:%S")(t);return n&&(o=n,o.setDate(e.getDate()),o.setMonth(e.getMonth()),o.setFullYear(e.getFullYear()),o.getHours()>e.getHours()&&(o=new Date(o.getTime()-a))),o}const vs=["evuIn","pv","batIn","evuOut"];let ct=[];function _s(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Pt(),ct=[],Ct.map(i=>{I.setEnergyPv(i,0),I.setEnergyBat(i,0)});const n=ys(a);Xe(n),It(o,ct),v.debug&&(console.debug("---------------------------------------- Graph Data ---------------------------"),console.debug("--- Incoming graph data:"),console.debug(a),console.debug("data to be displayed:"),console.debug(n),console.debug("-------------------------------------------------------------------------------")),p.graphMode=="today"&&setTimeout(()=>H.activate(),3e5)}function ys(t){const e=[];let a={};return t.map(o=>{a=bs(o);const n=a;e.push(n)}),e}function bs(t){const e={};if(p.graphMode=="day"||p.graphMode=="today")if(typeof t.date=="number")e.date=new Date(+t.date*1e3).getTime();else{const o=rt("%H:%M")(t.date);o&&(o.setMonth(H.date.getMonth()),o.setDate(H.date.getDate()),o.setFullYear(H.date.getFullYear()),e.date=o.getTime())}else if(typeof t.date=="string"){const o=rt("%Y%m%d")(t.date);o&&(e.date=o.getDate())}return e.evuOut=0,e.evuIn=0,Object.entries(t.counter).forEach(([o,n])=>{n.grid&&(e.evuOut+=n.power_exported,e.evuIn+=n.power_imported,ct.includes(o)||ct.push(o))}),e.evuOut==0&&e.evuIn==0&&Object.entries(t.counter).forEach(o=>{e.evuOut+=o[1].power_exported,e.evuIn+=o[1].power_imported}),e.pv=t.pv.all.power_exported,Object.entries(t.bat).length>0?(e.batIn=t.bat.all.power_imported,e.batOut=t.bat.all.power_exported,e.batSoc=t.bat.all.soc??0):(e.batIn=0,e.batOut=0,e.batSoc=0),Object.entries(t.cp).forEach(([o,n])=>{o!="all"?(e[o]=n.power_imported,I.keys().includes(o)||I.addItem(o)):e.charging=n.power_imported}),Object.entries(t.ev).forEach(([o,n])=>{o!="all"&&(e["soc"+o.substring(2)]=n.soc)}),e.devices=0,Object.entries(t.sh).forEach(([o,n])=>{o!="all"&&(e[o]=n.power_imported??0,e.devices+=n.power_imported??0,I.keys().includes(o)||I.addItem(o))}),e.selfUsage=e.pv-e.evuOut,t.hc&&t.hc.all?e.house=t.hc.all.power_imported:e.house=e.evuIn+e.batOut+e.pv-e.evuOut-e.charging-e.devices-e.batOut,e.evuIn+e.batOut+e.pv>0?I.keys().filter(o=>!vs.includes(o)).map(o=>{Ro(o,e)}):Object.keys(e).map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}let tt={};const Ot=["charging","house","batIn","devices"],ws=["evuIn","pv","batIn","evuOut"];let Ye=[];function ks(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Pt(),Ye=[],Ot.map(n=>{I.items[n].energyPv=0,I.items[n].energyBat=0}),a.length>0&&Xe(ua(a)),It(o,[])}function Ss(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Pt(),Ye=[],Ot.forEach(n=>{I.items[n].energyPv=0,I.items[n].energyBat=0}),Xe(ua(a)),It(o,[])}function ua(t){const e=[];let a={};return tt={},t.map(o=>{a=xs(o),e.push(a),Object.keys(a).forEach(n=>{n!="date"&&(a[n]<0&&(console.warn(`Negative energy value for ${n} in row ${a.date}. Ignoring the value.`),a[n]=0),tt[n]?tt[n]+=a[n]:tt[n]=a[n])})}),e}function xs(t){const e={},a=rt("%Y%m%d")(t.date);a&&(e.date=p.graphMode=="month"?a.getDate():a.getMonth()+1),e.evuOut=0,e.evuIn=0;let o=0,n=0;return Object.entries(t.counter).forEach(([c,h])=>{o+=h.energy_exported,n+=h.energy_imported,h.grid&&(e.evuOut+=h.energy_exported,e.evuIn+=h.energy_imported,Ye.includes(c)||Ye.push(c))}),Ye.length==0&&(e.evuOut=o,e.evuIn=n),e.pv=t.pv.all.energy_exported,Object.entries(t.bat).length>0?(t.bat.all.energy_imported>=0?e.batIn=t.bat.all.energy_imported:(console.warn("ignoring negative value for batIn on day "+e.date),e.batIn=0),t.bat.all.energy_exported>=0?e.batOut=t.bat.all.energy_exported:(console.warn("ignoring negative value for batOut on day "+e.date),e.batOut=0)):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([c,h])=>{c!="all"?(I.keys().includes(c)||I.addItem(c),e[c]=h.energy_imported):e.charging=h.energy_imported}),Object.entries(t.ev).forEach(([c,h])=>{c!="all"&&(e["soc-"+c]=h.soc)}),e.devices=Object.entries(t.sh).reduce((c,h)=>(I.keys().includes(h[0])||I.addItem(h[0]),h[1].energy_imported>=0?c+=h[1].energy_imported:console.warn(`Negative energy value for device ${h[0]} in row ${e.date}. Ignoring this value`),c),0),e.house=e.pv+e.evuIn+e.batOut-e.evuOut-e.batIn-e.charging,e.selfUsage=e.pv-e.evuOut,e.evuIn+e.batOut+e.pv>0?I.keys().filter(c=>!ws.includes(c)).map(c=>{Ho(c,e)}):Ot.map(c=>{e[c+"Pv"]=0,e[c+"Bat"]=0}),e}class Ms{constructor(e){l(this,"id");l(this,"dailyYieldExport",0);l(this,"dailyYieldImport",0);l(this,"exported",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"imported",0);l(this,"power",0);l(this,"soc",0);this.id=e}}class $s{constructor(){l(this,"dailyExport",0);l(this,"dailyImport",0);l(this,"exported",0);l(this,"imported",0);l(this,"power",0);l(this,"soc",0)}}const pe=Q({});Q(new $s);function Ps(t){t in pe?console.info("Duplicate battery message: "+t):pe[t]=new Ms(t)}function Cs(){Object.keys(pe).forEach(t=>{delete pe[parseInt(t)]})}function Is(t,e){const a=Bs(t);if(a&&!(a in pe)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?q.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(B.batIn.power=+e,z.batOut.power=0):(B.batIn.power=0,z.batOut.power=-e):t=="openWB/bat/get/soc"?q.batterySoc=+e:t=="openWB/bat/get/daily_exported"?z.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?B.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?pe[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?pe[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?pe[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?pe[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?pe[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?pe[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?pe[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(pe[a].soc=+e))}function Bs(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Os(t,e){if(t=="openWB/optional/et/provider")JSON.parse(e).type==null?oe.active=!1:(oe.active=!0,oe.etProvider=JSON.parse(e).name);else if(t=="openWB/optional/et/get/prices"){const a=JSON.parse(e);oe.etPriceList=new Map,Object.keys(a).map(o=>{oe.etPriceList.set(new Date(+o*1e3),a[o]*1e5)})}}function Ts(t,e){const a=ha(t);if(a&&!(a in P)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?B.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(B.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")q.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(P[a]){const o=JSON.parse(e);P[a].name=o.name,P[a].icon=o.name,ie["cp"+a]?(ie["cp"+a].name=o.name,ie["cp"+a].icon=o.name):ie["cp"+a]={name:o.name,icon:o.name,color:"var(--color-charging)"}}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))P[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))P[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))P[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))P[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))P[a].dailyYield=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))P[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))P[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))P[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))P[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))P[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))P[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/currents/i))P[a].currents=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const o=JSON.parse(e);P[a].chargedSincePlugged=o.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const o=JSON.parse(e);P[a].soc=o.soc,P[a].waitingForSoc=!1,P[a].rangeCharged=o.range_charged,P[a].rangeUnit=o.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const o=JSON.parse(e);P[a].vehicleName=String(o.name),P[a].updateConnectedVehicle(+o.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const o=JSON.parse(e);switch(o.chargemode){case"instant_charging":P[a].updateChargeMode(_e.instant_charging);break;case"pv_charging":P[a].updateChargeMode(_e.pv_charging);break;case"scheduled_charging":P[a].updateChargeMode(_e.scheduled_charging);break;case"standby":P[a].updateChargeMode(_e.standby);break;case"stop":P[a].updateChargeMode(_e.stop);break}P[a].chargeTemplate=o.charge_template,P[a].averageConsumption=o.average_consumption}}}function Vs(t,e){const a=ha(t);if(a!=null){if(!(a in W)){const o=new za(a);W[a]=o}if(t.match(/^openwb\/vehicle\/[0-9]+\/name$/i))Object.values(P).forEach(o=>{o.connectedVehicle==a&&(o.vehicleName=JSON.parse(e))}),W[a].name=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i))W[a].soc=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i))W[a].range=+e;else if(t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i))W[a].updateChargeTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i))W[a].updateEvTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/soc_module\/config$/i)){const o=JSON.parse(e);Object.values(P).forEach(n=>{n.connectedVehicle==a&&(n.isSocConfigured=o.type!==null,n.isSocManual=o.type=="manual")})}}}function Ls(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],n=JSON.parse(e);de[o]=n,As(o,n)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const n=+a[0].replace(/[^0-9]+/g,""),i=+o[0],c=JSON.parse(e);n in Re||(Re[n]=[]),Re[n][i]=c}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/chargemode\/scheduled_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const n=+a[0].replace(/[^0-9]+/g,""),i=+o[0],c=JSON.parse(e);n in Je||(Je[n]=[]),Je[n][i]=c}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],n=JSON.parse(e);kt[o]=n}}}function As(t,e){Object.values(P).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function ha(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Ds(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?Gs(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&Es(t,e)}function Gs(t,e){const a=pa(t);a!=null&&(a in E||ea(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?E[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?(E[a].name=e.toString(),E[a].icon=e.toString(),ie["sh"+a].name=e.toString(),ie["sh"+a].icon=e.toString()):t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?E[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canSwitch$/i)?E[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_homeConsumtion$/i)?E[a].countAsHouse=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(E[a].tempConfigured=+e))}function Es(t,e){const a=pa(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in E||ea(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))E[a].power=+e,Ws("power");else if(!t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Wh$/i)){if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))E[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))E[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))E[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))E[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:E[a].status="off";break;case 11:E[a].status="on";break;case 20:E[a].status="detection";break;case 30:E[a].status="timeout";break;default:E[a].status="off"}}}function Ws(t){switch(t){case"power":B.devices.power=Object.values(E).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.power,0);break;case"energy":B.devices.energy=Object.values(E).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function pa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}class zs{constructor(e){l(this,"id");l(this,"name","Zähler");l(this,"power",0);l(this,"energy_imported",0);l(this,"energy_exported",0);l(this,"grid",!1);l(this,"type","counter");l(this,"color","var(--color-evu)");l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"icon","");this.id=e}}const fe=Q({});function js(t,e){if(t in fe)console.info("Duplicate counter message: "+t);else switch(fe[t]=new zs(t),fe[t].type=e,e){case"counter":fe[t].color="var(--color-evu)";break;case"inverter":fe[t].color="var(--color-pv)";break;case"cp":fe[t].color="var(--color-charging)";break;case"bat":fe[t].color="var(--color-bat)";break}}const Ns=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#","openWB/command/"+Mt()+"/#","openWB/optional/int_display/#"];function Us(){Ea(Fs),Ns.forEach(t=>{De(t)}),re()}function Fs(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?Js(t,a):t.match(/^openwb\/counter\//i)?Rs(t,a):t.match(/^openwb\/bat\//i)?Is(t,a):t.match(/^openwb\/pv\//i)?Hs(t,a):t.match(/^openwb\/chargepoint\//i)?Ts(t,a):t.match(/^openwb\/vehicle\/template\//i)?Ls(t,a):t.match(/^openwb\/vehicle\//i)?Vs(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?Ys(t,a):t.match(/^openwb\/graph\//i)?ps(t,a):t.match(/^openwb\/log\/daily\//i)?_s(t,a):t.match(/^openwb\/log\/monthly\//i)?ks(t,a):t.match(/^openwb\/log\/yearly\//i)?Ss(t,a):t.match(/^openwb\/optional\/et\//i)?Os(t,a):t.match(/^openwb\/system\//i)?Qs(t,a):t.match(/^openwb\/LegacySmartHome\//i)?Ds(t,a):t.match(/^openwb\/command\//i)?Zs(t,a):t.match(/^openwb\/optional\//i)&&Xs(t,a)}function Js(t,e){const a=t.split("/"),o=+a[2];if(o==q.evuId?qs(t,e):a[3]=="config",a[3]=="get"&&o in fe)switch(a[4]){case"power":fe[o].power=+e;break;case"config":break;case"fault_str":break;case"fault_state":break;case"power_factors":break;case"imported":break;case"exported":break;case"frequency":break;case"daily_imported":fe[o].energy_imported=+e;break;case"daily_exported":fe[o].energy_exported=+e;break}}function Rs(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Na(),Cs();for(const o of a)o.type=="counter"&&(q.evuId=o.id);ga(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?(B.house.power=+e,Ha()):t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(B.house.energy=+e)}function ga(t){switch(t.type){case"counter":js(t.id,t.type);break;case"cp":ja(t.id);break;case"bat":Ps(t.id);break}t.children.forEach(e=>ga(e))}function Hs(t,e){switch(t){case"openWB/pv/get/power":z.pv.power=-e;break;case"openWB/pv/get/daily_exported":z.pv.energy=+e;break}}function Ys(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":q.updatePvBatteryPriority(e=="true");break}}function qs(t,e){switch(t.split("/")[4]){case"power":+e>0?(z.evuIn.power=+e,B.evuOut.power=0):(z.evuIn.power=0,B.evuOut.power=-e);break;case"daily_imported":z.evuIn.energy=+e;break;case"daily_exported":B.evuOut.energy=+e;break}}function Qs(t,e){if(t.match(/^openWB\/system\/device\/[0-9]+\/component\/[0-9]+\/config$/i)){const a=JSON.parse(e);a.type=="counter"&&(fe[a.id].name=a.name)}else t.match(/^openWB\/system\/ip_address$/i)?q.ipAddress=JSON.parse(e):t.match(/^openWB\/system\/time$/i)?q.systemTime=JSON.parse(e):t.match(/^openWB\/system\/version$/i)?q.version=JSON.parse(e):t.match(/^openWB\/system\/current_commit$/i)?q.versionDetails=JSON.parse(e):t.match(/^openWB\/system\/current_branch$/i)&&(q.devBranch=JSON.parse(e))}function Zs(t,e){const a=t.split("/");if(t.match(/^openWB\/command\/[a-z]+\/error$/i)&&a[2]==Mt()){const o=JSON.parse(e);console.error(`Error message from openWB: 
Command: ${o.command}
Data: JSON.stringify(err.data)
Error:
 ${o.error}`)}}function Xs(t,e){if(t.match(/^openwb\/optional\/int_display\/active$/i))ue.active=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/only_local_charge_points$/i))ue.localCpOnly=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/theme$/i)){const a=JSON.parse(e);ue.usePin=a.configuration.lock_changes,ue.code=a.configuration.lock_changes_code}}const Ks={class:"d-flex flex-column align-items-center justify-content-start infoitem"},ei=O({__name:"InfoItem",props:{heading:{},small:{type:Boolean}},setup(t){const e=t,a=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-small)"}),o=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-normal)"}),n=g(()=>e.small?"mt-0":"mt-1");return(i,c)=>(d(),f("span",Ks,[s("span",{class:K(["d-flex heading",n.value]),style:ne(a.value)},x(e.heading),7),s("span",{class:"d-flex my-0 me-0 align-items-center content",style:ne(o.value)},[ve(i.$slots,"default",{},void 0,!0)],4)]))}}),he=F(ei,[["__scopeId","data-v-f6af00e8"]]),ma=t=>(le("data-v-17a828b1"),t=t(),ce(),t),ti={class:"d-flex flex-column"},ai={class:"d-flex flex-fill justify-content-between align-items-center"},oi=ma(()=>s("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)),ni=[oi],ri=["id","min","max","step"],si=ma(()=>s("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)),ii=[si],li={class:"d-flex justify-content-between align-items-center"},ci={class:"minlabel ps-4"},di={class:"valuelabel"},ui={class:"maxlabel pe-4"},hi=O({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},decimals:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=a.decimals??0,n=e,i=g({get(){return Math.round(a.modelValue*Math.pow(10,o))/Math.pow(10,o)},set(u){n("update:modelValue",u)}});function c(){i.value>a.min&&(i.value=Math.round((i.value-a.step)*Math.pow(10,o))/Math.pow(10,o))}function h(){i.value<a.max&&(i.value=Math.round((i.value+a.step)*Math.pow(10,o))/Math.pow(10,o))}return(u,m)=>(d(),f("span",ti,[s("span",ai,[s("span",{type:"button",class:"minusButton",onClick:c},ni),We(s("input",{id:u.id,"onUpdate:modelValue":m[0]||(m[0]=_=>i.value=_),type:"range",class:"form-range flex-fill",min:u.min,max:u.max,step:u.step},null,8,ri),[[Ia,i.value,void 0,{number:!0}]]),s("span",{type:"button",class:"plusButton",onClick:h},ii)]),s("span",li,[s("span",ci,x(u.min),1),s("span",di,x(i.value)+" "+x(u.unit),1),s("span",ui,x(u.max),1)])]))}}),Ve=F(hi,[["__scopeId","data-v-17a828b1"]]),pi=t=>(le("data-v-0303d179"),t=t(),ce(),t),gi={class:"mt-2"},mi=pi(()=>s("p",{class:"heading ms-1"},"Sofortladen:",-1)),fi={key:0},vi=O({__name:"CPConfigInstant",props:{chargepoint:{}},setup(t){const a=ee(t.chargepoint),o=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}],n=g({get(){return a.value.instantMaxEnergy/1e3},set(i){a.value.instantMaxEnergy=i*1e3}});return(i,c)=>(d(),f("div",gi,[mi,y(R,{title:"Stromstärke",icon:"fa-bolt",fullwidth:!0},{default:S(()=>[y(Ve,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value.instantTargetCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(d(),f("hr",fi)):k("",!0),y(R,{title:"Begrenzung",icon:"fa-hand",fullwidth:!0},{default:S(()=>[y(je,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":c[1]||(c[1]=h=>a.value.instantChargeLimitMode=h),options:o.map(h=>[h.name,h.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(d(),L(R,{key:1,title:"Maximaler SoC",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[y(Ve,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":c[2]||(c[2]=h=>a.value.instantTargetSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):k("",!0),a.value.instantChargeLimitMode=="amount"?(d(),L(R,{key:2,title:"Zu ladende Energie",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[y(Ve,{id:"maxEnergy",modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=h=>n.value=h),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):k("",!0)]))}}),_i=F(vi,[["__scopeId","data-v-0303d179"]]),fa=t=>(le("data-v-1a90f282"),t=t(),ce(),t),yi={class:"pt-2"},bi=fa(()=>s("p",{class:"heading ms-1"},"PV-Laden:",-1)),wi={class:"form-check form-switch"},ki=fa(()=>s("hr",null,null,-1)),Si={key:2},xi=O({__name:"CPConfigPv",props:{chargepoint:{}},setup(t){const a=ee(t.chargepoint),o=g({get(){return a.value.pvMinCurrent>5},set(i){i?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),n=g({get(){return a.value.pvMinSoc>0},set(i){i?a.value.pvMinSoc=50:a.value.pvMinSoc=0}});return(i,c)=>(d(),f("div",yi,[bi,y(R,{title:"Maximaler Ladestand",icon:"fa-battery-three-quarters",fullwidth:!0},{default:S(()=>[y(Ve,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value.pvMaxSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),y(R,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:S(()=>[s("div",wi,[We(s("input",{id:"feedInLimitSwitch","onUpdate:modelValue":c[1]||(c[1]=h=>a.value.pvFeedInLimit=h),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[Ht,a.value.pvFeedInLimit]])])]),_:1}),ki,y(R,{title:"Minimaler Ladestand",icon:"fa-battery-half",infotext:r(Pe).minsoc,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:n.value,"onUpdate:modelValue":c[2]||(c[2]=h=>n.value=h)},null,8,["modelValue"])]),_:1},8,["infotext"]),n.value?(d(),L(R,{key:0,title:"...bis SoC",fullwidth:!0},{info:S(()=>[U(x(r(Pe).minsoc),1)]),default:S(()=>[y(Ve,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":c[3]||(c[3]=h=>a.value.pvMinSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):k("",!0),n.value?(d(),L(R,{key:1,title:"...mit Ladestrom",fullwidth:!0},{default:S(()=>[y(Ve,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":c[4]||(c[4]=h=>a.value.pvMinSocCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):k("",!0),o.value||n.value?(d(),f("hr",Si)):k("",!0),y(R,{title:"Minimaler Ladestrom",icon:"fa-bolt",infotext:r(Pe).minpv,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:o.value,"onUpdate:modelValue":c[5]||(c[5]=h=>o.value=h)},null,8,["modelValue"])]),_:1},8,["infotext"]),o.value?(d(),L(R,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:S(()=>[y(Ve,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":c[6]||(c[6]=h=>a.value.pvMinCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):k("",!0)]))}}),Mi=F(xi,[["__scopeId","data-v-1a90f282"]]),va=t=>(le("data-v-e8f5ad9d"),t=t(),ce(),t),$i=va(()=>s("p",{class:"heading ms-1 pt-2"},"Zielladen:",-1)),Pi={class:"table table-borderless"},Ci=va(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Ziel"),s("th",{class:"tableheader"},"Limit"),s("th",{class:"tableheader"},"Zeit"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader"})])],-1)),Ii={class:"tablecell"},Bi={class:"tablecell"},Oi={class:"tablecell"},Ti={class:"tablecell"},Vi={class:"tablecell left"},Li=["href"],Ai=O({__name:"CPConfigScheduled",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,o=g(()=>{let h=[];return Je[a.chargeTemplateId]&&(h=Object.values(Je[a.chargeTemplateId])),h});function n(h){return o.value[h].time}function i(h){return{color:o.value[h].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function c(h){return{"font-weight":o.value[h].active?"bold":"regular"}}return(h,u)=>(d(),f(X,null,[$i,s("table",Pi,[Ci,s("tbody",null,[(d(!0),f(X,null,ge(o.value,(m,_)=>(d(),f("tr",{key:_,style:ne(c(_))},[s("td",Ii,x(m.limit.soc_scheduled)+"%",1),s("td",Bi,x(m.limit.soc_limit)+"%",1),s("td",Oi,x(n(_)),1),s("td",Ti,x(e[m.frequency.selected]),1),s("td",Vi,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:K([m.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:ne(i(_)),type:"button"},null,6)],8,Li)])],4))),128))])])],64))}}),Di=F(Ai,[["__scopeId","data-v-e8f5ad9d"]]),_a=t=>(le("data-v-192e287b"),t=t(),ce(),t),Gi=_a(()=>s("p",{class:"heading ms-1 pt-2"},"Zeitpläne:",-1)),Ei={class:"table table-borderless"},Wi=_a(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Von"),s("th",{class:"tableheader"},"Bis"),s("th",{class:"tableheader"},"Ladestrom"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader right"})])],-1)),zi={class:"tablecell"},ji={class:"tablecell"},Ni={class:"tablecell"},Ui={class:"tablecell"},Fi={class:"tablecell left"},Ji=["href"],Ri=O({__name:"CPConfigTimed",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,o=g(()=>Re[a.chargeTemplateId]?Object.values(Re[a.chargeTemplateId])??[]:[]);function n(c){return{color:o.value[c].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function i(c){return{"font-weight":o.value[c].active?"bold":"regular"}}return(c,h)=>(d(),f(X,null,[Gi,s("table",Ei,[Wi,s("tbody",null,[(d(!0),f(X,null,ge(o.value,(u,m)=>(d(),f("tr",{key:m,style:ne(i(m))},[s("td",zi,x(u.time[0]),1),s("td",ji,x(u.time[1]),1),s("td",Ni,x(u.current)+" A",1),s("td",Ui,x(e[u.frequency.selected]),1),s("td",Fi,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:K([u.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:ne(n(m)),type:"button"},null,6)],8,Ji)])],4))),128))])])],64))}}),Hi=F(Ri,[["__scopeId","data-v-192e287b"]]),Yi={class:"settingsheader mt-2 ms-1"},qi=O({__name:"CPConfigVehicle",props:{vehicleId:{}},setup(t){const e=t;return(a,o)=>(d(),f(X,null,[s("p",Yi," Profile für "+x(r(W)[e.vehicleId].name)+": ",1),y(R,{title:"Ladeprofil",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[y(je,{modelValue:r(W)[e.vehicleId].chargeTemplateId,"onUpdate:modelValue":o[0]||(o[0]=n=>r(W)[e.vehicleId].chargeTemplateId=n),modelModifiers:{number:!0},options:Object.keys(r(de)).map(n=>[r(de)[+n].name,n])},null,8,["modelValue","options"])]),_:1}),y(R,{title:"Fahrzeug-Vorlage",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[y(je,{modelValue:r(W)[e.vehicleId].evTemplateId,"onUpdate:modelValue":o[1]||(o[1]=n=>r(W)[e.vehicleId].evTemplateId=n),modelModifiers:{number:!0},options:Object.keys(r(kt)).map(n=>[r(kt)[+n].name,n])},null,8,["modelValue","options"])]),_:1})],64))}}),Qi=F(qi,[["__scopeId","data-v-fcb57a44"]]),Zi={class:"settingsheader mt-2 ms-1"},Xi=O({__name:"CPChargeConfig",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint;return(o,n)=>(d(),f(X,null,[s("p",Zi," Ladeeinstellungen für "+x(r(a).vehicleName)+": ",1),y(R,{title:"Lademodus",icon:"fa-charging-station",infotext:r(Pe).chargemode,fullwidth:!0},{default:S(()=>[y(je,{modelValue:r(a).chargeMode,"onUpdate:modelValue":n[0]||(n[0]=i=>r(a).chargeMode=i),options:Object.keys(r(Ie)).map(i=>[r(Ie)[i].name,i,r(Ie)[i].color,r(Ie)[i].icon])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),y(R,{title:"Fahrzeug wechseln",icon:"fa-car",infotext:r(Pe).vehicle,fullwidth:!0},{default:S(()=>[y(je,{modelValue:r(a).connectedVehicle,"onUpdate:modelValue":n[1]||(n[1]=i=>r(a).connectedVehicle=i),modelModifiers:{number:!0},options:Object.values(r(W)).map(i=>[i.name,i.id])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),y(R,{title:"Sperren",icon:"fa-lock",infotext:r(Pe).locked,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:r(a).isLocked,"onUpdate:modelValue":n[2]||(n[2]=i=>r(a).isLocked=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),y(R,{title:"Priorität",icon:"fa-star",infotext:r(Pe).priority,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:r(a).hasPriority,"onUpdate:modelValue":n[3]||(n[3]=i=>r(a).hasPriority=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),y(R,{title:"Zeitplan",icon:"fa-clock",infotext:r(Pe).timeplan,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:r(a).timedCharging,"onUpdate:modelValue":n[4]||(n[4]=i=>r(a).timedCharging=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),r(oe).active?(d(),L(R,{key:0,title:"Strompreisbasiert laden",icon:"fa-money-bill",infotext:r(Pe).pricebased,fullwidth:!0},{default:S(()=>[y(Te,{modelValue:r(a).etActive,"onUpdate:modelValue":n[5]||(n[5]=i=>r(a).etActive=i)},null,8,["modelValue"])]),_:1},8,["infotext"])):k("",!0)],64))}}),Ki=F(Xi,[["__scopeId","data-v-a64493d7"]]),ya=t=>(le("data-v-5286b19d"),t=t(),ce(),t),el=ya(()=>s("p",{class:"settingsheader mt-2 ms-1"},"Preisbasiertes Laden:",-1)),tl={class:"providername ms-1"},al=ya(()=>s("hr",null,null,-1)),ol={class:"container"},nl={id:"pricechart",class:"p-0 m-0"},rl={viewBox:"0 0 400 300"},sl=["id","origin","transform"],il={key:0,class:"p-3"},ll={key:1,class:"d-flex justify-content-end"},cl=["disabled"],Ue=400,jt=250,Nt=12,dl=O({__name:"PriceChart",props:{chargepoint:{},globalview:{type:Boolean}},setup(t){const e=t;let a=e.chargepoint?ee(e.chargepoint.etMaxPrice):ee(0);const o=ee(!1),n=ee(e.chargepoint),i=g({get(){return a.value},set(b){a.value=b,o.value=!0}});function c(){n.value&&(P[n.value.id].etMaxPrice=i.value),o.value=!1}const h=ee(!1),u={top:0,bottom:15,left:20,right:5},m=g(()=>{let b=[];return oe.etPriceList.size>0&&oe.etPriceList.forEach((V,A)=>{b.push([A,V])}),b}),_=g(()=>m.value.length>1?(Ue-u.left-u.right)/m.value.length-1:0),T=g(()=>o.value?{background:"var(--color-charging)"}:{background:"var(--color-menu)"}),C=g(()=>{let b=Ge(m.value,V=>V[0]);return qe().range([u.left,Ue-u.left-u.right]).domain(b)}),j=g(()=>{let b=Ge(m.value,V=>V[1]);return b[0]=Math.floor(b[0]-1),b[1]=Math.floor(b[1]+1),b}),J=g(()=>Le().range([jt-u.bottom,0]).domain(j.value)),Y=g(()=>{const b=bt(),V=[[u.left,J.value(i.value)],[Ue-u.right,J.value(i.value)]];return b(V)}),M=g(()=>{const b=bt(),V=[[u.left,J.value(0)],[Ue-u.right,J.value(0)]];return b(V)}),N=g(()=>at(C.value).ticks(6).tickSize(5).tickFormat(yt("%H:%M"))),D=g(()=>dt(J.value).ticks(6).tickSizeInner(-(Ue-u.right-u.left)).tickFormat(b=>b.toString())),$=g(()=>{h.value==!0;const b=ye("g#"+w.value);b.selectAll("*").remove(),b.selectAll("bar").data(m.value).enter().append("g").append("rect").attr("class","bar").attr("x",Ae=>C.value(Ae[0])).attr("y",Ae=>J.value(Ae[1])).attr("width",_.value).attr("height",Ae=>J.value(j.value[0])-J.value(Ae[1])).attr("fill",Ae=>Ae[1]<=i.value?"var(--color-charging)":"var(--color-axis)");const A=b.append("g").attr("class","axis").call(N.value);A.attr("transform","translate(0,"+(jt-u.bottom)+")"),A.selectAll(".tick").attr("font-size",Nt).attr("color","var(--color-bg)"),A.selectAll(".tick line").attr("stroke","var(--color-fg)").attr("stroke-width","0.5"),A.select(".domain").attr("stroke","var(--color-bg");const se=b.append("g").attr("class","axis").call(D.value);return se.attr("transform","translate("+u.left+",0)"),se.selectAll(".tick").attr("font-size",Nt).attr("color","var(--color-bg)"),se.selectAll(".tick line").attr("stroke","var(--color-bg)").attr("stroke-width","0.5"),se.select(".domain").attr("stroke","var(--color-bg)"),j.value[0]<0&&b.append("path").attr("d",M.value).attr("stroke","var(--color-fg)"),b.append("path").attr("d",Y.value).attr("stroke","yellow"),"PriceChart.vue"}),w=g(()=>e.chargepoint?"priceChartCanvas"+e.chargepoint.id:"priceChartCanvasGlobal");return Ne(()=>{h.value=!h.value}),(b,V)=>(d(),f(X,null,[el,s("p",tl,"Anbieter: "+x(r(oe).etProvider),1),al,s("div",ol,[s("figure",nl,[(d(),f("svg",rl,[s("g",{id:w.value,origin:$.value,transform:"translate("+u.top+","+u.right+")"},null,8,sl)]))])]),b.chargepoint!=null?(d(),f("div",il,[b.chargepoint.etActive?(d(),L(Ve,{key:0,id:"foo",modelValue:i.value,"onUpdate:modelValue":V[0]||(V[0]=A=>i.value=A),min:-25,max:95,step:.1,decimals:1,unit:"ct"},null,8,["modelValue"])):k("",!0)])):k("",!0),b.chargepoint!=null?(d(),f("div",ll,[s("span",{class:"me-3 pt-0",onClick:c},[s("button",{type:"button",class:"btn btn-secondary",style:ne(T.value),disabled:!o.value}," Bestätigen ",12,cl)])])):k("",!0)],64))}}),ul=F(dl,[["__scopeId","data-v-5286b19d"]]),Ee=t=>(le("data-v-fdc511bd"),t=t(),ce(),t),hl={class:"status-string"},pl={style:{color:"red"}},gl={class:"m-0 mt-4 p-0 grid-col-12 tabarea"},ml={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},fl=["data-bs-target"],vl=Ee(()=>s("i",{class:"fa-solid fa-charging-station"},null,-1)),_l=[vl],yl=["data-bs-target"],bl=Ee(()=>s("i",{class:"fa-solid fa-lg fa-bolt"},null,-1)),wl=[bl],kl=["data-bs-target"],Sl=Ee(()=>s("i",{class:"fa-solid fa-solar-panel me-1"},null,-1)),xl=[Sl],Ml=["data-bs-target"],$l=Ee(()=>s("i",{class:"fa-solid fa-bullseye me-1"},null,-1)),Pl=[$l],Cl=["data-bs-target"],Il=Ee(()=>s("i",{class:"fa-solid fa-clock"},null,-1)),Bl=[Il],Ol=["data-bs-target"],Tl=Ee(()=>s("i",{class:"fa-solid fa-rectangle-list"},null,-1)),Vl=[Tl],Ll=["data-bs-target"],Al=Ee(()=>s("i",{class:"fa-solid fa-chart-line"},null,-1)),Dl=[Al],Gl={id:"settingsPanes",class:"tab-content mx-1 p-1 pb-3"},El=["id"],Wl=["id"],zl=["id"],jl=["id"],Nl=["id"],Ul=["id"],Fl=["id"],Jl=O({__name:"CPChargeConfigPanel",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint,o=g(()=>de[a.chargeTemplate]),n=g(()=>a.id);return Ne(()=>{}),(i,c)=>(d(),f(X,null,[y(R,{title:"Status",icon:"fa-info-circle",fullwidth:!0,class:"item"},{default:S(()=>[s("span",hl,x(r(a).stateStr),1)]),_:1}),r(a).faultState!=0?(d(),L(R,{key:0,title:"Fehler",class:"grid-col-12"},{default:S(()=>[s("span",pl,x(r(a).faultStr),1)]),_:1})):k("",!0),s("div",gl,[s("nav",ml,[s("a",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+n.value},_l,8,fl),i.chargepoint.chargeMode=="instant_charging"?(d(),f("a",{key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+n.value},wl,8,yl)):k("",!0),i.chargepoint.chargeMode=="pv_charging"?(d(),f("a",{key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+n.value},xl,8,kl)):k("",!0),i.chargepoint.chargeMode=="scheduled_charging"?(d(),f("a",{key:2,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+n.value},Pl,8,Ml)):k("",!0),i.chargepoint.timedCharging?(d(),f("a",{key:3,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+n.value},Bl,8,Cl)):k("",!0),s("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#carSettings"+n.value},Vl,8,Ol),r(oe).active&&r(a).etActive?(d(),f("a",{key:4,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#priceChart"+n.value},Dl,8,Ll)):k("",!0)]),s("div",Gl,[s("div",{id:"chargeSettings"+n.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[y(Ki,{chargepoint:i.chargepoint},null,8,["chargepoint"])],8,El),s("div",{id:"instantSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[y(_i,{chargepoint:r(a),vehicles:r(W),"charge-templates":r(de)},null,8,["chargepoint","vehicles","charge-templates"])],8,Wl),s("div",{id:"pvSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[y(Mi,{chargepoint:r(a),vehicles:r(W),"charge-templates":r(de)},null,8,["chargepoint","vehicles","charge-templates"])],8,zl),s("div",{id:"scheduledSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[o.value!=null?(d(),L(Di,{key:0,"charge-template-id":r(a).chargeTemplate},null,8,["charge-template-id"])):k("",!0)],8,jl),s("div",{id:"timeSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[o.value!=null?(d(),L(Hi,{key:0,"charge-template-id":r(a).chargeTemplate},null,8,["charge-template-id"])):k("",!0)],8,Nl),s("div",{id:"carSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"car-tab"},[r(W)[r(a).connectedVehicle]!=null?(d(),L(Qi,{key:0,"vehicle-id":r(a).connectedVehicle},null,8,["vehicle-id"])):k("",!0)],8,Ul),s("div",{id:"priceChart"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"price-tab"},[r(W)[r(a).connectedVehicle]!=null?(d(),L(ul,{key:0,chargepoint:r(a)},null,8,["chargepoint"])):k("",!0)],8,Fl)])])],64))}}),Rl=F(Jl,[["__scopeId","data-v-fdc511bd"]]),Hl=O({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=10?"fa-battery-empty":e.soc<50?"fa-battery-quarter":e.soc<75?"fa-battery-half":e.soc<95?"fa-battery-three-quarters":"fa-battery-full");return(o,n)=>(d(),f("span",null,[s("i",{class:K(["fa batIcon",a.value])},null,2),U(" "+x(Math.round(o.soc)+"%"),1)]))}}),Yl=F(Hl,[["__scopeId","data-v-a0bd055c"]]),ql=O({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Yt(e.wattH,v.decimalPlaces));return(o,n)=>(d(),f("span",null,x(a.value),1))}}),ba=t=>(le("data-v-7ca9921b"),t=t(),ce(),t),Ql=ba(()=>s("span",{class:"fa-solid fa-charging-station"}," ",-1)),Zl={key:0},Xl={class:"grid12"},Kl={class:"targetCurrent"},ec={key:1,class:"row m-0 mt-0 p-0"},tc={class:"col m-0 p-0"},ac={key:0},oc={class:"row"},nc={class:"col"},rc={class:"d-flex justify-content-between align-items-center"},sc=ba(()=>s("i",{class:"fa-solid fa-sm fa-car me-2"},null,-1)),ic={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},lc={key:1,class:"me-0 fa-solid fa-xs fa-coins ps-0"},cc={class:"grid12"},dc={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},uc={type:"button"},hc=O({__name:"CPChargePoint",props:{chargepoint:{}},setup(t){const e=t,a=ee(e.chargepoint),o=g({get(){return e.chargepoint.chargeMode},set(M){ue.locked?St():P[e.chargepoint.id].chargeMode=M}}),n=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),i=g(()=>(Math.round(e.chargepoint.realCurrent*10)/10).toLocaleString(void 0)+" A"),c=g(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),h=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),u=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),m=g(()=>{let M="";return e.chargepoint.isLocked?M="fa-lock":e.chargepoint.isCharging?M=" fa-bolt":e.chargepoint.isPluggedIn&&(M="fa-plug"),"fa "+M}),_=g(()=>e.chargepoint.soc),T=g(()=>({color:e.chargepoint.color})),C=g(()=>e.chargepoint.etMaxPrice>=+J.value?{color:"var(--color-charging)"}:{color:"var(--color-menu)"}),j=ee(!1),J=g(()=>{const[M]=oe.etPriceList.values();return(Math.round(M*10)/10).toFixed(1)});function Y(){ue.locked?St():new Ut("#settingspage").toggle()}return(M,N)=>j.value?k("",!0):(d(),L(ut,{key:0,"variable-width":!0},{title:S(()=>[s("span",{style:ne(T.value)},[Ql,U(" "+x(e.chargepoint.name),1)],4)]),buttons:S(()=>[y(Be,{color:"var(--color-charging)",icon:"fa-edit",onClick:Y},{default:S(()=>[U(" Einstellungen")]),_:1})]),footer:S(()=>[j.value?k("",!0):(d(),f("div",ac,[s("div",oc,[s("div",nc,[s("div",rc,[s("h3",null,[sc,U(" "+x(M.chargepoint.vehicleName)+" ",1),M.chargepoint.hasPriority?(d(),f("span",ic)):k("",!0),M.chargepoint.etActive?(d(),f("span",lc)):k("",!0)])])])]),s("div",cc,[M.chargepoint.isSocConfigured?(d(),L(he,{key:0,heading:"Ladestand:",class:"grid-col-4 grid-left"},{default:S(()=>[y(Yl,{soc:_.value,class:"me-2"},null,8,["soc"])]),_:1})):k("",!0),M.chargepoint.isSocConfigured?(d(),L(he,{key:1,heading:"Reichweite:",class:"grid-col-4"},{default:S(()=>[U(x(r(W)[e.chargepoint.connectedVehicle]?Math.round(r(W)[e.chargepoint.connectedVehicle].range):0)+" km ",1)]),_:1})):k("",!0),y(he,{heading:"Zeitplan:",class:"grid-col-4 grid-right"},{default:S(()=>[M.chargepoint.timedCharging?(d(),f("span",dc)):k("",!0),U(" "+x(e.chargepoint.timedCharging?"Ja":"Nein"),1)]),_:1}),r(oe).active?(d(),L(he,{key:2,heading:"Preisladen:",class:"grid-col-4 grid-left"},{default:S(()=>[U(x(a.value.etActive?"Ja":"Nein"),1)]),_:1})):k("",!0),r(oe).active?(d(),L(he,{key:3,heading:"max. Preis:",class:"grid-col-4"},{default:S(()=>[s("span",uc,x(e.chargepoint.etActive?(Math.round(e.chargepoint.etMaxPrice*10)/10).toFixed(1)+" ct":"-"),1)]),_:1})):k("",!0),r(oe).active?(d(),L(he,{key:4,heading:"akt. Preis:",class:"grid-col-4 grid-right"},{default:S(()=>[s("span",{style:ne(C.value)},x(J.value)+" ct ",5)]),_:1})):k("",!0),y(ra,{id:"chargemode-"+M.chargepoint.name,modelValue:o.value,"onUpdate:modelValue":N[0]||(N[0]=D=>o.value=D),class:"chargemodes mt-3 mb-3",options:Object.keys(r(Ie)).map(D=>({text:r(Ie)[D].name,value:D,color:r(Ie)[D].color,icon:r(Ie)[D].icon,active:r(Ie)[D].mode==M.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])])]))]),default:S(()=>[j.value?k("",!0):(d(),f("div",Zl,[s("div",Xl,[y(he,{heading:"Status:",class:"grid-col-4 grid-left"},{default:S(()=>[s("span",{style:ne({color:u.value})},[s("i",{class:K(m.value)},null,2),U(" "+x(h.value),1)],4)]),_:1}),y(he,{heading:"Geladen:",class:"grid-col-4"},{default:S(()=>[y(ql,{"watt-h":M.chargepoint.dailyYield},null,8,["watt-h"])]),_:1}),y(he,{heading:"gel. Reichw.:",class:"grid-col-4 grid-right"},{default:S(()=>[U(x(c.value),1)]),_:1}),e.chargepoint.power>0?(d(),L(he,{key:0,heading:"Leistung:",class:"grid-col-3 grid-left"},{default:S(()=>[y(ta,{watt:e.chargepoint.power},null,8,["watt"])]),_:1})):k("",!0),e.chargepoint.power>0?(d(),L(he,{key:1,heading:"Strom:",class:"grid-col-3"},{default:S(()=>[U(x(i.value),1)]),_:1})):k("",!0),e.chargepoint.power>0?(d(),L(he,{key:2,heading:"Phasen:",class:"grid-col-3"},{default:S(()=>[U(x(e.chargepoint.phasesInUse),1)]),_:1})):k("",!0),e.chargepoint.power>0?(d(),L(he,{key:3,heading:"Sollstrom:",class:"grid-col-3 grid-right"},{default:S(()=>[s("span",Kl,x(n.value),1)]),_:1})):k("",!0)])])),j.value?(d(),f("div",ec,[s("div",tc,[M.chargepoint!=null?(d(),L(Rl,{key:0,chargepoint:M.chargepoint},null,8,["chargepoint"])):k("",!0)])])):k("",!0)]),_:1}))}}),pc=F(hc,[["__scopeId","data-v-7ca9921b"]]),gc={class:"content"},mc={class:"leftside"},fc={class:"rightside"},vc=O({__name:"DisplayTheme",setup(t){function e(o){Ra(o)&&(ue.locked=!1,setTimeout(()=>{ue.locked=!0},ue.timeout*1e3))}Ne(()=>{window.addEventListener("resize",Xa),window.addEventListener("focus",a),Us()});function a(){document.hasFocus()&&re()}return(o,n)=>(d(),f(X,null,[s("div",gc,[s("div",mc,[We(s("div",null,[y(No)],512),[[pt,r(v).graphToShow=="powermeter"]]),We(s("div",null,[y(or)],512),[[pt,r(v).graphToShow=="powergraph"]]),We(s("div",null,[y(Pr)],512),[[pt,r(v).graphToShow=="energymeter"]])]),s("div",fc,[Object.values(r(P)).length>r(v).cpToShow?(d(),L(pc,{key:0,chargepoint:Object.values(r(P))[r(v).cpToShow],"full-width":!0},null,8,["chargepoint"])):k("",!0)])]),y(vt,{"modal-id":"numberpad"},{title:S(()=>[U("PIN Eingeben")]),default:S(()=>[y(Jr,{"model-value":"","onUpdate:modelValue":e})]),_:1}),y(vt,{"modal-id":"statuspage"},{title:S(()=>[U("Systemstatus")]),default:S(()=>[y(Kr)]),_:1}),Object.values(r(P)).length>r(v).cpToShow?(d(),L(vt,{key:0,"modal-id":"settingspage"},{title:S(()=>[U("Einstellungen für "+x(Object.values(r(P))[r(v).cpToShow].name)+" / "+x(Object.values(r(P))[r(v).cpToShow].vehicleName),1)]),default:S(()=>[y(hs,{chargepoint:Object.values(r(P))[r(v).cpToShow]},null,8,["chargepoint"])]),_:1})):k("",!0)],64))}}),_c=F(vc,[["__scopeId","data-v-fa9f7a78"]]),yc={class:"fixeddisplay"},bc=O({__name:"App",setup(t){return(e,a)=>(d(),f("div",yc,[y(_c),y(po)]))}}),wc=F(bc,[["__scopeId","data-v-75d14554"]]),kc=Ba(wc);kc.mount("#app");
