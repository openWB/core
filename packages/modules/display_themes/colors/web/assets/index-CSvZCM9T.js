var pa=Object.defineProperty;var ga=(t,e,a)=>e in t?pa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var l=(t,e,a)=>(ga(t,typeof e!="symbol"?e+"":e,a),a);import{m as ma,r as Q,a as ee,d as V,o as c,c as f,n as Y,b as w,e as le,f as J,g,s as ve,h as Ze,i as fa,j as k,w as C,k as q,p as ce,l as ue,q as s,t as Gt,u as Et,v as va,x as B,y as T,z as n,F as te,A as pe,B as De,C as mt,D as Oe,E as zt,G as lt,H as at,I as Fe,J as et,K as ft,L as _a,M as Ye,N as vt,O as ya,P as ba,Q as ot,R as Ge,S as wa,T as jt,U as dt,V as ka,W as Sa,X as xa}from"./vendor-U1h4_w4Q.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const Ma=0,Ut={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clean:!1,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},rt={topic:"",qos:Ma};let fe;const{host:$a,port:Pa,endpoint:Ca,...Ft}=Ut,Ia=`${Ft.protocol}://${$a}:${Pa}${Ca}`;try{fe=ma.connect(Ia,Ft),fe.on("connect",()=>{console.info("MQTT connection successful")}),fe.on("disconnect",()=>{console.info("MQTT disconnected")}),fe.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}function Ba(t){fe?fe.on("message",t):console.error("MqttRegister: MQTT client not available")}function Ve(t){rt.topic=t;const{topic:e,qos:a}=rt;fe.subscribe(e,{qos:a},o=>{if(o){console.error("MQTT Subscription error: "+o);return}})}function Ee(t){rt.topic=t;const{topic:e}=rt;fe.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}async function _t(t,e){let o=fe.connected,r=0;for(;!o&&r<10;)console.warn("MQTT publish: Not connected. Waiting 0.1 seconds"),await Oa(100),o=fe.connected,r+=1;if(r<10)try{fe.publish(t,e,{qos:0},i=>{i&&console.warn("MQTT publish error: ",i),console.info("MQTT publish: Message sent: ["+t+"]("+e+")")})}catch(i){console.warn("MQTT publish: caught error: "+i)}else console.error("MQTT publish: Lost connection to MQTT server. Please reload the page")}function wt(){return Ut.clientId}function Oa(t){return new Promise(e=>setTimeout(e,t))}class La{constructor(e){l(this,"id");l(this,"name","Ladepunkt");l(this,"icon","Ladepunkt");l(this,"type","");l(this,"ev",0);l(this,"template",0);l(this,"connectedPhases",0);l(this,"phase_1",0);l(this,"autoPhaseSwitchHw",!1);l(this,"controlPilotInterruptionHw",!1);l(this,"isEnabled",!0);l(this,"isPluggedIn",!1);l(this,"isCharging",!1);l(this,"_isLocked",!1);l(this,"_connectedVehicle",0);l(this,"chargeTemplate",0);l(this,"evTemplate",0);l(this,"_chargeMode","pv_charging");l(this,"_hasPriority",!1);l(this,"currentPlan","");l(this,"averageConsumption",0);l(this,"vehicleName","");l(this,"rangeCharged",0);l(this,"rangeUnit","");l(this,"counter",0);l(this,"dailyYield",0);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"phasesInUse",0);l(this,"power",0);l(this,"chargedSincePlugged",0);l(this,"stateStr","");l(this,"current",0);l(this,"currents",[0,0,0]);l(this,"phasesToUse",0);l(this,"isSocConfigured",!0);l(this,"isSocManual",!1);l(this,"waitingForSoc",!1);l(this,"color","white");l(this,"_timedCharging",!1);l(this,"_instantChargeLimitMode","");l(this,"_instantTargetCurrent",0);l(this,"_instantTargetSoc",0);l(this,"_instantMaxEnergy",0);l(this,"_pvFeedInLimit",!1);l(this,"_pvMinCurrent",0);l(this,"_pvMaxSoc",0);l(this,"_pvMinSoc",0);l(this,"_pvMinSocCurrent",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,X("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,X("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get soc(){return z[this.connectedVehicle]?z[this.connectedVehicle].soc:0}set soc(e){z[this.connectedVehicle]&&(z[this.connectedVehicle].soc=e)}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,X("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,X("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get timedCharging(){return ie[this.chargeTemplate]?ie[this.chargeTemplate].time_charging.active:!1}set timedCharging(e){ie[this.chargeTemplate].time_charging.active=e,X("cpTimedCharging",e,this.chargeTemplate)}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,X("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,X("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,X("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,X("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,X("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,X("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,X("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,X("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,X("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}get realCurrent(){switch(this.phasesInUse){case 0:return 0;case 1:return this.currents[0];case 2:return(this.currents[0]+this.currents[1])/2;case 3:return(this.currents[0]+this.currents[1]+this.currents[2])/3;default:return 0}}get etActive(){return z[this.connectedVehicle]?z[this.connectedVehicle].etActive:!1}set etActive(e){z[this.connectedVehicle]&&(z[this.connectedVehicle].etActive=e)}get etMaxPrice(){return z[this.connectedVehicle].etMaxPrice??0}set etMaxPrice(e){console.log("Setting et max price needs to be implemented"),X("cpEtMaxPrice",Math.round(e*10)/1e6,this.id)}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class Ta{constructor(e){l(this,"id");l(this,"name","");l(this,"_chargeTemplateId",0);l(this,"_evTemplateId",0);l(this,"tags",[]);l(this,"config",{});l(this,"soc",0);l(this,"range",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,X("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,X("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}get etActive(){return ie[this.chargeTemplateId]?ie[this.chargeTemplateId].et.active:!1}set etActive(e){ie[this.chargeTemplateId]&&X("priceCharging",e,this.chargeTemplateId)}get etMaxPrice(){if(ie[this.chargeTemplateId]&&ie[this.chargeTemplateId].et.active)return ie[this.chargeTemplateId].et.max_price*1e5}get chargepoint(){for(const e of Object.values(P))if(e.connectedVehicle==this.id)return e}}var me=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(me||{});const P=Q({}),z=Q({}),ie=Q({}),Ne=Q({}),Je=Q({}),yt=Q({});function Aa(t){t in P||(P[t]=new La(t),P[t].color="var(--color-cp"+(Object.values(P).length-1)+")")}function Va(){Object.keys(P).forEach(t=>{delete P[parseInt(t)]})}const Da={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpTimedCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",cpEtMaxPrice:"openWB/set/vehicle/template/charge_template/%/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control",socUpdate:"openWB/set/vehicle/%/get/force_soc_update",setSoc:"openWB/set/vehicle/%/soc_module/calculated_soc_state/manual_soc",priceCharging:"openWB/set/vehicle/template/charge_template/%/et/active"};function X(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let o=Da[t];if(!o){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpEtMaxPrice":case"cpPvMinSocCurrent":o=o.replace("%",P[a].chargeTemplate.toString());break;default:o=o.replace("%",String(a))}switch(typeof e){case"number":_t(o,JSON.stringify(+e));break;default:_t(o,JSON.stringify(e))}}function kt(t){_t("openWB/set/command/"+wt()+"/todo",JSON.stringify(t))}class Wa{constructor(){l(this,"batterySoc",0);l(this,"isBatteryConfigured",!0);l(this,"chargeMode","0");l(this,"_pvBatteryPriority",!1);l(this,"displayLiveGraph",!0);l(this,"isEtEnabled",!0);l(this,"etMaxPrice",0);l(this,"etCurrentPrice",0);l(this,"cpDailyExported",0);l(this,"evuId",0);l(this,"etProvider","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,X("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const se=Q({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""},cp1:{name:"Ladepunkt",color:"var(--color-cp1)",icon:"Ladepunkt"},cp2:{name:"Ladepunkt",color:"var(--color-cp2)",icon:"Ladepunkt"},cp3:{name:"Ladepunkt",color:"var(--color-cp3)",icon:"Ladepunkt"},cp4:{name:"Ladepunkt",color:"var(--color-cp4)",icon:"Ladepunkt"},cp5:{name:"Ladepunkt",color:"var(--color-cp5)",icon:"Ladepunkt"},cp6:{name:"Ladepunkt",color:"var(--color-cp6)",icon:"Ladepunkt"},cp7:{name:"Ladepunkt",color:"var(--color-cp7)",icon:"Ladepunkt"},cp8:{name:"Ladepunkt",color:"var(--color-cp8)",icon:"Ladepunkt"},sh1:{name:"Gerät",color:"var(--color-sh1)",icon:"Gerät"},sh2:{name:"Gerät",color:"var(--color-sh2)",icon:"Gerät"},sh3:{name:"Gerät",color:"var(--color-sh3)",icon:"Gerät"},sh4:{name:"Gerät",color:"var(--color-sh4)",icon:"Gerät"},sh5:{name:"Gerät",color:"var(--color-sh5)",icon:"Gerät"},sh6:{name:"Gerät",color:"var(--color-sh6)",icon:"Gerät"},sh7:{name:"Gerät",color:"var(--color-sh7)",icon:"Gerät"},sh8:{name:"Gerät",color:"var(--color-sh8)",icon:"Gerät"},sh9:{name:"Gerät",color:"var(--color-sh9)",icon:"Gerät"}});class Nt{constructor(){l(this,"_items",{});this.addItem("evuIn"),this.addItem("pv"),this.addItem("batOut"),this.addItem("evuOut"),this.addItem("charging"),this.addItem("devices"),this.addItem("batIn"),this.addItem("house")}get items(){return this._items}keys(){return Object.keys(this._items)}values(){return Object.values(this._items)}addItem(e){this._items[e]=Ce(e)}setEnergy(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energy=a}setEnergyPv(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyPv=a}setEnergyBat(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyBat=a}setPvPercentage(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].pvPercentage=a}calculateHouseEnergy(){this._items.house.energy=this._items.evuIn.energy+this._items.pv.energy+this._items.batOut.energy-this._items.evuOut.energy-this._items.batIn.energy-this._items.charging.energy-this._items.devices.energy}}let I=new Nt;function St(){I=new Nt}const j=Q({evuIn:Ce("evuIn"),pv:Ce("pv"),batOut:Ce("batOut")}),O=Q({evuOut:Ce("evuOut"),charging:Ce("charging"),devices:Ce("devices"),batIn:Ce("batIn"),house:Ce("house")}),Se=Q(new Wa);ee("");const nt=ee(!1);function Ce(t){return{name:se[t]?se[t].name:"item",power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:se[t]?se[t].color:"var(--color-charging)",icon:se[t]?se[t].icon:""}}function Ga(){O.house.power=O.house.power-O.devices.power}const Ea=ee(new Date),za=V({__name:"DisplayButton",props:{icon:{},color:{}},emits:["click"],setup(t,{emit:e}){const a=t,o=e;function r(){o("click",!0)}return(i,d)=>(c(),f("div",{style:J({"background-color":a.color?a.color:"var(--color-menu)"}),class:"mybutton",onClick:r},[a.icon?(c(),f("span",{key:0,class:Y(["fas me-2",a.icon])},null,2)):w("",!0),le(i.$slots,"default",{},void 0,!0)],4))}}),H=(t,e)=>{const a=t.__vccOpts||t;for(const[o,r]of e)a[o]=r;return a},Te=H(za,[["__scopeId","data-v-107f5e74"]]);class ja{constructor(e){l(this,"id");l(this,"name","Gerät");l(this,"power",0);l(this,"status","off");l(this,"energy",0);l(this,"runningTime",0);l(this,"configured",!1);l(this,"_showInGraph",!0);l(this,"color","white");l(this,"canSwitch",!1);l(this,"countAsHouse",!1);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"tempConfigured",0);l(this,"temp",[300,300,300]);l(this,"on",!1);l(this,"isAutomatic",!0);l(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,Z()}setShowInGraph(e){this._showInGraph=e}}const E=Q({});function Jt(t){t in E?console.info("Duplicate sh device message: "+t):(E[t]=new ja(t),E[t].color="var(--color-sh"+Object.values(E).length+")")}class Ua{constructor(){l(this,"graphToShow","powermeter");l(this,"cpToShow",0);l(this,"displayLocked",!0);l(this,"_showRelativeArcs",!1);l(this,"showTodayGraph",!0);l(this,"_graphPreference","live");l(this,"_usageStackOrder",0);l(this,"_displayMode","dark");l(this,"_showGrid",!1);l(this,"_smartHomeColors","normal");l(this,"_decimalPlaces",1);l(this,"_showQuickAccess",!0);l(this,"_simpleCpList",!1);l(this,"_shortCpList","no");l(this,"_showAnimations",!0);l(this,"_preferWideBoxes",!1);l(this,"_maxPower",4e3);l(this,"_fluidDisplay",!1);l(this,"_showClock","no");l(this,"_showButtonBar",!0);l(this,"_showCounters",!1);l(this,"_showVehicles",!1);l(this,"_showPrices",!1);l(this,"_debug",!1);l(this,"isEtEnabled",!1);l(this,"etPrice",20.5);l(this,"showRightButton",!0);l(this,"showLeftButton",!0);l(this,"animationDuration",300);l(this,"animationDelay",100);l(this,"zoomGraph",!1)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,Z()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,Z()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,Z()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,Ra(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,Z()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,Z()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,Ct(e),Z()}setSmartHomeColors(e){this._smartHomeColors=e,Ct(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,Z()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,Z()}setSimpleCpList(e){this._simpleCpList=e}get shortCpList(){return this._shortCpList}set shortCpList(e){this._shortCpList=e,Z()}setShortCpList(e){this._shortCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,Z()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,Z()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,Z()}setMaxPower(e){this._maxPower=e}get fluidDisplay(){return this._fluidDisplay}set fluidDisplay(e){this._fluidDisplay=e,Z()}setFluidDisplay(e){this._fluidDisplay=e}get showClock(){return this._showClock}set showClock(e){this._showClock=e,Z()}setShowClock(e){this._showClock=e}get debug(){return this._debug}set debug(e){this._debug=e,Z()}setDebug(e){this._debug=e}get showButtonBar(){return this._showButtonBar}set showButtonBar(e){this._showButtonBar=e,Z()}setShowButtonBar(e){this._showButtonBar=e}get showCounters(){return this._showCounters}set showCounters(e){this._showCounters=e,Z()}setShowCounters(e){this._showCounters=e}get showVehicles(){return this._showVehicles}set showVehicles(e){this._showVehicles=e,Z()}setShowVehicles(e){this._showVehicles=e}get showPrices(){return this._showPrices}set showPrices(e){this._showPrices=e,Z()}setShowPrices(e){this._showPrices=e}}const y=Q(new Ua),Fa=992,bt=Q({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function Na(){bt.x=document.documentElement.clientWidth,bt.y=document.documentElement.clientHeight}const Ja=g(()=>bt.x>=Fa),be={stop:{mode:me.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:me.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:me.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:me.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:me.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function Z(){Ha()}function Ra(t){const e=ve("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),Z()}function Ct(t){const e=ve("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}const Pe={chargemode:"Der Lademodus für das Fahrzeug an diesem Ladepunkt",vehicle:"Das Fahrzeug, das an diesem Ladepounkt geladen wird",locked:"Für das Laden sperren",priority:"Fahrzeuge mit Priorität werden bevorzugt mit mehr Leistung geladen, falls verfügbar",timeplan:"Das Laden nach Zeitplan für dieses Fahrzeug aktivieren",minsoc:"Immer mindestens bis zum eingestellten Ladestand laden. Wenn notwendig mit Netzstrom.",minpv:"Durchgehend mit mindestens dem eingestellten Strom laden. Wenn notwendig mit Netzstrom.",pricebased:"Laden bei dynamischem Stromtarif, wenn eingestellter Maximalpreis unterboten wird."};function Ha(){const t={};t.hideSH=Object.values(E).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=y.graphPreference=="live",t.displayM=y.displayMode,t.stackO=y.usageStackOrder,t.showGr=y.showGrid,t.decimalP=y.decimalPlaces,t.smartHomeC=y.smartHomeColors,t.relPM=y.showRelativeArcs,t.maxPow=y.maxPower,t.showQA=y.showQuickAccess,t.simpleCP=y.simpleCpList,t.shortCP=y.shortCpList,t.animation=y.showAnimations,t.wideB=y.preferWideBoxes,t.fluidD=y.fluidDisplay,t.clock=y.showClock,t.showButtonBar=y.showButtonBar,t.showCounters=y.showCounters,t.showVehicles=y.showVehicles,t.showPrices=y.showPrices,t.debug=y.debug,document.cookie="openWBColorTheme="+JSON.stringify(t)+";max-age=16000000;samesite=strict"}const ze=t=>(ce("data-v-7ad1d79d"),t=t(),ue(),t),Ya={class:"navigation"},qa=ze(()=>s("span",{class:"timedisplay"},"17:45",-1)),Qa=ze(()=>s("span",{class:"fas fa-arrow-left px-2"},null,-1)),Za=ze(()=>s("span",{class:"fas fa-charging-station pe-2"},null,-1)),Xa=ze(()=>s("span",{class:"fas fa-charging-station px-2"},null,-1)),Ka=ze(()=>s("span",{class:"fas fa-arrow-right pe-2"},null,-1)),eo=ze(()=>s("span",{class:"fas fa-lock px-4"},null,-1)),to=V({__name:"NavigationBar",setup(t){let e;function a(){console.log("Charge Point clicked");let p=Object.values(P).length;y.cpToShow=(y.cpToShow+1)%p}function o(){console.log("Charge Point clicked");let p=Object.values(P).length;y.cpToShow=((y.cpToShow-1)%p+p)%p,console.log(y.cpToShow)}function r(){y.graphToShow="powermeter"}function i(){y.graphToShow="powergraph"}function d(){y.graphToShow="energymeter"}return Ze(()=>{e=setInterval(()=>{Ea.value=new Date},1e3)}),fa(()=>{clearInterval(e)}),(p,u)=>(c(),f("div",Ya,[qa,k(Te,{onClick:o},{default:C(()=>[Qa,Za]),_:1}),k(Te,{onClick:a},{default:C(()=>[Xa,Ka]),_:1}),k(Te,{color:"var(--color-evu)"},{default:C(()=>[eo]),_:1}),k(Te,null,{default:C(()=>[q("Status")]),_:1}),k(Te,{icon:"fa-chart-pie",onClick:r},{default:C(()=>[q("Leistung")]),_:1}),k(Te,{icon:"fa-chart-line",onClick:i},{default:C(()=>[q("Verlauf")]),_:1}),k(Te,{icon:"fa-chart-column",onClick:d},{default:C(()=>[q("Energie")]),_:1})]))}}),ao=H(to,[["__scopeId","data-v-7ad1d79d"]]),oo=["origin"],ro=V({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},r=j;r["zz-empty"]=o;const i=Object.values(j).length-1,d=Gt().value(v=>v.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),p=Et().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),u=ve("g#pmSourceArc");return u.selectAll("*").remove(),u.selectAll("sources").data(d(Object.values(r))).enter().append("path").attr("d",p).attr("fill",v=>v.data.color).attr("stroke",(v,_)=>_==i?v.data.power>0?"var(--color-scale)":"null":v.data.color),"pmSourceArc.vue"});return va(()=>{let o=j.pv.power+j.evuIn.power+j.batOut.power;o>y.maxPower&&(y.maxPower=o)}),(o,r)=>(c(),f("g",{id:"pmSourceArc",origin:a.value},null,8,oo))}}),no=["origin"],so=V({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const r=[O.evuOut,O.charging].concat(Object.values(E).filter(v=>v.configured&&!v.countAsHouse).sort((v,_)=>_.power-v.power)).concat([O.batIn,O.house]).concat(o),i=r.length-1,d=Gt().value(v=>v.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),p=Et().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),u=ve("g#pmUsageArc");return u.selectAll("*").remove(),u.selectAll("consumers").data(d(r)).enter().append("path").attr("d",p).attr("fill",v=>v.data.color).attr("stroke",(v,_)=>_==i?v.data.power>0?"var(--color-scale)":"null":v.data.color),"pmUsageArc.vue"});return(o,r)=>(c(),f("g",{id:"pmUsageArc",origin:a.value},null,8,no))}});function tt(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Rt(t,e=1,a=!1){let o;if(t>1e6&&(a=!0,t=t/1e3),t>=1e3&&e<4){switch(e){case 0:o=Math.round(t/1e3);break;case 1:o=(Math.round(t/100)/10).toFixed(1);break;case 2:o=(Math.round(t/10)/100).toFixed(2);break;case 3:o=(Math.round(t)/1e3).toFixed(3);break;default:o=Math.round(t/100)/10;break}return o.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function io(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}const Ht=V({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>tt(e.watt,y.decimalPlaces));return(o,r)=>B(a.value)}}),lo={key:0,id:"pmLabel"},co=["x","y","fill","text-anchor"],uo=22,_e=V({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),o=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),r=g(()=>!e.data||e.data.power>0),i=g(()=>e.labeltext?"":"fas");return(d,p)=>r.value?(c(),f("g",lo,[s("text",{x:d.x,y:d.y,fill:o.value,"text-anchor":d.anchor,"font-size":uo,class:"pmLabel"},[s("tspan",{class:Y(i.value)},B(a.value),3),s("tspan",null,[d.data!==void 0?(c(),T(Ht,{key:0,watt:d.data.power},null,8,["watt"])):w("",!0)])],8,co)])):w("",!0)}}),ho={class:"wb-widget p-0 m-0 shadow"},po={class:"d-flex justify-content-between"},go={class:"m-4 me-0 mb-0"},mo=s("div",{class:"p-0"},"(title goes here)",-1),fo={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},vo={class:"px-4 pt-4 pb-2 wb-subwidget"},_o={class:"row"},yo={class:"col m-0 p-0"},bo={class:"container-fluid m-0 p-0"},wo={key:0},ko=s("hr",null,null,-1),So={class:"px-4 py-2 wb-subwidget"},xo={class:"row"},Mo={class:"col"},$o={class:"container-fluid m-0 p-0"},ct=V({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&y.preferWideBoxes?"col-lg-6":"col-lg-4");return(o,r)=>(c(),f("div",{class:Y(["p-2 m-0 d-flex",a.value])},[s("div",ho,[s("div",po,[s("h3",go,[le(o.$slots,"title",{},()=>[mo]),le(o.$slots,"subtitle")]),s("div",fo,[le(o.$slots,"buttons")])]),s("div",vo,[s("div",_o,[s("div",yo,[s("div",bo,[le(o.$slots,"default")])])])]),o.$slots.footer!=null?(c(),f("div",wo,[ko,s("div",So,[s("div",xo,[s("div",Mo,[s("div",$o,[le(o.$slots,"footer")])])])])])):w("",!0)])],2))}});class Po{constructor(){l(this,"active",!1);l(this,"etPriceList",new Map);l(this,"etProvider","");l(this,"etMaxPrice",0)}get etCurrentPriceString(){const[e]=oe.etPriceList.values();return(Math.round(e*10)/10).toFixed(1)+" ct"}}const oe=Q(new Po),Co={id:"powermeter",class:"p-0 m-0"},Io=["viewBox"],Bo=["transform"],Oo=["transform"],Lo=["x"],xe=500,Me=20,It=1,To=V({__name:"PowerMeter",setup(t){const e=xe,a=Math.PI/40,o=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],r=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],i=g(()=>xe/2-Me),d=g(()=>{let A="",U=Object.values(j).filter(G=>G.power>0);return U.length==1&&U[0].name=="PV"?A="Aktueller Verbrauch: ":A="Bezug/Verbrauch: ",A+tt(O.house.power+O.charging.power+O.devices.power+O.batIn.power,y.decimalPlaces)}),p=g(()=>{let A=j.pv.power+j.evuIn.power+j.batOut.power;return y.maxPower>A?tt(y.maxPower,y.decimalPlaces):tt(A,y.decimalPlaces)}),u=g(()=>Object.values(P)),v=g(()=>{let A=0;return y.showRelativeArcs&&(A=y.maxPower-(j.pv.power+j.evuIn.power+j.batOut.power)),A<0?0:A}),_=g(()=>[O.evuOut,O.charging,O.devices,O.batIn,O.house].filter(A=>A.power>0)),L=g(()=>o[_.value.length-1]);function M(A){return r[L.value[A]]}function F(A){return Math.round(u.value[A].soc)}function D(A){return A.length>12?A.slice(0,11)+".":A}const N=g(()=>{const[A]=oe.etPriceList.values();return Math.round(A*10)/10});return(A,U)=>(c(),T(ct,{"full-width":!0},{title:C(()=>[q(" Aktuelle Leistung ")]),default:C(()=>[s("figure",Co,[(c(),f("svg",{viewBox:"0 0 "+xe+" "+n(e)},[s("g",{transform:"translate("+xe/2+","+n(e)/2+")"},[s("g",{transform:"scale(0.9294,1)"},[k(ro,{radius:i.value,"corner-radius":It,"circle-gap-size":a,"empty-power":v.value},null,8,["radius","empty-power"]),k(so,{"sh-device":n(E),radius:i.value,"corner-radius":It,"circle-gap-size":a,"empty-power":v.value},null,8,["sh-device","radius","empty-power"]),k(_e,{x:0,y:-n(e)/10*2,data:n(j).pv,props:n(se).pv,anchor:"middle",config:n(y)},null,8,["y","data","props","config"]),k(_e,{x:0,y:-n(e)/10*3,data:n(j).evuIn,props:n(se).evuIn,anchor:"middle",config:n(y)},null,8,["y","data","props","config"]),k(_e,{x:0,y:-n(e)/10,data:n(j).batOut,props:n(se).batOut,anchor:"middle",config:n(y)},null,8,["y","data","props","config"]),n(oe).active?(c(),T(_e,{key:0,x:0,y:-n(e)/10,data:n(j).batOut,props:n(se).batOut,anchor:"middle",config:n(y)},null,8,["y","data","props","config"])):w("",!0),(c(!0),f(te,null,pe(_.value,(G,S)=>(c(),T(_e,{key:S,x:M(S).x,y:M(S).y,data:G,labelicon:G.icon,labelcolor:G.color,anchor:"middle",config:n(y)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),u.value.length>0&&n(z)[u.value[0].connectedVehicle]?(c(),T(_e,{key:1,x:-xe/2-Me/4+10,y:-n(e)/2+Me+5,labeltext:D(n(z)[u.value[0].connectedVehicle].name)+": "+F(0)+"%",labelcolor:u.value[0].color,anchor:"start",config:n(y)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),u.value.length>1&&n(z)[u.value[1].connectedVehicle]?(c(),T(_e,{key:2,x:xe/2+Me/4-10,y:-n(e)/2+Me+5,labeltext:D(n(z)[u.value[1].connectedVehicle].name)+": "+F(1)+"%",labelcolor:u.value[1].color,anchor:"end",config:n(y)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),n(Se).batterySoc>0?(c(),T(_e,{key:3,x:-xe/2-Me/4+10,y:n(e)/2-Me+15,labeltext:"Speicher: "+n(Se).batterySoc+"%",labelcolor:n(O).batIn.color,anchor:"start",config:n(y)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),n(oe).active?(c(),T(_e,{key:4,x:xe/2+Me/4-10,y:n(e)/2-Me+15,value:N.value,labeltext:n(oe).etCurrentPriceString,labelcolor:"var(--color-charging)",anchor:"end",config:n(y)},null,8,["x","y","value","labeltext","config"])):w("",!0),k(_e,{x:0,y:0,labeltext:d.value,labelcolor:"var(--color-fg)",anchor:"middle",config:n(y)},null,8,["labeltext","config"]),n(y).showRelativeArcs?(c(),f("text",{key:5,x:xe/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+B(p.value),9,Lo)):w("",!0)],8,Oo)],8,Bo)],8,Io))])]),_:1}))}}),ye=500,$e=500,W={top:10,right:20,bottom:10,left:25},xt=["charging","house","batIn","devices"];class Ao{constructor(){l(this,"data",[]);l(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const h=Q(new Ao);let st=!0,qe=!0;function Bt(){st=!1}function Ot(){qe=!1}function Vo(t){qe=t}function Xe(t){h.data=t}const ae=Q({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){h.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),Ve(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[],zo(),nt.value=!0},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),Ee(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)Ve(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)Ee(this.refreshTopicPrefix+t)},subscribeUpdates(){Ve(this.updateTopic)},unsubscribeUpdates(){Ee(this.updateTopic)}}),R=Q({topic:"openWB/log/daily/#",date:new Date,activate(){if(h.graphMode=="day"||h.graphMode=="today"){h.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");Ve(this.topic),kt({command:"getDailyLog",data:{day:t}})}},deactivate(){Ee(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),we=Q({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");h.data=[],Ve(this.topic),kt({command:"getMonthlyLog",data:{month:t}})},deactivate(){Ee(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){const t=new Date;t.getFullYear()==this.year?this.month-1<t.getMonth()&&(this.month=this.month+1):(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1)),this.activate()},getDate(){return new Date(this.year,this.month)}}),Be=Q({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();h.data=[],Ve(this.topic),kt({command:"getYearlyLog",data:{year:t}})},deactivate(){Ee(this.topic)},back(){this.year-=1,this.activate()},forward(){this.year<new Date().getFullYear()&&(this.year=this.year+1,this.activate())},getDate(){return new Date(this.year,this.month)}});function re(t=!1){switch(h.graphMode==""?Do(y.graphPreference):h.graphMode=="live"?y.graphPreference="live":y.graphPreference="today",t||(st=!0,qe=!0),h.graphMode){case"live":R.deactivate(),we.deactivate(),Be.deactivate(),ae.activate();break;case"today":ae.deactivate(),we.deactivate(),Be.deactivate(),R.activate();break;case"day":ae.deactivate(),we.deactivate(),Be.deactivate(),R.activate();break;case"month":ae.deactivate(),R.deactivate(),Be.deactivate(),we.activate();break;case"year":ae.deactivate(),R.deactivate(),we.deactivate(),Be.activate();break}}function Do(t){h.graphMode=t}function Wo(t,e){e[t]>0&&(I.items[t].energyPv+=1e3/12*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),I.items[t].energyBat+=1e3/12*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}function Go(t,e){e[t]>0&&(I.items[t].energyPv+=1e3*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),I.items[t].energyBat+=1e3*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}const Eo=["evuIn","pv","batIn","evuOut"],Re=ee(!1);function Mt(t,e){Object.entries(t).length>0?(Re.value=!1,Object.entries(t.counter).forEach(([a,o])=>{(e.length==0||e.includes(a))&&(I.items.evuIn.energy+=o.energy_imported,I.items.evuOut.energy+=o.energy_exported)}),I.items.pv.energy=t.pv.all.energy_exported,t.bat.all&&(I.items.batIn.energy=t.bat.all.energy_imported,I.items.batOut.energy=t.bat.all.energy_exported),Object.entries(t.cp).forEach(([a,o])=>{a=="all"?I.setEnergy("charging",o.energy_imported):I.setEnergy(a,o.energy_imported)}),I.setEnergy("devices",0),Object.entries(t.sh).forEach(([a,o])=>{I.setEnergy(a,o.energy_imported);const r=a.substring(2);E[+r].countAsHouse||(I.items.devices.energy+=o.energy_imported)}),t.hc&&t.hc.all?I.setEnergy("house",t.hc.all.energy_imported):I.calculateHouseEnergy(),I.keys().map(a=>{Eo.includes(a)||(I.setPvPercentage(a,Math.round((I.items[a].energyPv+I.items[a].energyBat)/I.items[a].energy*100)),xt.includes(a)&&(O[a].energy=I.items[a].energy,O[a].energyPv=I.items[a].energyPv,O[a].energyBat=I.items[a].energyBat,O[a].pvPercentage=I.items[a].pvPercentage))}),h.graphMode=="today"&&(Object.values(P).map(a=>{const o=I.items["cp"+a.id];o&&(a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}),Object.values(E).map(a=>{const o=I.items["sh"+a.id];o&&(a.energy=o.energy,a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}))):Re.value=!0,nt.value=!0}function zo(){I.keys().map(t=>{xt.includes(t)&&(O[t].energy=I.items[t].energy,O[t].energyPv=0,O[t].energyBat=0,O[t].pvPercentage=0)}),Object.values(P).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0}),Object.values(E).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0})}const ke=g(()=>{const t=De(h.data,e=>e.date);return t[1]?mt().domain(Array.from({length:t[1]},(e,a)=>a+1)).paddingInner(.4).range([0,ye-W.left-2]):mt().range([0,0])});function $t(){switch(h.graphMode){case"live":h.graphMode="today",y.showRightButton=!0,re();break;case"today":h.graphMode="day",R.date=new Date,R.back(),re();break;case"day":R.back(),re();break;case"month":we.back();break;case"year":Be.back();break}}function Yt(){const t=new Date;switch(h.graphMode){case"live":break;case"today":h.graphMode="live",y.showRightButton=!1,re();break;case"day":R.forward(),R.date.getDate()==t.getDate()&&R.date.getMonth()==t.getMonth()&&R.date.getFullYear()==t.getFullYear()&&(h.graphMode="today"),re();break;case"month":we.forward();break;case"year":Be.forward();break}}function qt(){switch(h.graphMode){case"live":$t();break;case"day":case"today":h.graphMode="month",re();break;case"month":h.graphMode="year",re();break}}function Qt(){switch(h.graphMode){case"year":h.graphMode="month",re();break;case"month":h.graphMode="today",re();break;case"today":case"day":h.graphMode="live",re();break}}function Lt(t){if(h.graphMode=="day"||h.graphMode=="today"){R.setDate(t);const e=new Date;R.date.getDate()==e.getDate()&&R.date.getMonth()==e.getMonth()&&R.date.getFullYear()==e.getFullYear()?h.graphMode="today":h.graphMode="day",re()}}const jo=["origin","transform"],Uo=V({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)"};var o,r;const i=y.showAnimations?y.animationDuration:0,d=y.showAnimations?y.animationDelay:0,p=g(()=>{const b=ve("g#pgSourceGraph");h.graphMode=="month"||h.graphMode=="year"?S(b):G(b),b.selectAll(".axis").remove();const m=b.append("g").attr("class","axis");return m.call(N.value),m.selectAll(".tick").attr("font-size",12),m.selectAll(".tick line").attr("stroke",U.value).attr("stroke-width",A.value),m.select(".domain").attr("stroke","var(--color-bg)"),"pgSourceGraph.vue"}),u=g(()=>h.graphMode=="month"||h.graphMode=="year"?["evuIn","batOut","selfUsage","evuOut"]:["selfUsage","evuOut","batOut","evuIn"]),v=g(()=>Oe().domain([0,h.data.length-1]).range([0,e.width])),_=g(()=>zt().keys(u.value)),L=g(()=>_.value(h.data)),M=g(()=>Oe().range([e.height-10,0]).domain(h.graphMode=="year"?[0,Math.ceil(F.value[1]*10)/10]:[0,Math.ceil(F.value[1])])),F=g(()=>{let b=De(h.data,m=>Math.max(m.pv+m.evuIn+m.batOut,m.selfUsage+m.evuOut));return b[0]!=null&&b[1]!=null?(h.graphMode=="year"&&(b[0]=b[0]/1e3,b[1]=b[1]/1e3),b):[0,0]}),D=g(()=>h.graphMode=="month"||h.graphMode=="year"?-e.width-e.margin.right-22:-e.width),N=g(()=>lt(M.value).tickSizeInner(D.value).ticks(4).tickFormat(b=>(b==0?"":Math.round(b*10)/10).toLocaleString(void 0))),A=g(()=>y.showGrid?"0.5":"1"),U=g(()=>y.showGrid?"var(--color-grid)":"var(--color-bg)");function G(b){const m=at().x(($,ne)=>v.value(ne)).y(M.value(0)),x=at().x(($,ne)=>v.value(ne)).y0($=>M.value(h.graphMode=="year"?$[0]/1e3:$[0])).y1($=>M.value(h.graphMode=="year"?$[1]/1e3:$[1]));st?(b.selectAll("*").remove(),o=b.selectAll(".sourceareas").data(L.value).enter().append("path").attr("fill",($,ne)=>a[u.value[ne]]).attr("d",$=>m($)),o.transition().duration(i).delay(d).ease(Fe).attr("d",$=>x($)),Bt()):o.data(L.value).transition().duration(0).ease(Fe).attr("d",$=>x($))}function S(b){st?(b.selectAll("*").remove(),r=b.selectAll(".sourcebar").data(L.value).enter().append("g").attr("fill",(m,x)=>a[u.value[x]]).selectAll("rect").data(m=>m).enter().append("rect").attr("x",(m,x)=>ke.value(h.data[x].date)??0).attr("y",()=>M.value(0)).attr("height",0).attr("width",ke.value.bandwidth()),r.transition().duration(i).delay(d).ease(Fe).attr("height",m=>h.graphMode=="year"?M.value(m[0]/1e3)-M.value(m[1]/1e3):M.value(m[0])-M.value(m[1])).attr("y",m=>h.graphMode=="year"?M.value(m[1]/1e3):M.value(m[1])),Bt()):(b.selectAll("*").remove(),r=b.selectAll(".sourcebar").data(L.value).enter().append("g").attr("fill",(m,x)=>a[u.value[x]]).selectAll("rect").data(m=>m).enter().append("rect").attr("x",(m,x)=>ke.value(h.data[x].date)??0).attr("y",m=>h.graphMode=="year"?M.value(m[1]/1e3):M.value(m[1])).attr("width",ke.value.bandwidth()).attr("height",m=>h.graphMode=="year"?M.value(m[0]/1e3)-M.value(m[1]/1e3):M.value(m[0])-M.value(m[1])))}return(b,m)=>(c(),f("g",{id:"pgSourceGraph",origin:p.value,transform:"translate("+b.margin.left+","+b.margin.top+")"},null,8,jo))}}),Fo=["origin","transform"],No=V({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn"],["charging","devices","house","batIn"],["devices","charging","house","batIn"]],o={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var r,i;const d=y.showAnimations?y.animationDuration:0,p=y.showAnimations?y.animationDelay:0,u=g(()=>{const S=ve("g#pgUsageGraph");h.graphMode=="month"||h.graphMode=="year"?G(S):U(S),S.selectAll(".axis").remove();const b=S.append("g").attr("class","axis");return b.call(A.value),b.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),y.showGrid?b.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):b.selectAll(".tick line").attr("stroke","var(--color-bg)"),b.select(".domain").attr("stroke","var(--color-bg)"),"pgUsageGraph.vue"}),v=g(()=>zt().keys(F.value)),_=g(()=>v.value(h.data)),L=g(()=>Oe().domain([0,h.data.length-1]).range([0,e.width])),M=g(()=>Oe().range([e.height+10,2*e.height]).domain(h.graphMode=="year"?[0,Math.ceil(D.value[1]*10)/10]:[0,Math.ceil(D.value[1])])),F=g(()=>{if(h.graphMode!="today"&&h.graphMode!="day")return a[e.stackOrder];{const S=a[e.stackOrder].slice(),b=S.indexOf("charging");S.splice(b,1);const m=/cp\d+/;let x=[];return h.data.length>0&&(x=Object.keys(h.data[0]).reduce(($,ne)=>(ne.match(m)&&$.push(ne),$),[])),x.map(($,ne)=>{S.splice(b+ne,0,$),o[$]="var(--color-cp"+ne+")"}),S}}),D=g(()=>{let S=De(h.data,b=>b.house+b.charging+b.batIn+b.devices);return S[0]!=null&&S[1]!=null?(h.graphMode=="year"&&(S[0]=S[0]/1e3,S[1]=S[1]/1e3),S):[0,0]}),N=g(()=>h.graphMode=="month"||h.graphMode=="year"?-e.width-e.margin.right-22:-e.width),A=g(()=>lt(M.value).tickSizeInner(N.value).ticks(4).tickFormat(S=>(S==0?"":Math.round(S*10)/10).toLocaleString(void 0)));function U(S){const b=at().x((x,$)=>L.value($)).y(M.value(0)),m=at().x((x,$)=>L.value($)).y0(x=>M.value(x[0])).y1(x=>M.value(x[1]));y.showAnimations?qe?(S.selectAll("*").remove(),r=S.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",x=>b(x)).attr("fill",(x,$)=>o[F.value[$]]),r.transition().duration(300).delay(100).ease(Fe).attr("d",x=>m(x)),Ot()):(S.selectAll("*").remove(),S.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",x=>m(x)).attr("fill",(x,$)=>o[F.value[$]])):(S.selectAll("*").remove(),S.selectAll(".usageareas").data(_.value).enter().append("path").attr("d",x=>m(x)).attr("fill",(x,$)=>o[F.value[$]]))}function G(S){qe?(S.selectAll("*").remove(),i=S.selectAll(".usagebar").data(_.value).enter().append("g").attr("fill",(b,m)=>o[a[e.stackOrder][m]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,m)=>ke.value(h.data[m].date)??0).attr("y",()=>M.value(0)).attr("height",0).attr("width",ke.value.bandwidth()),i.transition().duration(d).delay(p).ease(Fe).attr("y",b=>h.graphMode=="year"?M.value(b[0]/1e3):M.value(b[0])).attr("height",b=>h.graphMode=="year"?M.value(b[1]/1e3)-M.value(b[0]/1e3):M.value(b[1])-M.value(b[0])),Ot()):(S.selectAll("*").remove(),i=S.selectAll(".usagebar").data(_.value).enter().append("g").attr("fill",(b,m)=>o[a[e.stackOrder][m]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,m)=>ke.value(h.data[m].date)??0).attr("y",b=>h.graphMode=="year"?M.value(b[0]/1e3):M.value(b[0])).attr("height",b=>h.graphMode=="year"?M.value(b[1]/1e3)-M.value(b[0]/1e3):M.value(b[1])-M.value(b[0])).attr("width",ke.value.bandwidth()))}return(S,b)=>(c(),f("g",{id:"pgUsageGraph",origin:u.value,transform:"translate("+S.margin.left+","+S.margin.top+")"},null,8,Fo))}}),Jo=["transform"],Ro=["origin","transform"],Ho=["origin","transform"],Yo={key:0},qo=["width","height"],Qo={key:1},Zo=["y","width","height"],ht=12,Xo=V({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>et(p.value).ticks(4).tickSizeInner(d.value).tickFormat(ft("%H:%M"))),o=g(()=>_a(p.value).ticks(4).tickSizeInner(d.value+3).tickFormat(ft(""))),r=g(()=>et(ke.value).ticks(4).tickSizeInner(d.value).tickFormat(_=>_.toString())),i=g(()=>et(ke.value).ticks(4).tickSizeInner(d.value).tickFormat(()=>"")),d=g(()=>h.graphMode!=="month"&&h.graphMode!=="year"?y.showGrid?-(e.height/2-7):-10:0),p=g(()=>{let _=De(h.data,L=>L.date);return _[0]&&_[1]?Ye().domain(_).range([0,e.width]):Ye().range([0,0])}),u=g(()=>{let _=ve("g#PGXAxis");return _.selectAll("*").remove(),h.graphMode=="month"||h.graphMode=="year"?_.call(r.value):_.call(a.value),_.selectAll(".tick > text").attr("fill",(L,M)=>M>0||h.graphMode=="month"||h.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",ht),y.showGrid?_.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):_.selectAll(".tick line").attr("stroke","var(--color-bg)"),_.select(".domain").attr("stroke","var(--color-bg)"),_.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",ht).text(h.graphMode=="year"?"MW":"kW").attr("text-anchor","start"),"PGXAxis.vue"}),v=g(()=>{let _=ve("g#PGXAxis2");return _.selectAll("*").remove(),h.graphMode=="month"||h.graphMode=="year"?_.call(i.value):_.call(o.value),_.selectAll(".tick > text").attr("fill",(L,M)=>M>0||h.graphMode=="month"||h.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",ht),y.showGrid?(_.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),_.select(".domain").attr("stroke","var(--color-bg)")):_.selectAll(".tick line").attr("stroke","var(--color-bg)"),_.select(".domain").attr("stroke","var(--color-bg)"),"PGXAxis2.vue"});return(_,L)=>(c(),f("g",{transform:"translate("+_.margin.left+","+_.margin.top+")"},[s("g",{id:"PGXAxis",class:"axis",origin:u.value,transform:"translate(0,"+(_.height/2-6)+")"},null,8,Ro),s("g",{id:"PGXAxis2",class:"axis",origin:v.value,transform:"translate(0,"+(_.height/2+10)+")"},null,8,Ho),n(y).showGrid?(c(),f("g",Yo,[s("rect",{x:"0",y:"0",width:_.width,height:_.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,qo)])):w("",!0),n(y).showGrid?(c(),f("g",Qo,[s("rect",{x:"0",y:_.height/2+10,width:_.width,height:_.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Zo)])):w("",!0)],8,Jo))}}),Ko=["d"],er=["d","stroke"],tr=["x","y","text-anchor"],pt=V({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>{let L=De(h.data,M=>M.date);return L[0]&&L[1]?Ye().domain(L).range([0,e.width]):Ye().range([0,0])}),o=g(()=>Oe().range([e.height-10,0]).domain([0,100])),r=g(()=>{let M=vt().x(F=>a.value(F.date)).y(F=>o.value(e.order==2?F.batSoc:F["soc"+u.value.connectedVehicle])??o.value(0))(h.data);return M||""}),i=g(()=>e.order==2?"Speicher":u.value.vehicleName),d=g(()=>{switch(e.order){case 0:return"var(--color-cp1)";case 1:return"var(--color-cp2)";case 2:return"var(--color-battery)";default:return"red"}}),p=g(()=>{switch(e.order){case 0:return e.width-3;case 1:return 3;case 2:return e.width/2;default:return 0}}),u=g(()=>{const L=e.order==2?0:e.order;return Object.values(P)[L]}),v=g(()=>{if(h.data.length>0){let L;switch(e.order){case 0:return L=h.data.length-1,o.value(h.data[L]["soc"+u.value.connectedVehicle]+2);case 1:return L=0,o.value(h.data[L]["soc"+u.value.connectedVehicle]+2);case 2:return L=Math.round(h.data.length/2),o.value(h.data[L].batSoc+2);default:return 0}}else return 0}),_=g(()=>{switch(e.order){case 0:return"end";case 1:return"start";case 2:return"middle";default:return"middle"}});return(L,M)=>(c(),f(te,null,[s("path",{class:"soc-baseline",d:r.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,Ko),s("path",{class:"soc-dashes",d:r.value,stroke:d.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,er),s("text",{class:"cpname",x:p.value,y:v.value,style:J({fill:d.value,fontSize:10}),"text-anchor":_.value},B(i.value),13,tr)],64))}}),ar=["transform"],or=V({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Oe().range([e.height-10,0]).domain([0,100])),o=g(()=>ya(a.value).ticks(5).tickFormat(i=>i.toString()+"%"));function r(){let i=ve("g#PGSocAxis");i.call(o.value),i.selectAll(".tick").attr("font-size",12),i.selectAll(".tick line").attr("stroke","var(--color-bg)"),i.select(".domain").attr("stroke","var(--color-bg)")}return Ze(()=>{r()}),(i,d)=>(c(),f("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(i.width-20)+",0)"},null,8,ar))}}),rr=t=>(ce("data-v-7b8949f3"),t=t(),ue(),t),nr={class:"d-flex align-self-top justify-content-center align-items-center"},sr={class:"input-group input-group-xs"},ir={key:0,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},lr={class:"dropdown-menu"},cr={class:"table optiontable"},ur=["onClick"],dr={key:1,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},hr={class:"dropdown-menu"},pr={class:"table optiontable"},gr=["onClick"],mr={key:2,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},fr={class:"dropdown-menu"},vr={class:"table optiontable"},_r=["onClick"],yr=rr(()=>s("span",{class:"fa-solid fa-circle-check"},null,-1)),br=[yr],wr=V({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=new Date().getFullYear();let r=Array.from({length:10},(F,D)=>o-D);const i=ee(!0),d=e,p=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],u=ee(a.modelValue.getDate()),v=ee(a.modelValue.getMonth()),_=ee(a.modelValue.getFullYear()),L=g(()=>{const D=new Date(_.value,v.value,1).getDay();let N=0;switch(v.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:N=31;break;case 4:case 6:case 9:case 11:N=30;break;case 2:Math.trunc(_.value/4)*4==_.value&&(N=29)}let A=[],U=[0,0,0,0,0,0,0],G=D;for(let S=0;S<N;S++)U[G]=S+1,G==6?(A.push(U),U=[0,0,0,0,0,0,0],G=0):G++;return G<8&&A.push(U),A});function M(){d("update:modelValue",new Date(_.value,v.value,u.value)),i.value=!1}return(F,D)=>(c(),f("span",nr,[s("div",sr,[a.mode=="day"||a.mode=="today"?(c(),f("button",ir,B(u.value),1)):w("",!0),s("div",lr,[s("table",cr,[(c(!0),f(te,null,pe(L.value,(N,A)=>(c(),f("tr",{key:A,class:""},[(c(!0),f(te,null,pe(N,(U,G)=>(c(),f("td",{key:G},[U!=0?(c(),f("span",{key:0,type:"button",class:"btn optionbutton",onClick:S=>u.value=U},B(U),9,ur)):w("",!0)]))),128))]))),128))])]),a.mode!="year"&&a.mode!="live"?(c(),f("button",dr,B(v.value+1),1)):w("",!0),s("div",hr,[s("table",pr,[(c(),f(te,null,pe(p,(N,A)=>s("tr",{key:A,class:""},[(c(!0),f(te,null,pe(N,(U,G)=>(c(),f("td",{key:G,class:"p-0 m-0"},[s("span",{type:"button",class:"btn btn-sm optionbutton",onClick:S=>v.value=U},B(U+1),9,gr)]))),128))])),64))])]),a.mode!="live"?(c(),f("button",mr,B(_.value),1)):w("",!0),s("div",fr,[s("table",vr,[(c(!0),f(te,null,pe(n(r),(N,A)=>(c(),f("tr",{key:A,class:""},[s("td",null,[s("span",{type:"button",class:"btn optionbutton",onClick:U=>_.value=N},B(N),9,_r)])]))),128))])]),a.mode!="live"?(c(),f("button",{key:3,class:"button-outline-secondary",type:"button",onClick:M},br)):w("",!0)])]))}}),kr=H(wr,[["__scopeId","data-v-7b8949f3"]]),Sr={class:"btn-group m-0",role:"group","aria-label":"radiobar"},xr=["id","value"],Mr=V({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,r=g({get(){return a.modelValue},set(p){o("update:modelValue",p)}});function i(p){let u=a.options[p].color?a.options[p].color:"var(--color-fg)";return a.options[p].active?{color:"var(--color-bg)",background:u}:{color:u}}function d(p){let u=p.target;for(;u&&!u.value&&u.parentElement;)u=u.parentElement;u.value&&(r.value=u.value)}return(p,u)=>(c(),f("div",null,[s("div",Sr,[(c(!0),f(te,null,pe(p.options,(v,_)=>(c(),f("button",{id:"radio-"+v.value,key:_,class:Y(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",v.value==r.value?"active":""]),value:v.value,style:J(i(_)),onClick:d},[s("span",{style:J(i(_))},[v.icon?(c(),f("i",{key:0,class:Y(["fa-solid",v.icon])},null,2)):w("",!0),q(" "+B(v.text),1)],4)],14,xr))),128))])]))}}),Zt=H(Mr,[["__scopeId","data-v-20cf8590"]]),ut=t=>(ce("data-v-a73ca9f4"),t=t(),ue(),t),$r=ut(()=>s("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Pr=[$r],Cr=ut(()=>s("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Ir=[Cr],Br=ut(()=>s("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),Or=[Br],Lr=ut(()=>s("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),Tr=[Lr],Ar=V({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean},ignoreLive:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=ee(0),o=g(()=>{switch(h.graphMode){case"live":return e.ignoreLive?"heute":`${ae.duration} min`;case"today":return"heute";case"day":return R.date.getDate()+"."+(R.date.getMonth()+1)+".";case"month":return io(we.month-1,we.year);case"year":return Be.year.toString();default:return"???"}}),r=["live","today","day","month","year"],i=["Live","Heute","Tag","Monat","Jahr"],d=g({get(){return h.graphMode},set(G){switch(G){case"day":L();break;case"today":M();break;case"live":_();break;case"month":F();break;case"year":D()}}}),p=g(()=>{switch(h.graphMode){case"live":case"today":return R.getDate();case"month":return we.getDate();default:return R.getDate()}});function u(G){Lt(G)}function v(){a.value+=1,a.value>2&&(a.value=0)}function _(){h.graphMode!="live"&&(h.graphMode="live",re())}function L(){h.graphMode!="day"&&h.graphMode!="today"&&(h.graphMode="day",re())}function M(){h.graphMode!="today"&&(h.graphMode="today",Lt(new Date),re())}function F(){h.graphMode!="month"&&(h.graphMode="month",re())}function D(){h.graphMode!="year"&&(h.graphMode="year",re())}const N=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),A=g(()=>a.value==1?"justify-content-between":"justify-content-end"),U=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(G,S)=>(c(),f("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:J(N.value)},[a.value==2?(c(),T(Zt,{key:0,id:"pgm2",modelValue:d.value,"onUpdate:modelValue":S[0]||(S[0]=b=>d.value=b),class:"m-2",options:r.map((b,m)=>({text:i[m],value:b,color:"var(--color-menu)",active:b==n(h).graphMode}))},null,8,["modelValue","options"])):w("",!0),a.value==1?(c(),f("span",{key:1,type:"button",class:Y(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:S[1]||(S[1]=b=>G.$emit("shiftUp"))},Pr,2)):w("",!0),s("div",{class:Y(["d-flex align-items-center",U.value])},[a.value==1?(c(),f("span",{key:0,type:"button",class:Y(["p-1",{disabled:!e.showLeftButton}]),onClick:S[2]||(S[2]=b=>G.$emit("shiftLeft"))},Ir,2)):w("",!0),a.value<2?(c(),f("span",{key:1,type:"button",class:"btn-outline-secondary p-2 px-3 badge rounded-pill datebadge",onClick:v},B(o.value),1)):w("",!0),a.value==2?(c(),T(kr,{key:2,"model-value":p.value,mode:n(h).graphMode,"onUpdate:modelValue":u},null,8,["model-value","mode"])):w("",!0),a.value==1?(c(),f("span",{key:3,id:"graphRightButton",type:"button",class:Y(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:S[3]||(S[3]=b=>G.$emit("shiftRight"))},null,2)):w("",!0)],2),s("div",{class:Y(["d-flex align-items-center",A.value])},[a.value==1?(c(),f("span",{key:0,type:"button",class:"p-1",onClick:v},Or)):w("",!0),a.value==1?(c(),f("span",{key:1,id:"graphLeftButton",type:"button",class:Y(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:S[4]||(S[4]=b=>G.$emit("shiftDown"))},null,2)):w("",!0),a.value>0?(c(),f("span",{key:2,type:"button",class:"p-1",onClick:S[5]||(S[5]=b=>a.value=0)},Tr)):w("",!0)],2)],4))}}),Xt=H(Ar,[["__scopeId","data-v-a73ca9f4"]]),Kt=t=>(ce("data-v-bb5945e3"),t=t(),ue(),t),Vr={class:"d-flex justify-content-end"},Dr=Kt(()=>s("span",{class:"fa-solid fa-lg ps-1 fa-magnifying-glass"},null,-1)),Wr=[Dr],Gr=["viewBox"],Er=["transform"],zr={id:"button"},jr=["x","y"],Ur=Kt(()=>s("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},B(""),-1)),Fr=[Ur],Nr=2,Jr="Leistung / Ladestand ",Rr=V({__name:"PowerGraph",setup(t){function e(){let o=y.usageStackOrder+1;o>Nr&&(o=0),y.usageStackOrder=o,Vo(!0)}function a(){y.zoomGraph=!y.zoomGraph}return(o,r)=>(c(),T(ct,{"full-width":!0},{title:C(()=>[q(B(Jr))]),buttons:C(()=>[s("div",Vr,[k(Xt,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!1,onShiftLeft:n($t),onShiftRight:n(Yt),onShiftUp:n(qt),onShiftDown:n(Qt)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"]),n(Ja)?(c(),f("span",{key:0,type:"button",class:"ms-1 p-0 pt-1",onClick:a},Wr)):w("",!0)])]),default:C(()=>[s("figure",{id:"powergraph",class:"p-0 m-0",onClick:e},[(c(),f("svg",{viewBox:"0 0 "+n(ye)+" "+n($e)},[k(Uo,{width:n(ye)-n(W).left-2*n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W)},null,8,["width","height","margin"]),k(No,{width:n(ye)-n(W).left-2*n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W),"stack-order":n(y).usageStackOrder},null,8,["width","height","margin","stack-order"]),k(Xo,{width:n(ye)-n(W).left-2*n(W).right,height:n($e)-n(W).top-n(W).bottom,margin:n(W),"graph-data":n(h)},null,8,["width","height","margin","graph-data"]),s("g",{transform:"translate("+n(W).left+","+n(W).top+")"},[(n(h).graphMode=="day"||n(h).graphMode=="today"||n(h).graphMode=="live")&&Object.values(n(P)).length>0?(c(),T(pt,{key:0,width:n(ye)-n(W).left-2*n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W),order:0},null,8,["width","height","margin"])):w("",!0),(n(h).graphMode=="day"||n(h).graphMode=="today"||n(h).graphMode=="live")&&Object.values(n(P)).length>1?(c(),T(pt,{key:1,width:n(ye)-n(W).left-2*n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W),order:1},null,8,["width","height","margin"])):w("",!0),(n(h).graphMode=="day"||n(h).graphMode=="today")&&n(Se).isBatteryConfigured?(c(),T(pt,{key:2,width:n(ye)-n(W).left-2*n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W),order:2},null,8,["width","height","margin"])):w("",!0),n(h).graphMode=="day"||n(h).graphMode=="today"?(c(),T(or,{key:3,width:n(ye)-n(W).left-n(W).right,height:(n($e)-n(W).top-n(W).bottom)/2,margin:n(W)},null,8,["width","height","margin"])):w("",!0)],8,Er),s("g",zr,[s("text",{x:n(ye),y:n($e)-10,color:"var(--color-menu)","text-anchor":"end"},Fr,8,jr)])],8,Gr))])]),_:1}))}}),Hr=H(Rr,[["__scopeId","data-v-bb5945e3"]]),Yr=["id"],qr=["x","width","height","fill"],Qr=["x","width","height"],Zr=["x","y","width","height"],Xr=V({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),r=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(i,d)=>(c(),f("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[s("rect",{class:"bar",x:e.xScale(i.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:i.item.color},null,8,qr),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Qr),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:o.value,width:e.xScale.bandwidth()*2/3,height:r.value,fill:"var(--color-battery)","fill-opacity":"66%"},null,8,Zr)],8,Yr))}}),Kr={id:"emBargraph"},en=s("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),tn=V({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(r){if(r.name=="PV"){const i=h.graphMode=="live"||h.graphMode=="day"?j:I.items,p=(h.graphMode=="live"||h.graphMode=="day"?O:I.items).evuOut.energy,u=i.pv.energy;return Math.round((u-p)/u*100)}else if(r.name=="Netz"){const i=h.graphMode=="live"||h.graphMode=="day"?j:I.items,d=h.graphMode=="live"||h.graphMode=="day"?O:I.items,p=d.evuOut.energy,u=i.evuIn.energy,v=i.pv.energy,_=i.batOut.energy,L=d.batIn.energy;return Math.round((v+_-p-L)/(v+_+u-p-L)*100)}else return r.pvPercentage}function o(r){return r.name=="PV"?"Eigen":"Aut"}return(r,i)=>(c(),f("g",Kr,[(c(!0),f(te,null,pe(e.plotdata,(d,p)=>(c(),f("g",{key:p},[k(Xr,{item:d,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(d),autarchy:a(d)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),en]))}}),an=["origin"],on=V({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>lt(e.yScale).tickFormat(r=>r>0?(r/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),o=g(()=>{const r=ve("g#emYAxis");return r.attr("class","axis").call(a.value),r.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),r.selectAll(".tick").attr("font-size",e.fontsize),y.showGrid?r.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):r.selectAll(".tick line").attr("stroke","var(--color-bg)"),r.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(r,i)=>(c(),f("g",{id:"emYAxis",class:"axis",origin:o.value},null,8,an))}}),rn=["id"],nn=["x","y","font-size"],sn=["x","y","font-size","fill"],ln=["x","y","font-size","fill"],cn=V({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),o=g(()=>{let u=16,v=e.barcount;return v<=5?u=16:v==6?u=14:v>6&&v<=8?u=13:v==9?u=11:v==10?u=10:u=9,u}),r=g(()=>{let u=12,v=e.barcount;return v<=5?u=12:v==6?u=11:v>6&&v<=8||v==9?u=8:v==10?u=7:u=6,u});function i(u,v){return v.length>r.value?v.substring(0,r.value)+".":v}function d(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function p(){return"var(--color-pv)"}return(u,v)=>(c(),f("g",{id:"barlabel-"+e.item.name},[s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":o.value,"text-anchor":"middle",fill:"var(--color-menu)"},B(n(Rt)(u.item.energy,n(y).decimalPlaces,!1)),9,nn),s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.yScale(u.item.energy)-10,"font-size":o.value-2,"text-anchor":"middle",fill:p()},B(d()),9,sn),s("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":o.value,"text-anchor":"middle",fill:u.item.color,class:Y(u.item.icon.length<=2?"fas":"")},B(i(u.item.name,u.item.icon)),11,ln)],8,rn))}}),un={id:"emBarLabels"},dn=V({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(r){if(r.name=="PV"){const i=h.graphMode=="live"||h.graphMode=="day"?j:I.items,p=(h.graphMode=="live"||h.graphMode=="day"?O:I.items).evuOut.energy,u=i.pv.energy;return Math.round((u-p)/u*100)}else if(r.name=="Netz"){const i=h.graphMode=="live"||h.graphMode=="day"?j:I.items,d=h.graphMode=="live"||h.graphMode=="day"?O:I.items,p=d.evuOut.energy,u=i.evuIn.energy,v=i.pv.energy,_=i.batOut.energy,L=d.batIn.energy;return v+_-p-L>0?Math.round((v+_-p-L)/(v+_+u-p-L)*100):0}else return r.pvPercentage}function o(r){return r.name=="PV"?"Eigen":"Aut"}return(r,i)=>(c(),f("g",un,[(c(!0),f(te,null,pe(e.plotdata,(d,p)=>(c(),f("g",{key:p},[k(cn,{item:d,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(d),autarchy:a(d)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),hn={id:"energymeter",class:"p-0 m-0"},pn={viewBox:"0 0 500 500"},gn=["transform"],mn=["x"],fn={key:0},Tt=500,gt=500,At=12,vn="Energie",_n=V({__name:"EnergyMeter",setup(t){const e={top:25,bottom:30,left:25,right:0},a=g(()=>{let d=Object.values(j),p=i.value,u=I.values(),v=[];switch(y.debug&&(console.debug("----------------------- source summary -----------------"),console.debug(j),console.debug("----------------------- usage details ------------------"),console.debug(i.value),console.debug("----------------------- historic summary ---------------"),console.debug(I),console.debug("--------------------------------------------------------")),nt.value==!0&&(nt.value=!1),h.graphMode){default:case"live":case"today":v=d.concat(p).filter(_=>_.energy>0);break;case"day":case"month":case"year":u.length==0?Re.value=!0:(Re.value=!1,v=u.filter(_=>_.energy>0))}return v}),o=g(()=>mt().range([0,Tt-e.left-e.right]).domain(a.value.map(d=>d.name)).padding(.4)),r=g(()=>Oe().range([gt-e.bottom-e.top,15]).domain([0,ba(a.value,d=>d.energy)])),i=g(()=>{const d=Object.values(P).length,p=Object.values(E).filter(u=>u.configured).length;return[O.evuOut,O.devices,O.charging].concat(d>1?Object.values(P).map(u=>u.toPowerItem()):[]).concat(p>1?Object.values(E).filter(u=>u.configured&&u.showInGraph):[]).concat([O.batIn,O.house])});return(d,p)=>(c(),T(ct,{"full-width":!0},{title:C(()=>[q(B(vn))]),buttons:C(()=>[k(Xt,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!0,onShiftLeft:n($t),onShiftRight:n(Yt),onShiftUp:n(qt),onShiftDown:n(Qt)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:C(()=>[s("figure",hn,[(c(),f("svg",pn,[s("g",{transform:"translate("+e.left+","+e.top+")"},[k(tn,{plotdata:a.value,"x-scale":o.value,"y-scale":r.value,height:gt,margin:e},null,8,["plotdata","x-scale","y-scale"]),k(on,{"y-scale":r.value,width:Tt,fontsize:At,config:n(y)},null,8,["y-scale","config"]),s("text",{x:-e.left,y:"-15",fill:"var(--color-axis)","font-size":At},B(n(h).graphMode=="year"?"MWh":"kWh"),9,mn),k(dn,{plotdata:a.value,"x-scale":o.value,"y-scale":r.value,height:gt,margin:e,config:n(y)},null,8,["plotdata","x-scale","y-scale","config"])],8,gn)]))]),n(Re)?(c(),f("p",fn,"No data")):w("",!0)]),_:1}))}});function yn(t,e){t=="openWB/graph/boolDisplayLiveGraph"?Se.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?bn(t,e):t=="openWB/graph/lastlivevaluesJson"?wn(t,e):t=="openWB/graph/config/duration"&&(ae.duration=JSON.parse(e))}function bn(t,e){if(!ae.initialized){let a=[];const o=e.toString().split(`
`);o.length>1?a=o.map(d=>JSON.parse(d)):a=[];const r=t.match(/(\d+)$/g),i=r?r[0]:"";i!=""&&typeof ae.rawDataPacks[+i-1]>"u"&&(ae.rawDataPacks[+i-1]=a,ae.initCounter++)}if(ae.initCounter==16){const a=[];ae.unsubscribeRefresh(),ae.initialized=!0,ae.rawDataPacks.map(o=>{o.map(r=>{const i=ea(r);a.push(i)})}),Xe(a),ae.subscribeUpdates()}}function wn(t,e){const a=JSON.parse(e),o=ea(a);ae.graphRefreshCounter++,Xe(h.data.concat(o)),ae.graphRefreshCounter>60&&ae.activate()}function ea(t){const e={};e.date=kn(t.time).valueOf(),+t.grid>0?(e.evuIn=+t.grid,e.evuOut=0):+t.grid<=0?(e.evuIn=0,e.evuOut=-t.grid):(e.evuIn=0,e.evuOut=0),+t["pv-all"]>=0?(e.pv=+t["pv-all"],e.inverter=0):(e.pv=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,t["ev0-soc"]&&(e.soc0=+t["ev0-soc"]),t["ev1-soc"]&&(e.soc1=+t["ev1-soc"]),e.charging=+t["charging-all"];for(let a=0;a<10;a++){const o="cp"+a;e[o]=+t[o+"-power"]}return e.selfUsage=e.pv-e.evuOut,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function kn(t){const e=new Date(Date.now()),a=864e5;let o=new Date;const r=ot("%H:%M:%S")(t);return r&&(o=r,o.setDate(e.getDate()),o.setMonth(e.getMonth()),o.setFullYear(e.getFullYear()),o.getHours()>e.getHours()&&(o=new Date(o.getTime()-a))),o}const Sn=["evuIn","pv","batIn","evuOut"];let it=[];function xn(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;St(),it=[],xt.map(i=>{I.setEnergyPv(i,0),I.setEnergyBat(i,0)});const r=Mn(a);Xe(r),Mt(o,it),y.debug&&(console.debug("---------------------------------------- Graph Data ---------------------------"),console.debug("--- Incoming graph data:"),console.debug(a),console.debug("data to be displayed:"),console.debug(r),console.debug("-------------------------------------------------------------------------------")),h.graphMode=="today"&&setTimeout(()=>R.activate(),3e5)}function Mn(t){const e=[];let a={};return t.map(o=>{a=$n(o);const r=a;e.push(r)}),e}function $n(t){const e={};if(h.graphMode=="day"||h.graphMode=="today")if(typeof t.date=="number")e.date=new Date(+t.date*1e3).getTime();else{const o=ot("%H:%M")(t.date);o&&(o.setMonth(R.date.getMonth()),o.setDate(R.date.getDate()),o.setFullYear(R.date.getFullYear()),e.date=o.getTime())}else if(typeof t.date=="string"){const o=ot("%Y%m%d")(t.date);o&&(e.date=o.getDate())}return e.evuOut=0,e.evuIn=0,Object.entries(t.counter).forEach(([o,r])=>{r.grid&&(e.evuOut+=r.power_exported,e.evuIn+=r.power_imported,it.includes(o)||it.push(o))}),e.evuOut==0&&e.evuIn==0&&Object.entries(t.counter).forEach(o=>{e.evuOut+=o[1].power_exported,e.evuIn+=o[1].power_imported}),e.pv=t.pv.all.power_exported,Object.entries(t.bat).length>0?(e.batIn=t.bat.all.power_imported,e.batOut=t.bat.all.power_exported,e.batSoc=t.bat.all.soc??0):(e.batIn=0,e.batOut=0,e.batSoc=0),Object.entries(t.cp).forEach(([o,r])=>{o!="all"?(e[o]=r.power_imported,I.keys().includes(o)||I.addItem(o)):e.charging=r.power_imported}),Object.entries(t.ev).forEach(([o,r])=>{o!="all"&&(e["soc"+o.substring(2)]=r.soc)}),e.devices=0,Object.entries(t.sh).forEach(([o,r])=>{o!="all"&&(e[o]=r.power_imported??0,e.devices+=r.power_imported??0,I.keys().includes(o)||I.addItem(o))}),e.selfUsage=e.pv-e.evuOut,t.hc&&t.hc.all?e.house=t.hc.all.power_imported:e.house=e.evuIn+e.batOut+e.pv-e.evuOut-e.charging-e.devices-e.batOut,e.evuIn+e.batOut+e.pv>0?I.keys().filter(o=>!Sn.includes(o)).map(o=>{Wo(o,e)}):Object.keys(e).map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}let Ke={};const Pt=["charging","house","batIn","devices"],Pn=["evuIn","pv","batIn","evuOut"];let He=[];function Cn(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;St(),He=[],Pt.map(r=>{I.items[r].energyPv=0,I.items[r].energyBat=0}),a.length>0&&Xe(ta(a)),Mt(o,[])}function In(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;St(),He=[],Pt.forEach(r=>{I.items[r].energyPv=0,I.items[r].energyBat=0}),Xe(ta(a)),Mt(o,[])}function ta(t){const e=[];let a={};return Ke={},t.map(o=>{a=Bn(o),e.push(a),Object.keys(a).forEach(r=>{r!="date"&&(a[r]<0&&(console.warn(`Negative energy value for ${r} in row ${a.date}. Ignoring the value.`),a[r]=0),Ke[r]?Ke[r]+=a[r]:Ke[r]=a[r])})}),e}function Bn(t){const e={},a=ot("%Y%m%d")(t.date);a&&(e.date=h.graphMode=="month"?a.getDate():a.getMonth()+1),e.evuOut=0,e.evuIn=0;let o=0,r=0;return Object.entries(t.counter).forEach(([d,p])=>{o+=p.energy_exported,r+=p.energy_imported,p.grid&&(e.evuOut+=p.energy_exported,e.evuIn+=p.energy_imported,He.includes(d)||He.push(d))}),He.length==0&&(e.evuOut=o,e.evuIn=r),e.pv=t.pv.all.energy_exported,Object.entries(t.bat).length>0?(t.bat.all.energy_imported>=0?e.batIn=t.bat.all.energy_imported:(console.warn("ignoring negative value for batIn on day "+e.date),e.batIn=0),t.bat.all.energy_exported>=0?e.batOut=t.bat.all.energy_exported:(console.warn("ignoring negative value for batOut on day "+e.date),e.batOut=0)):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([d,p])=>{d!="all"?(I.keys().includes(d)||I.addItem(d),e[d]=p.energy_imported):e.charging=p.energy_imported}),Object.entries(t.ev).forEach(([d,p])=>{d!="all"&&(e["soc-"+d]=p.soc)}),e.devices=Object.entries(t.sh).reduce((d,p)=>(I.keys().includes(p[0])||I.addItem(p[0]),p[1].energy_imported>=0?d+=p[1].energy_imported:console.warn(`Negative energy value for device ${p[0]} in row ${e.date}. Ignoring this value`),d),0),e.house=e.pv+e.evuIn+e.batOut-e.evuOut-e.batIn-e.charging,e.selfUsage=e.pv-e.evuOut,e.evuIn+e.batOut+e.pv>0?I.keys().filter(d=>!Pn.includes(d)).map(d=>{Go(d,e)}):Pt.map(d=>{e[d+"Pv"]=0,e[d+"Bat"]=0}),e}class On{constructor(e){l(this,"id");l(this,"dailyYieldExport",0);l(this,"dailyYieldImport",0);l(this,"exported",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"imported",0);l(this,"power",0);l(this,"soc",0);this.id=e}}class Ln{constructor(){l(this,"dailyExport",0);l(this,"dailyImport",0);l(this,"exported",0);l(this,"imported",0);l(this,"power",0);l(this,"soc",0)}}const he=Q({});Q(new Ln);function Tn(t){t in he?console.info("Duplicate battery message: "+t):he[t]=new On(t)}function An(){Object.keys(he).forEach(t=>{delete he[parseInt(t)]})}function Vn(t,e){const a=Dn(t);if(a&&!(a in he)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?Se.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(O.batIn.power=+e,j.batOut.power=0):(O.batIn.power=0,j.batOut.power=-e):t=="openWB/bat/get/soc"?Se.batterySoc=+e:t=="openWB/bat/get/daily_exported"?j.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?O.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?he[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?he[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?he[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?he[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?he[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?he[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?he[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(he[a].soc=+e))}function Dn(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Wn(t,e){if(t=="openWB/optional/et/provider")JSON.parse(e).type==null?oe.active=!1:(oe.active=!0,oe.etProvider=JSON.parse(e).name);else if(t=="openWB/optional/et/get/prices"){const a=JSON.parse(e);oe.etPriceList=new Map,Object.keys(a).map(o=>{oe.etPriceList.set(new Date(+o*1e3),a[o]*1e5)})}}function Gn(t,e){const a=aa(t);if(a&&!(a in P)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?O.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(O.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")Se.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(P[a]){const o=JSON.parse(e);P[a].name=o.name,P[a].icon=o.name,se["cp"+a]?(se["cp"+a].name=o.name,se["cp"+a].icon=o.name):se["cp"+a]={name:o.name,icon:o.name,color:"var(--color-charging)"}}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))P[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))P[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))P[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))P[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))P[a].dailyYield=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))P[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))P[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))P[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))P[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))P[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))P[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/currents/i))P[a].currents=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const o=JSON.parse(e);P[a].chargedSincePlugged=o.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const o=JSON.parse(e);P[a].soc=o.soc,P[a].waitingForSoc=!1,P[a].rangeCharged=o.range_charged,P[a].rangeUnit=o.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const o=JSON.parse(e);P[a].vehicleName=String(o.name),P[a].updateConnectedVehicle(+o.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const o=JSON.parse(e);switch(o.chargemode){case"instant_charging":P[a].updateChargeMode(me.instant_charging);break;case"pv_charging":P[a].updateChargeMode(me.pv_charging);break;case"scheduled_charging":P[a].updateChargeMode(me.scheduled_charging);break;case"standby":P[a].updateChargeMode(me.standby);break;case"stop":P[a].updateChargeMode(me.stop);break}P[a].chargeTemplate=o.charge_template,P[a].averageConsumption=o.average_consumption}}}function En(t,e){const a=aa(t);if(a!=null){if(!(a in z)){const o=new Ta(a);z[a]=o}if(t.match(/^openwb\/vehicle\/[0-9]+\/name$/i))Object.values(P).forEach(o=>{o.connectedVehicle==a&&(o.vehicleName=JSON.parse(e))}),z[a].name=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i))z[a].soc=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i))z[a].range=+e;else if(t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i))z[a].updateChargeTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i))z[a].updateEvTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/soc_module\/config$/i)){const o=JSON.parse(e);Object.values(P).forEach(r=>{r.connectedVehicle==a&&(r.isSocConfigured=o.type!==null,r.isSocManual=o.type=="manual")})}}}function zn(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],r=JSON.parse(e);ie[o]=r,jn(o,r)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const r=+a[0].replace(/[^0-9]+/g,""),i=+o[0],d=JSON.parse(e);r in Je||(Je[r]=[]),Je[r][i]=d}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/chargemode\/scheduled_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const r=+a[0].replace(/[^0-9]+/g,""),i=+o[0],d=JSON.parse(e);r in Ne||(Ne[r]=[]),Ne[r][i]=d}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],r=JSON.parse(e);yt[o]=r}}}function jn(t,e){Object.values(P).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function aa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Un(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?Fn(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&Nn(t,e)}function Fn(t,e){const a=oa(t);a!=null&&(a in E||Jt(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?E[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?(E[a].name=e.toString(),E[a].icon=e.toString(),se["sh"+a].name=e.toString(),se["sh"+a].icon=e.toString()):t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?E[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canSwitch$/i)?E[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_homeConsumtion$/i)?E[a].countAsHouse=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(E[a].tempConfigured=+e))}function Nn(t,e){const a=oa(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in E||Jt(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))E[a].power=+e,Jn("power");else if(!t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Wh$/i)){if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))E[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))E[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))E[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))E[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:E[a].status="off";break;case 11:E[a].status="on";break;case 20:E[a].status="detection";break;case 30:E[a].status="timeout";break;default:E[a].status="off"}}}function Jn(t){switch(t){case"power":O.devices.power=Object.values(E).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.power,0);break;case"energy":O.devices.energy=Object.values(E).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function oa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}class Rn{constructor(e){l(this,"id");l(this,"name","Zähler");l(this,"power",0);l(this,"energy_imported",0);l(this,"energy_exported",0);l(this,"grid",!1);l(this,"type","counter");l(this,"color","var(--color-evu)");l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"icon","");this.id=e}}const ge=Q({});function Hn(t,e){if(t in ge)console.info("Duplicate counter message: "+t);else switch(ge[t]=new Rn(t),ge[t].type=e,e){case"counter":ge[t].color="var(--color-evu)";break;case"inverter":ge[t].color="var(--color-pv)";break;case"cp":ge[t].color="var(--color-charging)";break;case"bat":ge[t].color="var(--color-bat)";break}}const Yn=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#","openWB/command/"+wt()+"/#"];function qn(){Ba(Qn),Yn.forEach(t=>{Ve(t)}),re()}function Qn(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?Zn(t,a):t.match(/^openwb\/counter\//i)?Xn(t,a):t.match(/^openwb\/bat\//i)?Vn(t,a):t.match(/^openwb\/pv\//i)?Kn(t,a):t.match(/^openwb\/chargepoint\//i)?Gn(t,a):t.match(/^openwb\/vehicle\/template\//i)?zn(t,a):t.match(/^openwb\/vehicle\//i)?En(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?es(t,a):t.match(/^openwb\/graph\//i)?yn(t,a):t.match(/^openwb\/log\/daily\//i)?xn(t,a):t.match(/^openwb\/log\/monthly\//i)?Cn(t,a):t.match(/^openwb\/log\/yearly\//i)?In(t,a):t.match(/^openwb\/optional\/et\//i)?Wn(t,a):t.match(/^openwb\/system\//i)?as(t,a):t.match(/^openwb\/LegacySmartHome\//i)?Un(t,a):t.match(/^openwb\/command\//i)&&os(t,a)}function Zn(t,e){const a=t.split("/"),o=+a[2];if(o==Se.evuId?ts(t,e):a[3]=="config",a[3]=="get")switch(a[4]){case"power":ge[o].power=+e;break;case"config":break;case"fault_str":break;case"fault_state":break;case"power_factors":break;case"imported":break;case"exported":break;case"frequency":break;case"daily_imported":ge[o].energy_imported=+e;break;case"daily_exported":ge[o].energy_exported=+e;break}}function Xn(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Va(),An();for(const o of a)o.type=="counter"&&(Se.evuId=o.id);ra(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?(O.house.power=+e,Ga()):t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(O.house.energy=+e)}function ra(t){switch(t.type){case"counter":Hn(t.id,t.type);break;case"cp":Aa(t.id);break;case"bat":Tn(t.id);break}t.children.forEach(e=>ra(e))}function Kn(t,e){switch(t){case"openWB/pv/get/power":j.pv.power=-e;break;case"openWB/pv/get/daily_exported":j.pv.energy=+e;break}}function es(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":Se.updatePvBatteryPriority(e=="true");break}}function ts(t,e){switch(t.split("/")[4]){case"power":+e>0?(j.evuIn.power=+e,O.evuOut.power=0):(j.evuIn.power=0,O.evuOut.power=-e);break;case"daily_imported":j.evuIn.energy=+e;break;case"daily_exported":O.evuOut.energy=+e;break}}function as(t,e){if(t.match(/^openWB\/system\/device\/[0-9]+\/component\/[0-9]+\/config$/i)){const a=JSON.parse(e);a.type=="counter"&&(ge[a.id].name=a.name)}}function os(t,e){const a=t.split("/");if(t.match(/^openWB\/command\/[a-z]+\/error$/i)&&a[2]==wt()){const o=JSON.parse(e);console.error(`Error message from openWB: 
Command: ${o.command}
Data: JSON.stringify(err.data)
Error:
 ${o.error}`)}}const rs={class:"d-flex flex-column align-items-center justify-content-start infoitem"},ns=V({__name:"InfoItem",props:{heading:{},small:{type:Boolean}},setup(t){const e=t,a=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-small)"}),o=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-normal)"}),r=g(()=>e.small?"mt-0":"mt-1");return(i,d)=>(c(),f("span",rs,[s("span",{class:Y(["d-flex heading",r.value]),style:J(a.value)},B(e.heading),7),s("span",{class:"d-flex my-0 me-0 align-items-center content",style:J(o.value)},[le(i.$slots,"default",{},void 0,!0)],4)]))}}),de=H(ns,[["__scopeId","data-v-f6af00e8"]]),ss={class:"d-flex justify-content-between align-items-center titlerow"},is={class:"buttonarea grid-col-12",style:{"text-align":"right"}},ls={class:"contentrow grid-col-12"},cs=V({__name:"WbSubwidget",props:{titlecolor:{},fullwidth:{type:Boolean},small:{type:Boolean}},setup(t){const e=t,a=g(()=>{let r={"font-weight":"bold",color:"var(--color-fg)","font-size":"var(--font-normal)"};return e.titlecolor&&(r.color=e.titlecolor),e.small&&(r["font-size"]="var(--font-verysmall)"),r}),o=g(()=>e.fullwidth?"grid-col-12":"grid-col-4");return(r,i)=>(c(),f("div",{class:Y(["wb-subwidget px-3 pt-2 my-0",o.value])},[s("div",ss,[s("div",{class:"d-flex widgetname p-0 m-0",style:J(a.value)},[le(r.$slots,"title",{},void 0,!0)],4),s("div",is,[le(r.$slots,"buttons",{},void 0,!0)])]),s("div",ls,[le(r.$slots,"default",{},void 0,!0)])],2))}}),us=H(cs,[["__scopeId","data-v-971e553f"]]),ds=t=>(ce("data-v-b935eb33"),t=t(),ue(),t),hs={class:"grid-col-12 mt-2 mb-0 px-0 py-0 configitem"},ps={class:"titlecolumn m-0 p-0 d-flex align-items-center"},gs=ds(()=>s("i",{class:"me-1 fa-solid fa-sm fa-circle-info"},null,-1)),ms={class:"ms-1 mb-2 p-0 pt-2 d-flex justify-content-stretch align-items-center"},fs={class:"justify-content-stretch d-flex"},vs=V({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=ee(!1);function o(){a.value=!a.value}const r=g(()=>{let i={color:"var(--color-charging)"};return a.value&&(i.color="var(--color-battery)"),i});return(i,d)=>(c(),T(us,{fullwidth:!!i.fullwidth},{default:C(()=>[s("div",hs,[s("div",ps,[s("span",{class:"d-flex align-items-baseline m-0 p-0",onClick:o},[e.icon?(c(),f("i",{key:0,class:Y(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):w("",!0),q(" "+B(i.title),1)]),s("span",null,[e.infotext?(c(),f("i",{key:0,class:"fa-solid fa-sm fa-circle-question ms-4 me-2",style:J(r.value),onClick:o},null,4)):w("",!0)])]),a.value?(c(),f("p",{key:0,class:"infotext shadow m-0 ps-2 mb-1 p-1",onClick:o},[gs,q(" "+B(i.infotext),1)])):w("",!0),s("div",ms,[s("span",fs,[le(i.$slots,"default",{},void 0,!0)])])])]),_:3},8,["fullwidth"]))}}),K=H(vs,[["__scopeId","data-v-b935eb33"]]),na=t=>(ce("data-v-17a828b1"),t=t(),ue(),t),_s={class:"d-flex flex-column"},ys={class:"d-flex flex-fill justify-content-between align-items-center"},bs=na(()=>s("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)),ws=[bs],ks=["id","min","max","step"],Ss=na(()=>s("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)),xs=[Ss],Ms={class:"d-flex justify-content-between align-items-center"},$s={class:"minlabel ps-4"},Ps={class:"valuelabel"},Cs={class:"maxlabel pe-4"},Is=V({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},decimals:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=a.decimals??0,r=e,i=g({get(){return Math.round(a.modelValue*Math.pow(10,o))/Math.pow(10,o)},set(u){r("update:modelValue",u)}});function d(){i.value>a.min&&(i.value=Math.round((i.value-a.step)*Math.pow(10,o))/Math.pow(10,o))}function p(){i.value<a.max&&(i.value=Math.round((i.value+a.step)*Math.pow(10,o))/Math.pow(10,o))}return(u,v)=>(c(),f("span",_s,[s("span",ys,[s("span",{type:"button",class:"minusButton",onClick:d},ws),Ge(s("input",{id:u.id,"onUpdate:modelValue":v[0]||(v[0]=_=>i.value=_),type:"range",class:"form-range flex-fill",min:u.min,max:u.max,step:u.step},null,8,ks),[[wa,i.value,void 0,{number:!0}]]),s("span",{type:"button",class:"plusButton",onClick:p},xs)]),s("span",Ms,[s("span",$s,B(u.min),1),s("span",Ps,B(i.value)+" "+B(u.unit),1),s("span",Cs,B(u.max),1)])]))}}),Ie=H(Is,[["__scopeId","data-v-17a828b1"]]),Bs=["id","value"],Os=V({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,r=g({get(){return a.modelValue},set(p){o("update:modelValue",p)}});function i(p){return a.options[p][2]?{color:a.options[p][2]}:{color:"var(--color-fg)"}}function d(p){let u=p.target;for(;u&&!u.value&&u.parentElement;)u=u.parentElement;u.value&&(r.value=u.value)}return(p,u)=>(c(),f("div",null,[(c(!0),f(te,null,pe(p.options,(v,_)=>(c(),f("button",{id:"radio-"+v[1],key:_,class:Y(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",v[1]==r.value?"active":""]),value:v[1],style:J(i(_)),onClick:d},[s("span",{style:J(i(_))},[v[3]?(c(),f("i",{key:0,class:Y(["fa-solid",v[3]])},null,2)):w("",!0),q(" "+B(v[0]),1)],4)],14,Bs))),128))]))}}),Qe=H(Os,[["__scopeId","data-v-df222cbe"]]),Ls=t=>(ce("data-v-0303d179"),t=t(),ue(),t),Ts={class:"mt-2"},As=Ls(()=>s("p",{class:"heading ms-1"},"Sofortladen:",-1)),Vs={key:0},Ds=V({__name:"CPConfigInstant",props:{chargepoint:{}},setup(t){const a=ee(t.chargepoint),o=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}],r=g({get(){return a.value.instantMaxEnergy/1e3},set(i){a.value.instantMaxEnergy=i*1e3}});return(i,d)=>(c(),f("div",Ts,[As,k(K,{title:"Stromstärke",icon:"fa-bolt",fullwidth:!0},{default:C(()=>[k(Ie,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":d[0]||(d[0]=p=>a.value.instantTargetCurrent=p),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(c(),f("hr",Vs)):w("",!0),k(K,{title:"Begrenzung",icon:"fa-hand",fullwidth:!0},{default:C(()=>[k(Qe,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":d[1]||(d[1]=p=>a.value.instantChargeLimitMode=p),options:o.map(p=>[p.name,p.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(c(),T(K,{key:1,title:"Maximaler SoC",icon:"fa-sliders",fullwidth:!0},{default:C(()=>[k(Ie,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":d[2]||(d[2]=p=>a.value.instantTargetSoc=p),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):w("",!0),a.value.instantChargeLimitMode=="amount"?(c(),T(K,{key:2,title:"Zu ladende Energie",icon:"fa-sliders",fullwidth:!0},{default:C(()=>[k(Ie,{id:"maxEnergy",modelValue:r.value,"onUpdate:modelValue":d[3]||(d[3]=p=>r.value=p),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):w("",!0)]))}}),Ws=H(Ds,[["__scopeId","data-v-0303d179"]]),Gs={class:"form-check form-switch"},Ae=V({__name:"SwitchInput",props:{modelValue:{type:Boolean},onColor:{},offColor:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,r=g({get(){return a.modelValue},set(d){o("update:modelValue",d)}}),i=g(()=>r.value?{"background-color":"green"}:{"background-color":"white"});return(d,p)=>(c(),f("div",Gs,[Ge(s("input",{"onUpdate:modelValue":p[0]||(p[0]=u=>r.value=u),class:"form-check-input",type:"checkbox",role:"switch",style:J(i.value)},null,4),[[jt,r.value]])]))}}),sa=t=>(ce("data-v-1a90f282"),t=t(),ue(),t),Es={class:"pt-2"},zs=sa(()=>s("p",{class:"heading ms-1"},"PV-Laden:",-1)),js={class:"form-check form-switch"},Us=sa(()=>s("hr",null,null,-1)),Fs={key:2},Ns=V({__name:"CPConfigPv",props:{chargepoint:{}},setup(t){const a=ee(t.chargepoint),o=g({get(){return a.value.pvMinCurrent>5},set(i){i?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),r=g({get(){return a.value.pvMinSoc>0},set(i){i?a.value.pvMinSoc=50:a.value.pvMinSoc=0}});return(i,d)=>(c(),f("div",Es,[zs,k(K,{title:"Maximaler Ladestand",icon:"fa-battery-three-quarters",fullwidth:!0},{default:C(()=>[k(Ie,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":d[0]||(d[0]=p=>a.value.pvMaxSoc=p),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),k(K,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:C(()=>[s("div",js,[Ge(s("input",{id:"feedInLimitSwitch","onUpdate:modelValue":d[1]||(d[1]=p=>a.value.pvFeedInLimit=p),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[jt,a.value.pvFeedInLimit]])])]),_:1}),Us,k(K,{title:"Minimaler Ladestand",icon:"fa-battery-half",infotext:n(Pe).minsoc,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:r.value,"onUpdate:modelValue":d[2]||(d[2]=p=>r.value=p)},null,8,["modelValue"])]),_:1},8,["infotext"]),r.value?(c(),T(K,{key:0,title:"...bis SoC",fullwidth:!0},{info:C(()=>[q(B(n(Pe).minsoc),1)]),default:C(()=>[k(Ie,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":d[3]||(d[3]=p=>a.value.pvMinSoc=p),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):w("",!0),r.value?(c(),T(K,{key:1,title:"...mit Ladestrom",fullwidth:!0},{default:C(()=>[k(Ie,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":d[4]||(d[4]=p=>a.value.pvMinSocCurrent=p),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):w("",!0),o.value||r.value?(c(),f("hr",Fs)):w("",!0),k(K,{title:"Minimaler Ladestrom",icon:"fa-bolt",infotext:n(Pe).minpv,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:o.value,"onUpdate:modelValue":d[5]||(d[5]=p=>o.value=p)},null,8,["modelValue"])]),_:1},8,["infotext"]),o.value?(c(),T(K,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:C(()=>[k(Ie,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":d[6]||(d[6]=p=>a.value.pvMinCurrent=p),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):w("",!0)]))}}),Js=H(Ns,[["__scopeId","data-v-1a90f282"]]),ia=t=>(ce("data-v-e8f5ad9d"),t=t(),ue(),t),Rs=ia(()=>s("p",{class:"heading ms-1 pt-2"},"Zielladen:",-1)),Hs={class:"table table-borderless"},Ys=ia(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Ziel"),s("th",{class:"tableheader"},"Limit"),s("th",{class:"tableheader"},"Zeit"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader"})])],-1)),qs={class:"tablecell"},Qs={class:"tablecell"},Zs={class:"tablecell"},Xs={class:"tablecell"},Ks={class:"tablecell left"},ei=["href"],ti=V({__name:"CPConfigScheduled",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,o=g(()=>{let p=[];return Ne[a.chargeTemplateId]&&(p=Object.values(Ne[a.chargeTemplateId])),p});function r(p){return o.value[p].time}function i(p){return{color:o.value[p].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function d(p){return{"font-weight":o.value[p].active?"bold":"regular"}}return(p,u)=>(c(),f(te,null,[Rs,s("table",Hs,[Ys,s("tbody",null,[(c(!0),f(te,null,pe(o.value,(v,_)=>(c(),f("tr",{key:_,style:J(d(_))},[s("td",qs,B(v.limit.soc_scheduled)+"%",1),s("td",Qs,B(v.limit.soc_limit)+"%",1),s("td",Zs,B(r(_)),1),s("td",Xs,B(e[v.frequency.selected]),1),s("td",Ks,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:Y([v.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:J(i(_)),type:"button"},null,6)],8,ei)])],4))),128))])])],64))}}),ai=H(ti,[["__scopeId","data-v-e8f5ad9d"]]),la=t=>(ce("data-v-192e287b"),t=t(),ue(),t),oi=la(()=>s("p",{class:"heading ms-1 pt-2"},"Zeitpläne:",-1)),ri={class:"table table-borderless"},ni=la(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Von"),s("th",{class:"tableheader"},"Bis"),s("th",{class:"tableheader"},"Ladestrom"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader right"})])],-1)),si={class:"tablecell"},ii={class:"tablecell"},li={class:"tablecell"},ci={class:"tablecell"},ui={class:"tablecell left"},di=["href"],hi=V({__name:"CPConfigTimed",props:{chargeTemplateId:{}},setup(t){const e={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},a=t,o=g(()=>Je[a.chargeTemplateId]?Object.values(Je[a.chargeTemplateId])??[]:[]);function r(d){return{color:o.value[d].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function i(d){return{"font-weight":o.value[d].active?"bold":"regular"}}return(d,p)=>(c(),f(te,null,[oi,s("table",ri,[ni,s("tbody",null,[(c(!0),f(te,null,pe(o.value,(u,v)=>(c(),f("tr",{key:v,style:J(i(v))},[s("td",si,B(u.time[0]),1),s("td",ii,B(u.time[1]),1),s("td",li,B(u.current)+" A",1),s("td",ci,B(e[u.frequency.selected]),1),s("td",ui,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:Y([u.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:J(r(v)),type:"button"},null,6)],8,di)])],4))),128))])])],64))}}),pi=H(hi,[["__scopeId","data-v-192e287b"]]),gi={class:"settingsheader mt-2 ms-1"},mi=V({__name:"CPConfigVehicle",props:{vehicleId:{}},setup(t){const e=t;return(a,o)=>(c(),f(te,null,[s("p",gi," Profile für "+B(n(z)[e.vehicleId].name)+": ",1),k(K,{title:"Ladeprofil",icon:"fa-sliders",fullwidth:!0},{default:C(()=>[k(Qe,{modelValue:n(z)[e.vehicleId].chargeTemplateId,"onUpdate:modelValue":o[0]||(o[0]=r=>n(z)[e.vehicleId].chargeTemplateId=r),modelModifiers:{number:!0},options:Object.keys(n(ie)).map(r=>[n(ie)[+r].name,r])},null,8,["modelValue","options"])]),_:1}),k(K,{title:"Fahrzeug-Vorlage",icon:"fa-sliders",fullwidth:!0},{default:C(()=>[k(Qe,{modelValue:n(z)[e.vehicleId].evTemplateId,"onUpdate:modelValue":o[1]||(o[1]=r=>n(z)[e.vehicleId].evTemplateId=r),modelModifiers:{number:!0},options:Object.keys(n(yt)).map(r=>[n(yt)[+r].name,r])},null,8,["modelValue","options"])]),_:1})],64))}}),fi=H(mi,[["__scopeId","data-v-fcb57a44"]]),vi={class:"settingsheader mt-2 ms-1"},_i=V({__name:"CPChargeConfig",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint;return(o,r)=>(c(),f(te,null,[s("p",vi," Ladeeinstellungen für "+B(n(a).vehicleName)+": ",1),k(K,{title:"Lademodus",icon:"fa-charging-station",infotext:n(Pe).chargemode,fullwidth:!0},{default:C(()=>[k(Qe,{modelValue:n(a).chargeMode,"onUpdate:modelValue":r[0]||(r[0]=i=>n(a).chargeMode=i),options:Object.keys(n(be)).map(i=>[n(be)[i].name,i,n(be)[i].color,n(be)[i].icon])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),k(K,{title:"Fahrzeug wechseln",icon:"fa-car",infotext:n(Pe).vehicle,fullwidth:!0},{default:C(()=>[k(Qe,{modelValue:n(a).connectedVehicle,"onUpdate:modelValue":r[1]||(r[1]=i=>n(a).connectedVehicle=i),modelModifiers:{number:!0},options:Object.values(n(z)).map(i=>[i.name,i.id])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),k(K,{title:"Sperren",icon:"fa-lock",infotext:n(Pe).locked,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:n(a).isLocked,"onUpdate:modelValue":r[2]||(r[2]=i=>n(a).isLocked=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),k(K,{title:"Priorität",icon:"fa-star",infotext:n(Pe).priority,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:n(a).hasPriority,"onUpdate:modelValue":r[3]||(r[3]=i=>n(a).hasPriority=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),k(K,{title:"Zeitplan",icon:"fa-clock",infotext:n(Pe).timeplan,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:n(a).timedCharging,"onUpdate:modelValue":r[4]||(r[4]=i=>n(a).timedCharging=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),n(oe).active?(c(),T(K,{key:0,title:"Strompreisbasiert laden",icon:"fa-money-bill",infotext:n(Pe).pricebased,fullwidth:!0},{default:C(()=>[k(Ae,{modelValue:n(a).etActive,"onUpdate:modelValue":r[5]||(r[5]=i=>n(a).etActive=i)},null,8,["modelValue"])]),_:1},8,["infotext"])):w("",!0)],64))}}),yi=H(_i,[["__scopeId","data-v-a64493d7"]]),ca=t=>(ce("data-v-5286b19d"),t=t(),ue(),t),bi=ca(()=>s("p",{class:"settingsheader mt-2 ms-1"},"Preisbasiertes Laden:",-1)),wi={class:"providername ms-1"},ki=ca(()=>s("hr",null,null,-1)),Si={class:"container"},xi={id:"pricechart",class:"p-0 m-0"},Mi={viewBox:"0 0 400 300"},$i=["id","origin","transform"],Pi={key:0,class:"p-3"},Ci={key:1,class:"d-flex justify-content-end"},Ii=["disabled"],Ue=400,Vt=250,Dt=12,Bi=V({__name:"PriceChart",props:{chargepoint:{},globalview:{type:Boolean}},setup(t){const e=t;let a=e.chargepoint?ee(e.chargepoint.etMaxPrice):ee(0);const o=ee(!1),r=ee(e.chargepoint),i=g({get(){return a.value},set(m){a.value=m,o.value=!0}});function d(){r.value&&(P[r.value.id].etMaxPrice=i.value),o.value=!1}const p=ee(!1),u={top:0,bottom:15,left:20,right:5},v=g(()=>{let m=[];return oe.etPriceList.size>0&&oe.etPriceList.forEach((x,$)=>{m.push([$,x])}),m}),_=g(()=>v.value.length>1?(Ue-u.left-u.right)/v.value.length-1:0),L=g(()=>o.value?{background:"var(--color-charging)"}:{background:"var(--color-menu)"}),M=g(()=>{let m=De(v.value,x=>x[0]);return Ye().range([u.left,Ue-u.left-u.right]).domain(m)}),F=g(()=>{let m=De(v.value,x=>x[1]);return m[0]=Math.floor(m[0]-1),m[1]=Math.floor(m[1]+1),m}),D=g(()=>Oe().range([Vt-u.bottom,0]).domain(F.value)),N=g(()=>{const m=vt(),x=[[u.left,D.value(i.value)],[Ue-u.right,D.value(i.value)]];return m(x)}),A=g(()=>{const m=vt(),x=[[u.left,D.value(0)],[Ue-u.right,D.value(0)]];return m(x)}),U=g(()=>et(M.value).ticks(6).tickSize(5).tickFormat(ft("%H:%M"))),G=g(()=>lt(D.value).ticks(6).tickSizeInner(-(Ue-u.right-u.left)).tickFormat(m=>m.toString())),S=g(()=>{p.value==!0;const m=ve("g#"+b.value);m.selectAll("*").remove(),m.selectAll("bar").data(v.value).enter().append("g").append("rect").attr("class","bar").attr("x",Le=>M.value(Le[0])).attr("y",Le=>D.value(Le[1])).attr("width",_.value).attr("height",Le=>D.value(F.value[0])-D.value(Le[1])).attr("fill",Le=>Le[1]<=i.value?"var(--color-charging)":"var(--color-axis)");const $=m.append("g").attr("class","axis").call(U.value);$.attr("transform","translate(0,"+(Vt-u.bottom)+")"),$.selectAll(".tick").attr("font-size",Dt).attr("color","var(--color-bg)"),$.selectAll(".tick line").attr("stroke","var(--color-fg)").attr("stroke-width","0.5"),$.select(".domain").attr("stroke","var(--color-bg");const ne=m.append("g").attr("class","axis").call(G.value);return ne.attr("transform","translate("+u.left+",0)"),ne.selectAll(".tick").attr("font-size",Dt).attr("color","var(--color-bg)"),ne.selectAll(".tick line").attr("stroke","var(--color-bg)").attr("stroke-width","0.5"),ne.select(".domain").attr("stroke","var(--color-bg)"),F.value[0]<0&&m.append("path").attr("d",A.value).attr("stroke","var(--color-fg)"),m.append("path").attr("d",N.value).attr("stroke","yellow"),"PriceChart.vue"}),b=g(()=>e.chargepoint?"priceChartCanvas"+e.chargepoint.id:"priceChartCanvasGlobal");return Ze(()=>{p.value=!p.value}),(m,x)=>(c(),f(te,null,[bi,s("p",wi,"Anbieter: "+B(n(oe).etProvider),1),ki,s("div",Si,[s("figure",xi,[(c(),f("svg",Mi,[s("g",{id:b.value,origin:S.value,transform:"translate("+u.top+","+u.right+")"},null,8,$i)]))])]),m.chargepoint!=null?(c(),f("div",Pi,[m.chargepoint.etActive?(c(),T(Ie,{key:0,id:"foo",modelValue:i.value,"onUpdate:modelValue":x[0]||(x[0]=$=>i.value=$),min:-25,max:95,step:.1,decimals:1,unit:"ct"},null,8,["modelValue"])):w("",!0)])):w("",!0),m.chargepoint!=null?(c(),f("div",Ci,[s("span",{class:"me-3 pt-0",onClick:d},[s("button",{type:"button",class:"btn btn-secondary",style:J(L.value),disabled:!o.value}," Bestätigen ",12,Ii)])])):w("",!0)],64))}}),ua=H(Bi,[["__scopeId","data-v-5286b19d"]]),We=t=>(ce("data-v-fdc511bd"),t=t(),ue(),t),Oi={class:"status-string"},Li={style:{color:"red"}},Ti={class:"m-0 mt-4 p-0 grid-col-12 tabarea"},Ai={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},Vi=["data-bs-target"],Di=We(()=>s("i",{class:"fa-solid fa-charging-station"},null,-1)),Wi=[Di],Gi=["data-bs-target"],Ei=We(()=>s("i",{class:"fa-solid fa-lg fa-bolt"},null,-1)),zi=[Ei],ji=["data-bs-target"],Ui=We(()=>s("i",{class:"fa-solid fa-solar-panel me-1"},null,-1)),Fi=[Ui],Ni=["data-bs-target"],Ji=We(()=>s("i",{class:"fa-solid fa-bullseye me-1"},null,-1)),Ri=[Ji],Hi=["data-bs-target"],Yi=We(()=>s("i",{class:"fa-solid fa-clock"},null,-1)),qi=[Yi],Qi=["data-bs-target"],Zi=We(()=>s("i",{class:"fa-solid fa-rectangle-list"},null,-1)),Xi=[Zi],Ki=["data-bs-target"],el=We(()=>s("i",{class:"fa-solid fa-chart-line"},null,-1)),tl=[el],al={id:"settingsPanes",class:"tab-content mx-1 p-1 pb-3"},ol=["id"],rl=["id"],nl=["id"],sl=["id"],il=["id"],ll=["id"],cl=["id"],ul=V({__name:"CPChargeConfigPanel",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint,o=g(()=>ie[a.chargeTemplate]),r=g(()=>a.id);return Ze(()=>{}),(i,d)=>(c(),f(te,null,[k(K,{title:"Status",icon:"fa-info-circle",fullwidth:!0,class:"item"},{default:C(()=>[s("span",Oi,B(n(a).stateStr),1)]),_:1}),n(a).faultState!=0?(c(),T(K,{key:0,title:"Fehler",class:"grid-col-12"},{default:C(()=>[s("span",Li,B(n(a).faultStr),1)]),_:1})):w("",!0),s("div",Ti,[s("nav",Ai,[s("a",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+r.value},Wi,8,Vi),i.chargepoint.chargeMode=="instant_charging"?(c(),f("a",{key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+r.value},zi,8,Gi)):w("",!0),i.chargepoint.chargeMode=="pv_charging"?(c(),f("a",{key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+r.value},Fi,8,ji)):w("",!0),i.chargepoint.chargeMode=="scheduled_charging"?(c(),f("a",{key:2,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+r.value},Ri,8,Ni)):w("",!0),i.chargepoint.timedCharging?(c(),f("a",{key:3,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+r.value},qi,8,Hi)):w("",!0),s("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#carSettings"+r.value},Xi,8,Qi),n(oe).active&&n(a).etActive?(c(),f("a",{key:4,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#priceChart"+r.value},tl,8,Ki)):w("",!0)]),s("div",al,[s("div",{id:"chargeSettings"+r.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[k(yi,{chargepoint:i.chargepoint},null,8,["chargepoint"])],8,ol),s("div",{id:"instantSettings"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[k(Ws,{chargepoint:n(a),vehicles:n(z),"charge-templates":n(ie)},null,8,["chargepoint","vehicles","charge-templates"])],8,rl),s("div",{id:"pvSettings"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[k(Js,{chargepoint:n(a),vehicles:n(z),"charge-templates":n(ie)},null,8,["chargepoint","vehicles","charge-templates"])],8,nl),s("div",{id:"scheduledSettings"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[o.value!=null?(c(),T(ai,{key:0,"charge-template-id":n(a).chargeTemplate},null,8,["charge-template-id"])):w("",!0)],8,sl),s("div",{id:"timeSettings"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[o.value!=null?(c(),T(pi,{key:0,"charge-template-id":n(a).chargeTemplate},null,8,["charge-template-id"])):w("",!0)],8,il),s("div",{id:"carSettings"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"car-tab"},[n(z)[n(a).connectedVehicle]!=null?(c(),T(fi,{key:0,"vehicle-id":n(a).connectedVehicle},null,8,["vehicle-id"])):w("",!0)],8,ll),s("div",{id:"priceChart"+r.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"price-tab"},[n(z)[n(a).connectedVehicle]!=null?(c(),T(ua,{key:0,chargepoint:n(a)},null,8,["chargepoint"])):w("",!0)],8,cl)])])],64))}}),Wt=H(ul,[["__scopeId","data-v-fdc511bd"]]),dl=V({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=10?"fa-battery-empty":e.soc<50?"fa-battery-quarter":e.soc<75?"fa-battery-half":e.soc<95?"fa-battery-three-quarters":"fa-battery-full");return(o,r)=>(c(),f("span",null,[s("i",{class:Y(["fa batIcon",a.value])},null,2),q(" "+B(Math.round(o.soc)+"%"),1)]))}}),hl=H(dl,[["__scopeId","data-v-a0bd055c"]]),pl=V({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Rt(e.wattH,y.decimalPlaces));return(o,r)=>(c(),f("span",null,B(a.value),1))}}),gl=t=>(ce("data-v-6f679011"),t=t(),ue(),t),ml={class:"wb-widget p-0 m-0 shadow widgetWidth"},fl={class:"py-4 px-3 d-flex justify-content-between align-items-center"},vl=gl(()=>s("div",{class:"p-0"},"(title goes here)",-1)),_l={class:"p-0",style:{"text-align":"right"}},yl={class:"grid12 pb-3"},bl=V({__name:"WbWidgetFlex",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&y.preferWideBoxes?"col-lg-6":"col-lg-4");return(o,r)=>(c(),f("div",{class:Y(["p-2 m-0 d-flex",a.value])},[s("div",ml,[s("div",fl,[s("h3",null,[le(o.$slots,"title",{},()=>[vl],!0),le(o.$slots,"subtitle",{},void 0,!0)]),s("div",_l,[le(o.$slots,"buttons",{},void 0,!0)])]),s("div",yl,[le(o.$slots,"default",{},void 0,!0)])])],2))}}),wl=H(bl,[["__scopeId","data-v-6f679011"]]),je=t=>(ce("data-v-834bc991"),t=t(),ue(),t),kl=je(()=>s("span",{class:"fa-solid fa-charging-station"}," ",-1)),Sl={key:0},xl={class:"targetCurrent"},Ml={key:1,class:"row m-0 mt-0 p-0"},$l={class:"col m-0 p-0"},Pl={key:0},Cl={class:"col"},Il=je(()=>s("i",{class:"fa-solid fa-sm fa-car me-2"},null,-1)),Bl={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},Ol={key:1,class:"me-0 fa-solid fa-xs fa-coins ps-0"},Ll={class:"grid12"},Tl={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},Al={key:2,class:"socEditor rounded mt-2 d-flex flex-column align-items-center grid-col-12 grid-left"},Vl=je(()=>s("span",{class:"d-flex m-1 p-0 socEditTitle"},"Ladestand einstellen:",-1)),Dl={class:"d-flex justify-content-stretch align-items-center"},Wl={type:"button"},Gl=["id"],El=je(()=>s("span",{type:"button",class:"d-flex fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),zl=[El],jl=je(()=>s("span",{class:"fas fa-gear"}," ",-1)),Ul=je(()=>s("span",{class:"fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),Fl=[Ul],Nl=V({__name:"CPChargePoint",props:{chargepoint:{},fullWidth:{type:Boolean}},setup(t){const e=t,a=ee(e.chargepoint),o=g({get(){return e.chargepoint.chargeMode},set(m){P[e.chargepoint.id].chargeMode=m}}),r=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),i=g(()=>(Math.round(e.chargepoint.realCurrent*10)/10).toLocaleString(void 0)+" A"),d=g(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),p=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),u=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),v=g(()=>{let m="";return e.chargepoint.isLocked?m="fa-lock":e.chargepoint.isCharging?m=" fa-bolt":e.chargepoint.isPluggedIn&&(m="fa-plug"),"fa "+m}),_=g(()=>{switch(e.chargepoint.chargeMode){case"stop":return{color:"var(--fg)"};default:return{color:be[e.chargepoint.chargeMode].color}}}),L=g(()=>e.chargepoint.soc),M=g(()=>({color:e.chargepoint.color})),F=g(()=>e.chargepoint.etMaxPrice>=+S.value?{color:"var(--color-charging)"}:{color:"var(--color-menu)"}),D=ee(!1),N=ee(!1);function A(){X("socUpdate",1,e.chargepoint.connectedVehicle),P[e.chargepoint.id].waitingForSoc=!0}function U(){X("setSoc",G.value,e.chargepoint.connectedVehicle),N.value=!1}const G=g({get(){return e.chargepoint.soc},set(m){P[e.chargepoint.id].soc=m}}),S=g(()=>{const[m]=oe.etPriceList.values();return(Math.round(m*10)/10).toFixed(1)}),b=ee(!1);return(m,x)=>(c(),f(te,null,[D.value?w("",!0):(c(),T(ct,{key:0,"variable-width":!0,"full-width":e.fullWidth},{title:C(()=>[s("span",{style:J(M.value),onClick:x[0]||(x[0]=$=>D.value=!D.value)},[kl,q(" "+B(e.chargepoint.name),1)],4)]),footer:C(()=>[D.value?w("",!0):(c(),f("div",Pl,[s("div",{class:"row",onClick:x[2]||(x[2]=$=>D.value=!D.value)},[s("div",Cl,[s("h3",null,[Il,q(" "+B(m.chargepoint.vehicleName)+" ",1),m.chargepoint.hasPriority?(c(),f("span",Bl)):w("",!0),m.chargepoint.etActive?(c(),f("span",Ol)):w("",!0)])])]),s("div",Ll,[k(Zt,{id:"chargemode-"+m.chargepoint.name,modelValue:o.value,"onUpdate:modelValue":x[3]||(x[3]=$=>o.value=$),class:"chargemodes mt-3 mb-3",options:Object.keys(n(be)).map($=>({text:n(be)[$].name,value:$,color:n(be)[$].color,icon:n(be)[$].icon,active:n(be)[$].mode==m.chargepoint.chargeMode}))},null,8,["id","modelValue","options"]),m.chargepoint.isSocConfigured?(c(),T(de,{key:0,heading:"Ladestand:",class:"grid-col-4 grid-left"},{default:C(()=>[k(hl,{soc:L.value,class:"me-2"},null,8,["soc"]),m.chargepoint.isSocConfigured&&m.chargepoint.isSocManual?(c(),f("i",{key:0,class:"fa-solid fa-sm fas fa-edit",style:J({color:"var(--color-menu)"}),onClick:x[4]||(x[4]=$=>N.value=!N.value)},null,4)):w("",!0),m.chargepoint.isSocConfigured&&!m.chargepoint.isSocManual?(c(),f("i",{key:1,type:"button",class:Y(["fa-solid fa-sm",m.chargepoint.waitingForSoc?"fa-spinner fa-spin":"fa-sync"]),style:J({color:"var(--color-menu)"}),onClick:A},null,6)):w("",!0)]),_:1})):w("",!0),m.chargepoint.isSocConfigured?(c(),T(de,{key:1,heading:"Reichweite:",class:"grid-col-4"},{default:C(()=>[q(B(n(z)[e.chargepoint.connectedVehicle]?Math.round(n(z)[e.chargepoint.connectedVehicle].range):0)+" km ",1)]),_:1})):w("",!0),k(de,{heading:"Zeitplan:",class:"grid-col-4 grid-right"},{default:C(()=>[m.chargepoint.timedCharging?(c(),f("span",Tl)):w("",!0),q(" "+B(e.chargepoint.timedCharging?"Ja":"Nein"),1)]),_:1}),N.value?(c(),f("div",Al,[Vl,s("span",Dl,[s("span",null,[k(Ie,{id:"manualSoc",modelValue:G.value,"onUpdate:modelValue":x[5]||(x[5]=$=>G.value=$),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])])]),s("span",{type:"button",class:"fa-solid d-flex fa-lg me-2 mb-3 align-self-end fa-circle-check",onClick:U})])):w("",!0),n(oe).active?(c(),T(de,{key:3,heading:"Preisladen:",class:"grid-col-4 grid-left"},{default:C(()=>[k(Ae,{modelValue:a.value.etActive,"onUpdate:modelValue":x[6]||(x[6]=$=>a.value.etActive=$)},null,8,["modelValue"])]),_:1})):w("",!0),n(oe).active?(c(),T(de,{key:4,heading:"max. Preis:",class:"grid-col-4"},{default:C(()=>[s("span",Wl,B(e.chargepoint.etActive?(Math.round(e.chargepoint.etMaxPrice*10)/10).toFixed(1)+" ct":"-"),1)]),_:1})):w("",!0),n(oe).active?(c(),T(de,{key:5,heading:"akt. Preis:",class:"grid-col-4 grid-right"},{default:C(()=>[s("span",{style:J(F.value)},B(S.value)+" ct ",5)]),_:1})):w("",!0),b.value?(c(),f("div",{key:6,id:"priceChartInline"+e.chargepoint.id,class:"d-flex flex-column rounded priceEditor grid-col-12"},[n(z)[e.chargepoint.connectedVehicle]!=null?(c(),T(ua,{key:0,chargepoint:e.chargepoint},null,8,["chargepoint"])):w("",!0),s("span",{class:"d-flex ms-2 my-4 pe-3 pt-1 d-flex align-self-end",style:J(_.value),onClick:x[7]||(x[7]=$=>b.value=!1)},zl,4)],8,Gl)):w("",!0)])]))]),default:C(()=>[D.value?w("",!0):(c(),f("div",Sl,[s("div",{class:"grid12",onClick:x[1]||(x[1]=$=>D.value=!D.value)},[k(de,{heading:"Status:",class:"grid-col-4 grid-left"},{default:C(()=>[s("span",{style:J({color:u.value})},[s("i",{class:Y(v.value)},null,2),q(" "+B(p.value),1)],4)]),_:1}),k(de,{heading:"Geladen:",class:"grid-col-4"},{default:C(()=>[k(pl,{"watt-h":m.chargepoint.dailyYield},null,8,["watt-h"])]),_:1}),k(de,{heading:"gel. Reichw.:",class:"grid-col-4 grid-right"},{default:C(()=>[q(B(d.value),1)]),_:1}),e.chargepoint.power>0?(c(),T(de,{key:0,heading:"Leistung:",class:"grid-col-3 grid-left"},{default:C(()=>[k(Ht,{watt:e.chargepoint.power},null,8,["watt"])]),_:1})):w("",!0),e.chargepoint.power>0?(c(),T(de,{key:1,heading:"Strom:",class:"grid-col-3"},{default:C(()=>[q(B(i.value),1)]),_:1})):w("",!0),e.chargepoint.power>0?(c(),T(de,{key:2,heading:"Phasen:",class:"grid-col-3"},{default:C(()=>[q(B(e.chargepoint.phasesInUse),1)]),_:1})):w("",!0),e.chargepoint.power>0?(c(),T(de,{key:3,heading:"Sollstrom:",class:"grid-col-3 grid-right"},{default:C(()=>[s("span",xl,B(r.value),1)]),_:1})):w("",!0)])])),D.value?(c(),f("div",Ml,[s("div",$l,[m.chargepoint!=null?(c(),T(Wt,{key:0,chargepoint:m.chargepoint},null,8,["chargepoint"])):w("",!0)])])):w("",!0)]),_:1},8,["full-width"])),D.value?(c(),T(wl,{key:1,"full-width":e.fullWidth},{title:C(()=>[s("span",{style:J(M.value),onClick:x[8]||(x[8]=$=>D.value=!D.value)},[jl,q(" Einstellungen "+B(e.chargepoint.name),1)],4)]),buttons:C(()=>[s("span",{class:"ms-2 pt-1",style:J(_.value),onClick:x[9]||(x[9]=$=>D.value=!D.value)},Fl,4)]),default:C(()=>[m.chargepoint!=null?(c(),T(Wt,{key:0,chargepoint:m.chargepoint},null,8,["chargepoint"])):w("",!0)]),_:1},8,["full-width"])):w("",!0)],64))}}),Jl=H(Nl,[["__scopeId","data-v-834bc991"]]),Rl={class:"content"},Hl={class:"leftbar box"},Yl={class:"main box"},ql=V({__name:"DisplayTheme",setup(t){Ze(()=>{window.addEventListener("resize",Na),window.addEventListener("focus",e),qn()});function e(){document.hasFocus()&&re()}return(a,o)=>(c(),f("div",Rl,[s("div",Hl,[Object.values(n(P)).length>n(y).cpToShow?(c(),T(Jl,{key:0,chargepoint:Object.values(n(P))[n(y).cpToShow],"full-width":!0},null,8,["chargepoint"])):w("",!0)]),s("div",Yl,[Ge(s("div",null,[k(To)],512),[[dt,n(y).graphToShow=="powermeter"]]),Ge(s("div",null,[k(Hr)],512),[[dt,n(y).graphToShow=="powergraph"]]),Ge(s("div",null,[k(_n)],512),[[dt,n(y).graphToShow=="energymeter"]])])]))}}),da=H(ql,[["__scopeId","data-v-6a8ae437"]]),Ql={class:"fixeddisplay"},Zl=V({__name:"App",setup(t){return(e,a)=>(c(),f("div",Ql,[k(da),k(ao)]))}}),Xl=H(Zl,[["__scopeId","data-v-75d14554"]]),Kl=ka({history:Sa("/openWB/web/display/themes/colors"),routes:[{path:"/",name:"home",component:da}]}),ha=xa(Xl);ha.use(Kl);ha.mount("#app");
