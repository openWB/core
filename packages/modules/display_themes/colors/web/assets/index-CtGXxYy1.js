var ia=Object.defineProperty;var ca=(t,e,a)=>e in t?ia(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var s=(t,e,a)=>ca(t,typeof e!="symbol"?e+"":e,a);import{m as la,r as J,a as ce,M as Lt,d as A,o as h,c as _,n as X,b as $,e as he,f as oe,g,s as be,h as Ke,i as ua,j as c,t as C,u as n,k as P,w as I,l as j,p as we,q as ke,v as Dt,x as Gt,y as da,z as W,F as ie,A as pe,B as Ve,C as ut,D as Be,E as Vt,G as gt,H as Re,I as Ae,J as at,K as kt,L as ha,N as Ye,O as pa,P as ga,Q as ma,R as Fe,S as fa,T as He,U as rt,V as va}from"./vendor-BPRHbc3a.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=a(o);fetch(o.href,u)}})();function Je(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Et(t,e=1,a=!1){let r;if(t>1e6&&(a=!0,t=t/1e3),t>=1e3&&e<4){switch(e){case 0:r=Math.round(t/1e3);break;case 1:r=(Math.round(t/100)/10).toFixed(1);break;case 2:r=(Math.round(t/10)/100).toFixed(2);break;case 3:r=(Math.round(t)/1e3).toFixed(3);break;default:r=Math.round(t/100)/10;break}return r.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function _a(t){return t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}function ya(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}const ba=0,Wt={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clean:!1,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},Qe={topic:"",qos:ba};let le;const{host:wa,port:ka,endpoint:Sa,...Nt}=Wt,Ma=`${Nt.protocol}://${wa}:${ka}${Sa}`;try{le=la.connect(Ma,Nt),le.on("connect",()=>{console.info("MQTT connection successful.")}),le.on("disconnect",()=>{console.info("MQTT disconnected")}),le.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}async function xa(t){await jt(),le?le.on("message",t):console.error("MqttRegister: MQTT client not available")}async function Ce(t){Qe.topic=t;const{topic:e,qos:a}=Qe;await jt(),le.subscribe(e,{qos:a},r=>{if(r){console.error("MQTT Subscription error: "+r);return}})}function Oe(t){Qe.topic=t;const{topic:e}=Qe;le.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}async function dt(t,e){let r=le.connected,o=0;for(;!r&&o<10;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await zt(100),r=le.connected,o+=1;if(o<10)try{le.publish(t,e,{qos:0},u=>{u&&console.warn("MQTT publish error: ",u),console.info("MQTT publish: Message sent: ["+t+"]("+e+")")})}catch(u){console.warn("MQTT publish: caught error: "+u)}else console.error("MQTT publish: Lost connection to MQTT server. Please reload the page")}function mt(){return Wt.clientId}const St=20;async function jt(){let t=le.connected,e=0;for(;!t&&e<St;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await zt(100),t=le.connected,e+=1;return new Promise((a,r)=>{e<St?a(!0):r(!1)})}function zt(t){return new Promise(e=>setTimeout(e,t))}class Pa{constructor(e){s(this,"id");s(this,"name","Ladepunkt");s(this,"icon","Ladepunkt");s(this,"type","");s(this,"ev",0);s(this,"template",0);s(this,"connectedPhases",0);s(this,"phase_1",0);s(this,"autoPhaseSwitchHw",!1);s(this,"controlPilotInterruptionHw",!1);s(this,"isEnabled",!0);s(this,"isPluggedIn",!1);s(this,"isCharging",!1);s(this,"_isLocked",!1);s(this,"_connectedVehicle",0);s(this,"chargeTemplate",0);s(this,"evTemplate",0);s(this,"_chargeMode","pv_charging");s(this,"_hasPriority",!1);s(this,"currentPlan","");s(this,"averageConsumption",0);s(this,"vehicleName","");s(this,"rangeCharged",0);s(this,"rangeUnit","");s(this,"counter",0);s(this,"dailyYield",0);s(this,"energyPv",0);s(this,"energyBat",0);s(this,"pvPercentage",0);s(this,"faultState",0);s(this,"faultStr","");s(this,"phasesInUse",0);s(this,"power",0);s(this,"chargedSincePlugged",0);s(this,"stateStr","");s(this,"current",0);s(this,"currents",[0,0,0]);s(this,"phasesToUse",0);s(this,"isSocConfigured",!0);s(this,"isSocManual",!1);s(this,"waitingForSoc",!1);s(this,"color","white");s(this,"_timedCharging",!1);s(this,"_instantChargeLimitMode","");s(this,"_instantTargetCurrent",0);s(this,"_instantTargetSoc",0);s(this,"_instantMaxEnergy",0);s(this,"_pvFeedInLimit",!1);s(this,"_pvMinCurrent",0);s(this,"_pvMaxSoc",0);s(this,"_pvMinSoc",0);s(this,"_pvMinSocCurrent",0);s(this,"_etActive",!1);s(this,"_etMaxPrice",20);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,Q("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,Q("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get soc(){return U[this.connectedVehicle]?U[this.connectedVehicle].soc:0}set soc(e){U[this.connectedVehicle]&&(U[this.connectedVehicle].soc=e)}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,Q("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,Q("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get timedCharging(){return ve[this.chargeTemplate]?ve[this.chargeTemplate].time_charging.active:!1}set timedCharging(e){ve[this.chargeTemplate].time_charging.active=e,Q("cpTimedCharging",e,this.chargeTemplate)}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,Q("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,Q("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,Q("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,Q("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,Q("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,Q("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,Q("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,Q("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,Q("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}get realCurrent(){switch(this.phasesInUse){case 0:return 0;case 1:return this.currents[0];case 2:return(this.currents[0]+this.currents[1])/2;case 3:return(this.currents[0]+this.currents[1]+this.currents[2])/3;default:return 0}}get etActive(){return U[this.connectedVehicle]?U[this.connectedVehicle].etActive:!1}set etActive(e){U[this.connectedVehicle]&&(U[this.connectedVehicle].etActive=e)}get etMaxPrice(){return U[this.connectedVehicle].etMaxPrice??0}set etMaxPrice(e){console.log("Setting et max price needs to be implemented"),Q("cpEtMaxPrice",Math.round(e*10)/1e6,this.id)}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class $a{constructor(e){s(this,"id");s(this,"name","");s(this,"_chargeTemplateId",0);s(this,"_evTemplateId",0);s(this,"tags",[]);s(this,"config",{});s(this,"soc",0);s(this,"range",0);s(this,"_etActive",!1);s(this,"_etMaxPrice",20);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,Q("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,Q("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}get etActive(){return ve[this.chargeTemplateId]?ve[this.chargeTemplateId].et.active:!1}set etActive(e){ve[this.chargeTemplateId]&&Q("priceCharging",e,this.chargeTemplateId)}get etMaxPrice(){if(ve[this.chargeTemplateId]&&ve[this.chargeTemplateId].et.active)return ve[this.chargeTemplateId].et.max_price*1e5}get chargepoint(){for(const e of Object.values(b))if(e.connectedVehicle==this.id)return e}}var ge=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(ge||{});const b=J({}),U=J({}),ve=J({}),ot=J({}),nt=J({}),Ia=J({});function Ca(t){t in b||(b[t]=new Pa(t),b[t].color="var(--color-cp"+(Object.values(b).length-1)+")")}function Ba(){Object.keys(b).forEach(t=>{delete b[parseInt(t)]})}const Oa={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpTimedCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",cpEtMaxPrice:"openWB/set/vehicle/template/charge_template/%/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control",socUpdate:"openWB/set/vehicle/%/get/force_soc_update",setSoc:"openWB/set/vehicle/%/soc_module/calculated_soc_state/manual_soc",priceCharging:"openWB/set/vehicle/template/charge_template/%/et/active"};function Q(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let r=Oa[t];if(!r){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpEtMaxPrice":case"cpPvMinSocCurrent":r=r.replace("%",b[a].chargeTemplate.toString());break;default:r=r.replace("%",String(a))}switch(typeof e){case"number":dt(r,JSON.stringify(+e));break;default:dt(r,JSON.stringify(e))}}function ft(t){dt("openWB/set/command/"+mt()+"/todo",JSON.stringify(t))}class Ta{constructor(){s(this,"batterySoc",0);s(this,"isBatteryConfigured",!0);s(this,"chargeMode","0");s(this,"_pvBatteryPriority","ev_mode");s(this,"displayLiveGraph",!0);s(this,"isEtEnabled",!0);s(this,"etMaxPrice",0);s(this,"etCurrentPrice",0);s(this,"cpDailyExported",0);s(this,"evuId",0);s(this,"etProvider","");s(this,"ipAddress","");s(this,"systemTime","");s(this,"version","");s(this,"versionDetails","");s(this,"devBranch","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,Q("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const Aa=[["EV","ev_mode"],["Speicher","bat_mode"],["MinSoc","min_soc_bat_mode"]],te=J({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""},cp1:{name:"Ladepunkt",color:"var(--color-cp1)",icon:"Ladepunkt"},cp2:{name:"Ladepunkt",color:"var(--color-cp2)",icon:"Ladepunkt"},cp3:{name:"Ladepunkt",color:"var(--color-cp3)",icon:"Ladepunkt"},cp4:{name:"Ladepunkt",color:"var(--color-cp4)",icon:"Ladepunkt"},cp5:{name:"Ladepunkt",color:"var(--color-cp5)",icon:"Ladepunkt"},cp6:{name:"Ladepunkt",color:"var(--color-cp6)",icon:"Ladepunkt"},cp7:{name:"Ladepunkt",color:"var(--color-cp7)",icon:"Ladepunkt"},cp8:{name:"Ladepunkt",color:"var(--color-cp8)",icon:"Ladepunkt"},sh1:{name:"Gerät",color:"var(--color-sh1)",icon:"Gerät"},sh2:{name:"Gerät",color:"var(--color-sh2)",icon:"Gerät"},sh3:{name:"Gerät",color:"var(--color-sh3)",icon:"Gerät"},sh4:{name:"Gerät",color:"var(--color-sh4)",icon:"Gerät"},sh5:{name:"Gerät",color:"var(--color-sh5)",icon:"Gerät"},sh6:{name:"Gerät",color:"var(--color-sh6)",icon:"Gerät"},sh7:{name:"Gerät",color:"var(--color-sh7)",icon:"Gerät"},sh8:{name:"Gerät",color:"var(--color-sh8)",icon:"Gerät"},sh9:{name:"Gerät",color:"var(--color-sh9)",icon:"Gerät"}});class Ut{constructor(){s(this,"_items",{});this.addItem("evuIn"),this.addItem("pv"),this.addItem("batOut"),this.addItem("evuOut"),this.addItem("charging"),this.addItem("devices"),this.addItem("batIn"),this.addItem("house")}get items(){return this._items}keys(){return Object.keys(this._items)}values(){return Object.values(this._items)}addItem(e){this._items[e]=Pe(e)}setEnergy(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energy=a}setEnergyPv(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyPv=a}setEnergyBat(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyBat=a}setPvPercentage(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].pvPercentage=a}calculateHouseEnergy(){this._items.house.energy=this._items.evuIn.energy+this._items.pv.energy+this._items.batOut.energy-this._items.evuOut.energy-this._items.batIn.energy-this._items.charging.energy-this._items.devices.energy}}let S=new Ut;function vt(){S=new Ut}const E=J({evuIn:Pe("evuIn"),pv:Pe("pv"),batOut:Pe("batOut")}),B=J({evuOut:Pe("evuOut"),charging:Pe("charging"),devices:Pe("devices"),batIn:Pe("batIn"),house:Pe("house")}),F=J(new Ta);ce("");const qe=ce(!1);function Pe(t){return{name:te[t]?te[t].name:"item",power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:te[t]?te[t].color:"var(--color-charging)",icon:te[t]?te[t].icon:""}}const ae=J({active:!1,locked:!0,usePin:!1,code:"",timeout:60,localCpOnly:!1});function ht(){ae.usePin&&ae.locked?new Lt("#numberpad").toggle():(ae.locked=!1,setTimeout(()=>{ae.locked=!0},ae.timeout*1e3))}function La(t){return t==ae.code}function Da(){B.house.power=B.house.power-B.devices.power}const Mt=ce(new Date),Ga=A({__name:"DisplayButton",props:{icon:{},bgcolor:{},color:{}},emits:["click"],setup(t,{emit:e}){const a=t,r=e;function o(){r("click",!0)}return(u,l)=>(h(),_("div",{style:oe({"background-color":a.bgcolor?a.bgcolor:"var(--color-bg)",color:a.color?a.color:"var(--color-title)"}),class:"displaybutton rounded-pill",type:"button",onClick:o},[a.icon?(h(),_("span",{key:0,class:X(["fas me-2",a.icon])},null,2)):$("",!0),he(u.$slots,"default",{},void 0,!0)],4))}}),K=(t,e)=>{const a=t.__vccOpts||t;for(const[r,o]of e)a[r]=o;return a},$e=K(Ga,[["__scopeId","data-v-41a6697c"]]);class Va{constructor(e){s(this,"id");s(this,"name","Gerät");s(this,"power",0);s(this,"status","off");s(this,"energy",0);s(this,"runningTime",0);s(this,"configured",!1);s(this,"_showInGraph",!0);s(this,"color","white");s(this,"canSwitch",!1);s(this,"countAsHouse",!1);s(this,"energyPv",0);s(this,"energyBat",0);s(this,"pvPercentage",0);s(this,"tempConfigured",0);s(this,"temp",[300,300,300]);s(this,"on",!1);s(this,"isAutomatic",!0);s(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,H()}setShowInGraph(e){this._showInGraph=e}}const D=J({});function Ft(t){t in D?console.info("Duplicate sh device message: "+t):(D[t]=new Va(t),D[t].color="var(--color-sh"+Object.values(D).length+")")}class Ea{constructor(){s(this,"graphToShow","powermeter");s(this,"cpToShow",0);s(this,"displayLocked",!0);s(this,"_showRelativeArcs",!1);s(this,"showTodayGraph",!0);s(this,"_graphPreference","live");s(this,"_usageStackOrder",0);s(this,"_displayMode","dark");s(this,"_showGrid",!1);s(this,"_smartHomeColors","normal");s(this,"_decimalPlaces",1);s(this,"_showQuickAccess",!0);s(this,"_simpleCpList",!1);s(this,"_shortCpList","no");s(this,"_showAnimations",!0);s(this,"_preferWideBoxes",!1);s(this,"_maxPower",4e3);s(this,"_fluidDisplay",!1);s(this,"_showClock","no");s(this,"_showButtonBar",!0);s(this,"_showCounters",!1);s(this,"_showVehicles",!1);s(this,"_showPrices",!1);s(this,"_debug",!1);s(this,"isEtEnabled",!1);s(this,"etPrice",20.5);s(this,"showRightButton",!0);s(this,"showLeftButton",!0);s(this,"animationDuration",300);s(this,"animationDelay",100);s(this,"zoomGraph",!1)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,H()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,H()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,H()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,za(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,H()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,H()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,xt(e),H()}setSmartHomeColors(e){this._smartHomeColors=e,xt(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,H()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,H()}setSimpleCpList(e){this._simpleCpList=e}get shortCpList(){return this._shortCpList}set shortCpList(e){this._shortCpList=e,H()}setShortCpList(e){this._shortCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,H()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,H()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,H()}setMaxPower(e){this._maxPower=e}get fluidDisplay(){return this._fluidDisplay}set fluidDisplay(e){this._fluidDisplay=e,H()}setFluidDisplay(e){this._fluidDisplay=e}get showClock(){return this._showClock}set showClock(e){this._showClock=e,H()}setShowClock(e){this._showClock=e}get debug(){return this._debug}set debug(e){this._debug=e,H()}setDebug(e){this._debug=e}get showButtonBar(){return this._showButtonBar}set showButtonBar(e){this._showButtonBar=e,H()}setShowButtonBar(e){this._showButtonBar=e}get showCounters(){return this._showCounters}set showCounters(e){this._showCounters=e,H()}setShowCounters(e){this._showCounters=e}get showVehicles(){return this._showVehicles}set showVehicles(e){this._showVehicles=e,H()}setShowVehicles(e){this._showVehicles=e}get showPrices(){return this._showPrices}set showPrices(e){this._showPrices=e,H()}setShowPrices(e){this._showPrices=e}}const m=J(new Ea),Wa=992,pt=J({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function Na(){pt.x=document.documentElement.clientWidth,pt.y=document.documentElement.clientHeight}const ja=g(()=>pt.x>=Wa),Te={stop:{mode:ge.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:ge.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:ge.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:ge.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:ge.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function H(){Ua()}function za(t){const e=be("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),H()}function xt(t){const e=be("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}function Ua(){const t={};t.hideSH=Object.values(D).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=m.graphPreference=="live",t.displayM=m.displayMode,t.stackO=m.usageStackOrder,t.showGr=m.showGrid,t.decimalP=m.decimalPlaces,t.smartHomeC=m.smartHomeColors,t.relPM=m.showRelativeArcs,t.maxPow=m.maxPower,t.showQA=m.showQuickAccess,t.simpleCP=m.simpleCpList,t.shortCP=m.shortCpList,t.animation=m.showAnimations,t.wideB=m.preferWideBoxes,t.fluidD=m.fluidDisplay,t.clock=m.showClock,t.showButtonBar=m.showButtonBar,t.showCounters=m.showCounters,t.showVehicles=m.showVehicles,t.showPrices=m.showPrices,t.debug=m.debug,document.cookie="openWBColorTheme="+JSON.stringify(t)+";max-age=16000000;samesite=strict"}const Ee=t=>(we("data-v-126005ae"),t=t(),ke(),t),Fa={class:"navigation"},Ja={class:"graphbuttons"},Ra={class:"timedisplay"},Ya={class:"cpbuttons"},Ha=Ee(()=>c("span",{class:"fas fa-arrow-left px-2"},null,-1)),Qa=Ee(()=>c("span",{class:"fas fa-charging-station pe-2"},null,-1)),qa=Ee(()=>c("span",{class:"fas fa-lock px-4"},null,-1)),Xa=Ee(()=>c("span",{class:"fas fa-charging-station px-2"},null,-1)),Za=Ee(()=>c("span",{class:"fas fa-arrow-right pe-2"},null,-1)),Ka=A({__name:"NavigationBar",setup(t){let e;function a(){let p=Object.values(b).length;m.cpToShow=(m.cpToShow+1)%p}function r(){let p=Object.values(b).length;m.cpToShow=((m.cpToShow-1)%p+p)%p}function o(){m.graphToShow="powermeter"}function u(){m.graphToShow="powergraph"}function l(){m.graphToShow="energymeter"}return Ke(()=>{e=setInterval(()=>{Mt.value=new Date},1e3)}),ua(()=>{clearInterval(e)}),(p,d)=>(h(),_("div",Fa,[c("span",Ja,[c("span",Ra,C(n(_a)(n(Mt))),1),P($e,{icon:"fa-chart-pie",onClick:o},{default:I(()=>[j("Leistung")]),_:1}),P($e,{icon:"fa-chart-line",onClick:u},{default:I(()=>[j("Verlauf")]),_:1}),P($e,{icon:"fa-chart-column",onClick:l},{default:I(()=>[j("Energie")]),_:1})]),P($e,{icon:"fa-rectangle-list","data-bs-toggle":"modal","data-bs-target":"#statuspage"},{default:I(()=>[j("Status")]),_:1}),c("span",Ya,[P($e,{color:"var(--color-cp0)",onClick:r},{default:I(()=>[Ha,Qa]),_:1}),P($e,{bgcolor:n(ae).locked?"var(--color-evu)":"var(--color-pv)",onClick:n(ht)},{default:I(()=>[qa]),_:1},8,["bgcolor","onClick"]),P($e,{color:"var(--color-cp0)",onClick:a},{default:I(()=>[Xa,Za]),_:1})])]))}}),er=K(Ka,[["__scopeId","data-v-126005ae"]]),tr=["origin"],ar=A({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let r={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},o=E;o["zz-empty"]=r;const u=Object.values(E).length-1,l=Dt().value(f=>f.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),p=Gt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),d=be("g#pmSourceArc");return d.selectAll("*").remove(),d.selectAll("sources").data(l(Object.values(o))).enter().append("path").attr("d",p).attr("fill",f=>f.data.color).attr("stroke",(f,v)=>v==u?f.data.power>0?"var(--color-scale)":"null":f.data.color),"pmSourceArc.vue"});return da(()=>{let r=E.pv.power+E.evuIn.power+E.batOut.power;r>m.maxPower&&(m.maxPower=r)}),(r,o)=>(h(),_("g",{id:"pmSourceArc",origin:a.value},null,8,tr))}}),rr=["origin"],or=A({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let r={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const o=[B.evuOut,B.charging].concat(Object.values(D).filter(f=>f.configured&&!f.countAsHouse).sort((f,v)=>v.power-f.power)).concat([B.batIn,B.house]).concat(r),u=o.length-1,l=Dt().value(f=>f.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),p=Gt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),d=be("g#pmUsageArc");return d.selectAll("*").remove(),d.selectAll("consumers").data(l(o)).enter().append("path").attr("d",p).attr("fill",f=>f.data.color).attr("stroke",(f,v)=>v==u?f.data.power>0?"var(--color-scale)":"null":f.data.color),"pmUsageArc.vue"});return(r,o)=>(h(),_("g",{id:"pmUsageArc",origin:a.value},null,8,rr))}}),Jt=A({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>Je(e.watt,m.decimalPlaces));return(r,o)=>C(a.value)}}),nr={key:0,id:"pmLabel"},sr=["x","y","fill","text-anchor"],ir=22,me=A({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),r=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),o=g(()=>!e.data||e.data.power>0),u=g(()=>e.labeltext?"":"fas");return(l,p)=>o.value?(h(),_("g",nr,[c("text",{x:l.x,y:l.y,fill:r.value,"text-anchor":l.anchor,"font-size":ir,class:"pmLabel"},[c("tspan",{class:X(u.value)},C(a.value),3),c("tspan",null,[l.data!==void 0?(h(),W(Jt,{key:0,watt:l.data.power},null,8,["watt"])):$("",!0)])],8,sr)])):$("",!0)}}),cr={class:"wb-widget p-0 m-0 shadow"},lr={class:"d-flex justify-content-between"},ur={class:"m-4 me-0 mb-0"},dr=c("div",{class:"p-0"},"(title goes here)",-1),hr={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},pr={class:"px-4 pt-4 pb-2 wb-subwidget"},gr={class:"row"},mr={class:"col m-0 p-0"},fr={class:"container-fluid m-0 p-0"},vr={key:0},_r=c("hr",null,null,-1),yr={class:"px-4 py-2 wb-subwidget"},br={class:"row"},wr={class:"col"},kr={class:"container-fluid m-0 p-0"},et=A({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&m.preferWideBoxes?"col-lg-6":"col-lg-4");return(r,o)=>(h(),_("div",{class:X(["p-2 m-0 d-flex",a.value])},[c("div",cr,[c("div",lr,[c("h3",ur,[he(r.$slots,"title",{},()=>[dr]),he(r.$slots,"subtitle")]),c("div",hr,[he(r.$slots,"buttons")])]),c("div",pr,[c("div",gr,[c("div",mr,[c("div",fr,[he(r.$slots,"default")])])])]),r.$slots.footer!=null?(h(),_("div",vr,[_r,c("div",yr,[c("div",br,[c("div",wr,[c("div",kr,[he(r.$slots,"footer")])])])])])):$("",!0)])],2))}});class Sr{constructor(){s(this,"active",!1);s(this,"etPriceList",new Map);s(this,"etProvider","");s(this,"etMaxPrice",0)}get etCurrentPriceString(){const[e]=re.etPriceList.values();return(Math.round(e*10)/10).toFixed(1)+" ct"}}const re=J(new Sr),Mr={id:"powermeter",class:"p-0 m-0"},xr=["viewBox"],Pr=["transform"],$r={transform:"scale(0.9294,1)"},Ir=["x"],Se=500,Me=20,Pt=1,Cr=A({__name:"PowerMeter",setup(t){const e=Se,a=Math.PI/40,r=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],o=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],u=g(()=>Se/2-Me),l=g(()=>{let k="",N=Object.values(E).filter(L=>L.power>0);return N.length==1&&N[0].name=="PV"?k="Aktueller Verbrauch: ":k="Bezug/Verbrauch: ",k+Je(B.house.power+B.charging.power+B.devices.power+B.batIn.power,m.decimalPlaces)}),p=g(()=>{let k=E.pv.power+E.evuIn.power+E.batOut.power;return m.maxPower>k?Je(m.maxPower,m.decimalPlaces):Je(k,m.decimalPlaces)}),d=g(()=>Object.values(b)),f=g(()=>{let k=0;return m.showRelativeArcs&&(k=m.maxPower-(E.pv.power+E.evuIn.power+E.batOut.power)),k<0?0:k}),v=g(()=>[B.evuOut,B.charging,B.devices,B.batIn,B.house].filter(k=>k.power>0)),O=g(()=>r[v.value.length-1]);function M(k){return o[O.value[k]]}function R(k){return Math.round(d.value[k].soc)}function ee(k){return k.length>12?k.slice(0,11)+".":k}const Y=g(()=>{const[k]=re.etPriceList.values();return Math.round(k*10)/10});return(k,N)=>(h(),W(et,{"full-width":!0},{title:I(()=>[j(" Aktuelle Leistung ")]),default:I(()=>[c("figure",Mr,[(h(),_("svg",{viewBox:"0 0 "+Se+" "+n(e)},[c("g",{transform:"translate("+Se/2+","+n(e)/2+")"},[c("g",$r,[P(ar,{radius:u.value,"corner-radius":Pt,"circle-gap-size":a,"empty-power":f.value},null,8,["radius","empty-power"]),P(or,{"sh-device":n(D),radius:u.value,"corner-radius":Pt,"circle-gap-size":a,"empty-power":f.value},null,8,["sh-device","radius","empty-power"]),P(me,{x:0,y:-n(e)/10*2,data:n(E).pv,props:n(te).pv,anchor:"middle",config:n(m)},null,8,["y","data","props","config"]),P(me,{x:0,y:-n(e)/10*3,data:n(E).evuIn,props:n(te).evuIn,anchor:"middle",config:n(m)},null,8,["y","data","props","config"]),P(me,{x:0,y:-n(e)/10,data:n(E).batOut,props:n(te).batOut,anchor:"middle",config:n(m)},null,8,["y","data","props","config"]),n(re).active?(h(),W(me,{key:0,x:0,y:-n(e)/10,data:n(E).batOut,props:n(te).batOut,anchor:"middle",config:n(m)},null,8,["y","data","props","config"])):$("",!0),(h(!0),_(ie,null,pe(v.value,(L,w)=>(h(),W(me,{key:w,x:M(w).x,y:M(w).y,data:L,labelicon:L.icon,labelcolor:L.color,anchor:"middle",config:n(m)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),d.value.length>0&&n(U)[d.value[0].connectedVehicle]?(h(),W(me,{key:1,x:-Se/2-Me/4+10,y:-n(e)/2+Me+5,labeltext:ee(n(U)[d.value[0].connectedVehicle].name)+": "+R(0)+"%",labelcolor:d.value[0].color,anchor:"start",config:n(m)},null,8,["x","y","labeltext","labelcolor","config"])):$("",!0),d.value.length>1&&n(U)[d.value[1].connectedVehicle]?(h(),W(me,{key:2,x:Se/2+Me/4-10,y:-n(e)/2+Me+5,labeltext:ee(n(U)[d.value[1].connectedVehicle].name)+": "+R(1)+"%",labelcolor:d.value[1].color,anchor:"end",config:n(m)},null,8,["x","y","labeltext","labelcolor","config"])):$("",!0),n(F).batterySoc>0?(h(),W(me,{key:3,x:-Se/2-Me/4+10,y:n(e)/2-Me+15,labeltext:"Speicher: "+n(F).batterySoc+"%",labelcolor:n(B).batIn.color,anchor:"start",config:n(m)},null,8,["x","y","labeltext","labelcolor","config"])):$("",!0),n(re).active?(h(),W(me,{key:4,x:Se/2+Me/4-10,y:n(e)/2-Me+15,value:Y.value,labeltext:n(re).etCurrentPriceString,labelcolor:"var(--color-charging)",anchor:"end",config:n(m)},null,8,["x","y","value","labeltext","config"])):$("",!0),P(me,{x:0,y:0,labeltext:l.value,labelcolor:"var(--color-fg)",anchor:"middle",config:n(m)},null,8,["labeltext","config"]),n(m).showRelativeArcs?(h(),_("text",{key:5,x:Se/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+C(p.value),9,Ir)):$("",!0)])],8,Pr)],8,xr))])]),_:1}))}}),fe=500,xe=500,T={top:10,right:20,bottom:10,left:25},_t=["charging","house","batIn","devices"];class Br{constructor(){s(this,"data",[]);s(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const i=J(new Br);let Xe=!0,Ge=!0;function $t(){Xe=!1}function It(){Ge=!1}function Or(t){Ge=t}function We(t){i.data=t}const q=J({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){i.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),Ce(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[],Gr(),qe.value=!0},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),Oe(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)Ce(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)Oe(this.refreshTopicPrefix+t)},subscribeUpdates(){Ce(this.updateTopic)},unsubscribeUpdates(){Oe(this.updateTopic)}}),z=J({topic:"openWB/log/daily/#",date:new Date,activate(){if(i.graphMode=="day"||i.graphMode=="today"){i.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");Ce(this.topic),ft({command:"getDailyLog",data:{day:t}})}},deactivate(){Oe(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),_e=J({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");i.data=[],Ce(this.topic),ft({command:"getMonthlyLog",data:{month:t}})},deactivate(){Oe(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){const t=new Date;t.getFullYear()==this.year?this.month-1<t.getMonth()&&(this.month=this.month+1):(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1)),this.activate()},getDate(){return new Date(this.year,this.month)}}),Ie=J({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();i.data=[],Ce(this.topic),ft({command:"getYearlyLog",data:{year:t}})},deactivate(){Oe(this.topic)},back(){this.year-=1,this.activate()},forward(){this.year<new Date().getFullYear()&&(this.year=this.year+1,this.activate())},getDate(){return new Date(this.year,this.month)}});function Z(t=!1){switch(i.graphMode==""?Tr(m.graphPreference):i.graphMode=="live"?m.graphPreference="live":m.graphPreference="today",t||(Xe=!0,Ge=!0),i.graphMode){case"live":z.deactivate(),_e.deactivate(),Ie.deactivate(),q.activate();break;case"today":q.deactivate(),_e.deactivate(),Ie.deactivate(),z.activate();break;case"day":q.deactivate(),_e.deactivate(),Ie.deactivate(),z.activate();break;case"month":q.deactivate(),z.deactivate(),Ie.deactivate(),_e.activate();break;case"year":q.deactivate(),z.deactivate(),_e.deactivate(),Ie.activate();break}}function Tr(t){i.graphMode=t}function Ar(t,e){e[t]>0&&(S.items[t].energyPv+=1e3/12*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),S.items[t].energyBat+=1e3/12*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}function Lr(t,e){e[t]>0&&(S.items[t].energyPv+=1e3*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),S.items[t].energyBat+=1e3*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}const Dr=["evuIn","pv","batIn","evuOut"],Le=ce(!1);function yt(t,e){Object.entries(t).length>0?(Le.value=!1,Object.entries(t.counter).forEach(([a,r])=>{(e.length==0||e.includes(a))&&(S.items.evuIn.energy+=r.energy_imported,S.items.evuOut.energy+=r.energy_exported)}),S.items.pv.energy=t.pv.all.energy_exported,t.bat.all&&(S.items.batIn.energy=t.bat.all.energy_imported,S.items.batOut.energy=t.bat.all.energy_exported),Object.entries(t.cp).forEach(([a,r])=>{a=="all"?S.setEnergy("charging",r.energy_imported):S.setEnergy(a,r.energy_imported)}),S.setEnergy("devices",0),Object.entries(t.sh).forEach(([a,r])=>{S.setEnergy(a,r.energy_imported);const o=a.substring(2);D[+o].countAsHouse||(S.items.devices.energy+=r.energy_imported)}),t.hc&&t.hc.all?S.setEnergy("house",t.hc.all.energy_imported):S.calculateHouseEnergy(),S.keys().map(a=>{Dr.includes(a)||(S.setPvPercentage(a,Math.round((S.items[a].energyPv+S.items[a].energyBat)/S.items[a].energy*100)),_t.includes(a)&&(B[a].energy=S.items[a].energy,B[a].energyPv=S.items[a].energyPv,B[a].energyBat=S.items[a].energyBat,B[a].pvPercentage=S.items[a].pvPercentage))}),i.graphMode=="today"&&(Object.values(b).map(a=>{const r=S.items["cp"+a.id];r&&(a.energyPv=r.energyPv,a.energyBat=r.energyBat,a.pvPercentage=r.pvPercentage)}),Object.values(D).map(a=>{const r=S.items["sh"+a.id];r&&(a.energy=r.energy,a.energyPv=r.energyPv,a.energyBat=r.energyBat,a.pvPercentage=r.pvPercentage)}))):Le.value=!0,qe.value=!0}function Gr(){S.keys().map(t=>{_t.includes(t)&&(B[t].energy=S.items[t].energy,B[t].energyPv=0,B[t].energyBat=0,B[t].pvPercentage=0)}),Object.values(b).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0}),Object.values(D).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0})}const ye=g(()=>{const t=Ve(i.data,e=>e.date);return t[1]?ut().domain(Array.from({length:t[1]},(e,a)=>a+1)).paddingInner(.4).range([0,fe-T.left-2]):ut().range([0,0])});function bt(){switch(i.graphMode){case"live":i.graphMode="today",m.showRightButton=!0,Z();break;case"today":i.graphMode="day",z.date=new Date,z.back(),Z();break;case"day":z.back(),Z();break;case"month":_e.back();break;case"year":Ie.back();break}}function Rt(){const t=new Date;switch(i.graphMode){case"live":break;case"today":i.graphMode="live",m.showRightButton=!1,Z();break;case"day":z.forward(),z.date.getDate()==t.getDate()&&z.date.getMonth()==t.getMonth()&&z.date.getFullYear()==t.getFullYear()&&(i.graphMode="today"),Z();break;case"month":_e.forward();break;case"year":Ie.forward();break}}function Yt(){switch(i.graphMode){case"live":bt();break;case"day":case"today":i.graphMode="month",Z();break;case"month":i.graphMode="year",Z();break}}function Ht(){switch(i.graphMode){case"year":i.graphMode="month",Z();break;case"month":i.graphMode="today",Z();break;case"today":case"day":i.graphMode="live",Z();break}}function Ct(t){if(i.graphMode=="day"||i.graphMode=="today"){z.setDate(t);const e=new Date;z.date.getDate()==e.getDate()&&z.date.getMonth()==e.getMonth()&&z.date.getFullYear()==e.getFullYear()?i.graphMode="today":i.graphMode="day",Z()}}const Vr=["origin","transform"],Er=A({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)"};var r,o;const u=m.showAnimations?m.animationDuration:0,l=m.showAnimations?m.animationDelay:0,p=g(()=>{const y=be("g#pgSourceGraph");i.graphMode=="month"||i.graphMode=="year"?w(y):L(y),y.selectAll(".axis").remove();const x=y.append("g").attr("class","axis");return x.call(Y.value),x.selectAll(".tick").attr("font-size",12),x.selectAll(".tick line").attr("stroke",N.value).attr("stroke-width",k.value),x.select(".domain").attr("stroke","var(--color-bg)"),"pgSourceGraph.vue"}),d=g(()=>i.graphMode=="month"||i.graphMode=="year"?["evuIn","batOut","selfUsage","evuOut"]:["selfUsage","evuOut","batOut","evuIn"]),f=g(()=>Be().domain([0,i.data.length-1]).range([0,e.width])),v=g(()=>Vt().keys(d.value)),O=g(()=>v.value(i.data)),M=g(()=>Be().range([e.height-10,0]).domain(i.graphMode=="year"?[0,Math.ceil(R.value[1]*10)/10]:[0,Math.ceil(R.value[1])])),R=g(()=>{let y=Ve(i.data,x=>Math.max(x.pv+x.evuIn+x.batOut,x.selfUsage+x.evuOut));return y[0]!=null&&y[1]!=null?(i.graphMode=="year"&&(y[0]=y[0]/1e3,y[1]=y[1]/1e3),y):[0,0]}),ee=g(()=>i.graphMode=="month"||i.graphMode=="year"?-e.width-e.margin.right-22:-e.width),Y=g(()=>gt(M.value).tickSizeInner(ee.value).ticks(4).tickFormat(y=>(y==0?"":Math.round(y*10)/10).toLocaleString(void 0))),k=g(()=>m.showGrid?"0.5":"1"),N=g(()=>m.showGrid?"var(--color-grid)":"var(--color-bg)");function L(y){const x=Re().x((V,de)=>f.value(de)).y(M.value(0)),G=Re().x((V,de)=>f.value(de)).y0(V=>M.value(i.graphMode=="year"?V[0]/1e3:V[0])).y1(V=>M.value(i.graphMode=="year"?V[1]/1e3:V[1]));Xe?(y.selectAll("*").remove(),r=y.selectAll(".sourceareas").data(O.value).enter().append("path").attr("fill",(V,de)=>a[d.value[de]]).attr("d",V=>x(V)),r.transition().duration(u).delay(l).ease(Ae).attr("d",V=>G(V)),$t()):r.data(O.value).transition().duration(0).ease(Ae).attr("d",V=>G(V))}function w(y){Xe?(y.selectAll("*").remove(),o=y.selectAll(".sourcebar").data(O.value).enter().append("g").attr("fill",(x,G)=>a[d.value[G]]).selectAll("rect").data(x=>x).enter().append("rect").attr("x",(x,G)=>ye.value(i.data[G].date)??0).attr("y",()=>M.value(0)).attr("height",0).attr("width",ye.value.bandwidth()),o.transition().duration(u).delay(l).ease(Ae).attr("height",x=>i.graphMode=="year"?M.value(x[0]/1e3)-M.value(x[1]/1e3):M.value(x[0])-M.value(x[1])).attr("y",x=>i.graphMode=="year"?M.value(x[1]/1e3):M.value(x[1])),$t()):(y.selectAll("*").remove(),o=y.selectAll(".sourcebar").data(O.value).enter().append("g").attr("fill",(x,G)=>a[d.value[G]]).selectAll("rect").data(x=>x).enter().append("rect").attr("x",(x,G)=>ye.value(i.data[G].date)??0).attr("y",x=>i.graphMode=="year"?M.value(x[1]/1e3):M.value(x[1])).attr("width",ye.value.bandwidth()).attr("height",x=>i.graphMode=="year"?M.value(x[0]/1e3)-M.value(x[1]/1e3):M.value(x[0])-M.value(x[1])))}return(y,x)=>(h(),_("g",{id:"pgSourceGraph",origin:p.value,transform:"translate("+y.margin.left+","+y.margin.top+")"},null,8,Vr))}}),Wr=["origin","transform"],Nr=A({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn"],["charging","devices","house","batIn"],["devices","charging","house","batIn"]],r={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var o,u;const l=m.showAnimations?m.animationDuration:0,p=m.showAnimations?m.animationDelay:0,d=g(()=>{const w=be("g#pgUsageGraph");i.graphMode=="month"||i.graphMode=="year"?L(w):N(w),w.selectAll(".axis").remove();const y=w.append("g").attr("class","axis");return y.call(k.value),y.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),m.showGrid?y.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):y.selectAll(".tick line").attr("stroke","var(--color-bg)"),y.select(".domain").attr("stroke","var(--color-bg)"),"pgUsageGraph.vue"}),f=g(()=>Vt().keys(R.value)),v=g(()=>f.value(i.data)),O=g(()=>Be().domain([0,i.data.length-1]).range([0,e.width])),M=g(()=>Be().range([e.height+10,2*e.height]).domain(i.graphMode=="year"?[0,Math.ceil(ee.value[1]*10)/10]:[0,Math.ceil(ee.value[1])])),R=g(()=>{if(i.graphMode!="today"&&i.graphMode!="day")return a[e.stackOrder];{const w=a[e.stackOrder].slice(),y=w.indexOf("charging");w.splice(y,1);const x=/cp\d+/;let G=[];return i.data.length>0&&(G=Object.keys(i.data[0]).reduce((V,de)=>(de.match(x)&&V.push(de),V),[])),G.map((V,de)=>{w.splice(y+de,0,V),r[V]="var(--color-cp"+de+")"}),w}}),ee=g(()=>{let w=Ve(i.data,y=>y.house+y.charging+y.batIn+y.devices);return w[0]!=null&&w[1]!=null?(i.graphMode=="year"&&(w[0]=w[0]/1e3,w[1]=w[1]/1e3),w):[0,0]}),Y=g(()=>i.graphMode=="month"||i.graphMode=="year"?-e.width-e.margin.right-22:-e.width),k=g(()=>gt(M.value).tickSizeInner(Y.value).ticks(4).tickFormat(w=>(w==0?"":Math.round(w*10)/10).toLocaleString(void 0)));function N(w){const y=Re().x((G,V)=>O.value(V)).y(M.value(0)),x=Re().x((G,V)=>O.value(V)).y0(G=>M.value(G[0])).y1(G=>M.value(G[1]));m.showAnimations?Ge?(w.selectAll("*").remove(),o=w.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",G=>y(G)).attr("fill",(G,V)=>r[R.value[V]]),o.transition().duration(300).delay(100).ease(Ae).attr("d",G=>x(G)),It()):(w.selectAll("*").remove(),w.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",G=>x(G)).attr("fill",(G,V)=>r[R.value[V]])):(w.selectAll("*").remove(),w.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",G=>x(G)).attr("fill",(G,V)=>r[R.value[V]]))}function L(w){Ge?(w.selectAll("*").remove(),u=w.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(y,x)=>r[a[e.stackOrder][x]]).selectAll("rect").data(y=>y).enter().append("rect").attr("x",(y,x)=>ye.value(i.data[x].date)??0).attr("y",()=>M.value(0)).attr("height",0).attr("width",ye.value.bandwidth()),u.transition().duration(l).delay(p).ease(Ae).attr("y",y=>i.graphMode=="year"?M.value(y[0]/1e3):M.value(y[0])).attr("height",y=>i.graphMode=="year"?M.value(y[1]/1e3)-M.value(y[0]/1e3):M.value(y[1])-M.value(y[0])),It()):(w.selectAll("*").remove(),u=w.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(y,x)=>r[a[e.stackOrder][x]]).selectAll("rect").data(y=>y).enter().append("rect").attr("x",(y,x)=>ye.value(i.data[x].date)??0).attr("y",y=>i.graphMode=="year"?M.value(y[0]/1e3):M.value(y[0])).attr("height",y=>i.graphMode=="year"?M.value(y[1]/1e3)-M.value(y[0]/1e3):M.value(y[1])-M.value(y[0])).attr("width",ye.value.bandwidth()))}return(w,y)=>(h(),_("g",{id:"pgUsageGraph",origin:d.value,transform:"translate("+w.margin.left+","+w.margin.top+")"},null,8,Wr))}}),jr=["transform"],zr=["origin","transform"],Ur=["origin","transform"],Fr={key:0},Jr=["width","height"],Rr={key:1},Yr=["y","width","height"],st=12,Hr=A({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>at(p.value).ticks(4).tickSizeInner(l.value).tickFormat(kt("%H:%M"))),r=g(()=>ha(p.value).ticks(4).tickSizeInner(l.value+3).tickFormat(kt(""))),o=g(()=>at(ye.value).ticks(4).tickSizeInner(l.value).tickFormat(v=>v.toString())),u=g(()=>at(ye.value).ticks(4).tickSizeInner(l.value).tickFormat(()=>"")),l=g(()=>i.graphMode!=="month"&&i.graphMode!=="year"?m.showGrid?-(e.height/2-7):-10:0),p=g(()=>{let v=Ve(i.data,O=>O.date);return v[0]&&v[1]?Ye().domain(v).range([0,e.width]):Ye().range([0,0])}),d=g(()=>{let v=be("g#PGXAxis");return v.selectAll("*").remove(),i.graphMode=="month"||i.graphMode=="year"?v.call(o.value):v.call(a.value),v.selectAll(".tick > text").attr("fill",(O,M)=>M>0||i.graphMode=="month"||i.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",st),m.showGrid?v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),v.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",st).text(i.graphMode=="year"?"MW":"kW").attr("text-anchor","start"),"PGXAxis.vue"}),f=g(()=>{let v=be("g#PGXAxis2");return v.selectAll("*").remove(),i.graphMode=="month"||i.graphMode=="year"?v.call(u.value):v.call(r.value),v.selectAll(".tick > text").attr("fill",(O,M)=>M>0||i.graphMode=="month"||i.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",st),m.showGrid?(v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),v.select(".domain").attr("stroke","var(--color-bg)")):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),"PGXAxis2.vue"});return(v,O)=>(h(),_("g",{transform:"translate("+v.margin.left+","+v.margin.top+")"},[c("g",{id:"PGXAxis",class:"axis",origin:d.value,transform:"translate(0,"+(v.height/2-6)+")"},null,8,zr),c("g",{id:"PGXAxis2",class:"axis",origin:f.value,transform:"translate(0,"+(v.height/2+10)+")"},null,8,Ur),n(m).showGrid?(h(),_("g",Fr,[c("rect",{x:"0",y:"0",width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Jr)])):$("",!0),n(m).showGrid?(h(),_("g",Rr,[c("rect",{x:"0",y:v.height/2+10,width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Yr)])):$("",!0)],8,jr))}}),Qr=["d"],qr=["d","stroke"],Xr=["x","y","text-anchor"],it=A({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>{let O=Ve(i.data,M=>M.date);return O[0]&&O[1]?Ye().domain(O).range([0,e.width]):Ye().range([0,0])}),r=g(()=>Be().range([e.height-10,0]).domain([0,100])),o=g(()=>{let M=pa().x(R=>a.value(R.date)).y(R=>r.value(e.order==2?R.batSoc:R["soc"+d.value.connectedVehicle])??r.value(0))(i.data);return M||""}),u=g(()=>e.order==2?"Speicher":d.value.vehicleName),l=g(()=>{switch(e.order){case 0:return"var(--color-cp1)";case 1:return"var(--color-cp2)";case 2:return"var(--color-battery)";default:return"red"}}),p=g(()=>{switch(e.order){case 0:return e.width-3;case 1:return 3;case 2:return e.width/2;default:return 0}}),d=g(()=>{const O=e.order==2?0:e.order;return Object.values(b)[O]}),f=g(()=>{if(i.data.length>0){let O;switch(e.order){case 0:return O=i.data.length-1,r.value(i.data[O]["soc"+d.value.connectedVehicle]+2);case 1:return O=0,r.value(i.data[O]["soc"+d.value.connectedVehicle]+2);case 2:return O=Math.round(i.data.length/2),r.value(i.data[O].batSoc+2);default:return 0}}else return 0}),v=g(()=>{switch(e.order){case 0:return"end";case 1:return"start";case 2:return"middle";default:return"middle"}});return(O,M)=>(h(),_(ie,null,[c("path",{class:"soc-baseline",d:o.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,Qr),c("path",{class:"soc-dashes",d:o.value,stroke:l.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,qr),c("text",{class:"cpname",x:p.value,y:f.value,style:oe({fill:l.value,fontSize:10}),"text-anchor":v.value},C(u.value),13,Xr)],64))}}),Zr=["transform"],Kr=A({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Be().range([e.height-10,0]).domain([0,100])),r=g(()=>ga(a.value).ticks(5).tickFormat(u=>u.toString()+"%"));function o(){let u=be("g#PGSocAxis");u.call(r.value),u.selectAll(".tick").attr("font-size",12),u.selectAll(".tick line").attr("stroke","var(--color-bg)"),u.select(".domain").attr("stroke","var(--color-bg)")}return Ke(()=>{o()}),(u,l)=>(h(),_("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(u.width-20)+",0)"},null,8,Zr))}}),eo=t=>(we("data-v-7b8949f3"),t=t(),ke(),t),to={class:"d-flex align-self-top justify-content-center align-items-center"},ao={class:"input-group input-group-xs"},ro={key:0,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},oo={class:"dropdown-menu"},no={class:"table optiontable"},so=["onClick"],io={key:1,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},co={class:"dropdown-menu"},lo={class:"table optiontable"},uo=["onClick"],ho={key:2,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},po={class:"dropdown-menu"},go={class:"table optiontable"},mo=["onClick"],fo=eo(()=>c("span",{class:"fa-solid fa-circle-check"},null,-1)),vo=[fo],_o=A({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=new Date().getFullYear();let o=Array.from({length:10},(R,ee)=>r-ee);const u=ce(!0),l=e,p=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],d=ce(a.modelValue.getDate()),f=ce(a.modelValue.getMonth()),v=ce(a.modelValue.getFullYear()),O=g(()=>{const ee=new Date(v.value,f.value,1).getDay();let Y=0;switch(f.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:Y=31;break;case 4:case 6:case 9:case 11:Y=30;break;case 2:Math.trunc(v.value/4)*4==v.value&&(Y=29)}let k=[],N=[0,0,0,0,0,0,0],L=ee;for(let w=0;w<Y;w++)N[L]=w+1,L==6?(k.push(N),N=[0,0,0,0,0,0,0],L=0):L++;return L<8&&k.push(N),k});function M(){l("update:modelValue",new Date(v.value,f.value,d.value)),u.value=!1}return(R,ee)=>(h(),_("span",to,[c("div",ao,[a.mode=="day"||a.mode=="today"?(h(),_("button",ro,C(d.value),1)):$("",!0),c("div",oo,[c("table",no,[(h(!0),_(ie,null,pe(O.value,(Y,k)=>(h(),_("tr",{key:k,class:""},[(h(!0),_(ie,null,pe(Y,(N,L)=>(h(),_("td",{key:L},[N!=0?(h(),_("span",{key:0,type:"button",class:"btn optionbutton",onClick:w=>d.value=N},C(N),9,so)):$("",!0)]))),128))]))),128))])]),a.mode!="year"&&a.mode!="live"?(h(),_("button",io,C(f.value+1),1)):$("",!0),c("div",co,[c("table",lo,[(h(),_(ie,null,pe(p,(Y,k)=>c("tr",{key:k,class:""},[(h(!0),_(ie,null,pe(Y,(N,L)=>(h(),_("td",{key:L,class:"p-0 m-0"},[c("span",{type:"button",class:"btn btn-sm optionbutton",onClick:w=>f.value=N},C(N+1),9,uo)]))),128))])),64))])]),a.mode!="live"?(h(),_("button",ho,C(v.value),1)):$("",!0),c("div",po,[c("table",go,[(h(!0),_(ie,null,pe(n(o),(Y,k)=>(h(),_("tr",{key:k,class:""},[c("td",null,[c("span",{type:"button",class:"btn optionbutton",onClick:N=>v.value=Y},C(Y),9,mo)])]))),128))])]),a.mode!="live"?(h(),_("button",{key:3,class:"button-outline-secondary",type:"button",onClick:M},vo)):$("",!0)])]))}}),yo=K(_o,[["__scopeId","data-v-7b8949f3"]]),bo={class:"btn-group m-0",role:"group","aria-label":"radiobar"},wo=["id","value"],ko=A({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=e,o=g({get(){return a.modelValue},set(p){r("update:modelValue",p)}});function u(p){let d=a.options[p].color?a.options[p].color:"var(--color-fg)";return a.options[p].active?{color:"var(--color-bg)",background:d}:{color:d}}function l(p){let d=p.target;for(;d&&!d.value&&d.parentElement;)d=d.parentElement;d.value&&(o.value=d.value)}return(p,d)=>(h(),_("div",null,[c("div",bo,[(h(!0),_(ie,null,pe(p.options,(f,v)=>(h(),_("button",{id:"radio-"+f.value,key:v,class:X(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",f.value==o.value?"active":""]),value:f.value,style:oe(u(v)),onClick:l},[c("span",{style:oe(u(v))},[f.icon?(h(),_("i",{key:0,class:X(["fa-solid",f.icon])},null,2)):$("",!0),j(" "+C(f.text),1)],4)],14,wo))),128))])]))}}),Qt=K(ko,[["__scopeId","data-v-64bde815"]]),tt=t=>(we("data-v-a73ca9f4"),t=t(),ke(),t),So=tt(()=>c("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Mo=[So],xo=tt(()=>c("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Po=[xo],$o=tt(()=>c("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),Io=[$o],Co=tt(()=>c("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),Bo=[Co],Oo=A({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean},ignoreLive:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=ce(0),r=g(()=>{switch(i.graphMode){case"live":return e.ignoreLive?"heute":`${q.duration} min`;case"today":return"heute";case"day":return z.date.getDate()+"."+(z.date.getMonth()+1)+".";case"month":return ya(_e.month-1,_e.year);case"year":return Ie.year.toString();default:return"???"}}),o=["live","today","day","month","year"],u=["Live","Heute","Tag","Monat","Jahr"],l=g({get(){return i.graphMode},set(L){switch(L){case"day":O();break;case"today":M();break;case"live":v();break;case"month":R();break;case"year":ee()}}}),p=g(()=>{switch(i.graphMode){case"live":case"today":return z.getDate();case"month":return _e.getDate();default:return z.getDate()}});function d(L){Ct(L)}function f(){a.value+=1,a.value>2&&(a.value=0)}function v(){i.graphMode!="live"&&(i.graphMode="live",Z())}function O(){i.graphMode!="day"&&i.graphMode!="today"&&(i.graphMode="day",Z())}function M(){i.graphMode!="today"&&(i.graphMode="today",Ct(new Date),Z())}function R(){i.graphMode!="month"&&(i.graphMode="month",Z())}function ee(){i.graphMode!="year"&&(i.graphMode="year",Z())}const Y=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),k=g(()=>a.value==1?"justify-content-between":"justify-content-end"),N=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(L,w)=>(h(),_("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:oe(Y.value)},[a.value==2?(h(),W(Qt,{key:0,id:"pgm2",modelValue:l.value,"onUpdate:modelValue":w[0]||(w[0]=y=>l.value=y),class:"m-2",options:o.map((y,x)=>({text:u[x],value:y,color:"var(--color-menu)",active:y==n(i).graphMode}))},null,8,["modelValue","options"])):$("",!0),a.value==1?(h(),_("span",{key:1,type:"button",class:X(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:w[1]||(w[1]=y=>L.$emit("shiftUp"))},Mo,2)):$("",!0),c("div",{class:X(["d-flex align-items-center",N.value])},[a.value==1?(h(),_("span",{key:0,type:"button",class:X(["p-1",{disabled:!e.showLeftButton}]),onClick:w[2]||(w[2]=y=>L.$emit("shiftLeft"))},Po,2)):$("",!0),a.value<2?(h(),_("span",{key:1,type:"button",class:"btn-outline-secondary p-2 px-3 badge rounded-pill datebadge",onClick:f},C(r.value),1)):$("",!0),a.value==2?(h(),W(yo,{key:2,"model-value":p.value,mode:n(i).graphMode,"onUpdate:modelValue":d},null,8,["model-value","mode"])):$("",!0),a.value==1?(h(),_("span",{key:3,id:"graphRightButton",type:"button",class:X(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:w[3]||(w[3]=y=>L.$emit("shiftRight"))},null,2)):$("",!0)],2),c("div",{class:X(["d-flex align-items-center",k.value])},[a.value==1?(h(),_("span",{key:0,type:"button",class:"p-1",onClick:f},Io)):$("",!0),a.value==1?(h(),_("span",{key:1,id:"graphLeftButton",type:"button",class:X(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:w[4]||(w[4]=y=>L.$emit("shiftDown"))},null,2)):$("",!0),a.value>0?(h(),_("span",{key:2,type:"button",class:"p-1",onClick:w[5]||(w[5]=y=>a.value=0)},Bo)):$("",!0)],2)],4))}}),qt=K(Oo,[["__scopeId","data-v-a73ca9f4"]]),Xt=t=>(we("data-v-bb5945e3"),t=t(),ke(),t),To={class:"d-flex justify-content-end"},Ao=Xt(()=>c("span",{class:"fa-solid fa-lg ps-1 fa-magnifying-glass"},null,-1)),Lo=[Ao],Do=["viewBox"],Go=["transform"],Vo={id:"button"},Eo=["x","y"],Wo=Xt(()=>c("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},C(""),-1)),No=[Wo],jo=2,zo="Leistung / Ladestand ",Uo=A({__name:"PowerGraph",setup(t){function e(){let r=m.usageStackOrder+1;r>jo&&(r=0),m.usageStackOrder=r,Or(!0)}function a(){m.zoomGraph=!m.zoomGraph}return(r,o)=>(h(),W(et,{"full-width":!0},{title:I(()=>[j(C(zo))]),buttons:I(()=>[c("div",To,[P(qt,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!1,onShiftLeft:n(bt),onShiftRight:n(Rt),onShiftUp:n(Yt),onShiftDown:n(Ht)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"]),n(ja)?(h(),_("span",{key:0,type:"button",class:"ms-1 p-0 pt-1",onClick:a},Lo)):$("",!0)])]),default:I(()=>[c("figure",{id:"powergraph",class:"p-0 m-0",onClick:e},[(h(),_("svg",{viewBox:"0 0 "+n(fe)+" "+n(xe)},[P(Er,{width:n(fe)-n(T).left-2*n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T)},null,8,["width","height","margin"]),P(Nr,{width:n(fe)-n(T).left-2*n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T),"stack-order":n(m).usageStackOrder},null,8,["width","height","margin","stack-order"]),P(Hr,{width:n(fe)-n(T).left-2*n(T).right,height:n(xe)-n(T).top-n(T).bottom,margin:n(T),"graph-data":n(i)},null,8,["width","height","margin","graph-data"]),c("g",{transform:"translate("+n(T).left+","+n(T).top+")"},[(n(i).graphMode=="day"||n(i).graphMode=="today"||n(i).graphMode=="live")&&Object.values(n(b)).length>0?(h(),W(it,{key:0,width:n(fe)-n(T).left-2*n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T),order:0},null,8,["width","height","margin"])):$("",!0),(n(i).graphMode=="day"||n(i).graphMode=="today"||n(i).graphMode=="live")&&Object.values(n(b)).length>1?(h(),W(it,{key:1,width:n(fe)-n(T).left-2*n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T),order:1},null,8,["width","height","margin"])):$("",!0),(n(i).graphMode=="day"||n(i).graphMode=="today")&&n(F).isBatteryConfigured?(h(),W(it,{key:2,width:n(fe)-n(T).left-2*n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T),order:2},null,8,["width","height","margin"])):$("",!0),n(i).graphMode=="day"||n(i).graphMode=="today"?(h(),W(Kr,{key:3,width:n(fe)-n(T).left-n(T).right,height:(n(xe)-n(T).top-n(T).bottom)/2,margin:n(T)},null,8,["width","height","margin"])):$("",!0)],8,Go),c("g",Vo,[c("text",{x:n(fe),y:n(xe)-10,color:"var(--color-menu)","text-anchor":"end"},No,8,Eo)])],8,Do))])]),_:1}))}}),Fo=K(Uo,[["__scopeId","data-v-bb5945e3"]]),Jo=["id"],Ro=["x","width","height","fill"],Yo=["x","width","height"],Ho=["x","y","width","height"],Qo=A({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),r=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(u,l)=>(h(),_("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[c("rect",{class:"bar",x:e.xScale(u.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:u.item.color},null,8,Ro),c("rect",{class:"bar",x:e.xScale(u.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:r.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Yo),c("rect",{class:"bar",x:e.xScale(u.item.name)+e.xScale.bandwidth()/6,y:r.value,width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-battery)","fill-opacity":"66%"},null,8,Ho)],8,Jo))}}),qo={id:"emBargraph"},Xo=c("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),Zo=A({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const u=i.graphMode=="live"||i.graphMode=="day"?E:S.items,p=(i.graphMode=="live"||i.graphMode=="day"?B:S.items).evuOut.energy,d=u.pv.energy;return Math.round((d-p)/d*100)}else if(o.name=="Netz"){const u=i.graphMode=="live"||i.graphMode=="day"?E:S.items,l=i.graphMode=="live"||i.graphMode=="day"?B:S.items,p=l.evuOut.energy,d=u.evuIn.energy,f=u.pv.energy,v=u.batOut.energy,O=l.batIn.energy;return Math.round((f+v-p-O)/(f+v+d-p-O)*100)}else return o.pvPercentage}function r(o){return o.name=="PV"?"Eigen":"Aut"}return(o,u)=>(h(),_("g",qo,[(h(!0),_(ie,null,pe(e.plotdata,(l,p)=>(h(),_("g",{key:p},[P(Qo,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":r(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),Xo]))}}),Ko=["origin"],en=A({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>gt(e.yScale).tickFormat(o=>o>0?(o/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),r=g(()=>{const o=be("g#emYAxis");return o.attr("class","axis").call(a.value),o.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),o.selectAll(".tick").attr("font-size",e.fontsize),m.showGrid?o.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):o.selectAll(".tick line").attr("stroke","var(--color-bg)"),o.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(o,u)=>(h(),_("g",{id:"emYAxis",class:"axis",origin:r.value},null,8,Ko))}}),tn=["id"],an=["x","y","font-size"],rn=["x","y","font-size","fill"],on=["x","y","font-size","fill"],nn=A({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),r=g(()=>{let d=16,f=e.barcount;return f<=5?d=16:f==6?d=14:f>6&&f<=8?d=13:f==9?d=11:f==10?d=10:d=9,d}),o=g(()=>{let d=12,f=e.barcount;return f<=5?d=12:f==6?d=11:f>6&&f<=8||f==9?d=8:f==10?d=7:d=6,d});function u(d,f){return f.length>o.value?f.substring(0,o.value)+".":f}function l(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function p(){return"var(--color-pv)"}return(d,f)=>(h(),_("g",{id:"barlabel-"+e.item.name},[c("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":r.value,"text-anchor":"middle",fill:"var(--color-menu)"},C(n(Et)(d.item.energy,n(m).decimalPlaces,!1)),9,an),c("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.yScale(d.item.energy)-10,"font-size":r.value-2,"text-anchor":"middle",fill:p()},C(l()),9,rn),c("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":r.value,"text-anchor":"middle",fill:d.item.color,class:X(d.item.icon.length<=2?"fas":"")},C(u(d.item.name,d.item.icon)),11,on)],8,tn))}}),sn={id:"emBarLabels"},cn=A({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const u=i.graphMode=="live"||i.graphMode=="day"?E:S.items,p=(i.graphMode=="live"||i.graphMode=="day"?B:S.items).evuOut.energy,d=u.pv.energy;return Math.round((d-p)/d*100)}else if(o.name=="Netz"){const u=i.graphMode=="live"||i.graphMode=="day"?E:S.items,l=i.graphMode=="live"||i.graphMode=="day"?B:S.items,p=l.evuOut.energy,d=u.evuIn.energy,f=u.pv.energy,v=u.batOut.energy,O=l.batIn.energy;return f+v-p-O>0?Math.round((f+v-p-O)/(f+v+d-p-O)*100):0}else return o.pvPercentage}function r(o){return o.name=="PV"?"Eigen":"Aut"}return(o,u)=>(h(),_("g",sn,[(h(!0),_(ie,null,pe(e.plotdata,(l,p)=>(h(),_("g",{key:p},[P(nn,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":r(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),ln={id:"energymeter",class:"p-0 m-0"},un={viewBox:"0 0 500 500"},dn=["transform"],hn=["x"],pn={key:0},Bt=500,ct=500,Ot=12,gn="Energie",mn=A({__name:"EnergyMeter",setup(t){const e={top:25,bottom:30,left:25,right:0},a=g(()=>{let l=Object.values(E),p=u.value,d=S.values(),f=[];switch(m.debug&&(console.debug("----------------------- source summary -----------------"),console.debug(E),console.debug("----------------------- usage details ------------------"),console.debug(u.value),console.debug("----------------------- historic summary ---------------"),console.debug(S),console.debug("--------------------------------------------------------")),qe.value==!0&&(qe.value=!1),i.graphMode){default:case"live":case"today":f=l.concat(p).filter(v=>v.energy>0);break;case"day":case"month":case"year":d.length==0?Le.value=!0:(Le.value=!1,f=d.filter(v=>v.energy>0))}return f}),r=g(()=>ut().range([0,Bt-e.left-e.right]).domain(a.value.map(l=>l.name)).padding(.4)),o=g(()=>Be().range([ct-e.bottom-e.top,15]).domain([0,ma(a.value,l=>l.energy)])),u=g(()=>{const l=Object.values(b).length,p=Object.values(D).filter(d=>d.configured).length;return[B.evuOut,B.devices,B.charging].concat(l>1?Object.values(b).map(d=>d.toPowerItem()):[]).concat(p>1?Object.values(D).filter(d=>d.configured&&d.showInGraph):[]).concat([B.batIn,B.house])});return(l,p)=>(h(),W(et,{"full-width":!0},{title:I(()=>[j(C(gn))]),buttons:I(()=>[P(qt,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!0,onShiftLeft:n(bt),onShiftRight:n(Rt),onShiftUp:n(Yt),onShiftDown:n(Ht)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:I(()=>[c("figure",ln,[(h(),_("svg",un,[c("g",{transform:"translate("+e.left+","+e.top+")"},[P(Zo,{plotdata:a.value,"x-scale":r.value,"y-scale":o.value,height:ct,margin:e},null,8,["plotdata","x-scale","y-scale"]),P(en,{"y-scale":o.value,width:Bt,fontsize:Ot,config:n(m)},null,8,["y-scale","config"]),c("text",{x:-e.left,y:"-15",fill:"var(--color-axis)","font-size":Ot},C(n(i).graphMode=="year"?"MWh":"kWh"),9,hn),P(cn,{plotdata:a.value,"x-scale":r.value,"y-scale":o.value,height:ct,margin:e,config:n(m)},null,8,["plotdata","x-scale","y-scale","config"])],8,dn)]))]),n(Le)?(h(),_("p",pn,"No data")):$("",!0)]),_:1}))}}),Zt=t=>(we("data-v-dd7f6cd4"),t=t(),ke(),t),fn=["id"],vn={class:"modal-dialog modal-lg modal-fullscreen-sm-down"},_n={class:"modal-content"},yn={class:"modal-header"},bn={class:"modal-title"},wn=Zt(()=>c("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[c("i",{class:"fa-solid fa-lg fa-circle-check m-0 p-0"})],-1)),kn={class:"modal-body",style:{"background-color":"var(--color-fg)"}},Sn=Zt(()=>c("div",{class:"modal-footer"},null,-1)),Mn=A({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return Ke(()=>{}),(a,r)=>(h(),_("div",{id:e.modalId,class:"modal fade"},[c("div",vn,[c("div",_n,[c("div",yn,[c("h3",bn,[he(a.$slots,"title",{},void 0,!0)]),wn]),c("div",kn,[he(a.$slots,"default",{},void 0,!0)]),Sn])])],8,fn))}}),lt=K(Mn,[["__scopeId","data-v-dd7f6cd4"]]),xn={class:"digit",type:"button"},Pn=A({__name:"PadButton",props:{modelValue:{},color:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=ce(!1);function o(){r.value=!0,l("update:modelValue",a.modelValue),setTimeout(()=>{r.value=!1},300)}const u=g(()=>r.value?{"background-color":"white",color:"black"}:{"background-color":a.color??"var(--color-axis)"}),l=e;return(p,d)=>(h(),_("div",{class:"padbutton",style:oe(u.value),onClick:o},[c("span",xn,[he(p.$slots,"default",{},void 0,!0)])],4))}}),je=K(Pn,[["__scopeId","data-v-387dbf10"]]),Kt=t=>(we("data-v-7a451b9e"),t=t(),ke(),t),$n={class:"numberpad"},In={class:"codedisplay"},Cn={class:"numberentry"},Bn=Kt(()=>c("span",{class:"fas fa-delete-left"},null,-1)),On=Kt(()=>c("span",{class:"fas fa-circle-check"},null,-1)),Tn=A({__name:"NumberPad",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const r=ce(t.modelValue),o=e,u=g(()=>r.value.length==0?"Bitte geben Sie die PIN ein":"*".repeat(r.value.length));function l(p){p==-1?r.value=r.value.slice(0,-1):p==-2?(o("update:modelValue",r.value),r.value=""):r.value=r.value+p.toString()}return(p,d)=>(h(),_("div",$n,[c("p",In,C(u.value),1),c("div",Cn,[(h(),_(ie,null,pe(9,f=>P(je,{key:f,"model-value":f,"onUpdate:modelValue":l},{default:I(()=>[j(C(f),1)]),_:2},1032,["model-value"])),64)),P(je,{"model-value":0,"onUpdate:modelValue":l},{default:I(()=>[j("0")]),_:1}),P(je,{"model-value":-1,color:"var(--color-devices)","onUpdate:modelValue":l},{default:I(()=>[Bn]),_:1}),P(je,{"model-value":-2,color:"var(--color-devices)","data-bs-dismiss":"modal","onUpdate:modelValue":l},{default:I(()=>[On]),_:1})])]))}}),An=K(Tn,[["__scopeId","data-v-7a451b9e"]]),Ne=t=>(we("data-v-ecac4e45"),t=t(),ke(),t),Ln={class:"statustable"},Dn=Ne(()=>c("span",{class:"header"},"IP-Adresse:",-1)),Gn=Ne(()=>c("span",{class:"header"},"Systemzeit:",-1)),Vn=Ne(()=>c("span",{class:"header"},"Version:",-1)),En=Ne(()=>c("span",{class:"header"},"Version (Details):",-1)),Wn=Ne(()=>c("span",{class:"header"},"Entwicklungszweig:",-1)),Nn=A({__name:"StatusPage",setup(t){return(e,a)=>(h(),_("div",Ln,[Dn,c("span",null,C(n(F).ipAddress),1),Gn,c("span",null,C(new Date(n(F).systemTime*1e3).toLocaleString(void 0)),1),Vn,c("span",null,C(n(F).version),1),En,c("span",null,C(n(F).versionDetails),1),Wn,c("span",null,C(n(F).devBranch),1)]))}}),jn=K(Nn,[["__scopeId","data-v-ecac4e45"]]),zn={class:"configitem subgrid"},Un={class:"d-flex align-items-baseline m-0 p-0 grid-col-6"},Fn={class:"ms-1 mb-2 p-0 pt-2 d-flex justify-content-stretch align-items-center grid-col-6"},Jn={class:"justify-content-stretch d-flex"},Rn=A({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t;return(a,r)=>(h(),_("div",zn,[c("span",Un,[e.icon?(h(),_("i",{key:0,class:X(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):$("",!0),j(" "+C(a.title),1)]),c("div",Fn,[c("span",Jn,[he(a.$slots,"default",{},void 0,!0)])])]))}}),ze=K(Rn,[["__scopeId","data-v-d9b9bae8"]]),Yn=["id","value"],Hn=A({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=e,o=g({get(){return a.modelValue},set(p){r("update:modelValue",p)}});function u(p){return a.options[p][2]?{color:a.options[p][2]}:{color:"var(--color-charging)"}}function l(p){let d=p.target;for(;d&&!d.value&&d.parentElement;)d=d.parentElement;d.value&&(o.value=d.value)}return(p,d)=>(h(),_("div",null,[(h(!0),_(ie,null,pe(p.options,(f,v)=>(h(),_("button",{id:"radio-"+f[1],key:v,class:X(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",f[1]==o.value?"active":""]),value:f[1],style:oe(u(v)),onClick:l},[c("span",{style:oe(u(v))},[f[3]?(h(),_("i",{key:0,class:X(["fa-solid",f[3]])},null,2)):$("",!0),j(" "+C(f[0]),1)],4)],14,Yn))),128))]))}}),Tt=K(Hn,[["__scopeId","data-v-d288d3b5"]]),Qn={class:"form-check form-switch"},At=A({__name:"SwitchInput",props:{modelValue:{type:Boolean},onColor:{},offColor:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=e,o=g({get(){return a.modelValue},set(l){r("update:modelValue",l)}}),u=g(()=>o.value?{"background-color":"green","font-size":"20px"}:{"background-color":"white","font-size":"20px"});return(l,p)=>(h(),_("div",Qn,[Fe(c("input",{"onUpdate:modelValue":p[0]||(p[0]=d=>o.value=d),class:"form-check-input",type:"checkbox",role:"switch",style:oe(u.value)},null,4),[[fa,o.value]])]))}}),ea=t=>(we("data-v-ca704ee0"),t=t(),ke(),t),qn={class:"settingslist"},Xn=ea(()=>c("hr",{class:"grid-col-12"},null,-1)),Zn=ea(()=>c("hr",{class:"grid-col-12"},null,-1)),Kn=A({__name:"SettingsPage",props:{chargepoint:{}},setup(t){const e=t,a=g({get:()=>e.chargepoint.etActive,set:u=>{b[e.chargepoint.id].etActive=u}}),r=g({get:()=>e.chargepoint.timedCharging,set:u=>{b[e.chargepoint.id].timedCharging=u}}),o=g({get:()=>e.chargepoint.connectedVehicle,set:u=>{b[e.chargepoint.id].connectedVehicle=u}});return(u,l)=>(h(),_("div",qn,[n(F).isBatteryConfigured?(h(),W(ze,{key:0,title:"PV-Priorität (global)",icon:"fa-car-battery",infotext:"Priority during PV production",fullwidth:!0},{default:I(()=>[P(Tt,{modelValue:n(F).pvBatteryPriority,"onUpdate:modelValue":l[0]||(l[0]=p=>n(F).pvBatteryPriority=p),options:n(Aa)},null,8,["modelValue","options"])]),_:1})):$("",!0),Xn,P(ze,{title:"Fahrzeug wechseln",icon:"fa-car",fullwidth:!0},{default:I(()=>[P(Tt,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=p=>o.value=p),modelModifiers:{number:!0},options:Object.values(n(U)).map(p=>[p.name,p.id])},null,8,["modelValue","options"])]),_:1}),Zn,P(ze,{title:"Strompreisbasiert laden",icon:"fa-coins",infotext:"Settings"},{default:I(()=>[P(At,{modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=p=>a.value=p)},null,8,["modelValue"])]),_:1}),P(ze,{title:"Zeitplan aktivieren",icon:"fa-clock",infotext:"Settings"},{default:I(()=>[P(At,{modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=p=>r.value=p)},null,8,["modelValue"])]),_:1})]))}}),es=K(Kn,[["__scopeId","data-v-ca704ee0"]]);function ts(t,e){t=="openWB/graph/boolDisplayLiveGraph"?F.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?as(t,e):t=="openWB/graph/lastlivevaluesJson"?rs(t,e):t=="openWB/graph/config/duration"&&(q.duration=JSON.parse(e))}function as(t,e){if(!q.initialized){let a=[];const r=e.toString().split(`
`);r.length>1?a=r.map(l=>JSON.parse(l)):a=[];const o=t.match(/(\d+)$/g),u=o?o[0]:"";u!=""&&typeof q.rawDataPacks[+u-1]>"u"&&(q.rawDataPacks[+u-1]=a,q.initCounter++)}if(q.initCounter==16){const a=[];q.unsubscribeRefresh(),q.initialized=!0,q.rawDataPacks.map(r=>{r.map(o=>{const u=ta(o);a.push(u)})}),We(a),q.subscribeUpdates()}}function rs(t,e){const a=JSON.parse(e),r=ta(a);q.graphRefreshCounter++,We(i.data.concat(r)),q.graphRefreshCounter>60&&q.activate()}function ta(t){const e={};e.date=os(t.time).valueOf(),+t.grid>0?(e.evuIn=+t.grid,e.evuOut=0):+t.grid<=0?(e.evuIn=0,e.evuOut=-t.grid):(e.evuIn=0,e.evuOut=0),+t["pv-all"]>=0?(e.pv=+t["pv-all"],e.inverter=0):(e.pv=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,t["ev0-soc"]&&(e.soc0=+t["ev0-soc"]),t["ev1-soc"]&&(e.soc1=+t["ev1-soc"]),e.charging=+t["charging-all"];for(let a=0;a<10;a++){const r="cp"+a;e[r]=+(t[r+"-power"]??0)}return e.selfUsage=e.pv-e.evuOut,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function os(t){const e=new Date(Date.now()),a=864e5;let r=new Date;const o=He("%H:%M:%S")(t);return o&&(r=o,r.setDate(e.getDate()),r.setMonth(e.getMonth()),r.setFullYear(e.getFullYear()),r.getHours()>e.getHours()&&(r=new Date(r.getTime()-a))),r}const ns=["evuIn","pv","batIn","evuOut"];let Ze=[];function ss(t,e){const a=JSON.parse(e).entries,r=JSON.parse(e).totals;vt(),Ze=[],_t.map(u=>{S.setEnergyPv(u,0),S.setEnergyBat(u,0)});const o=is(a);We(o),yt(r,Ze),m.debug&&(console.debug("---------------------------------------- Graph Data ---------------------------"),console.debug("--- Incoming graph data:"),console.debug(a),console.debug("data to be displayed:"),console.debug(o),console.debug("-------------------------------------------------------------------------------")),i.graphMode=="today"&&setTimeout(()=>z.activate(),3e5)}function is(t){const e=[];let a={};return t.map(r=>{a=cs(r);const o=a;e.push(o)}),e}function cs(t){const e={};if(i.graphMode=="day"||i.graphMode=="today")if(typeof t.date=="number")e.date=new Date(+t.date*1e3).getTime();else{const r=He("%H:%M")(t.date);r&&(r.setMonth(z.date.getMonth()),r.setDate(z.date.getDate()),r.setFullYear(z.date.getFullYear()),e.date=r.getTime())}else if(typeof t.date=="string"){const r=He("%Y%m%d")(t.date);r&&(e.date=r.getDate())}return e.evuOut=0,e.evuIn=0,Object.entries(t.counter).forEach(([r,o])=>{o.grid&&(e.evuOut+=o.power_exported,e.evuIn+=o.power_imported,Ze.includes(r)||Ze.push(r))}),e.evuOut==0&&e.evuIn==0&&Object.entries(t.counter).forEach(r=>{e.evuOut+=r[1].power_exported,e.evuIn+=r[1].power_imported}),e.pv=t.pv.all.power_exported,Object.entries(t.bat).length>0?(e.batIn=t.bat.all.power_imported,e.batOut=t.bat.all.power_exported,e.batSoc=t.bat.all.soc??0):(e.batIn=0,e.batOut=0,e.batSoc=0),Object.entries(t.cp).forEach(([r,o])=>{r!="all"?(e[r]=o.power_imported,S.keys().includes(r)||S.addItem(r)):e.charging=o.power_imported}),Object.entries(t.ev).forEach(([r,o])=>{r!="all"&&(e["soc"+r.substring(2)]=o.soc)}),e.devices=0,Object.entries(t.sh).forEach(([r,o])=>{r!="all"&&(e[r]=o.power_imported??0,e.devices+=o.power_imported??0,S.keys().includes(r)||S.addItem(r))}),e.selfUsage=e.pv-e.evuOut,t.hc&&t.hc.all?e.house=t.hc.all.power_imported:e.house=e.evuIn+e.batOut+e.pv-e.evuOut-e.charging-e.devices-e.batOut,e.evuIn+e.batOut+e.pv>0?S.keys().filter(r=>!ns.includes(r)).map(r=>{Ar(r,e)}):Object.keys(e).map(r=>{e[r+"Pv"]=0,e[r+"Bat"]=0}),e}let Ue={};const wt=["charging","house","batIn","devices"],ls=["evuIn","pv","batIn","evuOut"];let De=[];function us(t,e){const a=JSON.parse(e).entries,r=JSON.parse(e).totals;vt(),De=[],wt.map(o=>{S.items[o].energyPv=0,S.items[o].energyBat=0}),a.length>0&&We(aa(a)),yt(r,[])}function ds(t,e){const a=JSON.parse(e).entries,r=JSON.parse(e).totals;vt(),De=[],wt.forEach(o=>{S.items[o].energyPv=0,S.items[o].energyBat=0}),We(aa(a)),yt(r,[])}function aa(t){const e=[];let a={};return Ue={},t.map(r=>{a=hs(r),e.push(a),Object.keys(a).forEach(o=>{o!="date"&&(a[o]<0&&(console.warn(`Negative energy value for ${o} in row ${a.date}. Ignoring the value.`),a[o]=0),Ue[o]?Ue[o]+=a[o]:Ue[o]=a[o])})}),e}function hs(t){const e={},a=He("%Y%m%d")(t.date);a&&(e.date=i.graphMode=="month"?a.getDate():a.getMonth()+1),e.evuOut=0,e.evuIn=0;let r=0,o=0;return Object.entries(t.counter).forEach(([l,p])=>{r+=p.energy_exported,o+=p.energy_imported,p.grid&&(e.evuOut+=p.energy_exported,e.evuIn+=p.energy_imported,De.includes(l)||De.push(l))}),De.length==0&&(e.evuOut=r,e.evuIn=o),e.pv=t.pv.all.energy_exported,Object.entries(t.bat).length>0?(t.bat.all.energy_imported>=0?e.batIn=t.bat.all.energy_imported:(console.warn("ignoring negative value for batIn on day "+e.date),e.batIn=0),t.bat.all.energy_exported>=0?e.batOut=t.bat.all.energy_exported:(console.warn("ignoring negative value for batOut on day "+e.date),e.batOut=0)):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([l,p])=>{l!="all"?(S.keys().includes(l)||S.addItem(l),e[l]=p.energy_imported):e.charging=p.energy_imported}),Object.entries(t.ev).forEach(([l,p])=>{l!="all"&&(e["soc-"+l]=p.soc)}),e.devices=Object.entries(t.sh).reduce((l,p)=>(S.keys().includes(p[0])||S.addItem(p[0]),p[1].energy_imported>=0?l+=p[1].energy_imported:console.warn(`Negative energy value for device ${p[0]} in row ${e.date}. Ignoring this value`),l),0),e.house=e.pv+e.evuIn+e.batOut-e.evuOut-e.batIn-e.charging,e.selfUsage=e.pv-e.evuOut,e.evuIn+e.batOut+e.pv>0?S.keys().filter(l=>!ls.includes(l)).map(l=>{Lr(l,e)}):wt.map(l=>{e[l+"Pv"]=0,e[l+"Bat"]=0}),e}class ps{constructor(e){s(this,"id");s(this,"dailyYieldExport",0);s(this,"dailyYieldImport",0);s(this,"exported",0);s(this,"faultState",0);s(this,"faultStr","");s(this,"imported",0);s(this,"power",0);s(this,"soc",0);this.id=e}}class gs{constructor(){s(this,"dailyExport",0);s(this,"dailyImport",0);s(this,"exported",0);s(this,"imported",0);s(this,"power",0);s(this,"soc",0)}}const se=J({});J(new gs);function ms(t){t in se?console.info("Duplicate battery message: "+t):se[t]=new ps(t)}function fs(){Object.keys(se).forEach(t=>{delete se[parseInt(t)]})}function vs(t,e){const a=_s(t);if(a&&!(a in se)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?F.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(B.batIn.power=+e,E.batOut.power=0):(B.batIn.power=0,E.batOut.power=-e):t=="openWB/bat/get/soc"?F.batterySoc=+e:t=="openWB/bat/get/daily_exported"?E.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?B.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?se[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?se[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?se[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?se[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?se[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?se[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?se[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(se[a].soc=+e))}function _s(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function ys(t,e){if(t=="openWB/optional/et/provider")JSON.parse(e).type==null?re.active=!1:(re.active=!0,re.etProvider=JSON.parse(e).name);else if(t=="openWB/optional/et/get/prices"){const a=JSON.parse(e);re.etPriceList=new Map,Object.keys(a).map(r=>{re.etPriceList.set(new Date(+r*1e3),a[r]*1e5)})}}function bs(t,e){const a=ra(t);if(a&&!(a in b)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?B.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(B.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")F.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(b[a]){const r=JSON.parse(e);b[a].name=r.name,b[a].icon=r.name,te["cp"+a]?(te["cp"+a].name=r.name,te["cp"+a].icon=r.name):te["cp"+a]={name:r.name,icon:r.name,color:"var(--color-charging)"}}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))b[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))b[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))b[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))b[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))b[a].dailyYield=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))b[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))b[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))b[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))b[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))b[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))b[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/currents/i))b[a].currents=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const r=JSON.parse(e);b[a].chargedSincePlugged=r.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const r=JSON.parse(e);b[a].soc=r.soc,b[a].waitingForSoc=!1,b[a].rangeCharged=r.range_charged,b[a].rangeUnit=r.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const r=JSON.parse(e);b[a].vehicleName=String(r.name),b[a].updateConnectedVehicle(+r.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const r=JSON.parse(e);switch(r.chargemode){case"instant_charging":b[a].updateChargeMode(ge.instant_charging);break;case"pv_charging":b[a].updateChargeMode(ge.pv_charging);break;case"scheduled_charging":b[a].updateChargeMode(ge.scheduled_charging);break;case"standby":b[a].updateChargeMode(ge.standby);break;case"stop":b[a].updateChargeMode(ge.stop);break}b[a].chargeTemplate=r.charge_template,b[a].averageConsumption=r.average_consumption}}}function ws(t,e){const a=ra(t);if(a!=null){if(!(a in U)){const r=new $a(a);U[a]=r}if(t.match(/^openwb\/vehicle\/[0-9]+\/name$/i))Object.values(b).forEach(r=>{r.connectedVehicle==a&&(r.vehicleName=JSON.parse(e))}),U[a].name=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i))U[a].soc=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i))U[a].range=+e;else if(t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i))U[a].updateChargeTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i))U[a].updateEvTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/soc_module\/config$/i)){const r=JSON.parse(e);Object.values(b).forEach(o=>{o.connectedVehicle==a&&(o.isSocConfigured=r.type!==null,o.isSocManual=r.type=="manual")})}}}function ks(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const r=+a[0],o=JSON.parse(e);ve[r]=o,Ss(r,o)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),r=t.match(/[0-9]+$/i);if(a&&r){const o=+a[0].replace(/[^0-9]+/g,""),u=+r[0],l=JSON.parse(e);o in nt||(nt[o]=[]),nt[o][u]=l}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/chargemode\/scheduled_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),r=t.match(/[0-9]+$/i);if(a&&r){const o=+a[0].replace(/[^0-9]+/g,""),u=+r[0],l=JSON.parse(e);o in ot||(ot[o]=[]),ot[o][u]=l}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const r=+a[0],o=JSON.parse(e);Ia[r]=o}}}function Ss(t,e){Object.values(b).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function ra(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Ms(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?xs(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&Ps(t,e)}function xs(t,e){const a=oa(t);a!=null&&(a in D||Ft(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?D[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?(D[a].name=e.toString(),D[a].icon=e.toString(),te["sh"+a].name=e.toString(),te["sh"+a].icon=e.toString()):t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?D[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canSwitch$/i)?D[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_homeConsumtion$/i)?D[a].countAsHouse=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(D[a].tempConfigured=+e))}function Ps(t,e){const a=oa(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in D||Ft(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))D[a].power=+e,$s("power");else if(!t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Wh$/i)){if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))D[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))D[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))D[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))D[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:D[a].status="off";break;case 11:D[a].status="on";break;case 20:D[a].status="detection";break;case 30:D[a].status="timeout";break;default:D[a].status="off"}}}function $s(t){switch(t){case"power":B.devices.power=Object.values(D).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.power,0);break;case"energy":B.devices.energy=Object.values(D).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function oa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}class Is{constructor(e){s(this,"id");s(this,"name","Zähler");s(this,"power",0);s(this,"energy_imported",0);s(this,"energy_exported",0);s(this,"grid",!1);s(this,"type","counter");s(this,"color","var(--color-evu)");s(this,"energyPv",0);s(this,"energyBat",0);s(this,"pvPercentage",0);s(this,"icon","");this.id=e}}const ue=J({});function Cs(t,e){if(t in ue)console.info("Duplicate counter message: "+t);else switch(ue[t]=new Is(t),ue[t].type=e,e){case"counter":ue[t].color="var(--color-evu)";break;case"inverter":ue[t].color="var(--color-pv)";break;case"cp":ue[t].color="var(--color-charging)";break;case"bat":ue[t].color="var(--color-bat)";break}}const Bs=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#","openWB/command/"+mt()+"/#","openWB/optional/int_display/#"];function Os(){xa(Ts),Bs.forEach(t=>{Ce(t)}),Z()}function Ts(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?As(t,a):t.match(/^openwb\/counter\//i)?Ls(t,a):t.match(/^openwb\/bat\//i)?vs(t,a):t.match(/^openwb\/pv\//i)?Ds(t,a):t.match(/^openwb\/chargepoint\//i)?bs(t,a):t.match(/^openwb\/vehicle\/template\//i)?ks(t,a):t.match(/^openwb\/vehicle\//i)?ws(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?Gs(t,a):t.match(/^openwb\/graph\//i)?ts(t,a):t.match(/^openwb\/log\/daily\//i)?ss(t,a):t.match(/^openwb\/log\/monthly\//i)?us(t,a):t.match(/^openwb\/log\/yearly\//i)?ds(t,a):t.match(/^openwb\/optional\/et\//i)?ys(t,a):t.match(/^openwb\/system\//i)?Es(t,a):t.match(/^openwb\/LegacySmartHome\//i)?Ms(t,a):t.match(/^openwb\/command\//i)?Ws(t,a):t.match(/^openwb\/optional\//i)&&Ns(t,a)}function As(t,e){const a=t.split("/"),r=+a[2];if(r==F.evuId?Vs(t,e):a[3]=="config",a[3]=="get"&&r in ue)switch(a[4]){case"power":ue[r].power=+e;break;case"config":break;case"fault_str":break;case"fault_state":break;case"power_factors":break;case"imported":break;case"exported":break;case"frequency":break;case"daily_imported":ue[r].energy_imported=+e;break;case"daily_exported":ue[r].energy_exported=+e;break}}function Ls(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Ba(),fs();for(const r of a)r.type=="counter"&&(F.evuId=r.id);na(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?(B.house.power=+e,Da()):t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(B.house.energy=+e)}function na(t){switch(t.type){case"counter":Cs(t.id,t.type);break;case"cp":Ca(t.id);break;case"bat":ms(t.id);break}t.children.forEach(e=>na(e))}function Ds(t,e){switch(t){case"openWB/pv/get/power":E.pv.power=-e;break;case"openWB/pv/get/daily_exported":E.pv.energy=+e;break}}function Gs(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":F.updatePvBatteryPriority(e=="true");break}}function Vs(t,e){switch(t.split("/")[4]){case"power":+e>0?(E.evuIn.power=+e,B.evuOut.power=0):(E.evuIn.power=0,B.evuOut.power=-e);break;case"daily_imported":E.evuIn.energy=+e;break;case"daily_exported":B.evuOut.energy=+e;break}}function Es(t,e){if(t.match(/^openWB\/system\/device\/[0-9]+\/component\/[0-9]+\/config$/i)){const a=JSON.parse(e);a.type=="counter"&&(ue[a.id].name=a.name)}else t.match(/^openWB\/system\/ip_address$/i)?F.ipAddress=JSON.parse(e):t.match(/^openWB\/system\/time$/i)?F.systemTime=JSON.parse(e):t.match(/^openWB\/system\/version$/i)?F.version=JSON.parse(e):t.match(/^openWB\/system\/current_commit$/i)?F.versionDetails=JSON.parse(e):t.match(/^openWB\/system\/current_branch$/i)&&(F.devBranch=JSON.parse(e))}function Ws(t,e){const a=t.split("/");if(t.match(/^openWB\/command\/[a-z]+\/error$/i)&&a[2]==mt()){const r=JSON.parse(e);console.error(`Error message from openWB: 
Command: ${r.command}
Data: JSON.stringify(err.data)
Error:
 ${r.error}`)}}function Ns(t,e){if(t.match(/^openwb\/optional\/int_display\/active$/i))ae.active=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/only_local_charge_points$/i))ae.localCpOnly=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/theme$/i)){const a=JSON.parse(e);ae.usePin=a.configuration.lock_changes,ae.code=a.configuration.lock_changes_code}}const js={class:"d-flex flex-column align-items-center justify-content-start infoitem"},zs=A({__name:"InfoItem",props:{heading:{},small:{type:Boolean}},setup(t){const e=t,a=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-small)"}),r=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-normal)"}),o=g(()=>e.small?"mt-0":"mt-1");return(u,l)=>(h(),_("span",js,[c("span",{class:X(["d-flex heading",o.value]),style:oe(a.value)},C(e.heading),7),c("span",{class:"d-flex my-0 me-0 align-items-center content",style:oe(r.value)},[he(u.$slots,"default",{},void 0,!0)],4)]))}}),ne=K(zs,[["__scopeId","data-v-f6af00e8"]]),Us=A({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=12?"fa-battery-empty":e.soc<38?"fa-battery-quarter":e.soc<63?"fa-battery-half":e.soc<89?"fa-battery-three-quarters":"fa-battery-full");return(r,o)=>(h(),_("span",null,[c("i",{class:X(["fa batIcon",a.value])},null,2),j(" "+C(Math.round(r.soc)+"%"),1)]))}}),Fs=K(Us,[["__scopeId","data-v-fc156cd3"]]),Js=A({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Et(e.wattH,m.decimalPlaces));return(r,o)=>(h(),_("span",null,C(a.value),1))}}),sa=t=>(we("data-v-6500d081"),t=t(),ke(),t),Rs=sa(()=>c("span",{class:"fa-solid fa-charging-station"}," ",-1)),Ys={class:"grid12"},Hs={class:"targetCurrent"},Qs={class:"d-flex justify-content-left align-items-center"},qs=sa(()=>c("i",{class:"fa-solid fa-sm fa-car me-3"},null,-1)),Xs={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},Zs={key:1,class:"me-0 fa-solid fa-xs fa-coins ps-0"},Ks={class:"grid12"},ei={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},ti={type:"button"},ai=A({__name:"CPChargePoint",props:{chargepoint:{}},setup(t){const e=t,a=ce(e.chargepoint),r=g({get(){return e.chargepoint.chargeMode},set(k){ae.locked?ht():b[e.chargepoint.id].chargeMode=k}}),o=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),u=g(()=>(Math.round(e.chargepoint.realCurrent*10)/10).toLocaleString(void 0)+" A"),l=g(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),p=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),d=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),f=g(()=>{let k="";return e.chargepoint.isLocked?k="fa-lock":e.chargepoint.isCharging?k=" fa-bolt":e.chargepoint.isPluggedIn&&(k="fa-plug"),"fa "+k}),v=g(()=>e.chargepoint.soc),O=g(()=>({color:e.chargepoint.color})),M=g(()=>e.chargepoint.etMaxPrice>=+ee.value?{color:"var(--color-charging)"}:{color:"var(--color-menu)"}),R=ce(!1),ee=g(()=>{const[k]=re.etPriceList.values();return(Math.round(k*10)/10).toFixed(1)});function Y(){ae.locked?ht():new Lt("#settingspage").toggle()}return(k,N)=>R.value?$("",!0):(h(),W(et,{key:0,"variable-width":!0},{title:I(()=>[c("span",{style:oe(O.value)},[Rs,j(" "+C(e.chargepoint.name),1)],4)]),buttons:I(()=>[P($e,{color:"var(--color-cp0)",icon:"fa-edit",onClick:Y},{default:I(()=>[j(" Einstellungen")]),_:1})]),footer:I(()=>[c("h3",Qs,[qs,j(" "+C(k.chargepoint.vehicleName)+" ",1),k.chargepoint.hasPriority?(h(),_("span",Xs)):$("",!0),k.chargepoint.etActive?(h(),_("span",Zs)):$("",!0)]),c("div",Ks,[k.chargepoint.isSocConfigured?(h(),W(ne,{key:0,heading:"Ladestand:",class:"grid-col-4 grid-left"},{default:I(()=>[P(Fs,{soc:v.value,class:"me-2"},null,8,["soc"])]),_:1})):$("",!0),k.chargepoint.isSocConfigured?(h(),W(ne,{key:1,heading:"Reichweite:",class:"grid-col-4"},{default:I(()=>[j(C(n(U)[e.chargepoint.connectedVehicle]?Math.round(n(U)[e.chargepoint.connectedVehicle].range):0)+" km ",1)]),_:1})):$("",!0),P(ne,{heading:"Zeitplan:",class:"grid-col-4 grid-right"},{default:I(()=>[k.chargepoint.timedCharging?(h(),_("span",ei)):$("",!0),j(" "+C(e.chargepoint.timedCharging?"Ja":"Nein"),1)]),_:1}),n(re).active?(h(),W(ne,{key:2,heading:"Preisladen:",class:"grid-col-4 grid-left"},{default:I(()=>[j(C(a.value.etActive?"Ja":"Nein"),1)]),_:1})):$("",!0),n(re).active?(h(),W(ne,{key:3,heading:"max. Preis:",class:"grid-col-4"},{default:I(()=>[c("span",ti,C(e.chargepoint.etActive?(Math.round(e.chargepoint.etMaxPrice*10)/10).toFixed(1)+" ct":"-"),1)]),_:1})):$("",!0),n(re).active?(h(),W(ne,{key:4,heading:"akt. Preis:",class:"grid-col-4 grid-right"},{default:I(()=>[c("span",{style:oe(M.value)},C(ee.value)+" ct ",5)]),_:1})):$("",!0),P(Qt,{id:"chargemode-"+k.chargepoint.name,modelValue:r.value,"onUpdate:modelValue":N[0]||(N[0]=L=>r.value=L),class:"chargemodes mt-3 mb-3",options:Object.keys(n(Te)).map(L=>({text:n(Te)[L].name,value:L,color:n(Te)[L].color,icon:n(Te)[L].icon,active:n(Te)[L].mode==k.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])])]),default:I(()=>[c("div",Ys,[P(ne,{heading:"Status:",class:"grid-col-4 grid-left"},{default:I(()=>[c("span",{style:oe({color:d.value})},[c("i",{class:X(f.value)},null,2),j(" "+C(p.value),1)],4)]),_:1}),P(ne,{heading:"Geladen:",class:"grid-col-4"},{default:I(()=>[P(Js,{"watt-h":k.chargepoint.dailyYield},null,8,["watt-h"])]),_:1}),P(ne,{heading:"gel. Reichw.:",class:"grid-col-4 grid-right"},{default:I(()=>[j(C(l.value),1)]),_:1}),e.chargepoint.power>0?(h(),W(ne,{key:0,heading:"Leistung:",class:"grid-col-3 grid-left"},{default:I(()=>[P(Jt,{watt:e.chargepoint.power},null,8,["watt"])]),_:1})):$("",!0),e.chargepoint.power>0?(h(),W(ne,{key:1,heading:"Strom:",class:"grid-col-3"},{default:I(()=>[j(C(u.value),1)]),_:1})):$("",!0),e.chargepoint.power>0?(h(),W(ne,{key:2,heading:"Phasen:",class:"grid-col-3"},{default:I(()=>[j(C(e.chargepoint.phasesInUse),1)]),_:1})):$("",!0),e.chargepoint.power>0?(h(),W(ne,{key:3,heading:"Sollstrom:",class:"grid-col-3 grid-right"},{default:I(()=>[c("span",Hs,C(o.value),1)]),_:1})):$("",!0)])]),_:1}))}}),ri=K(ai,[["__scopeId","data-v-6500d081"]]),oi=t=>(we("data-v-afcf5c89"),t=t(),ke(),t),ni={class:"content"},si={class:"leftside"},ii={class:"rightside"},ci=oi(()=>c("span",{class:"statustitle"},"Systemstatus",-1)),li={class:"settingstitle"},ui=A({__name:"DisplayTheme",setup(t){function e(r){La(r)&&(ae.locked=!1,setTimeout(()=>{ae.locked=!0},ae.timeout*1e3))}Ke(()=>{window.addEventListener("resize",Na),window.addEventListener("focus",a),Os()});function a(){document.hasFocus()&&Z()}return(r,o)=>(h(),_(ie,null,[c("div",ni,[c("div",si,[Fe(c("div",null,[P(Cr)],512),[[rt,n(m).graphToShow=="powermeter"]]),Fe(c("div",null,[P(Fo)],512),[[rt,n(m).graphToShow=="powergraph"]]),Fe(c("div",null,[P(mn)],512),[[rt,n(m).graphToShow=="energymeter"]])]),c("div",ii,[Object.values(n(b)).length>n(m).cpToShow?(h(),W(ri,{key:0,chargepoint:Object.values(n(b))[n(m).cpToShow],"full-width":!0},null,8,["chargepoint"])):$("",!0)])]),P(lt,{"modal-id":"numberpad"},{title:I(()=>[j("Code")]),default:I(()=>[P(An,{"model-value":"","onUpdate:modelValue":e})]),_:1}),P(lt,{"modal-id":"statuspage"},{title:I(()=>[ci]),default:I(()=>[P(jn)]),_:1}),Object.values(n(b)).length>n(m).cpToShow?(h(),W(lt,{key:0,"modal-id":"settingspage"},{title:I(()=>[c("span",li,"Einstellungen für "+C(Object.values(n(b))[n(m).cpToShow].name)+" ("+C(Object.values(n(b))[n(m).cpToShow].vehicleName)+") ",1)]),default:I(()=>[P(es,{chargepoint:Object.values(n(b))[n(m).cpToShow]},null,8,["chargepoint"])]),_:1})):$("",!0)],64))}}),di=K(ui,[["__scopeId","data-v-afcf5c89"]]),hi={class:"fixeddisplay"},pi=A({__name:"App",setup(t){return(e,a)=>(h(),_("div",hi,[P(di),P(er)]))}}),gi=K(pi,[["__scopeId","data-v-75d14554"]]),mi=va(gi);mi.mount("#app");
