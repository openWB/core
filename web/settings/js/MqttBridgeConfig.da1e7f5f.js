"use strict";(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[1058],{6365:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var a=n(6252),o=n(3577);const l=e=>((0,a.dD)("data-v-969346e4"),e=e(),(0,a.Cn)(),e),r={class:"mqttBridgeConfiguration"},u=(0,a.Uk)(" ACHTUNG: Die Konfiguration einer MQTT-Brücke erlaubt allen Nutzern mit Zugang zum entfernten MQTT-Server alle weitergeleiteten Daten dieser openWB einzusehen!"),i=l((()=>(0,a._)("br",null,null,-1))),d=(0,a.Uk)(' Es wird dringend empfohlen, dies nur für nicht-öffentliche MQTT-Server unter Verwendung starker Transport-Verschlüsselung (TLS) mit persönlichem Login und strenger Zugriffskontrolle (zumindest für die MQTT-Thema unterhalb von "Entfernter Präfix") zu aktivieren! '),s={key:0},m=(0,a.Uk)(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Modus "Nur Ladepunkt" befindet. '),p={key:1},g=(0,a.Uk)(" Es wurde noch keine MQTT Brücke konfiguriert. "),c=["name"],b=(0,a.Uk)(" Die Bezeichnung darf nur aus Buchstaben ohne Umlaute und Zahlen bestehen. "),h=l((()=>(0,a._)("hr",null,null,-1))),f=(0,a.Uk)(" Einstellungen zur Verbindung "),v=(0,a.Uk)(' Das Präfix darf nur aus Buchstaben ohne Umlaute, Zahlen, Binde- und Unterstrichen bestehen. Optional kann mit einem Schrägstrich "/" eine Topic-Struktur abgebildet werden. Am Ende des Präfix muss ein Schrägstrich "/" stehen. '),w=(0,a.Uk)(" Die Client ID darf nur aus Buchstaben ohne Umlaute, Zahlen, Binde- und Unterstrichen bestehen. "),k=(0,a.Uk)(' In der Einstellung "Automatisch" wird die Version zwischen Client und Server ausgehandelt. Wenn erforderlich, kann eine spezielle Version erzwungen werden. Versionen kleiner 1.2 gelten als veraltet und sollten nicht mehr verwendet werden. '),B=(0,a.Uk)(" Aktiviert eine proprietäre Protokoll-Erweiterung des Mosquitto Brokers, welche dem entfernten Broker signalisiert dass es sich um eine MQTT Brücke handelt. Ergibt bessere Leistung mit Mosquitto-Brokern, ist jedoch inkompatibel mit vielen anderen MQTT-Brokern. Daher bitte nur aktivieren, wenn der Ziel-Broker sicher ein Mosquitto-Broker ist. "),q=l((()=>(0,a._)("hr",null,null,-1))),V=(0,a.Uk)("Datenübertragung"),M=(0,a.Uk)("ToDo..."),U=(0,a.Uk)("ToDo..."),_=(0,a.Uk)("ToDo...");function x(e,t,n,l,x,W){const T=(0,a.up)("openwb-base-modal-dialog"),S=(0,a.up)("openwb-base-alert"),y=(0,a.up)("font-awesome-icon"),D=(0,a.up)("openwb-base-avatar"),A=(0,a.up)("openwb-base-text-input"),z=(0,a.up)("openwb-base-button-group-input"),C=(0,a.up)("openwb-base-heading"),I=(0,a.up)("openwb-base-number-input"),Z=(0,a.up)("openwb-base-submit-buttons"),E=(0,a.up)("openwb-base-card");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(T,{show:x.showMqttBridgeModal,title:"MQTT-Brücke löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:t[0]||(t[0]=e=>W.removeMqttBridge(x.modalMqttBridgeIndex,e))},{default:(0,a.w5)((()=>[(0,a.Uk)(' Wollen Sie die MQTT-Brücke "'+(0,o.zw)(W.getMqttBridgeName(x.modalMqttBridgeIndex))+'" wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)])),_:1},8,["show"]),(0,a._)("div",r,[(0,a.Wm)(S,{subtype:"danger"},{default:(0,a.w5)((()=>[u,i,d])),_:1}),(0,a.Wm)(E,{title:"Konfigurierte MQTT-Brücken"},{actions:(0,a.w5)((()=>[!1===e.$store.state.mqtt["openWB/general/extern"]?((0,a.wg)(),(0,a.j4)(D,{key:0,class:"bg-success clickable",onClick:W.addMqttBridge},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{"fixed-width":"",icon:["fas","plus"]})])),_:1},8,["onClick"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[!0===e.$store.state.mqtt["openWB/general/extern"]?((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(S,{subtype:"info"},{default:(0,a.w5)((()=>[m])),_:1})])):((0,a.wg)(),(0,a.iD)("div",p,[0===Object.keys(W.configuredMqttBridges).length?((0,a.wg)(),(0,a.j4)(S,{key:0,subtype:"info"},{default:(0,a.w5)((()=>[g])),_:1})):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W.configuredMqttBridges,((t,n)=>((0,a.wg)(),(0,a.iD)("form",{key:n,name:"mqttBridgeConfigurationForm"+W.getMqttBridgeIndex(n)},[(0,a.Wm)(E,{title:t.name,collapsible:!0,collapsed:!0,subtype:"primary"},{actions:(0,a.w5)((()=>[(0,a.Wm)(D,{class:"bg-danger clickable",onClick:e=>W.removeMqttBridgeModal(n,e)},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])])),footer:(0,a.w5)((()=>[(0,a.Wm)(Z,{formName:"mqttBridgeConfigurationForm"+W.getMqttBridgeIndex(n),hideDefaults:!0,onSave:t=>e.$emit("save",[n]),onReset:t=>e.$emit("reset",[n])},null,8,["formName","onSave","onReset"])])),default:(0,a.w5)((()=>[(0,a.Wm)(A,{title:"Bezeichnung",subtype:"text",required:"",pattern:"[A-Za-z0-9]+","model-value":t.name,"onUpdate:modelValue":t=>e.updateState(n,t,"name")},{help:(0,a.w5)((()=>[b])),_:2},1032,["model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"Brücke aktivieren",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.active,"onUpdate:modelValue":t=>e.updateState(n,t,"active")},null,8,["model-value","onUpdate:modelValue"]),h,(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(A,{title:"Entfernter Server",subtype:"host",required:"","model-value":t.remote.host,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.host")},null,8,["model-value","onUpdate:modelValue"]),(0,a.Wm)(I,{title:"Entfernter Port",required:"",min:1,max:65535,"model-value":t.remote.port,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.port")},null,8,["model-value","onUpdate:modelValue"]),(0,a.Wm)(A,{title:"Benutzername",subtype:"user",required:"",pattern:"[a-zA-Z0-9_\\-+.]+","model-value":t.remote.user,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.user")},null,8,["model-value","onUpdate:modelValue"]),(0,a.Wm)(A,{title:"Passwort",subtype:"password",required:"","model-value":t.remote.password,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.password")},null,8,["model-value","onUpdate:modelValue"]),(0,a.Wm)(A,{title:"Präfix",subtype:"text",pattern:"[A-Za-z0-9_\\-]+(\\/[A-Za-z0-9_\\-]+)?\\/","model-value":t.remote.prefix,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.prefix")},{help:(0,a.w5)((()=>[v])),_:2},1032,["model-value","onUpdate:modelValue"]),(0,a.Wm)(A,{title:"Client ID",subtype:"text",required:"",pattern:"[A-Za-z0-9_\\-]+","model-value":t.remote.client_id,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.client_id")},{help:(0,a.w5)((()=>[w])),_:2},1032,["model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"MQTT Protokoll",required:"required",buttons:[{buttonValue:"mqttv31",text:"v3.1"},{buttonValue:"mqttv311",text:"v3.1.1"}],"model-value":t.remote.protocol,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.protocol")},null,8,["buttons","model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"TLS Version",buttons:[{buttonValue:"auto",text:"Automatisch",class:"btn-outline-success"},{buttonValue:"tlsv1.0",text:"v1.0",class:"btn-outline-warning"},{buttonValue:"tlsv1.1",text:"v1.1",class:"btn-outline-warning"},{buttonValue:"tlsv1.2",text:"v1.2"}],"model-value":t.remote.tls_version,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.tls_version")},{help:(0,a.w5)((()=>[k])),_:2},1032,["buttons","model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"Brücke signalisieren",buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"model-value":t.remote.try_private,"onUpdate:modelValue":t=>e.updateState(n,t,"remote.try_private")},{help:(0,a.w5)((()=>[B])),_:2},1032,["model-value","onUpdate:modelValue"]),q,(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[V])),_:1}),(0,a.Wm)(z,{title:"Alle Statusdaten",buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"model-value":t.data_transfer.status,"onUpdate:modelValue":t=>e.updateState(n,t,"data_transfer.status")},{help:(0,a.w5)((()=>[M])),_:2},1032,["model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"Datenserien für Diagramme",buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"model-value":t.data_transfer.graph,"onUpdate:modelValue":t=>e.updateState(n,t,"data_transfer.graph")},{help:(0,a.w5)((()=>[U])),_:2},1032,["model-value","onUpdate:modelValue"]),(0,a.Wm)(z,{title:"Fernkonfiguration ermöglichen",buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"model-value":t.data_transfer.configuration,"onUpdate:modelValue":t=>e.updateState(n,t,"data_transfer.configuration")},{help:(0,a.w5)((()=>[_])),_:2},1032,["model-value","onUpdate:modelValue"])])),_:2},1032,["title"])],8,c)))),128))]))])),_:1})])],64)}var W=n(8947),T=n(1436),S=n(7810),y=n(6061);W.vI.add(T.r8p,T.$aW);var D={name:"OpenwbMqttBridgeConfiguration",mixins:[y.Z],emits:["sendCommand"],components:{FontAwesomeIcon:S.GN},data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/system/mqtt/bridge/+"],showMqttBridgeModal:!1,modalMqttBridgeIndex:void 0}},computed:{configuredMqttBridges:{get(){let e=this.getWildcardTopics("openWB/system/mqtt/bridge/+");for(const[t,n]of Object.entries(e))n.remote.is_openwb_cloud&&(console.log("filtering bridge "+t,n),delete e[t]);return e}}},methods:{addMqttBridge(e){e.stopPropagation(),this.$emit("sendCommand",{command:"addMqttBridge",data:{}})},getMqttBridgeIndex(e){return parseInt(e.match(/(?:\/)(\d+)$/)[1])},removeMqttBridgeModal(e,t){t.stopPropagation(),console.log("removeMqttBridgeModal",e),this.modalMqttBridgeIndex=this.getMqttBridgeIndex(e),this.showMqttBridgeModal=!0},removeMqttBridge(e,t){this.showMqttBridgeModal=!1,"confirm"==t&&(console.info("request removal of mqtt bridge '"+e+"'"),this.$emit("sendCommand",{command:"removeMqttBridge",data:{bridge:e}}))},getMqttBridgeName(e){return this.$store.state.mqtt["openWB/system/mqtt/bridge/"+e]?this.$store.state.mqtt["openWB/system/mqtt/bridge/"+e].name:e}}},A=n(8118);const z=(0,A.Z)(D,[["render",x],["__scopeId","data-v-969346e4"]]);var C=z}}]);
//# sourceMappingURL=MqttBridgeConfig.da1e7f5f.js.map