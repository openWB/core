"use strict";(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[261],{880:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var n=a(6252),l=a(3577);const o=e=>((0,n.dD)("data-v-68a1be8e"),e=e(),(0,n.Cn)(),e),i={class:"chargePointInstallation"},d={name:"chargePointInstallationForm"},u={class:"col-1"},s=(0,n.Uk)(" Bitte einen Ladepunkt auswählen, der hinzugefügt werden soll. "),m=o((()=>(0,n._)("hr",null,null,-1))),r=o((()=>(0,n._)("hr",null,null,-1))),c=(0,n.Uk)("Hardware-Optionen"),p=(0,n.Uk)(" Elektrischer Anschluss "),h=(0,n.Uk)(" Hier ist anzugeben, an welcher Phase am Hausanschluss die Phase 1 dieses Ladepunktes angeschlossen ist. Diese Information wird für das Lastmanagement benötigt, um bei einer Schieflast gezielt einzelne Ladepunkte zu drosseln."),g=o((()=>(0,n._)("br",null,null,-1))),b=(0,n.Uk)(" Bei mehreren Ladepunkten macht es Sinn, die Phasen rotierend anzuschließen, damit mehrere nicht dreiphasig ladende Fahrzeuge mit optimaler Leistung laden können, bevor das Lastmanagement eingreift. "),k=(0,n.Uk)(" Die Standard-Vorlage kann nicht umbenannt werden. "),w=o((()=>(0,n._)("hr",null,null,-1))),f=(0,n.Uk)("RFID"),P=o((()=>(0,n._)("hr",null,null,-1))),v=(0,n.Uk)("Autolock"),C=(0,n.Uk)(" Autolock Zeitpläne "),V={key:0},W={key:1},y={key:2},_={key:2};function x(e,t,a,o,x,T){const U=(0,n.up)("openwb-base-modal-dialog"),q=(0,n.up)("font-awesome-icon"),I=(0,n.up)("openwb-base-click-button"),A=(0,n.up)("openwb-base-select-input"),S=(0,n.up)("openwb-base-avatar"),L=(0,n.up)("openwb-base-text-input"),D=(0,n.up)("openwb-base-heading"),$=(0,n.up)("openwb-base-button-group-input"),B=(0,n.up)("openwb-base-card"),M=(0,n.up)("openwb-base-array-input"),z=(0,n.up)("openwb-base-submit-buttons");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(U,{show:x.showChargePointModal,title:"Ladepunkt löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:t[0]||(t[0]=e=>T.removeChargePoint(x.modalChargePointIndex,e))},{default:(0,n.w5)((()=>[(0,n.Uk)(' Wollen Sie den Ladepunkt "'+(0,l.zw)(T.getChargePointName(x.modalChargePointIndex))+'" (ID: '+(0,l.zw)(x.modalChargePointIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)])),_:1},8,["show"]),(0,n.Wm)(U,{show:x.showChargePointTemplateModal,title:"Ladepunkt-Vorlage löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:t[1]||(t[1]=e=>T.removeChargePointTemplate(x.modalChargePointTemplateIndex,e))},{default:(0,n.w5)((()=>[(0,n.Uk)(' Wollen Sie die Ladepunkt-Vorlage "'+(0,l.zw)(T.getChargePointTemplateName(x.modalChargePointTemplateIndex))+'" (ID: '+(0,l.zw)(x.modalChargePointTemplateIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)])),_:1},8,["show"]),(0,n.Wm)(U,{show:x.showChargePointTemplateAutolockPlanModal,title:"Autolock Zeitplan löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:t[2]||(t[2]=e=>T.removeChargePointTemplateAutolockPlan(x.modalChargePointTemplateIndex,x.modalChargePointTemplateAutolockPlanIndex,e))},{default:(0,n.w5)((()=>[(0,n.Uk)(' Wollen Sie den Autolock Zeitplan "'+(0,l.zw)(T.getChargePointTemplateAutolockPlanName(x.modalChargePointTemplateIndex,x.modalChargePointTemplateAutolockPlanIndex))+'" wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)])),_:1},8,["show"]),(0,n._)("div",i,[(0,n._)("form",d,[(0,n.Wm)(B,{title:"Ladepunkte",collapsible:!0,collapsed:!0},{default:(0,n.w5)((()=>[(0,n.Wm)(A,{class:"mb-2",title:"Verfügbare Ladepunkte",notSelected:"Bitte auswählen",options:T.getChargePointList(),"model-value":x.chargePointToAdd,"onUpdate:modelValue":t[3]||(t[3]=e=>x.chargePointToAdd=e)},{append:(0,n.w5)((()=>[(0,n._)("span",u,[(0,n.Wm)(I,{class:(0,l.C_)(void 0===x.chargePointToAdd?"btn-outline-success":"btn-success"),disabled:void 0===x.chargePointToAdd,onClick:T.addChargePoint},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","plus"]})])),_:1},8,["class","disabled","onClick"])])])),help:(0,n.w5)((()=>[s])),_:1},8,["options","model-value"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(T.installedChargePoints,((t,a)=>((0,n.wg)(),(0,n.j4)(B,{key:a,title:t.name+" (ID: "+t.id+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:(0,n.w5)((()=>[(0,n.Wm)(S,{class:"bg-danger clickable",onClick:e=>T.removeChargePointModal(a,e)},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])])),default:(0,n.w5)((()=>[(0,n.Wm)(L,{title:"Bezeichnung",subtype:"text","model-value":t.name,"onUpdate:modelValue":t=>e.updateState(a,t,"name")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(A,{title:"Ladepunkt-Vorlage",options:T.chargePointTemplateList,"model-value":e.$store.state.mqtt[a].template,"onUpdate:modelValue":t=>e.updateState(a,t,"template")},null,8,["options","model-value","onUpdate:modelValue"]),(0,n.Wm)(L,{title:"Ladepunkt-Typ",readonly:"","model-value":e.$store.state.mqtt[a].type},null,8,["model-value"]),m,(0,n.Wm)(L,{title:"Verbindungsmodul",subtype:"text","model-value":t.connection_module.type,"onUpdate:modelValue":t=>e.updateState(a,t,"connection_module.type"),disabled:""},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(L,{title:"Verbindung",subtype:"json","model-value":t.connection_module.configuration,"onUpdate:modelValue":t=>e.updateState(a,t,"connection_module.configuration")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(L,{title:"Leistungsmodul",subtype:"text","model-value":t.power_module.type,"onUpdate:modelValue":t=>e.updateState(a,t,"power_module.type"),disabled:""},null,8,["model-value","onUpdate:modelValue"]),r,(0,n.Wm)(D,null,{default:(0,n.w5)((()=>[c])),_:1}),(0,n.Wm)($,{title:"1/3-Phasenumschaltung vorhanden",buttons:[{buttonValue:!1,text:"Nein"},{buttonValue:!0,text:"Ja"}],"model-value":t.auto_phase_switch_hw,"onUpdate:modelValue":t=>e.updateState(a,t,"auto_phase_switch_hw")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)($,{title:"Control-Pilot-Unterbrechung vorhanden",buttons:[{buttonValue:!1,text:"Nein"},{buttonValue:!0,text:"Ja"}],"model-value":t.control_pilot_interruption_hw,"onUpdate:modelValue":t=>e.updateState(a,t,"control_pilot_interruption_hw")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(D,null,{default:(0,n.w5)((()=>[p])),_:1}),(0,n.Wm)($,{title:"Anzahl angeschlossener Phasen",buttons:[{buttonValue:1,text:"1"},{buttonValue:2,text:"2"},{buttonValue:3,text:"3"}],"model-value":t.connected_phases,"onUpdate:modelValue":t=>e.updateState(a,t,"connected_phases")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)($,{title:"Phase 1",buttons:[{buttonValue:0,text:"unbekannt",class:"btn-outline-danger"},{buttonValue:1,text:"EVU L1",class:"btn-outline-success"},{buttonValue:2,text:"EVU L2",class:"btn-outline-success"},{buttonValue:3,text:"EVU L3",class:"btn-outline-success"}],"model-value":t.phase_1,"onUpdate:modelValue":t=>e.updateState(a,t,"phase_1")},{help:(0,n.w5)((()=>[h,g,b])),_:2},1032,["model-value","onUpdate:modelValue"])])),_:2},1032,["title"])))),128))])),_:1}),(0,n.Wm)(B,{title:"Ladepunkt-Vorlagen",collapsible:!0,collapsed:!0},{actions:(0,n.w5)((()=>[!1===e.$store.state.mqtt["openWB/general/extern"]?((0,n.wg)(),(0,n.j4)(S,{key:0,class:"bg-success clickable",onClick:T.addChargePointTemplate},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","plus"]})])),_:1},8,["onClick"])):(0,n.kq)("",!0)])),default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(T.chargePointTemplates,((t,a)=>((0,n.wg)(),(0,n.j4)(B,{key:a,title:t.name+" (ID: "+T.getChargePointTemplateIndex(a)+")",collapsible:!0,collapsed:!0,subtype:"primary"},(0,n.Nv)({default:(0,n.w5)((()=>[(0,n.Wm)(L,{title:"Bezeichnung",subtype:"text","model-value":t.name,"onUpdate:modelValue":t=>e.updateState(a,t,"name"),disabled:a.endsWith("/0")},(0,n.Nv)({_:2},[a.endsWith("/0")?{name:"help",fn:(0,n.w5)((()=>[k]))}:void 0]),1032,["model-value","onUpdate:modelValue","disabled"]),w,(0,n.Wm)(D,null,{default:(0,n.w5)((()=>[f])),_:1}),(0,n.Wm)($,{title:"Freigabe mit RFID",buttons:[{buttonValue:!1,text:"Nein"},{buttonValue:!0,text:"Ja"}],"model-value":t.rfid_enabling,"onUpdate:modelValue":t=>e.updateState(a,t,"rfid_enabling")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(M,{title:"Zugeordnete Tags",noElementsMessage:"Keine Tags zugeordnet.","model-value":t.valid_tags,"onUpdate:modelValue":t=>e.updateState(a,t,"valid_tags")},null,8,["model-value","onUpdate:modelValue"]),P,(0,n.Wm)(D,null,{default:(0,n.w5)((()=>[v])),_:1}),(0,n.Wm)($,{title:"Autolock aktiv",buttons:[{buttonValue:!1,text:"Nein"},{buttonValue:!0,text:"Ja"}],"model-value":t.autolock.active,"onUpdate:modelValue":t=>e.updateState(a,t,"autolock.active")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)($,{title:"Erst nach Ladeende sperren",buttons:[{buttonValue:!1,text:"Nein"},{buttonValue:!0,text:"Ja"}],"model-value":t.autolock.wait_for_charging_end,"onUpdate:modelValue":t=>e.updateState(a,t,"autolock.wait_for_charging_end")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(D,null,{actions:(0,n.w5)((()=>[(0,n.Wm)(S,{class:"bg-success clickable",onClick:e=>T.addChargePointTemplateAutolockPlan(a,e)},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","plus"]})])),_:2},1032,["onClick"])])),default:(0,n.w5)((()=>[C])),_:2},1024),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(T.getChargePointTemplateAutolockPlans(a),((t,o)=>((0,n.wg)(),(0,n.j4)(B,{key:o,title:t.name,collapsible:!0,collapsed:!0},{actions:(0,n.w5)((i=>[1==i.collapsed?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,l.C_)(["subheader pill",t.active?"bg-success":"bg-danger"])},[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","clock"]}),(0,n.Uk)(" "+(0,l.zw)(t.time[0])+" - "+(0,l.zw)(t.time[1])+" ",1),"once"==t.frequency.selected?((0,n.wg)(),(0,n.iD)("span",V,[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","calendar-day"]}),(0,n.Uk)(" "+(0,l.zw)(e.formatDate(t.frequency.once[0])==e.formatDate(t.frequency.once[1])?e.formatDate(t.frequency.once[0]):e.formatDate(t.frequency.once[0])+"-"+e.formatDate(t.frequency.once[1])),1)])):(0,n.kq)("",!0),"daily"==t.frequency.selected?((0,n.wg)(),(0,n.iD)("span",W,[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","calendar-week"]})])):(0,n.kq)("",!0),"weekly"==t.frequency.selected?((0,n.wg)(),(0,n.iD)("span",y,[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","calendar-alt"]})])):(0,n.kq)("",!0)],2)):(0,n.kq)("",!0),0==i.collapsed?((0,n.wg)(),(0,n.j4)(S,{key:1,class:"bg-danger clickable",onClick:e=>T.removeChargePointTemplateAutolockPlanModal(a,o,e)},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])):(0,n.kq)("",!0)])),default:(0,n.w5)((()=>[(0,n.Wm)(L,{title:"Bezeichnung","model-value":t.name,"onUpdate:modelValue":t=>e.updateState(o,t,"name")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)($,{title:"Zeitplan aktiv",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.active,"onUpdate:modelValue":t=>e.updateState(o,t,"active")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(L,{title:"Sperren um",subtype:"time","model-value":t.time[0],"onUpdate:modelValue":t=>e.updateState(o,t,"time.0")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(L,{title:"Freigeben um",subtype:"time","model-value":t.time[1],"onUpdate:modelValue":t=>e.updateState(o,t,"time.1")},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)($,{title:"Wiederholungen",buttons:[{buttonValue:"once",text:"Einmalig",class:"btn-outline-info"},{buttonValue:"daily",text:"Täglich",class:"btn-outline-info"},{buttonValue:"weekly",text:"Wöchentlich",class:"btn-outline-info"}],"model-value":t.frequency.selected,"onUpdate:modelValue":t=>e.updateState(o,t,"frequency.selected")},null,8,["model-value","onUpdate:modelValue"]),"once"==t.frequency.selected?((0,n.wg)(),(0,n.j4)(L,{key:0,title:"Sperren ab ...",subtype:"date","model-value":t.frequency.once[0],"onUpdate:modelValue":t=>e.updateState(o,t,"frequency.once.0")},null,8,["model-value","onUpdate:modelValue"])):(0,n.kq)("",!0),"once"==t.frequency.selected?((0,n.wg)(),(0,n.j4)(L,{key:1,title:"... bis",subtype:"date",min:t.frequency.once[0],"model-value":t.frequency.once[1],"onUpdate:modelValue":t=>e.updateState(o,t,"frequency.once.1")},null,8,["min","model-value","onUpdate:modelValue"])):(0,n.kq)("",!0),"weekly"==t.frequency.selected?((0,n.wg)(),(0,n.iD)("div",_,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.weekdays,((a,l)=>((0,n.wg)(),(0,n.j4)($,{key:l,title:a,buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"model-value":t.frequency.weekly[l],"onUpdate:modelValue":t=>e.updateState(o,t,"frequency.weekly."+l)},null,8,["title","model-value","onUpdate:modelValue"])))),128))])):(0,n.kq)("",!0)])),_:2},1032,["title"])))),128))])),_:2},[a.endsWith("/0")?void 0:{name:"actions",fn:(0,n.w5)((()=>[(0,n.Wm)(S,{class:"bg-danger clickable",onClick:e=>T.removeChargePointTemplateModal(a,e)},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])]))}]),1032,["title"])))),128))])),_:1}),(0,n.Wm)(z,{formName:"chargePointInstallationForm",onSave:t[4]||(t[4]=t=>e.$emit("save")),onReset:t[5]||(t[5]=t=>e.$emit("reset")),onDefaults:t[6]||(t[6]=t=>e.$emit("defaults"))})])])],64)}var T=a(8947),U=a(1436),q=a(7810),I=a(6061);T.vI.add(U.r8p,U.$aW,U.$nv,U.IV4,U.Nl7);var A={name:"OpenwbChargePointInstallation",mixins:[I.Z],emits:["sendCommand"],components:{FontAwesomeIcon:q.GN},data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/chargepoint/+/config","openWB/chargepoint/template/+","openWB/chargepoint/template/+/autolock/+","openWB/system/configurable/chargepoints"],chargePointToAdd:void 0,showChargePointModal:!1,modalChargePointIndex:void 0,showChargePointTemplateModal:!1,modalChargePointTemplateIndex:void 0,showChargePointTemplateAutolockPlanModal:!1,modalChargePointTemplateAutolockPlanIndex:void 0}},computed:{installedChargePoints:{get(){return this.getWildcardTopics("openWB/chargepoint/+/config")}},chargePointTemplates:{get(){return this.getWildcardTopics("openWB/chargepoint/template/+")}},chargePointTemplateList:{get(){let e=[];return Object.keys(this.chargePointTemplates).forEach((t=>{let a=parseInt(t.match(/([0-9]+)/g)[0]),n=this.$store.state.mqtt["openWB/chargepoint/template/"+a].name;e.push({value:a,text:n})})),e}}},methods:{addChargePoint(e){e.stopPropagation(),this.$emit("sendCommand",{command:"addChargepoint",data:{type:this.chargePointToAdd}})},removeChargePointModal(e,t){t.stopPropagation(),this.modalChargePointIndex=parseInt(e.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showChargePointModal=!0},removeChargePoint(e,t){this.showChargePointModal=!1,"confirm"==t&&(console.info("request removal of charge point '"+e+"'"),this.$emit("sendCommand",{command:"removeChargepoint",data:{id:e}}))},getChargePointList(){return this.$store.state.mqtt["openWB/system/configurable/chargepoints"]},getChargePointName(e){return this.$store.state.mqtt["openWB/chargepoint/"+e+"/config"]?this.$store.state.mqtt["openWB/chargepoint/"+e+"/config"].name:"Ladepunkt "+e},getChargePointTemplateName(e){return this.$store.state.mqtt["openWB/chargepoint/template/"+e]?this.$store.state.mqtt["openWB/chargepoint/template/"+e].name:"Vorlage "+e},addChargePointTemplate(e){e.stopPropagation(),this.$emit("sendCommand",{command:"addChargepointTemplate",data:{}})},getChargePointTemplateIndex(e){return parseInt(e.match(/([^/]+)$/)[0])},removeChargePointTemplateModal(e,t){t.stopPropagation(),this.modalChargePointTemplateIndex=this.getChargePointTemplateIndex(e),this.showChargePointTemplateModal=!0},removeChargePointTemplate(e,t){this.showChargePointTemplateModal=!1,"confirm"==t&&(console.info("request removal of chargePoint template '"+e+"'"),this.$emit("sendCommand",{command:"removeChargepointTemplate",data:{id:e}}))},addChargePointTemplateAutolockPlan(e,t){t.stopPropagation(),console.info("requesting new charge point template autolock plan...");let a=this.getChargePointTemplateIndex(e);this.$emit("sendCommand",{command:"addAutolockPlan",data:{template:a}})},removeChargePointTemplateAutolockPlanModal(e,t,a){a.stopPropagation(),this.modalChargePointTemplateIndex=this.getChargePointTemplateIndex(e),this.modalChargePointTemplateAutolockPlanIndex=parseInt(t.match(/([^/]+)$/)[0]),this.showChargePointTemplateAutolockPlanModal=!0},removeChargePointTemplateAutolockPlan(e,t,a){this.showChargePointTemplateAutolockPlanModal=!1,"confirm"==a&&(console.info("request removal of chargePoint template '"+e+"' autolock plan '"+t+"'"),this.$emit("sendCommand",{command:"removeAutolockPlan",data:{template:e,plan:t}}))},getChargePointTemplateAutolockPlanName(e,t){return this.$store.state.mqtt["openWB/chargepoint/template/"+e+"/autolock/"+t]?this.$store.state.mqtt["openWB/chargepoint/template/"+e+"/autolock/"+t].name:"Autolock Zeitplan "+e+"/"+t},getChargePointTemplateAutolockPlans(e){let t=this.getChargePointTemplateIndex(e),a=this.getWildcardTopics("openWB/chargepoint/template/"+t+"/autolock/+");return a}}},S=a(8118);const L=(0,S.Z)(A,[["render",x],["__scopeId","data-v-68a1be8e"]]);var D=L}}]);
//# sourceMappingURL=ChargePointInstallation.b34f5502.js.map