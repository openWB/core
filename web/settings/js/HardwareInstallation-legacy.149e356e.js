(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[8054],{805:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return K}});t(8309);var o=t(6252),i=t(3577),u=function(e){return(0,o.dD)("data-v-13f4ddee"),e=e(),(0,o.Cn)(),e},a={class:"hardwareInstallation"},r={name:"hardwareInstallationForm"},d=(0,o.Uk)(" Wenn neue Komponenten - insbesondere Zähler - konfiguriert wurden, ist auch das "),c=(0,o.Uk)(" Lastmanagement "),s=(0,o.Uk)(" zu prüfen! "),l={class:"col-1"},m=(0,o.Uk)(" Bitte ein System auswählen, das hinzugefügt werden soll. "),p=u((function(){return(0,o._)("hr",null,null,-1)})),v=u((function(){return(0,o._)("hr",null,null,-1)})),f={class:"col-1"},g=(0,o.Uk)(" Bitte eine Komponente auswählen, die hinzugefügt werden soll. "),w=(0,o.Uk)(" Dieses System bietet keine Komponenten zur Installation an. "),h=u((function(){return(0,o._)("hr",null,null,-1)}));function b(e,n,t,u,b,y){var C=(0,o.up)("openwb-base-modal-dialog"),k=(0,o.up)("router-link"),_=(0,o.up)("openwb-base-alert"),W=(0,o.up)("font-awesome-icon"),T=(0,o.up)("openwb-base-click-button"),D=(0,o.up)("openwb-base-select-input"),U=(0,o.up)("openwb-base-avatar"),x=(0,o.up)("openwb-base-text-input"),I=(0,o.up)("openwb-config-proxy"),z=(0,o.up)("openwb-base-card"),M=(0,o.up)("openwb-base-submit-buttons");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(C,{show:b.showDeviceRemoveModal,title:"Gerät löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:y.removeDevice},{default:(0,o.w5)((function(){return[(0,o.Uk)(' Wollen Sie das Gerät "'+(0,i.zw)(b.modalDeviceName)+'" inklusive aller Komponenten wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)]})),_:1},8,["show","onModalResult"]),(0,o.Wm)(C,{show:b.showComponentRemoveModal,title:"Komponente löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:y.removeComponent},{default:(0,o.w5)((function(){return[(0,o.Uk)(' Wollen Sie die Komponente "'+(0,i.zw)(b.modalComponentName)+'" wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)]})),_:1},8,["show","onModalResult"]),(0,o._)("div",a,[(0,o._)("form",r,[(0,o.Wm)(_,{subtype:"info"},{default:(0,o.w5)((function(){return[d,(0,o.Wm)(k,{to:"/LoadManagementConfiguration"},{default:(0,o.w5)((function(){return[c]})),_:1}),s]})),_:1}),(0,o.Wm)(z,{title:"Systeme und Komponenten"},{default:(0,o.w5)((function(){return[(0,o.Wm)(D,{class:"mb-2",title:"Verfügbare Systeme",notSelected:"Bitte auswählen",options:y.getDeviceList(),"model-value":b.deviceToAdd,"onUpdate:modelValue":n[0]||(n[0]=function(e){return b.deviceToAdd=e})},{append:(0,o.w5)((function(){return[(0,o._)("span",l,[(0,o.Wm)(T,{class:(0,i.C_)(void 0===b.deviceToAdd?"btn-outline-success":"btn-success clickable"),disabled:void 0===b.deviceToAdd,onClick:y.addDevice},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","plus"]})]})),_:1},8,["class","disabled","onClick"])])]})),help:(0,o.w5)((function(){return[m]})),_:1},8,["options","model-value"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(y.installedDevices,(function(n,t){return(0,o.wg)(),(0,o.j4)(z,{key:n.id,collapsible:!0,collapsed:!0,subtype:"primary"},{header:(0,o.w5)((function(){return[(0,o.Wm)(U,{class:"bg-success"},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","network-wired"]})]})),_:1}),(0,o.Uk)(" "+(0,i.zw)(n.name),1)]})),actions:(0,o.w5)((function(){return[(0,o.Wm)(U,{class:"bg-danger clickable",onClick:function(e){return y.removeDeviceModal(n.id,n.name,e)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","trash"]})]})),_:2},1032,["onClick"])]})),default:(0,o.w5)((function(){return[(0,o.Wm)(x,{title:"Bezeichnung",subtype:"text","model-value":n.name,"onUpdate:modelValue":function(n){return e.updateState(t,n,"name")}},null,8,["model-value","onUpdate:modelValue"]),p,(0,o.Wm)(I,{deviceId:n.id,deviceType:n.type,configuration:n.configuration,"onUpdate:configuration":function(e){return y.updateConfiguration(t,e)}},null,8,["deviceId","deviceType","configuration","onUpdate:configuration"]),v,y.getComponentList(n.type).length?((0,o.wg)(),(0,o.j4)(D,{key:0,class:"mb-2",title:"Verfügbare Komponenten",notSelected:"Bitte auswählen",options:y.getComponentList(n.type),"model-value":b.componentToAdd[n.id],"onUpdate:modelValue":function(e){return b.componentToAdd[n.id]=e}},{append:(0,o.w5)((function(){return[(0,o._)("span",f,[(0,o.Wm)(T,{class:(0,i.C_)(void 0===b.componentToAdd[n.id]?"btn-outline-success":"btn-success clickable"),disabled:void 0===b.componentToAdd[n.id],onClick:function(e){return y.addComponent(n.id,n.type,b.componentToAdd[n.id])}},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","plus"]})]})),_:2},1032,["class","disabled","onClick"])])]})),help:(0,o.w5)((function(){return[g]})),_:2},1032,["options","model-value","onUpdate:modelValue"])):((0,o.wg)(),(0,o.j4)(_,{key:1,subtype:"info"},{default:(0,o.w5)((function(){return[w]})),_:1})),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(y.getMyInstalledComponents(n.id),(function(t,u){return(0,o.wg)(),(0,o.j4)(z,{key:t.id,collapsible:!0,collapsed:!0,subtype:"dark"},{header:(0,o.w5)((function(){return[(0,o.Wm)(U,{class:"bg-success"},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","microchip"]})]})),_:1}),(0,o.Uk)(" "+(0,i.zw)(t.name),1)]})),actions:(0,o.w5)((function(){return[(0,o.Wm)(U,{class:"bg-danger clickable",onClick:function(e){return y.removeComponentModal(n.id,t.id,t.type,t.name,e)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{"fixed-width":"",icon:["fas","trash"]})]})),_:2},1032,["onClick"])]})),default:(0,o.w5)((function(){return[(0,o.Wm)(x,{title:"Bezeichnung",subtype:"text","model-value":t.name,"onUpdate:modelValue":function(n){return e.updateState(u,n,"name")}},null,8,["model-value","onUpdate:modelValue"]),h,(0,o.Wm)(I,{deviceId:n.id,deviceType:n.type,componentId:t.id,componentType:t.type,configuration:t.configuration,"onUpdate:configuration":function(e){return y.updateConfiguration(u,e)}},null,8,["deviceId","deviceType","componentId","componentType","configuration","onUpdate:configuration"])]})),_:2},1024)})),128))]})),_:2},1024)})),128))]})),_:1}),(0,o.Wm)(M,{formName:"hardwareInstallationForm",onSave:n[1]||(n[1]=function(n){return e.$emit("save")}),onReset:n[2]||(n[2]=function(n){return e.$emit("reset")}),onDefaults:n[3]||(n[3]=function(n){return e.$emit("defaults")})})])])],64)}t(9826),t(1539);var y=t(8947),C=t(1436),k=t(7810),_=t(4912),W=(t(8862),{key:1}),T=(0,o.Uk)(" Es wurde keine Konfigurationsseite für den "),D={key:0},U={key:1},x=(0,o.Uk)(" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. "),I=(0,o.Uk)(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ");function z(e,n,t,u,a,r){var d=(0,o.up)("openwb-base-alert"),c=(0,o.up)("openwb-base-textarea");return a.componentTemplateFound?((0,o.wg)(),(0,o.j4)((0,o.LL)(r.myComponent),{key:0,configuration:t.configuration,deviceId:t.deviceId,componentId:t.componentId,"onUpdate:configuration":n[0]||(n[0]=function(e){return r.updateConfiguration(e)})},null,8,["configuration","deviceId","componentId"])):((0,o.wg)(),(0,o.iD)("div",W,[(0,o.Wm)(d,{subtype:"warning"},{default:(0,o.w5)((function(){return[T,t.componentType?((0,o.wg)(),(0,o.iD)("span",D,' Komponententyp "'+(0,i.zw)(t.componentType)+'" ',1)):((0,o.wg)(),(0,o.iD)("span",U,'Gerätetyp "'+(0,i.zw)(t.deviceType)+'"',1)),x]})),_:1}),(0,o.Wm)(c,{title:"Konfiguration",subtype:"json","model-value":t.configuration,"onUpdate:modelValue":n[1]||(n[1]=function(e){return r.updateConfiguration({value:e,object:"configuration"})})},{help:(0,o.w5)((function(){return[I]})),_:1},8,["model-value"]),(0,o.Wm)(d,{subtype:"info"},{default:(0,o.w5)((function(){return[(0,o._)("pre",null,(0,i.zw)(JSON.stringify(t.configuration,void 0,2)),1)]})),_:1})]))}t(2222),t(8783),t(3948);var M={name:"OpenwbConfigProxy",emits:["update:configuration"],props:{deviceId:{required:!0},deviceType:{type:String,required:!0},componentId:{default:void 0},componentType:{type:String,default:void 0},configuration:{type:Object,required:!0}},data:function(){return{componentTemplateFound:!0}},computed:{myComponent:function(){var e=this;return console.debug("loading component: ".concat(this.deviceType," / ").concat(this.componentType)),(0,o.RC)((function(){return t(1107)("./".concat(e.deviceType).concat(e.componentType?"/".concat(e.componentType):"/device",".vue")).then((function(n){return e.componentTemplateFound=!0,n})).catch((function(n){console.warn("component template not found",n),e.componentTemplateFound=!1}))}))}},methods:{updateConfiguration:function(e){this.$emit("update:configuration",e)}}},S=t(8118);const j=(0,S.Z)(M,[["render",z]]);var B=j;y.vI.add(C.r8p,C.kXW,C.zvy,C.$aW);var A={name:"OpenwbHardwareInstallation",mixins:[_.Z],emits:["sendCommand"],components:{FontAwesomeIcon:k.GN,OpenwbConfigProxy:B},data:function(){return{mqttTopicsToSubscribe:["openWB/counter/get/hierarchy","openWB/system/device/+/config","openWB/system/device/+/component/+/config","openWB/system/configurable/devices_components"],deviceToAdd:void 0,showDeviceRemoveModal:!1,modalDevice:void 0,modalDeviceName:"",componentToAdd:[],showComponentRemoveModal:!1,modalComponent:void 0,modalComponentName:""}},computed:{installedDevices:{get:function(){return this.getWildcardTopics("openWB/system/device/+/config")}},installedComponents:{get:function(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")}}},methods:{getMyInstalledComponents:function(e){return this.getWildcardTopics("openWB/system/device/"+e+"/component/+/config")},addDevice:function(){this.$emit("sendCommand",{command:"addDevice",data:{type:this.deviceToAdd}})},removeDeviceModal:function(e,n,t){t.stopPropagation(),this.modalDevice=e,this.modalDeviceName=n,this.showDeviceRemoveModal=!0},removeDevice:function(e){this.showDeviceRemoveModal=!1,"confirm"==e&&(console.info("request removal of device '"+this.modalDevice+"'"),this.$emit("sendCommand",{command:"removeDevice",data:{id:this.modalDevice}}))},getDeviceList:function(){return this.$store.state.mqtt["openWB/system/configurable/devices_components"]},addComponent:function(e,n,t){this.$emit("sendCommand",{command:"addComponent",data:{deviceId:e,deviceType:n,type:t}})},removeComponentModal:function(e,n,t,o,i){i.stopPropagation(),this.modalComponent={deviceId:e,id:n,type:t},this.modalComponentName=o,this.showComponentRemoveModal=!0},removeComponent:function(e){this.showComponentRemoveModal=!1,"confirm"==e&&(console.info("request removal of component '"+this.modalComponent.id+"' from device '"+this.modalComponent.deviceId+"' type '"+this.modalComponent.type+"'"),this.$emit("sendCommand",{command:"removeComponent",data:this.modalComponent}))},getComponentList:function(e){if(void 0===e)return[];console.debug("finding components for '"+e+"'");var n=this.$store.state.mqtt["openWB/system/configurable/devices_components"].find((function(n){return n.value===e}));return n.component},updateConfiguration:function(e,n){console.debug("updateConfiguration",n),this.updateState(e,n.value,n.object)}}};const R=(0,S.Z)(A,[["render",b],["__scopeId","data-v-13f4ddee"]]);var K=R},9826:function(e,n,t){"use strict";var o=t(2109),i=t(2092).find,u=t(1223),a="find",r=!0;a in[]&&Array(1)[a]((function(){r=!1})),o({target:"Array",proto:!0,forced:r},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),u(a)},1107:function(e,n,t){var o={"./alpha_ess/bat.vue":[6631,6631],"./alpha_ess/counter.vue":[4314,4314],"./alpha_ess/device.vue":[2132,2132],"./alpha_ess/inverter.vue":[8601,8601],"./carlo_gavazzi/counter.vue":[2463,2463],"./carlo_gavazzi/device.vue":[269,269],"./fronius/bat.vue":[9154,9154],"./fronius/counter_s0.vue":[6177,6177],"./fronius/counter_sm.vue":[1944,1944],"./fronius/device.vue":[585,585],"./fronius/inverter.vue":[8039,8039],"./http/bat.vue":[2614,2614],"./http/counter.vue":[8102,8102],"./http/device.vue":[4038,4038],"./http/inverter.vue":[8490,857],"./huawei/bat.vue":[8297,8297],"./huawei/counter.vue":[8175,8175],"./huawei/device.vue":[968,968],"./huawei/inverter.vue":[9517,9517],"./janitza/counter.vue":[6662,6662],"./janitza/device.vue":[7204,7204],"./json/bat.vue":[496,496],"./json/counter.vue":[6274,6274],"./json/device.vue":[9285,9285],"./json/inverter.vue":[7539,7539],"./mqtt/bat.vue":[7280,7280],"./mqtt/counter.vue":[3795,3795],"./mqtt/device.vue":[1226,6191],"./mqtt/inverter.vue":[3899,3899],"./openwb_flex/bat.vue":[7780,7780],"./openwb_flex/counter.vue":[4738,4738],"./openwb_flex/device.vue":[4821,4821],"./openwb_flex/inverter.vue":[9504,9669],"./powerdog/counter.vue":[5909,5909],"./powerdog/device.vue":[8962,8962],"./powerdog/inverter.vue":[3885,3885],"./saxpower/bat.vue":[8568,8568],"./saxpower/device.vue":[8164,8164],"./siemens/bat.vue":[275,275],"./siemens/counter.vue":[6604,6604],"./siemens/device.vue":[9410,9410],"./siemens/inverter.vue":[1258,1258],"./sma_shm/counter.vue":[4962,4962],"./sma_shm/device.vue":[9170,9170],"./sma_shm/inverter.vue":[8347,8347],"./solax/bat.vue":[2184,8212],"./solax/counter.vue":[5517,5517],"./solax/device.vue":[3997,3997],"./solax/inverter.vue":[8128,4635],"./sonnenbatterie/bat.vue":[558,558],"./sonnenbatterie/counter.vue":[3420,3420],"./sonnenbatterie/device.vue":[7746,7746],"./sonnenbatterie/inverter.vue":[366,366],"./studer/bat.vue":[3826,3826],"./studer/device.vue":[5200,5200],"./studer/inverter.vue":[6940,1128]};function i(e){if(!t.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return t.e(n[1]).then((function(){return t(i)}))}i.keys=function(){return Object.keys(o)},i.id=1107,e.exports=i}}]);
//# sourceMappingURL=HardwareInstallation-legacy.149e356e.js.map