import{l as q,a9 as $,F as L}from"./vendor-fortawesome-9c5ed7ee.js";import{_ as k,C as j}from"./index-7116c4bc.js";import{_ as W}from"./dynamic-import-helper-be004503.js";import{_ as C,u as d,l as s,m as g,x as _,E as a,B as c,F as f,G as r,A as D,a1 as M,a2 as P,N as I,z as A,M as E}from"./vendor-253b919f.js";const U={props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration"],methods:{updateConfiguration(o,e=void 0){this.$emit("update:configuration",{value:o,object:e})}}},F=C(U,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigMixin.vue"]]),N={name:"OpenwbIoDeviceConfigFallback",mixins:[F]},G={class:"io-device-config-fallback"},R={key:1};function z(o,e,i,b,l,n){const p=d("openwb-base-alert"),m=d("openwb-base-textarea");return s(),g("div",G,[Object.keys(o.ioDevice.configuration).length==0?(s(),_(p,{key:0,subtype:"info"},{default:a(()=>[c(' Das I/O-Modul "'+f(o.ioDevice.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(s(),g("div",R,[r(p,{subtype:"warning"},{default:a(()=>[c(' Es wurde keine Konfigurationsseite für das I/O-Modul "'+f(o.ioDevice.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),r(m,{title:"Konfiguration",subtype:"json","model-value":o.ioDevice.configuration,"onUpdate:modelValue":e[0]||(e[0]=w=>o.updateConfiguration(w,"configuration"))},{help:a(()=>e[1]||(e[1]=[c(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ")])),_:1},8,["model-value"]),r(p,{subtype:"info"},{default:a(()=>[D("pre",null,f(JSON.stringify(o.ioDevice.configuration,void 0,2)),1)]),_:1})]))])}const J=C(N,[["render",z],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigFallback.vue"]]),H={name:"OpenwbIoDeviceProxy",props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){return console.debug(`loading io device: ${this.ioDevice.type}`),M({loader:()=>W(Object.assign({"./add_on/io_device.vue":()=>k(()=>import("./io_device-71b984c0.js"),["assets/io_device-71b984c0.js","assets/index-7116c4bc.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/vendor-fortawesome-9c5ed7ee.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"]),"./dimm_kit/io_device.vue":()=>k(()=>import("./io_device-a982a234.js"),["assets/io_device-a982a234.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/vendor-fortawesome-9c5ed7ee.js","assets/index-7116c4bc.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"])}),`./${this.ioDevice.type}/io_device.vue`),errorComponent:J})}},methods:{updateConfiguration(o){this.$emit("update:configuration",o)},sendCommand(o){this.$emit("sendCommand",o)}}};function Q(o,e,i,b,l,n){const p=d("openwb-base-heading");return s(),g(I,null,[r(p,null,{default:a(()=>[c(' Einstellungen für I/O-Modul "'+f(i.ioDevice.name)+'" ',1)]),_:1}),(s(),_(P(n.myComponent),{"io-device":i.ioDevice,"onUpdate:configuration":e[0]||(e[0]=m=>n.updateConfiguration(m)),onSendCommand:e[1]||(e[1]=m=>n.sendCommand(m))},null,40,["io-device"]))],64)}const X=C(H,[["render",Q],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceProxy.vue"]]),Y={mixins:[j],props:{ioAction:{type:Object,required:!0},ioDevice:{type:Object,required:!0},availableChargePoints:{type:Array,required:!1,default:()=>[]},availableComponents:{type:Array,required:!1,default:()=>[]},availableIoDevices:{type:Array,required:!1,default:()=>[]}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(o,e=void 0){this.$emit("update:configuration",{value:o,object:e})}}},Z=C(Y,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigMixin.vue"]]),K={name:"OpenwbIoActionConfigFallback",mixins:[Z]},ee={class:"io-action-config-fallback"},oe={key:1};function te(o,e,i,b,l,n){var w,h;const p=d("openwb-base-alert"),m=d("openwb-base-textarea");return s(),g("div",ee,[Object.keys((w=o.ioAction)==null?void 0:w.configuration).length==0?(s(),_(p,{key:0,subtype:"info"},{default:a(()=>{var u;return[c(' Die I/O-Aktion "'+f((u=o.ioAction)==null?void 0:u.name)+'" bietet keine Einstellungen. ',1)]}),_:1})):(s(),g("div",oe,[r(p,{subtype:"warning"},{default:a(()=>{var u;return[c(' Es wurde keine Konfigurationsseite für die I/O-Aktion "'+f((u=o.ioAction)==null?void 0:u.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]}),_:1}),r(m,{title:"Konfiguration",subtype:"json","model-value":(h=o.ioAction)==null?void 0:h.configuration,"onUpdate:modelValue":e[0]||(e[0]=u=>o.updateConfiguration(u,"configuration"))},{help:a(()=>e[1]||(e[1]=[c(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ")])),_:1},8,["model-value"]),r(p,{subtype:"info"},{default:a(()=>{var u;return[D("pre",null,f(JSON.stringify((u=o.ioAction)==null?void 0:u.configuration,void 0,2)),1)]}),_:1})]))])}const ne=C(K,[["render",te],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigFallback.vue"]]),ie={name:"OpenwbIoActionProxy",props:{ioAction:{type:Object,required:!0},ioDevices:{type:Object,required:!0},installedChargePoints:{type:Object,required:!0},installedComponents:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){var o,e;return console.debug(`loading io action: ${(o=this.ioAction)==null?void 0:o.group} / ${(e=this.ioAction)==null?void 0:e.type}`),M({loader:()=>{var i,b;return W(Object.assign({"./controllable_consumers/dimming/io_action.vue":()=>k(()=>import("./io_action-efc68cfe.js"),["assets/io_action-efc68cfe.js","assets/OpenwbIoSinglePattern-f7c4bc3e.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/OpenwbIoSinglePattern-e689840a.css","assets/vendor-fortawesome-9c5ed7ee.js","assets/index-7116c4bc.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"]),"./controllable_consumers/dimming_direct_control/io_action.vue":()=>k(()=>import("./io_action-7bf4a7b2.js"),["assets/io_action-7bf4a7b2.js","assets/OpenwbIoSinglePattern-f7c4bc3e.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/OpenwbIoSinglePattern-e689840a.css","assets/vendor-fortawesome-9c5ed7ee.js","assets/index-7116c4bc.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"]),"./controllable_consumers/ripple_control_receiver/io_action.vue":()=>k(()=>import("./io_action-aa50b28f.js"),["assets/io_action-aa50b28f.js","assets/OpenwbIoPattern-9f91aea0.js","assets/vendor-fortawesome-9c5ed7ee.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/OpenwbIoPattern-a1d251cc.css","assets/index-7116c4bc.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"]),"./generator_systems/power_levels/io_action.vue":()=>k(()=>import("./io_action-f9bdb818.js"),["assets/io_action-f9bdb818.js","assets/OpenwbIoPattern-9f91aea0.js","assets/vendor-fortawesome-9c5ed7ee.js","assets/vendor-253b919f.js","assets/vendor-sortablejs-15c4534f.js","assets/vendor-3a7c342f.css","assets/OpenwbIoPattern-a1d251cc.css","assets/index-7116c4bc.js","assets/vendor-bootstrap-41f992c3.js","assets/vendor-jquery-e288bc43.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-403a452d.js","assets/index-27ba6225.css","assets/dynamic-import-helper-be004503.js"])}),`./${(i=this.ioAction)==null?void 0:i.group}/${(b=this.ioAction)==null?void 0:b.type}/io_action.vue`)},errorComponent:ne})},ioDeviceList(){return Object.keys(this.ioDevices).map(o=>{var e,i;return{value:(e=this.ioDevices[o])==null?void 0:e.id,text:(i=this.ioDevices[o])==null?void 0:i.name}})},availableIoDevices(){return Object.values(this.ioDevices)},availableChargePoints(){return Object.values(this.installedChargePoints).map(o=>({value:o==null?void 0:o.id,text:o==null?void 0:o.name}))},availableComponents(){return Object.values(this.installedComponents).map(o=>({value:o==null?void 0:o.id,text:o==null?void 0:o.name,type:o==null?void 0:o.type}))}},methods:{updateConfiguration(o,e=void 0){e?this.$emit("update:configuration",{value:o,object:e}):this.$emit("update:configuration",o)},updateIoDevice(o){var e;if(this.updateConfiguration(o,"configuration.io_device"),Array.isArray((e=this.ioAction.configuration)==null?void 0:e.input_pattern)){let i=this.ioAction.configuration.input_pattern.map(b=>({value:b.value,input_matrix:{}}));this.updateConfiguration(i,"configuration.input_pattern")}Object.prototype.hasOwnProperty.call(this.ioAction.configuration,"digital_input")&&this.updateConfiguration(null,"configuration.digital_input")}}},ae={key:0};function se(o,e,i,b,l,n){var w,h;const p=d("openwb-base-heading"),m=d("openwb-base-select-input");return s(),g(I,null,[r(p,null,{default:a(()=>{var u;return[c(' Einstellungen für I/O-Aktion "'+f((u=i.ioAction)==null?void 0:u.name)+'" ',1)]}),_:1}),r(m,{title:"Eingangs-Gerät","not-selected":"Bitte auswählen","empty-value":null,required:"",options:n.ioDeviceList,"model-value":(w=i.ioAction)==null?void 0:w.configuration.io_device,"onUpdate:modelValue":e[0]||(e[0]=u=>n.updateIoDevice(u))},{help:a(()=>e[2]||(e[2]=[c(" Bitte das Gerät auswählen, über das der Schaltbefehl empfangen werden soll. Für jede Aktion kann nur ein Gerät ausgewählt werden. ")])),_:1},8,["options","model-value"]),((h=i.ioAction)==null?void 0:h.configuration.io_device)!==null?(s(),g("div",ae,[e[3]||(e[3]=D("hr",null,null,-1)),(s(),_(P(n.myComponent),{"io-action":i.ioAction,"io-device":i.ioDevices[`openWB/system/io/${i.ioAction.configuration.io_device}/config`],"available-charge-points":n.availableChargePoints,"available-components":n.availableComponents,"available-io-devices":n.availableIoDevices,"onUpdate:configuration":e[1]||(e[1]=u=>n.updateConfiguration(u))},null,40,["io-action","io-device","available-charge-points","available-components","available-io-devices"]))])):A("",!0)],64)}const re=C(ie,[["render",se],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionProxy.vue"]]);q.add($);const ue={name:"OpenwbIoConfigView",components:{FontAwesomeIcon:L,OpenwbIoDeviceProxy:X,OpenwbIoActionProxy:re},mixins:[j],props:{installAssistantActive:{type:Boolean,required:!1,default:!1}},emits:["save","reset","defaults","send-command"],data(){return{mqttTopicsToSubscribe:["openWB/system/configurable/io_devices","openWB/system/io/+/config","openWB/system/configurable/io_actions","openWB/io/action/+/config","openWB/chargepoint/+/config","openWB/system/device/+/component/+/config"],showIoDeviceDeleteModal:!1,modalIoDeviceIndex:void 0,ioDeviceToAdd:void 0,showIoActionDeleteModal:!1,modalIoActionIndex:void 0,ioActionToAdd:void 0}},computed:{ioDeviceList:{get(){return this.$store.state.mqtt["openWB/system/configurable/io_devices"]}},installedIoDevices:{get(){return this.getWildcardTopics("openWB/system/io/+/config")}},ioActionList:{get(){return this.$store.state.mqtt["openWB/system/configurable/io_actions"]===void 0?[]:Object.entries(this.$store.state.mqtt["openWB/system/configurable/io_actions"]).map(([o,e])=>({label:e.group_name,options:e.actions.map(i=>({value:[o,i.value],text:i.text})).sort((i,b)=>i.text.localeCompare(b.text))})).sort((o,e)=>o.label.localeCompare(e.label))}},installedIoActions:{get(){return this.getWildcardTopics("openWB/io/action/+/config")}},installedChargePoints:{get(){return this.getWildcardTopics("openWB/chargepoint/+/config")}},installedComponents:{get(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")}}},methods:{getIoDeviceName(o){return this.$store.state.mqtt["openWB/system/io/"+o+"/config"]?this.$store.state.mqtt["openWB/system/io/"+o+"/config"].name:"I/O-Gerät "+o},addIoDevice(){this.$emit("send-command",{command:"addIoDevice",data:{type:this.ioDeviceToAdd}})},removeIoDeviceModal(o,e){e.stopPropagation(),this.modalIoDeviceIndex=parseInt(o.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoDeviceDeleteModal=!0},removeIoDevice(o,e){this.showIoDeviceDeleteModal=!1,e=="confirm"&&this.$emit("send-command",{command:"removeIoDevice",data:{id:o}})},addIoAction(){this.$emit("send-command",{command:"addIoAction",data:{type:this.ioActionToAdd}})},removeIoActionModal(o,e){e.stopPropagation(),this.modalIoActionIndex=parseInt(o.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoActionDeleteModal=!0},removeIoAction(o,e){this.showIoActionDeleteModal=!1,e=="confirm"&&this.$emit("send-command",{command:"removeIoAction",data:{id:o}})},updateConfiguration(o,e){console.debug("updateConfiguration",o,e),this.updateState(o,e.value,e.object)}}},de={class:"ioConfig"},le={name:"ioConfigForm"},ce={key:0},pe={key:0};function me(o,e,i,b,l,n){const p=d("openwb-base-modal-dialog"),m=d("font-awesome-icon"),w=d("openwb-base-avatar"),h=d("openwb-base-text-input"),u=d("openwb-io-device-proxy"),O=d("openwb-base-card"),B=d("openwb-base-select-input"),V=d("openwb-io-action-proxy"),T=d("openwb-base-alert"),S=d("openwb-base-submit-buttons");return s(),g(I,null,[r(p,{show:l.showIoDeviceDeleteModal,title:"Modul löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[0]||(e[0]=t=>n.removeIoDevice(l.modalIoDeviceIndex,t))},{default:a(()=>[c(' Wollen Sie das Ein-/Ausgangs-Gerät "'+f(n.getIoDeviceName(l.modalIoDeviceIndex))+'" (ID: '+f(l.modalIoDeviceIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),r(p,{show:l.showIoActionDeleteModal,title:"Aktion löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[1]||(e[1]=t=>n.removeIoAction(l.modalIoActionIndex,t))},{default:a(()=>[c(' Wollen Sie die Aktion "'+f(n.getIoDeviceName(l.modalIoActionIndex))+'" (ID: '+f(l.modalIoActionIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),D("div",de,[D("form",le,[r(O,{title:"Ein-/Ausgangs-Geräte"},{default:a(()=>[(s(!0),g(I,null,E(n.installedIoDevices,(t,y)=>(s(),_(O,{key:y,title:(t==null?void 0:t.name)+" (ID: "+(t==null?void 0:t.id)+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:a(v=>[v.collapsed?A("",!0):(s(),_(w,{key:0,class:"bg-danger clickable",onClick:x=>n.removeIoDeviceModal(y,x)},{default:a(()=>[r(m,{"fixed-width":"",icon:["fas","trash"]})]),_:2},1032,["onClick"]))]),default:a(()=>[r(h,{title:"Bezeichnung",subtype:"text","model-value":t.name,"onUpdate:modelValue":v=>o.updateState(y,v,"name")},null,8,["model-value","onUpdate:modelValue"]),r(h,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":o.$store.state.mqtt[y].type},null,8,["model-value"]),e[7]||(e[7]=D("hr",null,null,-1)),r(u,{"io-device":t,"onUpdate:configuration":v=>n.updateConfiguration(y,v)},null,8,["io-device","onUpdate:configuration"])]),_:2},1032,["title"]))),128)),Object.keys(n.installedIoDevices).length>0?(s(),g("hr",ce)):A("",!0),r(B,{title:"Verfügbare Geräte","not-selected":"Bitte auswählen",options:n.ioDeviceList,"model-value":l.ioDeviceToAdd,"add-button":!0,"onUpdate:modelValue":e[2]||(e[2]=t=>l.ioDeviceToAdd=t),"onInput:add":n.addIoDevice},{help:a(()=>e[8]||(e[8]=[c(" Bitte ein Ein-/Ausgangs-Modul auswählen, das hinzugefügt werden soll. ")])),_:1},8,["options","model-value","onInput:add"])]),_:1}),r(O,{title:"Ein-/Ausgangs-Aktionen"},{default:a(()=>[(s(!0),g(I,null,E(n.installedIoActions,(t,y)=>(s(),_(O,{key:y,title:(t==null?void 0:t.name)+" (ID: "+(t==null?void 0:t.id)+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:a(v=>[v.collapsed?A("",!0):(s(),_(w,{key:0,class:"bg-danger clickable",onClick:x=>n.removeIoActionModal(y,x)},{default:a(()=>[r(m,{"fixed-width":"",icon:["fas","trash"]})]),_:2},1032,["onClick"]))]),default:a(()=>[r(h,{title:"Bezeichnung",subtype:"text","model-value":t==null?void 0:t.name,"onUpdate:modelValue":v=>o.updateState(y,v,"name")},null,8,["model-value","onUpdate:modelValue"]),r(h,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":[t==null?void 0:t.group,t==null?void 0:t.type].join(" / ")},null,8,["model-value"]),e[9]||(e[9]=D("hr",null,null,-1)),t!==void 0?(s(),_(V,{key:0,"io-action":t,"io-devices":n.installedIoDevices,"installed-charge-points":n.installedChargePoints,"installed-components":n.installedComponents,"onUpdate:configuration":v=>n.updateConfiguration(y,v)},null,8,["io-action","io-devices","installed-charge-points","installed-components","onUpdate:configuration"])):A("",!0)]),_:2},1032,["title"]))),128)),Object.keys(n.installedIoActions).length>0?(s(),g("hr",pe)):A("",!0),Object.keys(n.installedIoDevices).length>0?(s(),_(B,{key:1,title:"Verfügbare Aktionen","not-selected":"Bitte auswählen",groups:n.ioActionList,"model-value":l.ioActionToAdd,"add-button":!0,"onUpdate:modelValue":e[3]||(e[3]=t=>l.ioActionToAdd=t),"onInput:add":n.addIoAction},{help:a(()=>e[10]||(e[10]=[c(" Bitte eine Ein-/Ausgangs-Aktion auswählen, die hinzugefügt werden soll. ")])),_:1},8,["groups","model-value","onInput:add"])):(s(),_(T,{key:2,subtype:"warning"},{default:a(()=>e[11]||(e[11]=[c(" Keine Ein-/Ausgangs-Geräte vorhanden!"),D("br",null,null,-1),c(" Bitte fügen Sie zuerst ein Ein-/Ausgangs-Gerät hinzu, bevor Sie Aktionen konfigurieren. ")])),_:1}))]),_:1}),r(S,{"form-name":"ioConfigForm",onSave:e[4]||(e[4]=t=>o.$emit("save")),onReset:e[5]||(e[5]=t=>o.$emit("reset")),onDefaults:e[6]||(e[6]=t=>o.$emit("defaults"))})])])],64)}const ge=C(ue,[["render",me],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/IoConfig.vue"]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{we as I,F as O,Z as a};
