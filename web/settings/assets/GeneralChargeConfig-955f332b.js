import{_ as g,C as T}from"./index-1588343c.js";import{_ as E}from"./dynamic-import-helper-be004503.js";import{_ as h,q as o,k as s,l as p,B as i,M as a,x as r,y as _,u as c,a1 as $,z as k,a2 as V,I as P,A as W}from"./vendor-b3afda6d.js";import"./vendor-fortawesome-d651dd92.js";import"./vendor-bootstrap-37731caa.js";import"./vendor-jquery-2371184a.js";import"./vendor-axios-dc7988e3.js";import"./vendor-sortablejs-806a0b5c.js";const L={name:"ElectricityTariffConfigFallback",emits:["update:configuration"],props:{electricityTariff:{type:Object,required:!0}},methods:{updateConfiguration(e,t=void 0){this.$emit("update:configuration",{value:e,object:t})}}},A={class:"backup-cloud-fallback"};function O(e,t,l,v,y,d){const u=o("openwb-base-alert"),f=o("openwb-base-textarea");return s(),p("div",A,[i(u,{subtype:"warning"},{default:a(()=>[r(' Es wurde keine Konfigurationsseite für den Anbieter "'+_(l.electricityTariff.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),i(f,{title:"Konfiguration",subtype:"json","model-value":l.electricityTariff.configuration,"onUpdate:modelValue":t[0]||(t[0]=m=>d.updateConfiguration(m,"configuration"))},{help:a(()=>[r(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ")]),_:1},8,["model-value"]),i(u,{subtype:"info"},{default:a(()=>[c("pre",null,_(JSON.stringify(l.electricityTariff.configuration,void 0,2)),1)]),_:1})])}const q=h(L,[["render",O],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/OpenwbElectricityTariffConfigFallback.vue"]]),U={name:"OpenwbElectricityTariffProxy",emits:["update:configuration"],props:{electricityTariff:{type:Object,required:!0}},computed:{myComponent(){return console.debug(`loading electricity tariff cloud: ${this.electricityTariff.type}`),$({loader:()=>E(Object.assign({"./awattar/electricity_tariff.vue":()=>g(()=>import("./electricity_tariff-440299b5.js"),["assets/electricity_tariff-440299b5.js","assets/vendor-b3afda6d.js","assets/vendor-sortablejs-806a0b5c.js","assets/vendor-aab9f734.css"]),"./energycharts/electricity_tariff.vue":()=>g(()=>import("./electricity_tariff-317cf88b.js"),["assets/electricity_tariff-317cf88b.js","assets/index-1588343c.js","assets/vendor-b3afda6d.js","assets/vendor-sortablejs-806a0b5c.js","assets/vendor-aab9f734.css","assets/vendor-fortawesome-d651dd92.js","assets/vendor-bootstrap-37731caa.js","assets/vendor-jquery-2371184a.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-dc7988e3.js","assets/index-b3227821.css"]),"./rabot/electricity_tariff.vue":()=>g(()=>import("./electricity_tariff-7a249832.js"),["assets/electricity_tariff-7a249832.js","assets/vendor-b3afda6d.js","assets/vendor-sortablejs-806a0b5c.js","assets/vendor-aab9f734.css"]),"./tibber/electricity_tariff.vue":()=>g(()=>import("./electricity_tariff-ff5ad3ad.js"),["assets/electricity_tariff-ff5ad3ad.js","assets/vendor-b3afda6d.js","assets/vendor-sortablejs-806a0b5c.js","assets/vendor-aab9f734.css"]),"./voltego/electricity_tariff.vue":()=>g(()=>import("./electricity_tariff-2f2bda3c.js"),["assets/electricity_tariff-2f2bda3c.js","assets/vendor-b3afda6d.js","assets/vendor-sortablejs-806a0b5c.js","assets/vendor-aab9f734.css"])}),`./${this.electricityTariff.type}/electricity_tariff.vue`),errorComponent:q})}},methods:{updateConfiguration(e){this.$emit("update:configuration",e)}}};function F(e,t,l,v,y,d){const u=o("openwb-base-heading");return s(),p(P,null,[i(u,null,{default:a(()=>[r(' Einstellungen für Modul "'+_(l.electricityTariff.name)+'" ',1)]),_:1}),(s(),k(V(d.myComponent),{electricityTariff:l.electricityTariff,"onUpdate:configuration":t[0]||(t[0]=f=>d.updateConfiguration(f))},null,40,["electricityTariff"]))],64)}const D=h(U,[["render",F],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/OpenwbElectricityTariffProxy.vue"]]),N={name:"OpenwbGeneralChargeConfig",mixins:[T],components:{OpenwbElectricityTariffProxy:D},data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/general/chargemode_config/phase_switch_delay","openWB/general/chargemode_config/retry_failed_phase_switches","openWB/general/chargemode_config/unbalanced_load","openWB/general/chargemode_config/unbalanced_load_limit","openWB/general/prices/bat","openWB/general/prices/grid","openWB/general/prices/pv","openWB/optional/et/provider","openWB/system/configurable/electricity_tariffs"]}},computed:{electricityTariffList(){return this.$store.state.mqtt["openWB/system/configurable/electricity_tariffs"]}},methods:{getElectricityTariffDefaultConfiguration(e){const t=this.electricityTariffList.find(l=>l.value==e);return Object.prototype.hasOwnProperty.call(t,"defaults")?{...t.defaults}:(console.warn("no default configuration found for electricity tariff type!",e),{})},updateSelectedElectricityTariff(e){this.updateState("openWB/optional/et/provider",e,"type"),this.updateState("openWB/optional/et/provider",this.getElectricityTariffDefaultConfiguration(e))},updateConfiguration(e,t){console.debug("updateConfiguration",e,t),this.updateState(e,t.value,t.object)}}},I={class:"generalChargeConfig"},M={name:"generalChargeConfigForm"},x={key:0},R={key:1},Z=c("br",null,null,-1),j=c("br",null,null,-1),G=c("hr",null,null,-1),J=c("br",null,null,-1),K={key:0},H={key:1},Q=c("br",null,null,-1),X={key:0};function Y(e,t,l,v,y,d){const u=o("openwb-base-alert"),f=o("openwb-base-button-group-input"),m=o("openwb-base-range-input"),w=o("openwb-base-heading"),b=o("openwb-base-number-input"),B=o("openwb-base-card"),S=o("openwb-base-select-input"),z=o("openwb-electricity-tariff-proxy"),C=o("openwb-base-submit-buttons");return s(),p("div",I,[c("form",M,[i(B,{title:"Allgemein"},{default:a(()=>[e.$store.state.mqtt["openWB/general/extern"]===!0?(s(),p("div",x,[i(u,{subtype:"info"},{default:a(()=>[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ')]),_:1})])):(s(),p("div",R,[i(f,{title:"Begrenzung der Schieflast",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":e.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load"],"onUpdate:modelValue":t[0]||(t[0]=n=>e.updateState("openWB/general/chargemode_config/unbalanced_load",n))},{help:a(()=>[r(" Wenn diese Option aktiviert ist, werden nicht-dreiphasige Ladevorgänge so geregelt, dass am Netzanschlusspunkt (EVU-Zähler) die eingestellte Grenze für die Schieflast nicht überschritten wird. Hierfür muss der EVU-Zähler einzelne Phasenströme bereitstellen!"),Z,r(' Weiterhin müssen bei den Ladepunkten sowie Fahrzeugen sämtliche Angaben zur Anzahl angeschlossener/unterstützter Phasen und der Phasenrotation hinterlegt werden, damit der Regelung bekannt ist, welcher Ladevorgang welche Phase am Netzanschluss beeinflusst. siehe "Konfiguration - Ladepunkte -> elektrischer Anschluss - Phase 1" und "Konfiguration - Fahrzeuge -> Fahrzeug-Profile" ')]),_:1},8,["model-value"]),e.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load"]?(s(),k(m,{key:0,title:"Erlaubte Schieflast",min:10,max:32,step:1,unit:"A","model-value":e.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load_limit"],"onUpdate:modelValue":t[1]||(t[1]=n=>e.updateState("openWB/general/chargemode_config/unbalanced_load_limit",n))},{help:a(()=>[r(" Hiermit wird festgelegt, welche Schieflast am Netzanschlusspunkt erlaubt ist. Bei Überschreitung werden gezielt einzelne Ladevorgänge in der Leistung begrenzt. ")]),_:1},8,["model-value"])):W("",!0),i(f,{title:"Phasenumschaltung wiederholt anstoßen",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":e.$store.state.mqtt["openWB/general/chargemode_config/retry_failed_phase_switches"],"onUpdate:modelValue":t[2]||(t[2]=n=>e.updateState("openWB/general/chargemode_config/retry_failed_phase_switches",n))},{help:a(()=>[r(" Wenn diese Option aktiviert ist, werden bis zu drei Umschaltversuche vorgenommen, wenn die vorgegebene und genutzte Phasenzahl nicht übereinstimmen. Wird die Option deaktiviert, wird nur eine Umschaltung durchgeführt."),j,r(" Die gezählten Fehlversuche werden mit dem Abstecken zurückgesetzt. ")]),_:1},8,["model-value"]),i(m,{title:"Verzögerung automat. Phasenumschaltung",min:1,max:15,step:1,unit:"Min.","model-value":e.$store.state.mqtt["openWB/general/chargemode_config/phase_switch_delay"],"onUpdate:modelValue":t[3]||(t[3]=n=>e.updateState("openWB/general/chargemode_config/phase_switch_delay",n))},{help:a(()=>[r(" Um zu viele Umschaltungen zu vermeiden, wird Anhand dieses Wertes definiert, wann die Umschaltung erfolgen soll. Ist für durchgehend x Minuten die Maximalstromstärke erreicht, wird auf mehrphasige Ladung umgestellt. Ist die Ladung nur für ein Intervall unterhalb der Maximalstromstärke, beginnt das Intervall für die Umschaltung erneut. Ist die Ladung im mehrphasigen Modus für 16 - x Minuten auf der Minimalstromstärke, wird wieder auf einphasige Ladung gewechselt. ")]),_:1},8,["model-value"]),G,i(w,null,{help:a(()=>[r(" Zur Berechnung der Ladekosten im Lade-Log werden stundenweise die Anteile der Stromquellen (Speicher, Netz, PV) berechnet und mit den hier angegebenen Preisen multipliziert."),J,r(" Ist die Abrechnung über das Ladeprotokoll, z.B. mit dem Arbeitgeber, vereinbart, ist bei allen drei Feldern der vereinbarte Preis einzutragen. ")]),default:a(()=>[r(" Berechnung der Ladekosten ")]),_:1}),i(b,{title:"Preis für Netzbezug",step:.001,precision:3,unit:"ct/kWh","model-value":e.$store.state.mqtt["openWB/general/prices/grid"]*1e5,"onUpdate:modelValue":t[4]||(t[4]=n=>e.updateState("openWB/general/prices/grid",parseFloat((n/1e5).toFixed(7))))},{help:a(()=>[r(" Ist ein Anbieter für variable Stromtarife konfiguriert, wird statt des hier angegebenen Netzpreises der dynamische Strompreis des Anbieters verwendet (stündliche Aktualisierung durch den Anbieter). ")]),_:1},8,["model-value"]),i(b,{title:"Preis für Speicherentladung",step:.001,precision:3,unit:"ct/kWh","model-value":e.$store.state.mqtt["openWB/general/prices/bat"]*1e5,"onUpdate:modelValue":t[5]||(t[5]=n=>e.updateState("openWB/general/prices/bat",parseFloat((n/1e5).toFixed(7))))},null,8,["model-value"]),i(b,{title:"Preis für PV-Strom",step:.001,precision:3,unit:"ct/kWh","model-value":e.$store.state.mqtt["openWB/general/prices/pv"]*1e5,"onUpdate:modelValue":t[6]||(t[6]=n=>e.updateState("openWB/general/prices/pv",parseFloat((n/1e5).toFixed(7))))},null,8,["model-value"])]))]),_:1}),i(B,{title:"Optional"},{default:a(()=>[e.$store.state.mqtt["openWB/general/extern"]===!0?(s(),p("div",K,[i(u,{subtype:"info"},{default:a(()=>[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ')]),_:1})])):(s(),p("div",H,[i(w,null,{default:a(()=>[r(" Variable Stromtarife ")]),_:1}),i(u,{subtype:"info"},{default:a(()=>[r(" Bei Sofort- und Zeitladen wird nur geladen, wenn der Strompreis unter dem maximalen angegeben Strompreis liegt. Für Zielladen wird die Ladedauer ermittelt und dann zu den günstigsten Stunden geladen."),Q,r(" Wenn keine Preise abgefragt werden können, wird bei Sofort- und Zeitladen immer geladen und bei Zielladen zunächst mit PV-Überschuss und zum Erreichen des Zieltermins mit Netzstrom. ")]),_:1}),i(S,{class:"mb-2",title:"Anbieter",options:d.electricityTariffList,"model-value":e.$store.state.mqtt["openWB/optional/et/provider"]?e.$store.state.mqtt["openWB/optional/et/provider"].type:"","onUpdate:modelValue":t[7]||(t[7]=n=>d.updateSelectedElectricityTariff(n))},null,8,["options","model-value"]),e.$store.state.mqtt["openWB/optional/et/provider"]&&e.$store.state.mqtt["openWB/optional/et/provider"].type?(s(),p("div",X,[i(z,{electricityTariff:e.$store.state.mqtt["openWB/optional/et/provider"],"onUpdate:configuration":t[8]||(t[8]=n=>d.updateConfiguration("openWB/optional/et/provider",n))},null,8,["electricityTariff"])])):W("",!0)]))]),_:1}),i(C,{formName:"generalChargeConfigForm",onSave:t[9]||(t[9]=n=>e.$emit("save")),onReset:t[10]||(t[10]=n=>e.$emit("reset")),onDefaults:t[11]||(t[11]=n=>e.$emit("defaults"))})])])}const le=h(N,[["render",Y],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/GeneralChargeConfig.vue"]]);export{le as default};
