import{C as W}from"./index-UZ-qidAy.js";import{F as k,l as z,a2 as y,ae as V,af as q}from"./vendor-fortawesome-DunXjMUr.js";import{_ as C,m as g,l as o,f as s,y as m,q as i,u as n,D as a,x as d,z as h,E as w}from"./vendor-Cm2BcoGA.js";import"./vendor-bootstrap-CFWPZPj5.js";import"./vendor-jquery-CEMonh9Y.js";import"./vendor-axios-DnM0A367.js";import"./vendor-sortablejs-BIKIFH7x.js";z.add(y,V,q);const $={name:"OpenwbPVChargeConfigView",components:{FontAwesomeIcon:k},mixins:[W],emits:["save","reset","defaults"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/general/chargemode_config/pv_charging/bat_mode","openWB/general/chargemode_config/pv_charging/bat_power_reserve","openWB/general/chargemode_config/pv_charging/bat_power_reserve_active","openWB/general/chargemode_config/pv_charging/bat_power_discharge","openWB/general/chargemode_config/pv_charging/bat_power_discharge_active","openWB/general/chargemode_config/pv_charging/min_bat_soc","openWB/general/chargemode_config/pv_charging/max_bat_soc","openWB/bat/config/bat_control_permitted","openWB/bat/get/power_limit_controllable","openWB/bat/config/power_limit_mode"],mqttTopicsToPublish:["openWB/general/chargemode_config/pv_charging/bat_mode","openWB/general/chargemode_config/pv_charging/min_bat_soc","openWB/general/chargemode_config/pv_charging/max_bat_soc","openWB/general/chargemode_config/pv_charging/bat_power_reserve","openWB/general/chargemode_config/pv_charging/bat_power_reserve_active","openWB/general/chargemode_config/pv_charging/bat_power_discharge","openWB/general/chargemode_config/pv_charging/bat_power_discharge_active","openWB/bat/config/bat_control_permitted","openWB/bat/config/power_limit_mode"]}},computed:{batMode:{get(){return this.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_mode"]},set(t){this.updateState("openWB/general/chargemode_config/pv_charging/bat_mode",t)}}}},E={class:"batteryConfig"},M={name:"batteryConfigForm"},F={key:0},D={key:1},N={key:0},L={key:1},U={key:2},A={key:0},P={key:0},H={key:1},T={key:0},I={key:0},R={key:0},G={key:1},J={key:2},O={key:1};function x(t,e,K,j,S,u){const l=g("openwb-base-alert"),b=g("font-awesome-icon"),p=g("openwb-base-button-group-input"),c=g("openwb-base-range-input"),_=g("openwb-base-heading"),f=g("openwb-base-number-input"),v=g("openwb-base-card"),B=g("openwb-base-submit-buttons");return o(),s("div",E,[m("form",M,[i(v,{title:"Passive Speicherbeachtung (PV)"},{default:n(()=>[t.$store.state.mqtt["openWB/general/extern"]===!0?(o(),s("div",F,[i(l,{subtype:"info"},{default:n(()=>[...e[12]||(e[12]=[a(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ',-1)])]),_:1})])):(o(),s("div",D,[i(l,{subtype:"info"},{default:n(()=>[...e[13]||(e[13]=[a(' Die Regelmodi der Speicherbeachtung erfolgen "passiv" durch Anpassung der Fahrzeug-Ladeleistung. PV-Überschuss wird, je nach Konfiguration, entweder dem Fahrzeug zugeteilt oder dem Speicher überlassen. Netz- und Speicherbezug wird, sofern nicht anders konfiguriert, vermieden. ',-1)])]),_:1}),i(p,{modelValue:u.batMode,"onUpdate:modelValue":e[0]||(e[0]=r=>u.batMode=r),title:"Ladepriorität",buttons:[{buttonValue:"ev_mode"},{buttonValue:"bat_mode"},{buttonValue:"min_soc_bat_mode"}]},{"label-ev_mode":n(()=>[i(b,{"fixed-width":"",icon:["fas","car-side"]}),e[14]||(e[14]=a(" Fahrzeuge ",-1))]),"label-bat_mode":n(()=>[i(b,{"fixed-width":"",icon:["fas","fa-car-battery"]}),e[15]||(e[15]=a(" Speicher ",-1))]),"label-min_soc_bat_mode":n(()=>[i(b,{"fixed-width":"",icon:["fas","fa-battery-half"]}),e[16]||(e[16]=a(" Nach SoC des Speichers ",-1))]),help:n(()=>[u.batMode==="ev_mode"?(o(),s("div",N," Der gesamte Überschuss wird in das EV geladen. Wird mehr Überschuss erzeugt als die Fahrzeuge abnehmen, findet auch eine Speicherladung statt. ")):d("",!0),u.batMode==="bat_mode"?(o(),s("div",L," Der gesamte Überschuss wird in den Speicher geladen. Ist die maximale Ladeleistung des Speichers erreicht und es wird eingespeist, wird dieser Überschuss unter Beachtung der Einschaltschwelle in die Fahrzeuge geladen. ")):d("",!0),u.batMode==="min_soc_bat_mode"?(o(),s("div",U,' Verhält sich bis zum Erreichen des Mindest-SoC wie "Ladepriorität Speicher" und oberhalb des Mindest-SoC wie "Ladepriorität Fahrzeuge". Die maximale Leistung der Speicherbe- und entladung lässt sich hier festlegen. ')):d("",!0)]),_:1},8,["modelValue"]),u.batMode==="min_soc_bat_mode"?(o(),s("div",A,[i(c,{title:"Mindest-SoC des Speichers",min:0,max:100,step:1,unit:"%",required:"","model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/min_bat_soc"],"onUpdate:modelValue":e[1]||(e[1]=r=>(t.updateState("openWB/general/chargemode_config/pv_charging/min_bat_soc",r),t.updateState("openWB/general/chargemode_config/pv_charging/max_bat_soc",t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/min_bat_soc"]<t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/max_bat_soc"]?t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/max_bat_soc"]:r)))},{help:n(()=>[...e[17]||(e[17]=[a(" Unterhalb des Mindest-SoC wird vorhandener PV-Überschuss bevorzugt in den Speicher geladen. Oberhalb des Mindest-SoC hat die Fahrzeugladung Priorität. ",-1)])]),_:1},8,["model-value"]),i(c,{title:"Maximal-SoC des Speichers",min:0,max:100,step:1,unit:"%",required:"","model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/max_bat_soc"],"onUpdate:modelValue":e[2]||(e[2]=r=>(t.updateState("openWB/general/chargemode_config/pv_charging/max_bat_soc",r),t.updateState("openWB/general/chargemode_config/pv_charging/min_bat_soc",t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/max_bat_soc"]>t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/min_bat_soc"]?t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/min_bat_soc"]:r)))},{help:n(()=>[...e[18]||(e[18]=[a(" Wird der Maximal-SoC überschritten, darf der Speicher bis zum Erreichen des Mindest-SoC zur Fahrzeugladung mitbenutzt werden. ",-1)])]),_:1},8,["model-value"]),t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/min_bat_soc"]==t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/max_bat_soc"]?(o(),h(l,{key:0,subtype:"info"},{default:n(()=>[...e[19]||(e[19]=[a(" Bei identischen SoC Angaben findet keine Speicherhysterese statt. ",-1)])]),_:1})):d("",!0),i(_,null,{default:n(()=>[...e[20]||(e[20]=[a(" Speicher-Ladeleistung unterhalb Mindest-SoC ",-1)])]),_:1}),i(p,{title:"Nur eine bestimmte Ladeleistung reservieren",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_reserve_active"],"onUpdate:modelValue":e[3]||(e[3]=r=>t.updateState("openWB/general/chargemode_config/pv_charging/bat_power_reserve_active",r))},w({_:2},[t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_reserve_active"]?{name:"help",fn:n(()=>[e[21]||(e[21]=a(" ACHTUNG: Der hier eingestellte Wert darf die maximale Ladeleistung des Speichers nicht überschreiten!",-1)),e[22]||(e[22]=m("br",null,null,-1)),e[23]||(e[23]=a(" Befindet sich der Speicher unterhalb des Mindest-SoC, wird er mit der hier eingestellten Speicherladeleistung geladen. Verbleibender Überschuss wird in die Fahrzeuge geladen. ",-1))]),key:"0"}:{name:"help",fn:n(()=>[e[24]||(e[24]=a(" Befindet sich der Speicher unterhalb des Mindest-SoC, wird er priorisiert geladen. ",-1))]),key:"1"}]),1032,["model-value"]),t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_reserve_active"]?(o(),h(f,{key:1,title:"Reservierte Ladeleistung",min:.1,step:.1,unit:"kW",required:"","model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_reserve"]/1e3,"onUpdate:modelValue":e[4]||(e[4]=r=>t.updateState("openWB/general/chargemode_config/pv_charging/bat_power_reserve",r*1e3))},null,8,["model-value"])):d("",!0),i(_,null,{default:n(()=>[...e[25]||(e[25]=[a(" Speicher-SoC oberhalb Maximal-SoC ",-1)])]),_:1}),i(p,{title:"Entladung des Speichers erlauben",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_discharge_active"],"onUpdate:modelValue":e[5]||(e[5]=r=>t.updateState("openWB/general/chargemode_config/pv_charging/bat_power_discharge_active",r))},w({_:2},[t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_discharge_active"]?{name:"help",fn:n(()=>[e[26]||(e[26]=a(" ACHTUNG: Der hier eingestellte Wert darf die maximale Entadeleistung des Speichers nicht überschreiten! Wird der Maximal-SoC überschritten, wird die PV-Ladung mit der hier eingestellten Speicherentladeleistung unterstützt. Der Speicher darf bis zum Mindest-SoC entladen werden. Die erlaubte Entladeleistung des Speichers wird dem Überschuss zum Erreichen der Einschaltschwelle hinzugerechnet. ",-1))]),key:"0"}:{name:"help",fn:n(()=>[e[27]||(e[27]=a(" Oberhalb des Maximal-SoC wird der Speicher nicht für die Fahrzeugladung mitgenutzt. ",-1))]),key:"1"}]),1032,["model-value"]),t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_discharge_active"]?(o(),h(f,{key:2,title:"Erlaubte Entladeleistung",min:.1,step:.1,unit:"kW",required:"","model-value":t.$store.state.mqtt["openWB/general/chargemode_config/pv_charging/bat_power_discharge"]/1e3,"onUpdate:modelValue":e[6]||(e[6]=r=>t.updateState("openWB/general/chargemode_config/pv_charging/bat_power_discharge",r*1e3))},null,8,["model-value"])):d("",!0)])):d("",!0)]))]),_:1}),i(v,{title:"Aktive Speichersteuerung"},{default:n(()=>[t.$store.state.mqtt["openWB/general/extern"]===!0?(o(),s("div",P,[i(l,{subtype:"info"},{default:n(()=>[...e[28]||(e[28]=[a(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ',-1)])]),_:1})])):(o(),s("div",H,[i(l,{subtype:"info",class:"mb-3"},{default:n(()=>[e[29]||(e[29]=m("p",null,[a(" Die aktive Speichersteuerung durch openWB basiert auf öffentlich zugänglichen Informationen zu den verschiedenen Speichersystemen. Diese können auch nicht herstellerseitig freigegebene Informationen beinhalten."),m("br"),a(' Fragen bezüglich der Gewährleistung und Hardwarekompatibilität sind vor der Nutzung mit dem Hersteller zu klären. openWB übernimmt keine Haftung für Schäden, welche aus der Nutzung der "aktiven Speichersteuerung" entstehen. ')],-1)),i(p,{title:"Hinweise zur aktiven Speichersteuerung gelesen und akzeptiert",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.$store.state.mqtt["openWB/bat/config/bat_control_permitted"],"onUpdate:modelValue":e[7]||(e[7]=r=>t.updateState("openWB/bat/config/bat_control_permitted",r))},null,8,["model-value"])]),_:1}),t.$store.state.mqtt["openWB/bat/config/bat_control_permitted"]===!0?(o(),s("div",T,[i(_,{class:"mt-0"},{default:n(()=>[...e[30]||(e[30]=[a(" Regelmodi der aktiven Speichersteuerung ",-1)])]),_:1}),i(l,{subtype:"info"},{default:n(()=>[...e[31]||(e[31]=[a(" Die aktive Speichersteuerung kann Speicherentladung in allen Lademodi begrenzen - z.B. Vermeidung von Netzbezug bei Sofortladen. Die erlaubte Entladeleistung des Speichers (Speicherbeachtung PV) wird bei aktiver Speichersteuerung überschrieben, da Speicherentladung aktiv begrenzt wird. ",-1)])]),_:1}),t.$store.state.mqtt["openWB/bat/get/power_limit_controllable"]===!0?(o(),s("div",I,[i(p,{title:"Speichersteuerung",buttons:[{buttonValue:"no_limit",text:"Aus"},{buttonValue:"limit_stop",text:"volle Entladesperre"},{buttonValue:"limit_to_home_consumption",text:"Entladung in Fahrzeuge sperren"}],"model-value":t.$store.state.mqtt["openWB/bat/config/power_limit_mode"],"onUpdate:modelValue":e[8]||(e[8]=r=>t.updateState("openWB/bat/config/power_limit_mode",r))},{help:n(()=>[t.$store.state.mqtt["openWB/bat/config/power_limit_mode"]==="no_limit"?(o(),s("div",R," Der Speicher regelt eigenständig und wird nicht gesteuert. Es greift nur die konfigurierte Speicherbeachtung. ")):d("",!0),t.$store.state.mqtt["openWB/bat/config/power_limit_mode"]==="limit_stop"?(o(),s("div",G," Die Speicherentladung wird komplett gesperrt, sobald ein Fahrzeug lädt! Alle Verbraucher (Fahrzeuge, Hausverbrauch) werden durch Netzstrom versorgt. ")):d("",!0),t.$store.state.mqtt["openWB/bat/config/power_limit_mode"]==="limit_to_home_consumption"?(o(),s("div",J,' Fahrzeugladung erzeugt Netzbezug statt Speicherentladung. Weitere Verbraucher (bspw. Hausverbrauch) werden durch den Speicher ausgeglichen. Kann die Entladung am Speicher nur komplett gesperrt werden, verhält sich diese Einstellung wie "volle Entladesperre". ')):d("",!0)]),_:1},8,["model-value"])])):(o(),s("div",O,[i(l,{subtype:"info"},{default:n(()=>[...e[32]||(e[32]=[a(" Die Speicher-Entladung ins Fahrzeug kann nicht gesteuert werden, da die Entladeleistung nicht an den/die konfigurierten Speicher übergeben werden kann. ",-1)])]),_:1})]))])):d("",!0)]))]),_:1}),i(B,{"form-name":"batteryConfigForm",onSave:e[9]||(e[9]=r=>t.$emit("save",S.mqttTopicsToPublish)),onReset:e[10]||(e[10]=r=>t.$emit("reset")),onDefaults:e[11]||(e[11]=r=>t.$emit("defaults"))})])])}const re=C($,[["render",x],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/ActiveBatControlConfiguration.vue"]]);export{re as default};
