import{C as B}from"./index-izo6aVi2.js";import{F as $,l as C,T as z,U as E,c as M,f as H,V as P,W as V,X as R,M as F,Y as G,Z as K,_ as Z,$ as J,a0 as U,a1 as A,a2 as I,a3 as Q,n as X,o as Y,p as tt,q as et,a4 as st,a5 as ot}from"./vendor-fortawesome-Bn25cRey.js";import{_ as x,l as d,k as n,y as m,D as O,q as i,x as t,e as h,m as l,A as g,J as a,u as T,f as S,j as at,L as W,K as k}from"./vendor-CPWhyePA.js";import{L as it,C as rt,p as nt,a as ct,b as dt,c as lt,P as pt,d as ut,T as mt,i as gt,e as ht}from"./vendor-chartjs-DB5Gx2Mc.js";import"./vendor-bootstrap-DoSh2SwU.js";import"./vendor-jquery-CEMonh9Y.js";import"./vendor-axios-BuID6n48.js";import"./vendor-luxon-BDx6lZXm.js";C.add(z,E,M,H);const bt={name:"StatusCard",components:{FontAwesomeIcon:$},props:{subtype:{type:String,required:!0},state:{type:Number,required:!1,default:0},stateMessage:{type:String,required:!1,default:void 0},componentId:{type:Number,required:!1,default:void 0}},computed:{stateClass(){switch(this.state){case 0:return"success";case 1:return"warning";case 2:return"danger";default:return"dark"}},stateIcon(){switch(this.state){case 0:return["fas","check-circle"];case 1:return["fas","exclamation-triangle"];case 2:return["fas","times-circle"];default:return["fas","question-circle"]}},stateLabel(){switch(this.state){case 0:return"OK";case 1:return"Warnung";case 2:return"Fehler";default:return"Unbekannt"}}}},_t={class:"container"},ft={class:"row justify-content-end"},vt={key:0,class:"col px-0"},yt={style:{"white-space":"pre-wrap"}},Tt={key:1,class:"col col-auto pr-0"},wt={class:"text-right"};function xt(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-avatar"),p=d("openwb-base-alert"),_=d("openwb-base-card");return n(),m(_,{subtype:c.subtype,collapsible:!0,collapsed:!0},O({header:i(()=>[S(e.$slots,"header-left")]),actions:i(()=>[S(e.$slots,"header-right"),l(r,{class:at(["ml-2",`bg-${s.stateClass}`]),title:s.stateLabel},{default:i(()=>[l(u,{icon:s.stateIcon},null,8,["icon"])]),_:1},8,["class","title"])]),default:i(()=>[S(e.$slots,"default")]),_:2},[c.componentId!==void 0||c.stateMessage?{name:"footer",fn:i(()=>[t("div",_t,[t("div",ft,[c.stateMessage?(n(),h("div",vt,[l(p,{subtype:s.stateClass},{default:i(()=>[l(u,{icon:s.stateIcon},null,8,["icon"]),o[0]||(o[0]=g(" Modulmeldung: ",-1)),t("span",yt,a(c.stateMessage),1)]),_:1},8,["subtype"])])):T("",!0),c.componentId!==void 0?(n(),h("div",Tt,[t("div",wt,"ID: "+a(c.componentId),1)])):T("",!0)])])]),key:"0"}:void 0]),1032,["subtype"])}const q=x(bt,[["render",xt],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/StatusCard.vue"]]);C.add(P);const Wt={name:"ChargePointSumCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],data(){return{mqttTopicsToSubscribe:["openWB/chargepoint/get/power","openWB/chargepoint/get/imported","openWB/chargepoint/get/exported","openWB/chargepoint/get/daily_imported","openWB/chargepoint/get/daily_exported"]}},computed:{baseTopic:{get(){return"openWB/chargepoint"}}}},kt={class:"text-right"},Bt={class:"row"},$t={class:"col text-right text-monospace"},Ct={class:"row"},qt={class:"col-4 text-right text-monospace"},Nt={class:"col-4 text-right text-monospace"},St={class:"row"},Pt={class:"col-4 text-right text-monospace"},At={class:"col-4 text-right text-monospace"};function It(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"primary"},{"header-left":i(()=>[l(u,{icon:["fas","charging-station"]}),o[0]||(o[0]=g(" Alle Ladepunkte ",-1))]),"header-right":i(()=>[t("span",kt,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1)]),default:i(()=>[l(r,{subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[1]||(o[1]=t("div",{class:"row py-2"},[t("div",{class:"col font-weight-bold"},"Ladevorgang"),t("div",{class:"col text-right"},"Leistung")],-1)),t("div",Bt,[t("div",$t,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001)),1)])]),_:1}),l(r,{subtype:"white","body-bg":"white",class:"py-1 mb-2",title:"Zählerstände"},{default:i(()=>[o[4]||(o[4]=t("div",{class:"row justify-content-end"},[t("div",{class:"col-4 text-right"},"Geladen"),t("div",{class:"col-4 text-right"},"Entladen")],-1)),t("div",Ct,[o[2]||(o[2]=t("div",{class:"col text-right"},"Heute",-1)),t("div",qt,a(e.formatNumberTopic(s.baseTopic+"/get/daily_imported",3,3,.001)+" kWh"),1),t("div",Nt,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001)+" kWh"),1)]),t("div",St,[o[3]||(o[3]=t("div",{class:"col text-right"},"Gesamt",-1)),t("div",Pt,a(e.formatNumberTopic(s.baseTopic+"/get/imported",3,3,.001)+" kWh"),1),t("div",At,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001)+" kWh"),1)])]),_:1})]),_:1})}const Ot=x(Wt,[["render",It],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/ChargePointSumCard.vue"]]);C.add(P,V,R,F,G,K,Z,J);const Lt={name:"ChargePointCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{chargePointId:{type:Number,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/chargepoint/${this.chargePointId}/config`,`openWB/chargepoint/${this.chargePointId}/get/+`,`openWB/chargepoint/${this.chargePointId}/set/+`,`openWB/internal_chargepoint/${this.chargePointId}/data/phases_to_use`]}},computed:{baseTopic:{get(){return"openWB/chargepoint/"+this.chargePointId}},chargePointConfig:{get(){return this.$store.state.mqtt[`${this.baseTopic}/config`]}},chargingStatus:{get(){let e=this.$store.state.mqtt[this.baseTopic+"/get/plug_state"],o=this.$store.state.mqtt[this.baseTopic+"/get/charge_state"];return e==1&&o==1?{icon:["fas","plug-circle-bolt"],text:"Fahrzeug angesteckt, Ladevorgang aktiv"}:e==1?{icon:["fas","plug-circle-check"],text:"Fahrzeug angesteckt, kein Ladevorgang aktiv"}:{icon:["fas","plug-circle-minus"],text:"Kein Fahrzeug angesteckt"}}}}},jt={class:"row py-2"},Dt={class:"col text-right"},zt={style:{"white-space":"pre-wrap"}},Et={class:"row"},Mt={class:"col text-right text-monospace"},Ht={class:"col text-right text-monospace"},Vt={class:"row"},Rt={key:0,class:"col text-right text-monospace"},Ft={key:1,class:"col text-right text-monospace"},Gt={class:"col text-right text-monospace"},Kt={class:"row"},Zt={class:"col-4 text-right text-monospace"},Jt={class:"col-4 text-right text-monospace"},Ut={class:"row"},Qt={class:"col-4 text-right text-monospace"},Xt={class:"col-4 text-right text-monospace"},Yt={class:"row"},te={class:"col text-right text-monospace"},ee={class:"col text-right text-monospace"},se={class:"col text-right text-monospace"},oe={class:"row"},ae={class:"col text-right text-monospace"},ie={class:"col text-right text-monospace"},re={class:"col text-right text-monospace"},ne={class:"row"},ce={class:"col text-right text-monospace"},de={class:"col text-right text-monospace"},le={class:"col text-right text-monospace"},pe={class:"row"},ue={class:"col text-right text-monospace"},me={class:"col text-right text-monospace"},ge={class:"col text-right text-monospace"},he={class:"row"},be={class:"col text-center text-monospace"};function _e(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-alert"),p=d("openwb-base-card"),_=d("status-card");return s.chargePointConfig?(n(),m(_,{key:0,subtype:"primary","component-id":c.chargePointId,state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","charging-station"]}),g(" "+a(s.chargePointConfig.name),1)]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW",1)]),default:i(()=>[l(p,{subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",jt,[o[0]||(o[0]=t("div",{class:"col col-auto font-weight-bold"},"Status",-1)),t("div",Dt,[l(u,{icon:s.chargingStatus.icon,title:s.chargingStatus.text},null,8,["icon","title"]),g(" "+a(s.chargingStatus.text),1)])]),l(r,{subtype:"info"},{default:i(()=>[o[1]||(o[1]=g(" Statusmeldung: ",-1)),t("span",zt,a(e.$store.state.mqtt[s.baseTopic+"/get/state_str"]),1)]),_:1}),t("div",null," max. Ladeleistung: "+a((e.max_power=e.formatNumberTopic(s.baseTopic+"/get/max_evse_current",0))=="-"?e.max_power:(()=>{const N=Math.floor(e.max_power*3*230/1e3);return N===13?"20A 1-phasig, 16A 3-phasig":N+" kW"})()),1)]),_:1}),l(p,{subtype:"white","body-bg":"white",class:"py-1 mb-2",title:"Ladevorgang"},{default:i(()=>[o[2]||(o[2]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Ladestrom Vorgabe"),t("div",{class:"col text-right"},"Leistung")],-1)),t("div",Et,[t("div",Mt,a(e.formatNumberTopic(s.baseTopic+"/set/current",2))+" A",1),t("div",Ht,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1)]),o[3]||(o[3]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Phasen Vorgabe"),t("div",{class:"col text-right"},"Phasen Aktuell")],-1)),t("div",Vt,[e.$store.state.mqtt["openWB/general/extern"]===!0?(n(),h("div",Rt,a(e.formatNumberTopic("openWB/internal_chargepoint/"+c.chargePointId+"/data/phases_to_use")),1)):(n(),h("div",Ft,a(e.formatNumberTopic(s.baseTopic+"/set/phases_to_use")),1)),t("div",Gt,a(e.formatNumberTopic(s.baseTopic+"/get/phases_in_use")),1)])]),_:1}),l(p,{subtype:"white","body-bg":"white",class:"py-1 mb-2",title:"Zählerstände"},{default:i(()=>[o[6]||(o[6]=t("div",{class:"row justify-content-end"},[t("div",{class:"col-4 text-right"},"Geladen"),t("div",{class:"col-4 text-right"},"Entladen")],-1)),t("div",Kt,[o[4]||(o[4]=t("div",{class:"col text-right"},"Heute",-1)),t("div",Zt,a(e.formatNumberTopic(s.baseTopic+"/get/daily_imported",3,3,.001))+" kWh ",1),t("div",Jt,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001))+" kWh ",1)]),t("div",Ut,[o[5]||(o[5]=t("div",{class:"col text-right"},"Gesamt",-1)),t("div",Qt,a(e.formatNumberTopic(s.baseTopic+"/get/imported",3,3,.001))+" kWh ",1),t("div",Xt,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001))+" kWh ",1)])]),_:1}),l(p,{subtype:"white","body-bg":"white",class:"py-1 mb-2",title:"Werte pro Phase"},{default:i(()=>[t("div",Yt,[o[7]||(o[7]=t("div",{class:"col-md-4 pr-1 text-center text-md-right"},"Spannung [V]",-1)),t("div",te,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[0]),1),t("div",ee,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[1]),1),t("div",se,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[2]),1)]),t("div",oe,[o[8]||(o[8]=t("div",{class:"col-md-4 pr-1 text-center text-md-right"},"Strom [A]",-1)),t("div",ae,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[0]),1),t("div",ie,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[1]),1),t("div",re,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[2]),1)]),t("div",ne,[o[9]||(o[9]=t("div",{class:"col-md-4 pr-1 text-center text-md-right"},"Wirkleistung [kW]",-1)),t("div",ce,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[0]),1),t("div",de,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[1]),1),t("div",le,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[2]),1)]),t("div",pe,[o[10]||(o[10]=t("div",{class:"col-md-4 pr-1 text-center text-md-right"},"Leistungsfaktor",-1)),t("div",ue,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[0]),1),t("div",me,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[1]),1),t("div",ge,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[2]),1)]),t("div",he,[o[11]||(o[11]=t("div",{class:"col-md-4 pr-1 text-center text-md-right"},"Netzfrequenz",-1)),t("div",be,a(e.formatNumberTopic(s.baseTopic+"/get/frequency",3))+" Hz ",1)])]),_:1})]),_:1},8,["component-id","state","state-message"])):T("",!0)}const fe=x(Lt,[["render",_e],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/ChargePointCard.vue"]]);C.add(U);const ve={name:"CounterCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{counter:{type:Object,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/counter/${this.counter.id}/get/+`]}},computed:{baseTopic:{get(){return"openWB/counter/"+this.counter.id}}}},ye={class:"row"},Te={class:"col text-right text-monospace pl-0"},we={class:"col text-right text-monospace pl-0"},xe={class:"row"},We={class:"col text-right text-monospace pl-0"},ke={class:"col text-right text-monospace pl-0"},Be={class:"row"},$e={class:"col"},Ce={class:"row"},qe={class:"col text-right text-monospace pl-0"},Ne={class:"col text-right text-monospace pl-0"},Se={class:"col text-right text-monospace pl-0"},Pe={class:"row"},Ae={class:"col"},Ie={class:"row"},Oe={class:"col text-right text-monospace pl-0"},Le={class:"col text-right text-monospace pl-0"},je={class:"col text-right text-monospace pl-0"},De={class:"row"},ze={class:"col"},Ee={class:"row"},Me={class:"col text-right text-monospace pl-0"},He={class:"col text-right text-monospace pl-0"},Ve={class:"col text-right text-monospace pl-0"},Re={class:"row"},Fe={class:"col"},Ge={class:"row"},Ke={class:"col text-right text-monospace pl-0"},Ze={class:"col text-right text-monospace pl-0"},Je={class:"col text-right text-monospace pl-0"};function Ue(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"danger","component-id":c.counter.id,state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","gauge-high"]}),g(" "+a(c.counter.name),1)]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW",1)]),default:i(()=>[l(r,{title:"Aktuelle Werte",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[0]||(o[0]=t("div",{class:"row"},[t("div",{class:"col-6 text-right"},"Leistung"),t("div",{class:"col-6 text-right"},"Netzfrequenz")],-1)),t("div",ye,[t("div",Te,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001)+" kW"),1),t("div",we,a(e.formatNumberTopic(s.baseTopic+"/get/frequency",3)+" Hz"),1)])]),_:1}),l(r,{title:"Zählerstände",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[1]||(o[1]=t("div",{class:"row"},[t("div",{class:"col-6 text-right"},"Export"),t("div",{class:"col-6 text-right"},"Import")],-1)),t("div",xe,[t("div",We,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001)+" kWh"),1),t("div",ke,a(e.formatNumberTopic(s.baseTopic+"/get/imported",3,3,.001)+" kWh"),1)])]),_:1}),l(r,{title:"Werte pro Phase",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",Be,[o[2]||(o[2]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Spannung [V]",-1)),t("div",$e,[t("div",Ce,[t("div",qe,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[0]),1),t("div",Ne,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[1]),1),t("div",Se,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/voltages",1)[2]),1)])])]),t("div",Pe,[o[3]||(o[3]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Strom [A]",-1)),t("div",Ae,[t("div",Ie,[t("div",Oe,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[0]),1),t("div",Le,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[1]),1),t("div",je,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[2]),1)])])]),t("div",De,[o[4]||(o[4]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Wirkleistung [kW]",-1)),t("div",ze,[t("div",Ee,[t("div",Me,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[0]),1),t("div",He,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[1]),1),t("div",Ve,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/powers",3,3,.001)[2]),1)])])]),t("div",Re,[o[5]||(o[5]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Leistungsfaktor",-1)),t("div",Fe,[t("div",Ge,[t("div",Ke,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[0]),1),t("div",Ze,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[1]),1),t("div",Je,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/power_factors",2)[2]),1)])])])]),_:1})]),_:1},8,["component-id","state","state-message"])}const Qe=x(ve,[["render",Ue],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/CounterCard.vue"]]);C.add(A);const Xe={name:"InverterSumCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],data(){return{mqttTopicsToSubscribe:["openWB/pv/get/+"]}},computed:{baseTopic:{get(){return"openWB/pv"}}}},Ye={class:"row"},ts={class:"col text-right text-monospace"},es={class:"col text-right text-monospace"},ss={class:"row"},os={class:"col text-right text-monospace"},as={class:"col text-right text-monospace"},is={class:"col text-right text-monospace"};function rs(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"success",state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","solar-panel"]}),o[0]||(o[0]=g(" Alle Wechselrichter ",-1))]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW",1)]),default:i(()=>[l(r,{title:"Aktuelle Werte",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[1]||(o[1]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Leistung"),t("div",{class:"col text-right"},"Zählerstand")],-1)),t("div",Ye,[t("div",ts,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1),t("div",es,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001))+" kWh ",1)])]),_:1}),l(r,{title:"Erträge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[2]||(o[2]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Heute"),t("div",{class:"col text-right"},"Monat"),t("div",{class:"col text-right"},"Jahr")],-1)),t("div",ss,[t("div",os,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001))+" kWh ",1),t("div",as,a(e.formatNumberTopic(s.baseTopic+"/get/monthly_exported",1,1,.001))+" kWh ",1),t("div",is,a(e.formatNumberTopic(s.baseTopic+"/get/yearly_exported",0,0,.001))+" kWh ",1)])]),_:1})]),_:1},8,["state","state-message"])}const ns=x(Xe,[["render",rs],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/InverterSumCard.vue"]]);C.add(A);const cs={name:"InverterCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{inverter:{type:Object,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/pv/${this.inverter.id}/get/+`]}},computed:{baseTopic:{get(){return"openWB/pv/"+this.inverter.id}}}},ds={class:"row"},ls={class:"col text-right text-monospace"},ps={class:"col text-right text-monospace"},us={class:"row"},ms={class:"col text-right text-monospace"},gs={class:"col text-right text-monospace"},hs={class:"col text-right text-monospace"},bs={class:"row"},_s={class:"col"},fs={class:"row"},vs={class:"col text-right text-monospace pl-0"},ys={class:"col text-right text-monospace pl-0"},Ts={class:"col text-right text-monospace pl-0"};function ws(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"success","component-id":c.inverter.id,state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","solar-panel"]}),g(" "+a(c.inverter.name),1)]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW",1)]),default:i(()=>[l(r,{title:"Aktuelle Werte",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[0]||(o[0]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Leistung"),t("div",{class:"col text-right"},"Zählerstand")],-1)),t("div",ds,[t("div",ls,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1),t("div",ps,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001))+" kWh ",1)])]),_:1}),l(r,{title:"Erträge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[1]||(o[1]=t("div",{class:"row"},[t("div",{class:"col text-right"},"Heute"),t("div",{class:"col text-right"},"Monat"),t("div",{class:"col text-right"},"Jahr")],-1)),t("div",us,[t("div",ms,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001))+" kWh ",1),t("div",gs,a(e.formatNumberTopic(s.baseTopic+"/get/monthly_exported",1,1,.001))+" kWh ",1),t("div",hs,a(e.formatNumberTopic(s.baseTopic+"/get/yearly_exported",0,0,.001))+" kWh ",1)])]),_:1}),l(r,{title:"Werte pro Phase",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",bs,[o[2]||(o[2]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Strom [A]",-1)),t("div",_s,[t("div",fs,[t("div",vs,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[0]),1),t("div",ys,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[1]),1),t("div",Ts,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[2]),1)])])])]),_:1})]),_:1},8,["component-id","state","state-message"])}const xs=x(cs,[["render",ws],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/InverterCard.vue"]]);C.add(I);const Ws={name:"BatterySumCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],data(){return{mqttTopicsToSubscribe:["openWB/bat/get/+"]}},computed:{baseTopic:{get(){return"openWB/bat"}}}},ks={class:"row"},Bs={class:"col text-right text-monospace pl-0"},$s={class:"col text-right text-monospace pl-0"},Cs={class:"row"},qs={class:"col text-right text-monospace"},Ns={class:"col text-right text-monospace"},Ss={class:"row"},Ps={class:"col text-right text-monospace"},As={class:"col text-right text-monospace"};function Is(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"warning",state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","car-battery"]}),o[0]||(o[0]=g(" Alle Speicher ",-1))]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",1,1,.001))+" kW / "+a(e.$store.state.mqtt[s.baseTopic+"/get/soc"])+" % ",1)]),default:i(()=>[l(r,{title:"Aktuelle Werte",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[1]||(o[1]=t("div",{class:"row"},[t("div",{class:"col-6 text-right"},"Leistung"),t("div",{class:"col-6 text-right"},"Ladestand")],-1)),t("div",ks,[t("div",Bs,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1),t("div",$s,a(e.$store.state.mqtt[s.baseTopic+"/get/soc"])+" %",1)])]),_:1}),l(r,{title:"Zählerstände",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[4]||(o[4]=t("div",{class:"row"},[t("div",{class:"col"}),t("div",{class:"col text-right"},"Geladen"),t("div",{class:"col text-right"},"Entladen")],-1)),t("div",Cs,[o[2]||(o[2]=t("div",{class:"col text-right"},"Heute",-1)),t("div",qs,a(e.formatNumberTopic(s.baseTopic+"/get/daily_imported",3,3,.001))+" kWh ",1),t("div",Ns,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001))+" kWh ",1)]),t("div",Ss,[o[3]||(o[3]=t("div",{class:"col text-right"},"Gesamt",-1)),t("div",Ps,a(e.formatNumberTopic(s.baseTopic+"/get/imported",3,3,.001))+" kWh ",1),t("div",As,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001))+" kWh ",1)])]),_:1})]),_:1},8,["state","state-message"])}const Os=x(Ws,[["render",Is],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/BatterySumCard.vue"]]);C.add(I);const Ls={name:"BatteryCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{battery:{type:Object,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/bat/${this.battery.id}/get/+`]}},computed:{baseTopic:{get(){return"openWB/bat/"+this.battery.id}}}},js={class:"row"},Ds={class:"col text-right text-monospace pl-0"},zs={class:"col text-right text-monospace pl-0"},Es={class:"row"},Ms={class:"col text-right text-monospace"},Hs={class:"col text-right text-monospace"},Vs={class:"row"},Rs={class:"col text-right text-monospace"},Fs={class:"col text-right text-monospace"},Gs={class:"row"},Ks={class:"col"},Zs={class:"row"},Js={class:"col text-right text-monospace pl-0"},Us={class:"col text-right text-monospace pl-0"},Qs={class:"col text-right text-monospace pl-0"};function Xs(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"warning","component-id":c.battery.id,state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},{"header-left":i(()=>[l(u,{icon:["fas","car-battery"]}),g(" "+a(c.battery.name),1)]),"header-right":i(()=>[g(a(e.formatNumberTopic(s.baseTopic+"/get/power",1,1,.001))+" kW / "+a(e.$store.state.mqtt[s.baseTopic+"/get/soc"])+" % ",1)]),default:i(()=>[l(r,{title:"Aktuelle Werte",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[0]||(o[0]=t("div",{class:"row"},[t("div",{class:"col-6 text-right"},"Leistung"),t("div",{class:"col-6 text-right"},"Ladestand")],-1)),t("div",js,[t("div",Ds,a(e.formatNumberTopic(s.baseTopic+"/get/power",3,3,.001))+" kW ",1),t("div",zs,a(e.$store.state.mqtt[s.baseTopic+"/get/soc"])+" %",1)])]),_:1}),l(r,{title:"Zählerstände",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[3]||(o[3]=t("div",{class:"row"},[t("div",{class:"col"}),t("div",{class:"col text-right"},"Geladen"),t("div",{class:"col text-right"},"Entladen")],-1)),t("div",Es,[o[1]||(o[1]=t("div",{class:"col text-right"},"Heute",-1)),t("div",Ms,a(e.formatNumberTopic(s.baseTopic+"/get/daily_imported",3,3,.001))+" kWh ",1),t("div",Hs,a(e.formatNumberTopic(s.baseTopic+"/get/daily_exported",3,3,.001))+" kWh ",1)]),t("div",Vs,[o[2]||(o[2]=t("div",{class:"col text-right"},"Gesamt",-1)),t("div",Rs,a(e.formatNumberTopic(s.baseTopic+"/get/imported",3,3,.001))+" kWh ",1),t("div",Fs,a(e.formatNumberTopic(s.baseTopic+"/get/exported",3,3,.001))+" kWh ",1)])]),_:1}),l(r,{title:"Werte pro Phase",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",Gs,[o[4]||(o[4]=t("div",{class:"col-md-4 pr-0 text-center text-md-right"},"Strom [A]",-1)),t("div",Ks,[t("div",Zs,[t("div",Js,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[0]),1),t("div",Us,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[1]),1),t("div",Qs,a(e.formatPhaseArrayNumberTopic(s.baseTopic+"/get/currents",2)[2]),1)])])])]),_:1})]),_:1},8,["component-id","state","state-message"])}const Ys=x(Ls,[["render",Xs],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/BatteryCard.vue"]]);C.add(Q,X,Y,tt,et);const to={name:"IoDeviceCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{ioDevice:{type:Object,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/io/states/${this.ioDevice.id}/get/+`,"openWB/io/action/+/config","openWB/io/action/+/timestamp"],state:{true:{icon:["fas","square"],title:"Geschlossen",actionTitle:"Aktiv"},false:{icon:["far","square"],title:"Offen",actionTitle:"Inaktiv"}}}},computed:{baseTopic(){return`openWB/io/states/${this.ioDevice.id}`},hasDigitalInputs(){return Object.keys(this.$store.state.mqtt[`${this.baseTopic}/get/digital_input`]||{}).length>0},hasDigitalOutputs(){return Object.keys(this.$store.state.mqtt[`${this.baseTopic}/get/digital_output`]||{}).length>0},hasAnalogInputs(){return Object.keys(this.$store.state.mqtt[`${this.baseTopic}/get/analog_input`]||{}).length>0},hasAnalogOutputs(){return Object.keys(this.$store.state.mqtt[`${this.baseTopic}/get/analog_output`]||{}).length>0},digitalInputStates(){return this.$store.state.mqtt[`${this.baseTopic}/get/digital_input`]},digitalOutputStates(){return this.$store.state.mqtt[`${this.baseTopic}/get/digital_output`]},analogInputStates(){return this.$store.state.mqtt[`${this.baseTopic}/get/analog_input`]},analogOutputStates(){return this.$store.state.mqtt[`${this.baseTopic}/get/analog_output`]},ioActionConfigs(){return Object.fromEntries(Object.entries(this.getWildcardTopics("openWB/io/action/+/config")).filter(([,e])=>e.configuration.io_device===this.ioDevice.id))},ioActionState(){return e=>{const o=this.$store.state.mqtt[`openWB/io/action/${e}/timestamp`];return o&&new Date(o*1e3).toLocaleString()}}},methods:{getIcon(e){return this.state[e].icon},getTitle(e){return this.state[e].title},getActionTitle(e){return this.state[e].actionTitle}}},eo={class:"col-auto"},so={class:"col text-right"},oo={class:"row"},ao={class:"row"},io={class:"row"},ro={class:"row"};function no(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-alert"),p=d("openwb-base-tooltip"),_=d("openwb-base-card"),N=d("status-card");return n(),m(N,{subtype:"secondary",state:e.$store.state.mqtt[`${s.baseTopic}/get/fault_state`],"state-message":e.$store.state.mqtt[`${s.baseTopic}/get/fault_str`],"component-id":c.ioDevice.id},{"header-left":i(()=>[l(u,{icon:["fas","tower-broadcast"]}),g(" "+a(c.ioDevice.name),1)]),default:i(()=>[l(_,{title:"Zugehörige Aktionen",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[Object.keys(s.ioActionConfigs).length===0?(n(),m(r,{key:0,subtype:"info",class:"mb-2"},{default:i(()=>[...o[0]||(o[0]=[g(" Es wurden noch keine Aktionen erstellt, welche dieses IO-Gerät als Signalquelle verwenden. ",-1)])]),_:1})):(n(!0),h(k,{key:1},W(s.ioActionConfigs,(y,w)=>(n(),h("div",{key:w,class:"row"},[t("div",eo,[l(p,{description:s.getActionTitle(![void 0,null].includes(s.ioActionState(y.id)))},{default:i(()=>[l(u,{icon:s.getIcon(![void 0,null].includes(s.ioActionState(y.id))),class:"fa-fw"},null,8,["icon"])]),_:2},1032,["description"]),g(" "+a(y.name),1)]),t("div",so,a(s.ioActionState(y.id)),1)]))),128))]),_:1}),s.hasDigitalInputs?(n(),m(_,{key:0,title:"Digitale Eingänge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",oo,[(n(!0),h(k,null,W(s.digitalInputStates,(y,w)=>(n(),h("div",{key:w,class:"col io-state"},[g(a(w)+": ",1),l(p,{description:s.getTitle(y)},{default:i(()=>[l(u,{icon:s.getIcon(y),class:"fa-fw"},null,8,["icon"])]),_:2},1032,["description"])]))),128))])]),_:1})):T("",!0),s.hasDigitalOutputs?(n(),m(_,{key:1,title:"Digitale Ausgänge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",ao,[(n(!0),h(k,null,W(s.digitalOutputStates,(y,w)=>(n(),h("div",{key:w,class:"col io-state"},[g(a(w)+": ",1),l(p,{description:s.getTitle(y)},{default:i(()=>[l(u,{icon:s.getIcon(y),class:"fa-fw"},null,8,["icon"])]),_:2},1032,["description"])]))),128))])]),_:1})):T("",!0),s.hasAnalogInputs?(n(),m(_,{key:2,title:"Analoge Eingänge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",io,[(n(!0),h(k,null,W(s.analogInputStates,(y,w)=>(n(),h("div",{key:w,class:"col io-state"},a(w)+": "+a(y),1))),128))])]),_:1})):T("",!0),s.hasAnalogOutputs?(n(),m(_,{key:3,title:"Analoge Ausgänge",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",ro,[(n(!0),h(k,null,W(s.analogOutputStates,(y,w)=>(n(),h("div",{key:w,class:"col io-state"},a(w)+": "+a(y),1))),128))])]),_:1})):T("",!0)]),_:1},8,["state","state-message","component-id"])}const co=x(to,[["render",no],["__scopeId","data-v-356761d0"],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/IoDeviceCard.vue"]]);C.add(st);const lo={name:"VehicleCard",components:{StatusCard:q,FontAwesomeIcon:$},mixins:[B],props:{vehicleId:{type:Number,required:!0}},data(){return{mqttTopicsToSubscribe:[`openWB/vehicle/${this.vehicleId}/name`,`openWB/vehicle/${this.vehicleId}/info`,`openWB/vehicle/${this.vehicleId}/get/+`]}},computed:{information:{get(){return this.$store.state.mqtt[this.baseTopic+"/info"]}},name:{get(){const e=this.baseTopic+"/name";return this.$store.state.mqtt[e]!==void 0?this.$store.state.mqtt[e]:`Fahrzeug ${this.vehicleId}`}},soc:{get(){return this.formatNumberTopic(this.baseTopic+"/get/soc")}},socTimestamp:{get(){return this.$store.state.mqtt[this.baseTopic+"/get/soc_timestamp"]!==void 0?new Date(this.$store.state.mqtt[this.baseTopic+"/get/soc_timestamp"]*1e3).toLocaleString():"-"}},socRange:{get(){return this.$store.state.mqtt[this.baseTopic+"/get/range"]!==void 0?Math.round(this.$store.state.mqtt[this.baseTopic+"/get/range"]):0}},baseTopic:{get(){return"openWB/vehicle/"+this.vehicleId}}}},po={class:"row"},uo={class:"col text-monospace"},mo={class:"row"},go={class:"col text-monospace"},ho={class:"row"},bo={class:"col text-right text-monospace"},_o={class:"col text-right text-monospace"},fo={class:"col text-right text-monospace"};function vo(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("openwb-base-card"),p=d("status-card");return n(),m(p,{subtype:"info","component-id":c.vehicleId,state:e.$store.state.mqtt[s.baseTopic+"/get/fault_state"],"state-message":e.$store.state.mqtt[s.baseTopic+"/get/fault_str"]},O({"header-left":i(()=>[l(u,{icon:["fas","car"]}),g(" "+a(s.name),1)]),default:i(()=>[l(r,{title:"Fahrzeuginformationen",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[t("div",po,[o[0]||(o[0]=t("div",{class:"col pr-0"},"Hersteller",-1)),t("div",uo,a(s.information.manufacturer),1)]),t("div",mo,[o[1]||(o[1]=t("div",{class:"col pr-0"},"Modell",-1)),t("div",go,a(s.information.model),1)])]),_:1}),l(r,{title:"Fahrzeugdaten",subtype:"white","body-bg":"white",class:"py-1 mb-2"},{default:i(()=>[o[2]||(o[2]=t("div",{class:"row"},[t("div",{class:"col pr-0 text-right"},"Ladestand"),t("div",{class:"col pr-0 text-right"},"Reichweite"),t("div",{class:"col pr-0 text-right"},"Letzter Zeitstempel")],-1)),t("div",ho,[t("div",bo,a(s.soc)+" %",1),t("div",_o,a(s.socRange)+" km",1),t("div",fo,a(s.socTimestamp),1)])]),_:1})]),_:2},[s.soc!="-"?{name:"header-right",fn:i(()=>[g(a(s.soc)+" % ",1)]),key:"0"}:void 0]),1032,["component-id","state","state-message"])}const yo=x(lo,[["render",vo],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/VehicleCard.vue"]]);C.add(ot);rt.register(nt,ct,dt,lt,pt,ut,mt,gt,ht);const To={name:"ElectricityPricingCard",components:{StatusCard:q,FontAwesomeIcon:$,ChartjsLine:it},mixins:[B],data(){return{mqttTopicsToSubscribe:["openWB/optional/ep/flexible_tariff/provider","openWB/optional/ep/flexible_tariff/get/fault_state","openWB/optional/ep/flexible_tariff/get/fault_str","openWB/optional/ep/grid_fee/provider","openWB/optional/ep/grid_fee/get/fault_state","openWB/optional/ep/grid_fee/get/fault_str","openWB/optional/ep/get/prices","openWB/optional/ep/flexible_tariff/get/prices","openWB/optional/ep/grid_fee/get/prices"],chartDatasets:{datasets:[{label:"Gesamtpreis",unit:"ct/kWh",type:"line",stepped:!0,borderColor:"rgba(255, 149, 0, 0.9)",backgroundColor:"rgba(255, 149, 0, 0.7)",fill:!1,pointStyle:"circle",pointRadius:0,pointHoverRadius:4,cubicInterpolationMode:"monotone",hidden:!1,borderWidth:1,data:void 0,yAxisID:"y",parsing:{xAxisKey:"timestamp",yAxisKey:"price"}},{label:"Stromtarif",unit:"ct/kWh",type:"line",stepped:!0,borderColor:"rgba(139, 0, 0, 0.9)",backgroundColor:"rgba(139, 0, 0, 0.9)",fill:!1,pointStyle:"circle",pointRadius:0,pointHoverRadius:4,cubicInterpolationMode:"monotone",hidden:!1,borderWidth:1,data:void 0,yAxisID:"y",parsing:{xAxisKey:"timestamp",yAxisKey:"price"}},{label:"Netzentgelt",unit:"ct/kWh",type:"line",stepped:!0,borderColor:"rgba(255, 0, 0, 0.4)",backgroundColor:"rgba(255, 0, 0, 0.4)",fill:!1,pointStyle:"circle",pointRadius:0,pointHoverRadius:4,cubicInterpolationMode:"monotone",hidden:!1,borderWidth:1,data:void 0,yAxisID:"y",parsing:{xAxisKey:"timestamp",yAxisKey:"price"}}]},chartOptions:{plugins:{title:{display:!1},tooltip:{enabled:!0},legend:{display:!0,position:"top",labels:{filter:function(e,o){return!o.datasets[e.datasetIndex].hidden}}}},elements:{point:{radius:2}},responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{type:"time",time:{unit:"hour",text:"Zeit",maxTicksLimit:24},display:!0,title:{display:!0,text:"Uhrzeit"},ticks:{font:{size:12},callback:this.formatTickLabel,maxTicksLimit:0},grid:{}},y:{position:"left",type:"linear",display:"auto",title:{font:{size:12},display:!0,text:"Preis [ct/kWh]"},grid:{},ticks:{font:{size:12},stepSize:.01,maxTicksLimit:11}}}}}},computed:{electricityPricingConfigured(){const e=this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"],o=this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"];return e&&e.type||o&&o.type},chartDataRead(){return this.chartDataObject.datasets.some(o=>o.data!==void 0&&!o.hidden)},chartDataObject(){const e=JSON.parse(JSON.stringify(this.chartDatasets));if(this.$store.state.mqtt["openWB/optional/ep/get/prices"]){var o=this.$store.state.mqtt["openWB/optional/ep/get/prices"],c=[];for(const[r,p]of Object.entries(o))c.push({timestamp:r*1e3,price:p*1e5});if(c.length>0){const r=c.slice(-1)[0];let p=this.endOfToday;if(c.length>1){const _=c.slice(-2,-1)[0];p=r.timestamp+r.timestamp-_.timestamp-1}c.push({timestamp:p,price:r.price})}e.datasets[0].data=c}else e.datasets[0].hidden=!0;if(this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"]?.type&&this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/get/prices"]){var v=this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/get/prices"],b=[];for(const[r,p]of Object.entries(v))b.push({timestamp:r*1e3,price:p*1e5});if(b.length>0){const r=b.slice(-1)[0];let p=this.endOfToday;if(b.length>1){const _=b.slice(-2,-1)[0];p=r.timestamp+r.timestamp-_.timestamp-1}b.push({timestamp:p,price:r.price})}e.datasets[1].data=b}else e.datasets[1].hidden=!0;if(this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"]?.type&&this.$store.state.mqtt["openWB/optional/ep/grid_fee/get/prices"]){var s=this.$store.state.mqtt["openWB/optional/ep/grid_fee/get/prices"],u=[];for(const[r,p]of Object.entries(s))u.push({timestamp:r*1e3,price:p*1e5});if(u.length>0){const r=u.slice(-1)[0];let p=this.endOfToday;if(u.length>1){const _=u.slice(-2,-1)[0];p=r.timestamp+r.timestamp-_.timestamp-1}u.push({timestamp:p,price:r.price})}e.datasets[2].data=u}else e.datasets[2].hidden=!0;return e},currentPrice(){return this.chartDataObject.datasets[0].data===void 0||this.chartDataObject.datasets[0].data.length===0?this.formatNumber(0,2):this.formatNumber(this.chartDataObject.datasets[0].data[0].price||0,2)},endOfToday(){return new Date().setHours(23,59,59,999).valueOf()},baseTopic:{get(){return"openWB/optional/ep/flexible_tariff"}},combinedState(){const e=this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/get/fault_state"]||0,o=this.$store.state.mqtt["openWB/optional/ep/grid_fee/get/fault_state"]||0;return Math.max(e,o)},combinedStateMessage(){const e=[];if(this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"]?.type){const c=(this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/get/fault_state"]||0)>0?this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/get/fault_str"]:"Kein Fehler.";e.push(`Stromtarif: ${c}`)}if(this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"]?.type){const c=(this.$store.state.mqtt["openWB/optional/ep/grid_fee/get/fault_state"]||0)>0?this.$store.state.mqtt["openWB/optional/ep/grid_fee/get/fault_str"]:"Kein Fehler.";e.push(`Netzentgelt: ${c}`)}return e.length>0?e.join(`
`):void 0},tariffProvider(){return this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"]?.name||null},gridFeeProvider(){return this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"]?.name||null},showLegend(){const e=this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"]?.type,o=this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"]?.type;return e&&o},dynamicChartOptions(){const e=JSON.parse(JSON.stringify(this.chartOptions));return e.plugins.legend.display=this.showLegend,e.scales.x.ticks.callback=this.formatTickLabel,e}},methods:{formatTickLabel(e){const o=new Date(e);return`${this.endOfToday<o?o.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})+" ":""}${o.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}`}}},wo={key:0},xo={key:1},Wo={key:2},ko={class:"openwb-chart"};function Bo(e,o,c,v,b,s){const u=d("font-awesome-icon"),r=d("chartjs-line"),p=d("openwb-base-card"),_=d("status-card");return s.electricityPricingConfigured?(n(),m(_,{key:0,subtype:"secondary",state:s.combinedState,"state-message":s.combinedStateMessage},{"header-left":i(()=>[l(u,{icon:["fas","ranking-star"]}),o[0]||(o[0]=g(" Variable Strompreise ",-1))]),"header-right":i(()=>[g(a(s.currentPrice)+" ct/kWh",1)]),default:i(()=>[l(p,{subtype:"white","body-bg":"white",class:"py-1 mb-2"},{header:i(()=>[s.tariffProvider?(n(),h("span",wo,"Stromtarif: "+a(s.tariffProvider),1)):T("",!0),s.tariffProvider&&s.gridFeeProvider?(n(),h("br",xo)):T("",!0),s.gridFeeProvider?(n(),h("span",Wo,"Netzentgelte: "+a(s.gridFeeProvider),1)):T("",!0)]),default:i(()=>[t("div",ko,[s.chartDataRead?(n(),m(r,{key:0,ref:"myChart",data:s.chartDataObject,options:s.dynamicChartOptions},null,8,["data","options"])):T("",!0)])]),_:1})]),_:1},8,["state","state-message"])):T("",!0)}const $o=x(To,[["render",Bo],["__scopeId","data-v-6a18833c"],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/status/ElectricityPricingCard.vue"]]),Co={name:"OpenwbStatusView",components:{ChargePointSumCard:Ot,ChargePointCard:fe,CounterCard:Qe,InverterSumCard:ns,InverterCard:xs,BatterySumCard:Os,BatteryCard:Ys,IoDeviceCard:co,VehicleCard:yo,ElectricityPricingCard:$o},mixins:[B],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/chargepoint/get/power","openWB/chargepoint/+/config","openWB/system/device/+/component/+/config","openWB/bat/get/power","openWB/pv/get/power","openWB/system/io/+/config","openWB/vehicle/+/info","openWB/optional/ep/flexible_tariff/provider","openWB/optional/ep/grid_fee/provider"]}},computed:{installedChargePoints:{get(){return Object.keys(this.getWildcardTopics("openWB/chargepoint/+/config")).map(e=>{let o=e.match(/^openWB\/chargepoint\/(\d+)\/config$/);return o?parseInt(o[1]):null}).filter(e=>e!==null)}},showChargePointSumCard:{get(){return this.$store.state.mqtt["openWB/chargepoint/get/power"]!==void 0&&this.$store.state.mqtt["openWB/general/extern"]===!1&&this.installedChargePoints.length>1}},counterConfigs:{get(){return this.$store.state.mqtt["openWB/general/extern"]===!0?{}:this.filterComponentsByType(this.getWildcardTopics("openWB/system/device/+/component/+/config"),"counter")}},showInverterSumCard:{get(){return this.$store.state.mqtt["openWB/pv/get/power"]!==void 0&&this.$store.state.mqtt["openWB/general/extern"]===!1&&Object.keys(this.inverterConfigs).length>1}},inverterConfigs:{get(){return this.$store.state.mqtt["openWB/general/extern"]===!0?{}:this.filterComponentsByType(this.getWildcardTopics("openWB/system/device/+/component/+/config"),"inverter")}},showBatterySumCard:{get(){return this.$store.state.mqtt["openWB/bat/get/power"]!==void 0&&this.$store.state.mqtt["openWB/general/extern"]===!1&&Object.keys(this.batteryConfigs).length>1}},batteryConfigs:{get(){return this.$store.state.mqtt["openWB/general/extern"]===!0?{}:this.filterComponentsByType(this.getWildcardTopics("openWB/system/device/+/component/+/config"),"bat")}},vehicles:{get(){if(this.$store.state.mqtt["openWB/general/extern"]===!0)return{};let e=this.getWildcardTopics("openWB/vehicle/+/info");return Object.keys(e).map(o=>{let c=o.match(/^openWB\/vehicle\/(\d+)\/info$/);return c?parseInt(c[1]):null})}},ioDeviceConfigs:{get(){return this.getWildcardTopics("openWB/system/io/+/config")}},showElectricityPricingCard:{get(){return(this.$store.state.mqtt["openWB/optional/ep/flexible_tariff/provider"]?.type||this.$store.state.mqtt["openWB/optional/ep/grid_fee/provider"]?.type)&&this.$store.state.mqtt["openWB/general/extern"]===!1}}},methods:{filterComponentsByType(e,o){return Object.keys(e).filter(c=>e[c].type.includes(o)).reduce((c,v)=>({...c,[v]:e[v]}),{})}}},qo={class:"status"};function No(e,o,c,v,b,s){const u=d("charge-point-sum-card"),r=d("charge-point-card"),p=d("counter-card"),_=d("inverter-sum-card"),N=d("inverter-card"),y=d("battery-sum-card"),w=d("battery-card"),L=d("vehicle-card"),j=d("io-device-card"),D=d("electricity-pricing-card");return n(),h("div",qo,[s.showChargePointSumCard?(n(),m(u,{key:0})):T("",!0),(n(!0),h(k,null,W(s.installedChargePoints,f=>(n(),m(r,{key:f,"charge-point-id":f},null,8,["charge-point-id"]))),128)),(n(!0),h(k,null,W(s.counterConfigs,f=>(n(),m(p,{key:f.id,counter:f},null,8,["counter"]))),128)),s.showInverterSumCard?(n(),m(_,{key:1})):T("",!0),(n(!0),h(k,null,W(s.inverterConfigs,f=>(n(),m(N,{key:f.id,inverter:f},null,8,["inverter"]))),128)),s.showBatterySumCard?(n(),m(y,{key:2})):T("",!0),(n(!0),h(k,null,W(s.batteryConfigs,f=>(n(),m(w,{key:f.id,battery:f},null,8,["battery"]))),128)),(n(!0),h(k,null,W(s.vehicles,f=>(n(),m(L,{key:f,"vehicle-id":f},null,8,["vehicle-id"]))),128)),(n(!0),h(k,null,W(s.ioDeviceConfigs,f=>(n(),m(j,{key:f.id,"io-device":f},null,8,["io-device"]))),128)),s.showElectricityPricingCard?(n(),m(D,{key:3})):T("",!0)])}const zo=x(Co,[["render",No],["__scopeId","data-v-051028a3"],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/Status.vue"]]);export{zo as default};
