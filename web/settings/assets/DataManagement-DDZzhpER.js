const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/backup_cloud-Bm10rblD.js","assets/vendor-CPWhyePA.js","assets/vendor-D1GV4U4l.css","assets/vendor-fortawesome-Bn25cRey.js","assets/index-izo6aVi2.js","assets/vendor-bootstrap-DoSh2SwU.js","assets/vendor-jquery-CEMonh9Y.js","assets/vendor-bootstrap-BJ8HpIhY.css","assets/vendor-axios-BuID6n48.js","assets/index-BJFb1kjD.css","assets/dynamic-import-helper-BheWnx7M.js","assets/backup_cloud-D1vYBaz7.js","assets/backup_cloud-Ds9fZzOf.js","assets/backup_cloud-Y8Rmu9ot.js","assets/monitoring-C7G4Ezp-.js"])))=>i.map(i=>d[i]);
import{F as A,l as P,aa as L,ab as T,aA as H,aB as N,aC as K,aD as I,aE as G}from"./vendor-fortawesome-Bn25cRey.js";import{_ as B,C as J}from"./index-izo6aVi2.js";import{_ as j}from"./dynamic-import-helper-BheWnx7M.js";import{_ as C,l as m,k as d,e as g,y as h,q as i,A as o,J as f,m as t,x as s,a1 as E,a2 as R,K as M,u as k,j as W,L as z,D as V}from"./vendor-CPWhyePA.js";const Z={props:{backupCloud:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(n,e=void 0){this.$emit("update:configuration",{value:n,object:e})},sendSystemCommand(n,e={}){this.$emit("sendCommand",{command:n,data:e})}}},Q=C(Z,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/backup_clouds/BackupCloudConfigMixin.vue"]]),X={name:"BackupCloudConfigFallback",mixins:[Q]},Y={class:"backup-cloud-fallback"},ee={key:1};function ne(n,e,r,y,l,u){const p=m("openwb-base-alert"),c=m("openwb-base-textarea");return d(),g("div",Y,[Object.keys(n.backupCloud.configuration).length==0?(d(),h(p,{key:0,subtype:"info"},{default:i(()=>[o(' Die Backup-Cloud "'+f(n.backupCloud.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(d(),g("div",ee,[t(p,{subtype:"warning"},{default:i(()=>[o(' Es wurde keine Konfigurationsseite für die Backup-Cloud "'+f(n.backupCloud.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),t(c,{title:"Konfiguration",subtype:"json","model-value":n.backupCloud.configuration,"onUpdate:modelValue":e[0]||(e[0]=b=>n.updateConfiguration(b,"configuration"))},{help:i(()=>[...e[1]||(e[1]=[o(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),t(p,{subtype:"info"},{default:i(()=>[s("pre",null,f(JSON.stringify(n.backupCloud.configuration,void 0,2)),1)]),_:1})]))])}const te=C(X,[["render",ne],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/backup_clouds/OpenwbBackupCloudConfigFallback.vue"]]);P.add(L,T);const oe={name:"OpenwbBackupCloudProxy",components:{FontAwesomeIcon:A},props:{backupCloud:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],methods:{getBackupCloudComponent(){return console.debug(`loading backup cloud: ${this.backupCloud.type}`),E({loader:()=>j(Object.assign({"./nextcloud/backup_cloud.vue":()=>B(()=>import("./backup_cloud-Bm10rblD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),"./nfs/backup_cloud.vue":()=>B(()=>import("./backup_cloud-D1vYBaz7.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10])),"./onedrive/backup_cloud.vue":()=>B(()=>import("./backup_cloud-Ds9fZzOf.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10])),"./samba/backup_cloud.vue":()=>B(()=>import("./backup_cloud-Y8Rmu9ot.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10]))}),`./${this.backupCloud.type}/backup_cloud.vue`,3),errorComponent:te})},updateConfiguration(n){this.$emit("update:configuration",n)},sendCommand(n){this.$emit("sendCommand",n)}}};function ie(n,e,r,y,l,u){const p=m("font-awesome-icon"),c=m("openwb-base-alert"),b=m("openwb-base-heading");return d(),g(M,null,[r.backupCloud.official?(d(),h(c,{key:0,subtype:"success"},{default:i(()=>[t(p,{icon:["fas","certificate"]}),o(' Das ausgewählte Backup-Cloud Modul "'+f(r.backupCloud.name)+'" wird von openWB gepflegt. ',1)]),_:1})):(d(),h(c,{key:1,subtype:"info"},{default:i(()=>[t(p,{icon:["fas","people-group"]}),o(' Das ausgewählte Backup-Cloud Modul "'+f(r.backupCloud.name)+'" wird in unserer Community gepflegt. Rückfragen oder Probleme bitte im Forum diskutieren. ',1)]),_:1})),t(b,null,{default:i(()=>[o(' Einstellungen für Backup-Cloud Modul "'+f(r.backupCloud.name)+'" ',1)]),_:1}),(d(),h(R(u.getBackupCloudComponent()),{"backup-cloud":r.backupCloud,"onUpdate:configuration":e[0]||(e[0]=w=>u.updateConfiguration(w)),onSendCommand:e[1]||(e[1]=w=>u.sendCommand(w))},null,40,["backup-cloud"]))],64)}const se=C(oe,[["render",ie],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/backup_clouds/OpenwbBackupCloudProxy.vue"]]),ae={props:{monitoring:{type:Object,required:!0}},emits:["update:configuration"],methods:{updateConfiguration(n,e=void 0){this.$emit("update:configuration",{value:n,object:e})}}},re=C(ae,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/monitoring/MonitoringConfigMixin.vue"]]),le={name:"MonitoringConfigFallback",mixins:[re]},ue={class:"monitoring-fallback"},de={key:1};function pe(n,e,r,y,l,u){const p=m("openwb-base-alert"),c=m("openwb-base-textarea");return d(),g("div",ue,[Object.keys(n.monitoring.configuration).length==0?(d(),h(p,{key:0,subtype:"info"},{default:i(()=>[o(' Der Anbieter "'+f(n.monitoring.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(d(),g("div",de,[t(p,{subtype:"warning"},{default:i(()=>[o(' Es wurde keine Konfigurationsseite für den Anbieter "'+f(n.monitoring.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),t(c,{title:"Konfiguration",subtype:"json","model-value":n.monitoring.configuration,"onUpdate:modelValue":e[0]||(e[0]=b=>n.updateConfiguration(b,"configuration"))},{help:i(()=>[...e[1]||(e[1]=[o(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),t(p,{subtype:"info"},{default:i(()=>[s("pre",null,f(JSON.stringify(n.monitoring.configuration,void 0,2)),1)]),_:1})]))])}const ce=C(le,[["render",pe],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/monitoring/OpenwbMonitoringConfigFallback.vue"]]);P.add(L,T);const me={name:"OpenwbMonitoringProxy",components:{FontAwesomeIcon:A},props:{monitoring:{type:Object,required:!0}},emits:["update:configuration"],methods:{getMonitoringComponent(){return console.debug(`loading monitoring: ${this.monitoring.type}`),E({loader:()=>j(Object.assign({"./zabbix/monitoring.vue":()=>B(()=>import("./monitoring-C7G4Ezp-.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10]))}),`./${this.monitoring.type}/monitoring.vue`,3),errorComponent:ce})},updateConfiguration(n){this.$emit("update:configuration",n)}}};function ge(n,e,r,y,l,u){const p=m("font-awesome-icon"),c=m("openwb-base-alert"),b=m("openwb-base-heading");return d(),g(M,null,[r.monitoring.official?(d(),h(c,{key:0,subtype:"success"},{default:i(()=>[t(p,{icon:["fas","certificate"]}),o(' Das ausgewählte Monitoring Modul "'+f(r.monitoring.name)+'" wird von openWB gepflegt. ',1)]),_:1})):(d(),h(c,{key:1,subtype:"info"},{default:i(()=>[t(p,{icon:["fas","people-group"]}),o(' Das ausgewählte Monitoring Modul "'+f(r.monitoring.name)+'" wird in unserer Community gepflegt. Rückfragen oder Probleme bitte im Forum diskutieren. ',1)]),_:1})),t(b,null,{default:i(()=>[o(' Einstellungen für Modul "'+f(r.monitoring.name)+'" ',1)]),_:1}),(d(),h(R(u.getMonitoringComponent()),{monitoring:r.monitoring,"onUpdate:configuration":e[0]||(e[0]=w=>u.updateConfiguration(w))},null,40,["monitoring"]))],64)}const fe=C(me,[["render",ge],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/monitoring/OpenwbMonitoringProxy.vue"]]);P.add(H,N,K,I,G);const be={name:"OpenwbDataManagementView",components:{FontAwesomeIcon:A,OpenwbBackupCloudProxy:se,OpenwbMonitoringProxy:fe},mixins:[J],props:{installAssistantActive:{type:Boolean,required:!1,default:!1},showBackupCloudSection:{type:Boolean,required:!1,default:!0}},emits:["sendCommand","save","reset","defaults"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/system/configurable/backup_clouds","openWB/system/configurable/monitoring","openWB/system/backup_password","openWB/system/backup_cloud/config","openWB/system/backup_cloud/backup_before_update","openWB/system/device/+/component/+/config","openWB/chargepoint/+/config","openWB/optional/monitoring/config","openWB/vehicle/+/name","openWB/LegacySmartHome/config/get/Devices/+/device_configured","openWB/LegacySmartHome/config/get/Devices/+/device_name"],warningAcknowledged:!1,showRestoreSection:!this.installAssistantActive,restorePassword:void 0,selectedRestoreFile:void 0,restoreUploadDone:!1,selectedDataMigrationFile:void 0,dataMigrationUploadDone:!1,dataMigrationConfig:[{sectionName:"Ladepunkte",sectionComponents:[{key:"cp1",label:"Ladepunkt 1",validTypes:["chargePoint"]},{key:"cp2",label:"Ladepunkt 2",validTypes:["chargePoint"]},{key:"cp3",label:"Ladepunkt 3",validTypes:["chargePoint"]},{key:"cp4",label:"Ladepunkt 4",validTypes:["chargePoint"]},{key:"cp5",label:"Ladepunkt 5",validTypes:["chargePoint"]},{key:"cp6",label:"Ladepunkt 6",validTypes:["chargePoint"]},{key:"cp7",label:"Ladepunkt 7",validTypes:["chargePoint"]},{key:"cp8",label:"Ladepunkt 8",validTypes:["chargePoint"]}]},{sectionName:"Zähler",sectionComponents:[{key:"evu",label:"EVU",validTypes:["counter"]},{key:"consumer1",label:"Verbraucher 1",validTypes:["counter"]},{key:"consumer2",label:"Verbraucher 2",validTypes:["counter"]},{key:"consumer3",label:"Verbraucher 3",validTypes:["counter"]}]},{sectionName:"Wechselrichter",sectionComponents:[{key:"pvAll",label:"Wechselrichter (Summe)",validTypes:["inverter"],help:"Die 1.9er Version von openWB speichert lediglich die Summen-Leistung aller Wechselrichter."}]},{sectionName:"Batteriespeicher",sectionComponents:[{key:"bat",label:"Speicher 1",validTypes:["battery"]}]},{sectionName:"Fahrzeuge",sectionComponents:[{key:"ev1",label:"Fahrzeug von Ladepunkt 1",validTypes:["vehicle"]},{key:"ev2",label:"Fahrzeug von Ladepunkt 2",validTypes:["vehicle"]}]},{sectionName:"SmartHome 2.0",sectionComponents:[{key:"sh1",label:"Gerät 1",validTypes:["smartHome"]},{key:"sh2",label:"Gerät 2",validTypes:["smartHome"]},{key:"sh3",label:"Gerät 3",validTypes:["smartHome"]},{key:"sh4",label:"Gerät 4",validTypes:["smartHome"]},{key:"sh5",label:"Gerät 5",validTypes:["smartHome"]},{key:"sh6",label:"Gerät 6",validTypes:["smartHome"]},{key:"sh7",label:"Gerät 7",validTypes:["smartHome"]},{key:"sh8",label:"Gerät 8",validTypes:["smartHome"]},{key:"sh9",label:"Gerät 9",validTypes:["smartHome"]}]}],dataMigrationMapping:{cp1:void 0,cp2:void 0,cp3:void 0,cp4:void 0,cp5:void 0,cp6:void 0,cp7:void 0,cp8:void 0,evu:void 0,pvAll:void 0,bat:void 0,consumer1:void 0,consumer2:void 0,consumer3:void 0,sh1:void 0,sh2:void 0,sh3:void 0,sh4:void 0,sh5:void 0,sh6:void 0,sh7:void 0,sh8:void 0,sh9:void 0,ev1:void 0,ev2:void 0}}},computed:{backupCloudList(){return this.$store.state.mqtt["openWB/system/configurable/backup_clouds"]},componentConfigurations(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")},chargePointOptions(){let n=this.getWildcardTopics("openWB/chargepoint/+/config");var e=[];for(const r of Object.values(n))e.push({value:r.id,text:r.name});return e},counterOptions(){var n=[];for(const e of Object.values(this.componentConfigurations))this.isComponentType(e.type,"counter")&&n.push({value:e.id,text:e.name});return n},inverterOptions(){var n=[];for(const e of Object.values(this.componentConfigurations))this.isComponentType(e.type,"inverter")&&n.push({value:e.id,text:e.name});return n},monitoringList(){return this.$store.state.mqtt["openWB/system/configurable/monitoring"]},batteryOptions(){var n=[];for(const e of Object.values(this.componentConfigurations))this.isComponentType(e.type,"bat")&&n.push({value:e.id,text:e.name});return n},vehicleOptions(){let n=this.getWildcardTopics("openWB/vehicle/+/name");var e=[];for(const[r,y]of Object.entries(n)){let l=parseInt(r.match(/\/(\d\d?)\//)[1]);e.push({value:l,text:y})}return e},smartHomeOptions(){let n=this.getWildcardTopics("openWB/LegacySmartHome/config/get/Devices/+/device_configured");var e=[];for(const[r,y]of Object.entries(n))if(y==1){let l=parseInt(r.match(/\/(\d\d?)\//)[1]);e.push({value:l,text:this.$store.state.mqtt[`openWB/LegacySmartHome/config/get/Devices/${l}/device_name`]})}return e},disableRestoreUpload(){return!this.selectedRestoreFile||this.selectedRestoreFile?.name?.endsWith(".gpg")&&!(this.restorePassword||this.$store.state.mqtt["openWB/system/backup_password"])}},methods:{isComponentType(n,e){return n.split("_").includes(e)},getBackupCloudDefaultConfiguration(n){const e=this.backupCloudList.find(r=>r.value==n);return Object.prototype.hasOwnProperty.call(e,"defaults")?{...JSON.parse(JSON.stringify(e.defaults))}:(console.warn("no default configuration found for backup cloud type!",n),{})},sendSystemCommand(n,e={}){this.$emit("sendCommand",{command:n,data:e})},getMigrationOptions(n){var e=[{value:void 0,text:"-- nicht übernehmen --"}];return n.includes("chargePoint")&&e.push(...this.chargePointOptions),n.includes("counter")&&e.push(...this.counterOptions),n.includes("inverter")&&e.push(...this.inverterOptions),n.includes("battery")&&e.push(...this.batteryOptions),n.includes("vehicle")&&e.push(...this.vehicleOptions),n.includes("smartHome")&&e.push(...this.smartHomeOptions),e},updateConfiguration(n,e){console.debug("updateConfiguration",n,e),this.updateState(n,e.value,e.object)},updateSelectedBackupCloud(n){this.updateState("openWB/system/backup_cloud/config",n,"type"),this.updateState("openWB/system/backup_cloud/config",this.getBackupCloudDefaultConfiguration(n))},updateSelectedRestoreFile(n){this.selectedRestoreFile=n.target.files[0]},updateSelectedDataMigrationFile(n){this.selectedDataMigrationFile=n.target.files[0]},uploadFile(n,e,r,y={}){return new Promise(l=>{if(e!==void 0){this.$root.postClientMessage("Hochladen der Datei gestartet.","info");let u=new FormData;u.append("file",e),u.append("target",n);for(const[p,c]of Object.entries(y))u.append(p,c);this.axios.post(location.protocol+"//"+location.host+"/openWB/web/settings/uploadFile.php",u,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$root.postClientMessage(r,"success"),l(!0)}).catch(p=>{if(p.response){console.error(p.response.status,p.response.data);var c="Hochladen der Datei fehlgeschlagen!<br />"+p.response.status+": "+p.response.data}else p.request?(console.error(p.request),c+="Es wurde keine Antwort vom Server empfangen."):(console.error("Error",p.message),c+="Es ist ein unbekannter Fehler aufgetreten.");this.$root.postClientMessage(c,"danger"),l(!1)})}else console.error("no file selected for upload"),l(!1)})},getMonitoringDefaultConfiguration(n){const e=this.monitoringList.find(r=>r.value==n);return Object.prototype.hasOwnProperty.call(e,"defaults")?{...e.defaults}:(console.warn("no default configuration found for monitoring type!",n),{})},updateSelectedMonitoring(n){this.updateState("openWB/optional/monitoring/config",n,"type"),this.updateState("openWB/optional/monitoring/config",this.getMonitoringDefaultConfiguration(n))},async uploadRestoreFile(){const n="Die Sicherungsdatei wurde erfolgreich hochgeladen. Du kannst die Wiederherstellung jetzt starten.";this.restoreUploadDone=await this.uploadFile("restore",this.selectedRestoreFile,n,[void 0,null,""].includes(this.restorePassword)?void 0:{restorePassword:this.restorePassword})},async uploadDataMigrationFile(){const n="Die Sicherungsdatei wurde erfolgreich hochgeladen. Du kannst den Import jetzt starten.";this.dataMigrationUploadDone=await this.uploadFile("migrate",this.selectedDataMigrationFile,n)},restoreBackup(){this.sendSystemCommand("restoreBackup"),this.$store.commit("storeLocal",{name:"reloadRequired",value:!0})},dataMigration(){this.sendSystemCommand("dataMigration",this.dataMigrationMapping)},factoryReset(){this.sendSystemCommand("factoryReset",{}),this.$store.commit("storeLocal",{name:"reloadRequired",value:!0})}}},he={class:"system"},ke={key:1},ye={name:"backupPasswordForm"},ve={name:"backupForm"},we={class:"row justify-content-center"},_e={class:"col-md-4 d-flex py-1 justify-content-center"},Ce={key:0,name:"restoreForm"},Be={class:"input-group mb-2"},De={class:"input-group-prepend"},Se={class:"input-group-text"},We={class:"custom-file"},Me={id:"input-file-label",class:"custom-file-label",for:"input-file","data-browse":"Suchen"},Oe={class:"input-group-append"},Fe=["disabled"],Ae={class:"row justify-content-center"},Pe={class:"col-md-4 d-flex py-1 justify-content-center"},ze={key:1},Ve={key:0,name:"cloudBackupForm"},Le={key:0},Te={name:"dataMigrationForm"},je={class:"input-group"},Ee={class:"input-group-prepend"},Re={class:"input-group-text"},Ue={class:"custom-file"},qe={id:"data-migration-file-label",class:"custom-file-label",for:"data-migration-file","data-browse":"Suchen"},xe={class:"input-group-append"},$e=["disabled"],He={class:"row justify-content-center"},Ne={class:"col-md-4 d-flex py-1 justify-content-center"},Ke={key:1,name:"resetForm"},Ie={class:"row justify-content-center"},Ge={class:"col-md-4 d-flex py-1 justify-content-center"},Je={key:2,name:"monitoringForm"},Ze={key:1},Qe={key:0};function Xe(n,e,r,y,l,u){const p=m("openwb-base-button-group-input"),c=m("openwb-base-alert"),b=m("openwb-base-heading"),w=m("openwb-base-text-input"),O=m("openwb-base-submit-buttons"),v=m("font-awesome-icon"),D=m("openwb-base-click-button"),F=m("openwb-base-select-input"),U=m("openwb-base-button-input"),q=m("openwb-backup-cloud-proxy"),S=m("openwb-base-card"),x=m("openwb-monitoring-proxy");return d(),g("div",he,[r.installAssistantActive?k("",!0):(d(),h(c,{key:0,subtype:"danger"},{default:i(()=>[e[25]||(e[25]=s("h2",null,"Achtung!",-1)),e[26]||(e[26]=s("p",null," Vor allen Aktionen auf dieser Seite ist sicherzustellen, dass kein Ladevorgang aktiv ist! Zur Sicherheit bitte zusätzlich alle Fahrzeuge von der Ladestation / den Ladestationen abstecken! ",-1)),t(p,{modelValue:l.warningAcknowledged,"onUpdate:modelValue":e[0]||(e[0]=a=>l.warningAcknowledged=a),title:"Ich habe die Warnung verstanden",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}]},null,8,["modelValue"])]),_:1})),l.warningAcknowledged||r.installAssistantActive?(d(),g("div",ke,[t(S,{title:"Sicherung / Wiederherstellung",subtype:"success",collapsible:!0,collapsed:!r.installAssistantActive},{default:i(()=>[s("form",ye,[t(b,null,{default:i(()=>[...e[27]||(e[27]=[o("Allgemein",-1)])]),_:1}),t(w,{title:"Kennwort für Sicherungen",subtype:"password","model-value":n.$store.state.mqtt["openWB/system/backup_password"],"onUpdate:modelValue":e[1]||(e[1]=a=>n.updateState("openWB/system/backup_password",a))},{help:i(()=>[...e[28]||(e[28]=[o(" Ist hier ein Kennwort gesetzt, werden alle Sicherungen mit einem Kennwortschutz versehen. Diese Option sollte genutzt werden, wenn die Sicherungsdatei über unsichere Kanäle (z.B. eine Backup-Cloud im Internet) übertragen wird.",-1),s("br",null,null,-1),o(" Wichtig: Das Kennwort wird nicht in der Sicherung gespeichert! Ohne gültiges Kennwort kann eine geschützte Sicherung nicht wiederhergestellt werden! ",-1)])]),_:1},8,["model-value"]),t(O,{"form-name":"backupPasswordForm","hide-reset":!0,"hide-defaults":!0,"save-id":"saveBackupPassword",onSave:e[2]||(e[2]=a=>n.$emit("save",["openWB/system/backup_password"])),onReset:e[3]||(e[3]=a=>n.$emit("reset"))}),e[29]||(e[29]=s("hr",null,null,-1))]),s("form",ve,[t(b,null,{default:i(()=>[...e[30]||(e[30]=[o("Sicherung",-1)])]),_:1}),t(c,{subtype:"danger"},{default:i(()=>[...e[31]||(e[31]=[o(' Es können nur Sicherungen wiederhergestellt werden, die in den Entwicklungszweigen "master", "Beta" oder "Release" erstellt wurden! ',-1)])]),_:1}),t(c,{subtype:"info"},{default:i(()=>[...e[32]||(e[32]=[o(" Nachdem die Sicherung abgeschlossen ist, kann die erstellte Datei über den Link in der Benachrichtigung oder ",-1),s("a",{href:"/openWB/data/backup/",target:"_blank"},"hier",-1),o(" heruntergeladen werden. ",-1)])]),_:1}),s("div",we,[s("div",_e,[t(D,{class:"btn-success clickable",onButtonClicked:e[4]||(e[4]=a=>u.sendSystemCommand("createBackup",{use_extended_filename:!0}))},{default:i(()=>[e[33]||(e[33]=o(" Sicherung erstellen ",-1)),t(v,{icon:["fas","archive"]})]),_:1})])])]),l.showRestoreSection?(d(),g("form",Ce,[e[39]||(e[39]=s("hr",null,null,-1)),t(b,null,{default:i(()=>[...e[34]||(e[34]=[o("Wiederherstellung",-1)])]),_:1}),t(c,{subtype:"danger"},{default:i(()=>[...e[35]||(e[35]=[o(" Für die Wiederherstellung wird eine aktive Internetverbindung benötigt.",-1),s("br",null,null,-1),o(' Es können nur Sicherungen wiederhergestellt werden, die in den Entwicklungszweigen "master", "Beta" oder "Release" erstellt wurden! ',-1)])]),_:1}),s("div",Be,[s("div",De,[s("div",Se,[t(v,{icon:["fas","file-archive"]})])]),s("div",We,[s("input",{id:"input-file",type:"file",class:"custom-file-input",accept:".tar.gz,.openwb-backup,application/gzip,application/tar+gzip,.openwb-backup.gpg,application/gzip+gpg,application/tar+gzip+gpg",onChange:e[5]||(e[5]=a=>u.updateSelectedRestoreFile(a))},null,32),s("label",Me,f(l.selectedRestoreFile?l.selectedRestoreFile.name:"Bitte eine Datei auswählen"),1)]),s("div",Oe,[s("button",{class:W(["btn",u.disableRestoreUpload?"btn-outline-success":"btn-success clickable"]),disabled:u.disableRestoreUpload,type:"button",onClick:e[6]||(e[6]=a=>u.uploadRestoreFile())},[e[36]||(e[36]=o(" Hochladen ",-1)),t(v,{icon:["fas","upload"]})],10,Fe)])]),l.selectedRestoreFile?.name?.endsWith(".gpg")?(d(),h(w,{key:0,modelValue:l.restorePassword,"onUpdate:modelValue":e[7]||(e[7]=a=>l.restorePassword=a),title:"Kennwort dieser Sicherung",subtype:"password"},{help:i(()=>[...e[37]||(e[37]=[o(' Wenn die Sicherung mit einem Kennwortschutz versehen wurde, wird zuerst eine Entschlüsselung mit dem unter "Allgemein" hinterlegten Kennwort versucht. Falls die Sicherung mit einem anderen Kennwort geschützt wurde, muss dieses hier eingegeben werden. ',-1)])]),_:1},8,["modelValue"])):k("",!0),s("div",Ae,[s("div",Pe,[t(D,{class:W(l.restoreUploadDone?"btn-success clickable":"btn-outline-success"),disabled:!l.restoreUploadDone,onButtonClicked:e[8]||(e[8]=a=>u.restoreBackup())},{default:i(()=>[e[38]||(e[38]=o(" Wiederherstellung starten ",-1)),t(v,{icon:["fas","box-open"]})]),_:1},8,["class","disabled"])])])])):k("",!0),r.installAssistantActive?k("",!0):(d(),g("div",ze,[r.showBackupCloudSection?(d(),g("form",Ve,[e[43]||(e[43]=s("hr",null,null,-1)),t(b,null,{default:i(()=>[...e[40]||(e[40]=[o(" Automatische Sicherung in einen Cloud-Dienst ",-1)])]),_:1}),t(c,{subtype:"info"},{default:i(()=>[...e[41]||(e[41]=[o(" Ist die openWB als primary konfiguriert, wird zwischen Mitternacht und 5:00 Uhr automatisch eine Sicherung erstellt und in den angegebenen Cloud-Dienst (nicht openWB Cloud!) hochgeladen. Ist kein Cloud-Dienst konfiguriert, wird keine automatische Sicherung erstellt. Die automatische Sicherung kann unabhängig von der openWB Cloud genutzt werden.",-1),s("br",null,null,-1),o(" Die manuelle Cloud-Sicherung und -falls aktiviert- die Sicherung vor einem Update werden sowohl von einer primary als auch von einer secondary durchgeführt.",-1),s("br",null,null,-1),o(" Die Anleitung zur Konfiguration des Cloud-Dienstes findest Du ",-1),s("a",{href:"https://github.com/openWB/core/wiki/Cloud-Sicherung",target:"_blank",rel:"noopener noreferrer"}," hier ",-1),o(" . ",-1)])]),_:1}),t(F,{class:"mb-2",title:"Backup-Cloud",options:u.backupCloudList,"model-value":n.$store.state.mqtt["openWB/system/backup_cloud/config"]?.type,"onUpdate:modelValue":e[9]||(e[9]=a=>u.updateSelectedBackupCloud(a))},null,8,["options","model-value"]),n.$store.state.mqtt["openWB/system/backup_cloud/config"]?.type?(d(),g("div",Le,[t(p,{title:"Sicherung vor System-Update",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":n.$store.state.mqtt["openWB/system/backup_cloud/backup_before_update"],"onUpdate:modelValue":e[10]||(e[10]=a=>n.updateState("openWB/system/backup_cloud/backup_before_update",a))},{help:i(()=>[...e[42]||(e[42]=[o(" Ist diese Option aktiviert, dann wird vor jedem System-Update automatisch eine Sicherung erstellt und diese in die Backup-Cloud hochgeladen. ",-1)])]),_:1},8,["model-value"]),t(U,{title:"Manuelle Cloud-Sicherung","button-text":"Sicherung erstellen und hochladen",subtype:"success",onButtonClicked:e[11]||(e[11]=a=>u.sendSystemCommand("createCloudBackup",{}))}),t(q,{"backup-cloud":n.$store.state.mqtt["openWB/system/backup_cloud/config"],"onUpdate:configuration":e[12]||(e[12]=a=>u.updateConfiguration("openWB/system/backup_cloud/config",a)),onSendCommand:e[13]||(e[13]=a=>u.sendSystemCommand(a.command,a.args))},null,8,["backup-cloud"])])):k("",!0),t(O,{"form-name":"cloudBackupForm","hide-reset":!0,"hide-defaults":!0,"save-id":"saveCloudBackup",onSave:e[14]||(e[14]=a=>n.$emit("save")),onReset:e[15]||(e[15]=a=>n.$emit("reset")),onDefaults:e[16]||(e[16]=a=>n.$emit("defaults"))})])):k("",!0)]))]),_:1},8,["collapsed"]),!r.installAssistantActive&&!n.$store.state.mqtt["openWB/general/extern"]?(d(),h(S,{key:0,title:"Datenübernahme",subtype:"success",collapsible:!0,collapsed:!0},{default:i(()=>[s("form",Te,[t(c,{subtype:"info"},{default:i(()=>[...e[44]||(e[44]=[o(" Hier kann die Sicherung aus den älteren Software Versionen 1.9.303 oder 1.9.304 hochgeladen werden, um vorhandene historische Daten (Diagramme und Ladeprotokolle) sowie Cloud-Daten und Seriennummer in diese Installation zu importieren.",-1),s("br",null,null,-1),o(" Ein Import aus Versionen kleiner als 1.9.303 ist nicht möglich. Falls eine Datenübernahme aus 1.9er Versionen gewünscht ist, muss erst ein Upgrade auf 1.9.303 oder 1.9.304 durchgeführt werden! Die Zuordnung zwischen den alten und neuen Komponenten muss manuell durchgeführt werden. ",-1)])]),_:1}),t(c,{subtype:"danger"},{default:i(()=>[...e[45]||(e[45]=[o(" Die Portierung kann bei vielen historischen Daten von mehreren Jahren durchaus bis zu 30 Minuten dauern. Die openWB in dieser Zeit bitte nicht herunterfahren! Du erhältst eine Meldung, wenn die Datenübernahme abgeschlossen ist.",-1),s("br",null,null,-1),o(" Vor der Datenübernahme unbedingt eine Sicherung erstellen.",-1),s("br",null,null,-1),o(" Die Datenübernahme kann nur durch Einspielen einer Sicherung rückgängig gemacht werden! ",-1)])]),_:1}),s("div",je,[s("div",Ee,[s("div",Re,[t(v,{icon:["fas","file-archive"]})])]),s("div",Ue,[s("input",{id:"data-migration-file",type:"file",class:"custom-file-input",accept:".tar.gz,application/gzip,application/tar+gzip",onChange:e[17]||(e[17]=a=>u.updateSelectedDataMigrationFile(a))},null,32),s("label",qe,f(l.selectedDataMigrationFile?l.selectedDataMigrationFile.name:"Bitte eine Datei auswählen"),1)]),s("div",xe,[s("button",{class:W(["btn",l.selectedDataMigrationFile?"btn-success clickable":"btn-outline-success"]),disabled:!l.selectedDataMigrationFile,type:"button",onClick:e[18]||(e[18]=a=>u.uploadDataMigrationFile())},[e[46]||(e[46]=o(" Hochladen ",-1)),t(v,{icon:["fas","upload"]})],10,$e)])]),t(b,null,{default:i(()=>[...e[47]||(e[47]=[o(" Zuordnung der Komponenten ",-1)])]),_:1}),(d(!0),g(M,null,z(l.dataMigrationConfig,a=>(d(),g("div",{key:a.sectionName},[t(b,null,{default:i(()=>[o(f(a.sectionName),1)]),_:2},1024),(d(!0),g(M,null,z(a.sectionComponents,_=>(d(),h(F,{key:_.key,modelValue:l.dataMigrationMapping[_.key],"onUpdate:modelValue":$=>l.dataMigrationMapping[_.key]=$,title:_.label,options:u.getMigrationOptions(_.validTypes)},V({_:2},[_.help?{name:"help",fn:i(()=>[o(f(_.help),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","title","options"]))),128))]))),128)),s("div",He,[s("div",Ne,[t(D,{class:W(l.dataMigrationUploadDone?"btn-success clickable":"btn-outline-success"),disabled:!l.dataMigrationUploadDone,onButtonClicked:e[19]||(e[19]=a=>u.dataMigration())},{default:i(()=>[e[48]||(e[48]=o(" Datenübernahme starten ",-1)),t(v,{icon:["fas","box-open"]})]),_:1},8,["class","disabled"])])])])]),_:1})):k("",!0),r.installAssistantActive?k("",!0):(d(),g("form",Ke,[t(S,{title:"Zurücksetzen",subtype:"danger",collapsible:!0,collapsed:!0},{footer:i(()=>[s("div",Ie,[s("div",Ge,[t(D,{class:"btn-danger clickable",onButtonClicked:e[20]||(e[20]=a=>u.factoryReset())},{default:i(()=>[t(v,{icon:["fas","skull-crossbones"]}),e[50]||(e[50]=o(" Zurücksetzen ",-1)),t(v,{icon:["fas","skull-crossbones"]})]),_:1})])])]),default:i(()=>[t(c,{subtype:"danger"},{default:i(()=>[...e[49]||(e[49]=[o(" Alle Einstellungen, angelegte Geräte/Komponenten, Ladepunkte und Fahrzeuge, etc., Tages-, Monats- und Jahresauswertungen sowie das Ladeprotokoll werden unwiederbringlich gelöscht. Auch die Vorkonfiguration im Auslieferungszustand wird gelöscht. Die openWB muss danach komplett neu eingerichtet werden. Die openWB wird hierfür automatisch neu gestartet. Bitte erstelle vor dem Zurücksetzen eine Sicherung! ",-1)])]),_:1})]),_:1})])),r.installAssistantActive?k("",!0):(d(),g("form",Je,[t(S,{title:"Monitoring",subtype:"success",collapsible:!0,collapsed:!0},V({default:i(()=>[n.$store.state.mqtt["openWB/general/extern"]===!0?(d(),h(c,{key:0,subtype:"info"},{default:i(()=>[...e[51]||(e[51]=[o(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ',-1)])]),_:1})):(d(),g("div",Ze,[t(c,{subtype:"info"},{default:i(()=>[...e[52]||(e[52]=[o(" Das Monitoring informiert Dich sofort per E-Mail, wenn eine Deiner Komponenten oder Ladepunkte ein Problem hat oder die openWB nicht mehr erreichbar ist. ",-1)])]),_:1}),t(F,{class:"mb-2",title:"Anbieter",options:u.monitoringList,"model-value":n.$store.state.mqtt["openWB/optional/monitoring/config"]?n.$store.state.mqtt["openWB/optional/monitoring/config"].type:"","onUpdate:modelValue":e[21]||(e[21]=a=>u.updateSelectedMonitoring(a))},null,8,["options","model-value"]),n.$store.state.mqtt["openWB/optional/monitoring/config"]&&n.$store.state.mqtt["openWB/optional/monitoring/config"].type?(d(),g("div",Qe,[t(x,{monitoring:n.$store.state.mqtt["openWB/optional/monitoring/config"],"onUpdate:configuration":e[22]||(e[22]=a=>u.updateConfiguration("openWB/optional/monitoring/config",a))},null,8,["monitoring"])])):k("",!0)]))]),_:2},[n.$store.state.mqtt["openWB/general/extern"]!==!0?{name:"footer",fn:i(()=>[t(O,{"form-name":"monitoringForm","hide-defaults":!0,"save-id":"saveMonitoring",onSave:e[23]||(e[23]=a=>n.$emit("save")),onReset:e[24]||(e[24]=a=>n.$emit("reset"))})]),key:"0"}:void 0]),1024)]))])):k("",!0)])}const Ye=C(be,[["render",Xe],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/DataManagement.vue"]]),sn=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));export{Q as B,Ye as D,re as M,sn as a};
