import{E as I}from"./GeneralChargeConfig-81572382.js";import{_ as S,l as o,m as c,A as u,p as k,u as s,x as w,D as N,E as a,B as f,F as V,G as r,y as C,z as B,N as x,M as $,I as q,S as z}from"./vendor-cc4615be.js";import{l as T,d as F,ab as O,F as U}from"./vendor-fortawesome-82b7eff7.js";import"./index-6c827446.js";import"./vendor-bootstrap-09a7ccd9.js";import"./vendor-jquery-13cad4c1.js";import"./vendor-axios-3dcaeec5.js";import"./vendor-sortablejs-7c09d6dd.js";import"./dynamic-import-helper-be004503.js";const H={name:"TimeRow"},W={class:"w-100"},A={class:"form-row align-items-center"},D={class:"col-10"},Q={class:"form-row"},Z={class:"col-6"},M={class:"col-6"},P={class:"col-2 text-right"};function K(t,e,p,v,g,n){return o(),c("div",W,[u("div",A,[u("div",D,[u("div",Q,[u("div",Z,[k(t.$slots,"start")]),u("div",M,[k(t.$slots,"end")])])]),u("div",P,[k(t.$slots,"action")])])])}const R=S(H,[["render",K],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/fixed_hours/TimeRow.vue"]]);T.add(F);T.add(O);const L={name:"TimeTable",components:{FontAwesomeIcon:U,TimeRow:R},inheritAttrs:!1,props:{title:{type:String,required:!0,default:"#TITLE#"},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],data(){return{endOptions:this.modelValue.map(()=>this.generateTimeOptions("01:00","24:00"))}},computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{generateTimeOptions(t,e){const p=[],v=parseInt(t.split(":")[0],10),g=parseInt(e.split(":")[0],10);for(let n=v;n<=g;n++){const d=`${n.toString().padStart(2,"0")}:00`;p.push({value:d,text:d})}return p},addTime(){this.value.push(["",""])},removeTime(t){this.value.splice(t,1)},updateEndOptions(t){const e=this.value[t][0];if(e){const v=(parseInt(e.split(":")[0],10)+1).toString().padStart(2,"0")+":00";this.endOptions[t]=this.generateTimeOptions(v,"24:00")}else this.endOptions[t]=this.generateTimeOptions("01:00","24:00")}}},j={key:0,class:"w-100 alert alert-danger"},G=["onUpdate:modelValue","onChange"],J=["value"],X=["onUpdate:modelValue"],Y=["value"];function ee(t,e,p,v,g,n){const m=s("font-awesome-icon"),d=s("openwb-base-avatar"),h=s("time-row"),y=s("openwb-base-setting-element");return o(),w(y,null,N({title:a(()=>[k(t.$slots,"title",{},()=>[f(V(p.title),1)])]),default:a(()=>[r(h,null,{start:a(()=>e[0]||(e[0]=[f(" Beginn ",-1)])),end:a(()=>e[1]||(e[1]=[f(" Ende ",-1)])),action:a(()=>[r(d,{class:"bg-success clickable",title:"Zeitbereich hinzufügen",onClick:C(n.addTime,["stop"])},{default:a(()=>[r(m,{icon:["fas","plus"]})]),_:1},8,["onClick"])]),_:1}),n.value.length===0?(o(),c("div",j," Keine Zeitbereiche definiert! ")):B("",!0),(o(!0),c(x,null,$(n.value,(_,b)=>(o(),w(h,{key:b},{start:a(()=>[q(u("select",{"onUpdate:modelValue":i=>_[0]=i,class:"form-control",required:"",onChange:i=>n.updateEndOptions(b)},[e[2]||(e[2]=u("option",{value:"",disabled:""}," -- Bitte auswählen -- ",-1)),(o(!0),c(x,null,$(n.generateTimeOptions("00:00","23:00"),i=>(o(),c("option",{key:i.value,value:i.value},V(i.text),9,J))),128))],40,G),[[z,_[0]]])]),end:a(()=>[q(u("select",{"onUpdate:modelValue":i=>_[1]=i,class:"form-control",required:""},[e[3]||(e[3]=u("option",{value:"",disabled:""}," -- Bitte auswählen -- ",-1)),(o(!0),c(x,null,$(g.endOptions[b],i=>(o(),c("option",{key:i.value,value:i.value},V(i.text),9,Y))),128))],8,X),[[z,_[1]]])]),action:a(()=>[n.value.length>1?(o(),w(d,{key:0,class:"bg-danger clickable",title:"Zeitbereich entfernen",onClick:C(i=>n.removeTime(b),["stop"])},{default:a(()=>[r(m,{icon:["fas","trash"]})]),_:2},1032,["onClick"])):B("",!0)]),_:2},1024))),128))]),_:2},[t.$slots.help?{name:"help",fn:a(()=>[k(t.$slots,"help")]),key:"0"}:void 0]),1024)}const te=S(L,[["render",ee],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/fixed_hours/TimeTable.vue"]]);T.add(F);T.add(O);const ne={name:"FixedTariff",components:{FontAwesomeIcon:U,TimeTable:te},props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","delete"],computed:{tariff:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},dates:{get(){return this.tariff.active_times.dates.map(([t,e])=>`${t};${e}`)},set(t){this.tariff.active_times.dates=t.map(e=>e.split(";"))}}}};function ae(t,e,p,v,g,n){const m=s("font-awesome-icon"),d=s("openwb-base-avatar"),h=s("openwb-base-text-input"),y=s("openwb-base-number-input"),_=s("openwb-base-select-input"),b=s("time-table"),i=s("openwb-base-card");return o(),w(i,{subtype:"info",collapsible:!0},{header:a(()=>[f(V(n.tariff.name),1)]),actions:a(()=>[r(d,{class:"bg-danger clickable",onClick:e[0]||(e[0]=l=>t.$emit("delete"))},{default:a(()=>[r(m,{icon:["fas","trash"]})]),_:1})]),default:a(()=>[r(h,{modelValue:n.tariff.name,"onUpdate:modelValue":e[1]||(e[1]=l=>n.tariff.name=l),title:"Tarifname"},null,8,["modelValue"]),r(y,{title:"Preis",min:0,step:.1,precision:1,required:"",unit:"ct/kWh","model-value":n.tariff.price*100,"onUpdate:modelValue":e[2]||(e[2]=l=>n.tariff.price=parseFloat((l/100).toFixed(3)))},null,8,["model-value"]),r(_,{modelValue:n.dates,"onUpdate:modelValue":e[3]||(e[3]=l=>n.dates=l),title:"Quartale",required:"",multiple:"",options:[{value:"01-01;31-03",text:"1. Quartal"},{value:"01-04;30-06",text:"2. Quartal"},{value:"01-07;30-09",text:"3. Quartal"},{value:"01-10;31-12",text:"4. Quartal"}]},null,8,["modelValue"]),r(b,{modelValue:n.tariff.active_times.times,"onUpdate:modelValue":e[4]||(e[4]=l=>n.tariff.active_times.times=l),title:"Aktive Zeiten"},null,8,["modelValue"])]),_:1})}const ie=S(ne,[["render",ae],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/fixed_hours/FixedTariff.vue"]]);T.add(F);T.add(O);const se={name:"ElectricityTariffFixedHours",components:{FontAwesomeIcon:U,FixedTariff:ie},mixins:[I],computed:{value:{get(){return this.electricityTariff},set(t){console.log("set",t),this.updateConfiguration(t)}}},methods:{addTariff(){this.value.configuration.tariffs.push({name:"Neuer Tarif",price:0,active_times:{dates:[],times:[["",""]]}})},removeTariff(t){this.value.configuration.tariffs.splice(t,1)}}},oe={class:"electricity-tariff-fixed-hours"};function re(t,e,p,v,g,n){const m=s("openwb-base-alert"),d=s("openwb-base-number-input"),h=s("font-awesome-icon"),y=s("openwb-base-avatar"),_=s("openwb-base-heading"),b=s("fixed-tariff");return o(),c("div",oe,[r(m,{subtype:"info"},{default:a(()=>e[1]||(e[1]=[f(" Konfiguriert feste Tarifzeiten, z.b. HT, NT und Standardpreis. ",-1)])),_:1,__:[1]}),r(d,{title:"Standardpreis",min:0,step:.1,precision:1,required:"",unit:"ct/kWh","model-value":n.value.configuration.default_price*100,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value.configuration.default_price=parseFloat((i/100).toFixed(3)))},{help:a(()=>e[2]||(e[2]=[f(" Standardpreis sofern kein anderer Tarif aktiv ist. ",-1)])),_:1},8,["model-value"]),e[5]||(e[5]=u("hr",null,null,-1)),r(_,null,{actions:a(()=>[r(y,{class:"bg-success clickable",onClick:C(n.addTariff,["stop"])},{default:a(()=>[r(h,{icon:["fas","plus"]})]),_:1},8,["onClick"])]),default:a(()=>[e[3]||(e[3]=f(" Tarife ",-1))]),_:1,__:[3]}),n.value.configuration.tariffs.length===0?(o(),w(m,{key:0,subtype:"info"},{default:a(()=>e[4]||(e[4]=[f(" Es wurde noch kein Tarif konfiguriert. Klicken Sie auf das Plus-Symbol um einen neuen Tarif hinzuzufügen.",-1),u("br",null,null,-1),f(" Tarife ermöglichen es unterschiedliche Preise für unterschiedliche Zeiten zu definieren. ",-1)])),_:1,__:[4]})):B("",!0),(o(!0),c(x,null,$(n.value.configuration.tariffs,(i,l)=>(o(),w(b,{key:l,"model-value":i,"onUpdate:modelValue":E=>n.value.configuration.tariffs[l]=E,onDelete:E=>n.removeTariff(l)},null,8,["model-value","onUpdate:modelValue","onDelete"]))),128))])}const ve=S(se,[["render",re],["__scopeId","data-v-aa5a711c"],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/fixed_hours/electricity_tariff.vue"]]);export{ve as default};
