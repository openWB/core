const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/io_device-CZtvKDQw.js","assets/index-BFYuTgoH.js","assets/vendor-BoRpwYSS.js","assets/vendor-sortablejs-B7wL87hN.js","assets/vendor-D1GV4U4l.css","assets/vendor-fortawesome-CaZSeuAc.js","assets/vendor-bootstrap-C_iHcwa3.js","assets/vendor-jquery-CEMonh9Y.js","assets/vendor-bootstrap-Ct-dCSDz.css","assets/vendor-axios-B0SCfrz2.js","assets/index-BqSnybEn.css","assets/dynamic-import-helper-BheWnx7M.js","assets/io_device-CrjH9rx4.js","assets/io_device-Bsob9EW0.js","assets/io_action-BZVtMbXa.js","assets/OpenwbIoSinglePattern-B8WLkVTb.js","assets/io_action-Bs5W8yHg.js","assets/io_action-DAk-kvVP.js","assets/OpenwbIoPattern-D-ke8pKI.js","assets/OpenwbIoPattern-01UVkHjE.css","assets/io_action-EJchjx26.js"])))=>i.map(i=>d[i]);
import{F as q,l as L,af as U}from"./vendor-fortawesome-CaZSeuAc.js";import{_ as D,C as W}from"./index-BFYuTgoH.js";import{_ as E}from"./dynamic-import-helper-BheWnx7M.js";import{_ as I,m as r,f as m,l as i,z as f,y as n,D as u,K as g,x as s,u as _,a2 as j,q as h,L as C,M as B,a3 as T}from"./vendor-BoRpwYSS.js";const F={props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(o,e=void 0){this.$emit("update:configuration",{value:o,object:e})},sendSystemCommand(o,e){this.$emit("sendCommand",{command:o,data:e})}}},$=I(F,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigMixin.vue"]]),N={name:"OpenwbIoDeviceConfigFallback",mixins:[$]},R={class:"io-device-config-fallback"},z={key:1};function G(o,e,l,A,d,t){const c=r("openwb-base-alert"),y=r("openwb-base-textarea");return i(),m("div",R,[Object.keys(o.ioDevice.configuration).length==0?(i(),f(c,{key:0,subtype:"info"},{default:n(()=>[u(' Das I/O-Modul "'+g(o.ioDevice.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(i(),m("div",z,[s(c,{subtype:"warning"},{default:n(()=>[u(' Es wurde keine Konfigurationsseite für das I/O-Modul "'+g(o.ioDevice.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),s(y,{title:"Konfiguration",subtype:"json","model-value":o.ioDevice.configuration,"onUpdate:modelValue":e[0]||(e[0]=b=>o.updateConfiguration(b,"configuration"))},{help:n(()=>[...e[1]||(e[1]=[u(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),s(c,{subtype:"info"},{default:n(()=>[_("pre",null,g(JSON.stringify(o.ioDevice.configuration,void 0,2)),1)]),_:1})]))])}const J=I(N,[["render",G],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigFallback.vue"]]),H={name:"OpenwbIoDeviceProxy",props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){return console.debug(`loading io device: ${this.ioDevice.type}`),j({loader:()=>E(Object.assign({"./add_on/io_device.vue":()=>D(()=>import("./io_device-CZtvKDQw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),"./dimm_kit/io_device.vue":()=>D(()=>import("./io_device-CrjH9rx4.js"),__vite__mapDeps([12,2,3,4,5,1,6,7,8,9,10,11])),"./eebus/io_device.vue":()=>D(()=>import("./io_device-Bsob9EW0.js"),__vite__mapDeps([13,2,3,4,5,1,6,7,8,9,10,11]))}),`./${this.ioDevice.type}/io_device.vue`,3),errorComponent:J})},outputs(){const o=[];if(this.ioDevice.output){if(this.ioDevice.output.analog)for(const e in this.ioDevice.output.analog)o.push(`openWB/set/system/io/${this.ioDevice.id}/set/manual/analog_output/${e}`);if(this.ioDevice.output.digital)for(const e in this.ioDevice.output.digital)o.push(`openWB/set/system/io/${this.ioDevice.id}/set/manual/digital_output/${e}`)}return o}},methods:{updateConfiguration(o){this.$emit("update:configuration",o)},sendCommand(o){this.$emit("sendCommand",o)}}};function Q(o,e,l,A,d,t){const c=r("openwb-base-heading"),y=r("openwb-base-copy-to-clipboard"),b=r("openwb-base-alert");return i(),m("div",null,[s(c,null,{default:n(()=>[u(' Einstellungen für I/O-Modul "'+g(l.ioDevice.name)+'" ',1)]),_:1}),t.outputs.length?(i(),f(b,{key:0,subtype:"info"},{default:n(()=>[e[2]||(e[2]=u(" Die Ausgänge können über die folgenden Topics manuell per MQTT geschaltet werden. Falls Ausgänge in Aktionen konfiguriert werden, überschreibt das manuelle Setzen den Status. ",-1)),_("ul",null,[(i(!0),m(C,null,B(t.outputs,v=>(i(),m("li",{key:v},[s(y,{class:"text-info",tooltip:"Topic kopieren"},{default:n(()=>[u(g(v),1)]),_:2},1024)]))),128))]),e[3]||(e[3]=u(" Als Wert wird ein boolean als json oder 0/1 akzeptiert.",-1)),e[4]||(e[4]=_("br",null,null,-1)),e[5]||(e[5]=u(" Beispiel: ",-1)),e[6]||(e[6]=_("span",{class:"text-info"},"false",-1))]),_:1})):h("",!0),(i(),f(T(t.myComponent),{"io-device":l.ioDevice,"onUpdate:configuration":e[0]||(e[0]=v=>t.updateConfiguration(v)),onSendCommand:e[1]||(e[1]=v=>t.sendCommand(v))},null,40,["io-device"]))])}const X=I(H,[["render",Q],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceProxy.vue"]]),Y={mixins:[W],props:{ioAction:{type:Object,required:!0},ioDevice:{type:Object,required:!0},availableChargePoints:{type:Array,required:!1,default:()=>[]},availableComponents:{type:Array,required:!1,default:()=>[]},availableIoDevices:{type:Array,required:!1,default:()=>[]}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(o,e=void 0){this.$emit("update:configuration",{value:o,object:e})}}},Z=I(Y,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigMixin.vue"]]),K={name:"OpenwbIoActionConfigFallback",mixins:[Z]},ee={class:"io-action-config-fallback"},oe={key:1};function te(o,e,l,A,d,t){const c=r("openwb-base-alert"),y=r("openwb-base-textarea");return i(),m("div",ee,[Object.keys(o.ioAction?.configuration).length==0?(i(),f(c,{key:0,subtype:"info"},{default:n(()=>[u(' Die I/O-Aktion "'+g(o.ioAction?.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(i(),m("div",oe,[s(c,{subtype:"warning"},{default:n(()=>[u(' Es wurde keine Konfigurationsseite für die I/O-Aktion "'+g(o.ioAction?.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),s(y,{title:"Konfiguration",subtype:"json","model-value":o.ioAction?.configuration,"onUpdate:modelValue":e[0]||(e[0]=b=>o.updateConfiguration(b,"configuration"))},{help:n(()=>[...e[1]||(e[1]=[u(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),s(c,{subtype:"info"},{default:n(()=>[_("pre",null,g(JSON.stringify(o.ioAction?.configuration,void 0,2)),1)]),_:1})]))])}const ne=I(K,[["render",te],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigFallback.vue"]]),ie={name:"OpenwbIoActionProxy",props:{ioAction:{type:Object,required:!0},ioDevices:{type:Object,required:!0},installedChargePoints:{type:Object,required:!0},installedComponents:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){return console.debug(`loading io action: ${this.ioAction?.group} / ${this.ioAction?.type}`),j({loader:()=>E(Object.assign({"./controllable_consumers/dimming/io_action.vue":()=>D(()=>import("./io_action-BZVtMbXa.js"),__vite__mapDeps([14,15,2,3,4,5,1,6,7,8,9,10,11])),"./controllable_consumers/dimming_direct_control/io_action.vue":()=>D(()=>import("./io_action-Bs5W8yHg.js"),__vite__mapDeps([16,15,2,3,4,5,1,6,7,8,9,10,11])),"./controllable_consumers/ripple_control_receiver/io_action.vue":()=>D(()=>import("./io_action-DAk-kvVP.js"),__vite__mapDeps([17,18,5,2,3,4,19,1,6,7,8,9,10,11])),"./generator_systems/stepwise_control/io_action.vue":()=>D(()=>import("./io_action-EJchjx26.js"),__vite__mapDeps([20,18,5,2,3,4,19,1,6,7,8,9,10,11]))}),`./${this.ioAction?.group}/${this.ioAction?.type}/io_action.vue`,4),errorComponent:ne})},ioDeviceList(){return Object.keys(this.ioDevices).map(o=>({value:this.ioDevices[o]?.id,text:this.ioDevices[o]?.name}))},availableIoDevices(){return Object.values(this.ioDevices)},availableChargePoints(){return Object.values(this.installedChargePoints).map(o=>({value:o?.id,text:o?.name}))},availableComponents(){return Object.values(this.installedComponents).map(o=>({value:o?.id,text:o?.name,type:o?.type}))}},methods:{updateConfiguration(o,e=void 0){e?this.$emit("update:configuration",{value:o,object:e}):this.$emit("update:configuration",o)},updateIoDevice(o){if(this.updateConfiguration(o,"configuration.io_device"),Array.isArray(this.ioAction.configuration?.input_pattern)){let e=this.ioAction.configuration.input_pattern.map(l=>({value:l.value,matrix:{}}));this.updateConfiguration(e,"configuration.input_pattern")}Object.prototype.hasOwnProperty.call(this.ioAction.configuration,"digital_input")&&this.updateConfiguration(null,"configuration.digital_input")}}},ae={key:0};function se(o,e,l,A,d,t){const c=r("openwb-base-heading"),y=r("openwb-base-select-input");return i(),m(C,null,[s(c,null,{default:n(()=>[u(' Einstellungen für I/O-Aktion "'+g(l.ioAction?.name)+'" ',1)]),_:1}),s(y,{title:"Eingangs-Gerät","not-selected":"Bitte auswählen","empty-value":null,required:"",options:t.ioDeviceList,"model-value":l.ioAction?.configuration.io_device,"onUpdate:modelValue":e[0]||(e[0]=b=>t.updateIoDevice(b))},{help:n(()=>[...e[2]||(e[2]=[u(" Bitte das Gerät auswählen, über das der Schaltbefehl empfangen werden soll. Für jede Aktion kann nur ein Gerät ausgewählt werden. ",-1)])]),_:1},8,["options","model-value"]),l.ioAction?.configuration.io_device!==null?(i(),m("div",ae,[e[3]||(e[3]=_("hr",null,null,-1)),(i(),f(T(t.myComponent),{"io-action":l.ioAction,"io-device":l.ioDevices[`openWB/system/io/${l.ioAction.configuration.io_device}/config`],"available-charge-points":t.availableChargePoints,"available-components":t.availableComponents,"available-io-devices":t.availableIoDevices,"onUpdate:configuration":e[1]||(e[1]=b=>t.updateConfiguration(b))},null,40,["io-action","io-device","available-charge-points","available-components","available-io-devices"]))])):h("",!0)],64)}const le=I(ie,[["render",se],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionProxy.vue"]]);L.add(U);const re={name:"OpenwbIoConfigView",components:{FontAwesomeIcon:q,OpenwbIoDeviceProxy:X,OpenwbIoActionProxy:le},mixins:[W],props:{installAssistantActive:{type:Boolean,required:!1,default:!1}},emits:["save","reset","defaults","send-command"],data(){return{mqttTopicsToSubscribe:["openWB/system/configurable/io_devices","openWB/system/io/+/config","openWB/system/configurable/io_actions","openWB/io/action/+/config","openWB/chargepoint/+/config","openWB/system/device/+/component/+/config"],mqttTopicsToPublish:["openWB/system/io/+/config","openWB/io/action/+/config"],showIoDeviceDeleteModal:!1,modalIoDeviceIndex:void 0,ioDeviceToAdd:void 0,showIoActionDeleteModal:!1,modalIoActionIndex:void 0,ioActionToAdd:void 0}},computed:{ioDeviceList:{get(){return this.$store.state.mqtt["openWB/system/configurable/io_devices"]}},installedIoDevices:{get(){return this.getWildcardTopics("openWB/system/io/+/config")}},ioActionList:{get(){return this.$store.state.mqtt["openWB/system/configurable/io_actions"]===void 0?[]:Object.entries(this.$store.state.mqtt["openWB/system/configurable/io_actions"]).map(([o,e])=>({label:e.group_name,options:e.actions.map(l=>({value:[o,l.value],text:l.text})).sort((l,A)=>l.text.localeCompare(A.text))})).sort((o,e)=>o.label.localeCompare(e.label))}},installedIoActions:{get(){return this.getWildcardTopics("openWB/io/action/+/config")}},installedChargePoints:{get(){return this.getWildcardTopics("openWB/chargepoint/+/config")}},installedComponents:{get(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")}}},methods:{getIoDeviceName(o){return this.$store.state.mqtt["openWB/system/io/"+o+"/config"]?this.$store.state.mqtt["openWB/system/io/"+o+"/config"].name:"I/O-Gerät "+o},addIoDevice(){this.sendSystemCommand("addIoDevice",{type:this.ioDeviceToAdd})},removeIoDeviceModal(o,e){e.stopPropagation(),this.modalIoDeviceIndex=parseInt(o.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoDeviceDeleteModal=!0},removeIoDevice(o,e){this.showIoDeviceDeleteModal=!1,e=="confirm"&&this.sendSystemCommand("removeIoDevice",{id:o})},addIoAction(){this.sendSystemCommand("addIoAction",{type:this.ioActionToAdd})},removeIoActionModal(o,e){e.stopPropagation(),this.modalIoActionIndex=parseInt(o.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoActionDeleteModal=!0},removeIoAction(o,e){this.showIoActionDeleteModal=!1,e=="confirm"&&this.sendSystemCommand("removeIoAction",{id:o})},sendSystemCommand(o,e){this.$emit("send-command",{command:o,data:e})},updateConfiguration(o,e){console.debug("updateConfiguration",o,e),this.updateState(o,e.value,e.object)}}},ue={class:"ioConfig"},de={name:"ioConfigForm"},ce={key:0},pe={key:0};function me(o,e,l,A,d,t){const c=r("openwb-base-modal-dialog"),y=r("font-awesome-icon"),b=r("openwb-base-avatar"),v=r("openwb-base-text-input"),M=r("openwb-io-device-proxy"),k=r("openwb-base-card"),x=r("openwb-base-select-input"),P=r("openwb-io-action-proxy"),V=r("openwb-base-alert"),S=r("openwb-base-submit-buttons");return i(),m(C,null,[s(c,{show:d.showIoDeviceDeleteModal,title:"Modul löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[0]||(e[0]=a=>t.removeIoDevice(d.modalIoDeviceIndex,a))},{default:n(()=>[u(' Willst Du das Ein-/Ausgangs-Gerät "'+g(t.getIoDeviceName(d.modalIoDeviceIndex))+'" (ID: '+g(d.modalIoDeviceIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),s(c,{show:d.showIoActionDeleteModal,title:"Aktion löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[1]||(e[1]=a=>t.removeIoAction(d.modalIoActionIndex,a))},{default:n(()=>[u(' Willst Du die Aktion "'+g(t.getIoDeviceName(d.modalIoActionIndex))+'" (ID: '+g(d.modalIoActionIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),_("div",ue,[_("form",de,[s(k,{title:"Ein-/Ausgangs-Geräte"},{default:n(()=>[(i(!0),m(C,null,B(t.installedIoDevices,(a,w)=>(i(),f(k,{key:w,title:a?.name+" (ID: "+a?.id+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:n(p=>[p.collapsed?h("",!0):(i(),f(b,{key:0,class:"bg-danger clickable",onClick:O=>t.removeIoDeviceModal(w,O)},{default:n(()=>[s(y,{icon:["fas","trash"]})]),_:1},8,["onClick"]))]),default:n(()=>[s(v,{title:"Bezeichnung",subtype:"text","model-value":a.name,"onUpdate:modelValue":p=>o.updateState(w,p,"name")},null,8,["model-value","onUpdate:modelValue"]),s(v,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":o.$store.state.mqtt[w].type},null,8,["model-value"]),e[8]||(e[8]=_("hr",null,null,-1)),s(M,{"io-device":a,"onUpdate:configuration":p=>t.updateConfiguration(w,p),onSendCommand:e[2]||(e[2]=p=>t.sendSystemCommand(p.command,p.data))},null,8,["io-device","onUpdate:configuration"])]),_:2},1032,["title"]))),128)),Object.keys(t.installedIoDevices).length>0?(i(),m("hr",ce)):h("",!0),s(x,{title:"Verfügbare Geräte","not-selected":"Bitte auswählen",options:t.ioDeviceList,"model-value":d.ioDeviceToAdd,"add-button":!0,"onUpdate:modelValue":e[3]||(e[3]=a=>d.ioDeviceToAdd=a),"onInput:add":t.addIoDevice},{help:n(()=>[...e[9]||(e[9]=[u(" Bitte ein Ein-/Ausgangs-Modul auswählen, das hinzugefügt werden soll. ",-1)])]),_:1},8,["options","model-value","onInput:add"])]),_:1}),s(k,{title:"Ein-/Ausgangs-Aktionen"},{default:n(()=>[(i(!0),m(C,null,B(t.installedIoActions,(a,w)=>(i(),f(k,{key:w,title:a?.name+" (ID: "+a?.id+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:n(p=>[p.collapsed?h("",!0):(i(),f(b,{key:0,class:"bg-danger clickable",onClick:O=>t.removeIoActionModal(w,O)},{default:n(()=>[s(y,{icon:["fas","trash"]})]),_:1},8,["onClick"]))]),default:n(()=>[s(v,{title:"Bezeichnung",subtype:"text","model-value":a?.name,"onUpdate:modelValue":p=>o.updateState(w,p,"name")},null,8,["model-value","onUpdate:modelValue"]),s(v,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":[a?.group,a?.type].join(" / ")},null,8,["model-value"]),e[10]||(e[10]=_("hr",null,null,-1)),a!==void 0?(i(),f(P,{key:0,"io-action":a,"io-devices":t.installedIoDevices,"installed-charge-points":t.installedChargePoints,"installed-components":t.installedComponents,"onUpdate:configuration":p=>t.updateConfiguration(w,p)},null,8,["io-action","io-devices","installed-charge-points","installed-components","onUpdate:configuration"])):h("",!0)]),_:2},1032,["title"]))),128)),Object.keys(t.installedIoActions).length>0?(i(),m("hr",pe)):h("",!0),Object.keys(t.installedIoDevices).length>0?(i(),f(x,{key:1,title:"Verfügbare Aktionen","not-selected":"Bitte auswählen",groups:t.ioActionList,"model-value":d.ioActionToAdd,"add-button":!0,"onUpdate:modelValue":e[4]||(e[4]=a=>d.ioActionToAdd=a),"onInput:add":t.addIoAction},{help:n(()=>[...e[11]||(e[11]=[u(" Bitte eine Ein-/Ausgangs-Aktion auswählen, die hinzugefügt werden soll. ",-1)])]),_:1},8,["groups","model-value","onInput:add"])):(i(),f(V,{key:2,subtype:"warning"},{default:n(()=>[...e[12]||(e[12]=[u(" Keine Ein-/Ausgangs-Geräte vorhanden!",-1),_("br",null,null,-1),u(" Bitte füge zuerst ein Ein-/Ausgangs-Gerät hinzu, bevor Du Aktionen konfigurierst. ",-1)])]),_:1}))]),_:1}),s(S,{"form-name":"ioConfigForm",onSave:e[5]||(e[5]=a=>o.$emit("save",d.mqttTopicsToPublish)),onReset:e[6]||(e[6]=a=>o.$emit("reset")),onDefaults:e[7]||(e[7]=a=>o.$emit("defaults"))})])])],64)}const ge=I(re,[["render",me],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/IoConfiguration.vue"]]),ye=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as I,$ as O,Z as a,ye as b};
