import{C as $}from"./index-2eee0632.js";import{_ as w,u as p,l as o,m as s,A as l,G as a,E as i,B as r,z as c,N as k,M as B,F as f}from"./vendor-25d394b4.js";import"./vendor-fortawesome-a02b6813.js";import"./vendor-bootstrap-374cd88e.js";import"./vendor-jquery-3364d39b.js";import"./vendor-axios-ac33d60c.js";import"./vendor-sortablejs-0eb84ec8.js";const y={name:"IdentificationConfigView",mixins:[$],emits:["save","reset","defaults"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/chargepoint/+/config","openWB/chargepoint/+/get/rfid","openWB/chargepoint/+/get/vehicle_id","openWB/chargepoint/+/get/rfid_timestamp","openWB/chargepoint/+/set/rfid","openWB/optional/rfid/active","openWB/chargepoint/+/config","openWB/chargepoint/template/+","openWB/vehicle/template/charge_template/+","openWB/vehicle/+/name","openWB/vehicle/+/charge_template","openWB/vehicle/+/tag_id"],tempIdTagList:{}}},computed:{idTagList(){return Object.values(this.updateIdTagList())},chargePointTemplates:{get(){return this.getWildcardTopics("openWB/chargepoint/template/+")}},vehicleIndexes:{get(){return this.getWildcardIndexList("openWB/vehicle/+/name")}}},methods:{getIdFromTopic(e){return e.match(/(?:\/)([0-9]+)(?=\/)*/g)[0].replace(/[^0-9]+/g,"")},updateIdTagList(){return Object.entries(this.getWildcardTopics("^openWB/chargepoint/[^+/]+/[gs]et/(rfid|vehicle_id)$",!0)).forEach(e=>{e[1]!==null&&(this.tempIdTagList[e[1]]=`${e[1]} (${e[0].includes("/set/")?"zugewiesen":"erfasst"} an ${this.getChargePointName(this.getIdFromTopic(e[0]))})`)}),this.tempIdTagList},getChargePointName(e){return this.$store.state.mqtt["openWB/chargepoint/"+e+"/config"]?this.$store.state.mqtt["openWB/chargepoint/"+e+"/config"].name:"Ladepunkt "+e},getChargePointTemplateIndex(e){return parseInt(e.match(/([^/]+)$/)[0])},getVehicleName(e){return this.$store.state.mqtt["openWB/vehicle/"+e+"/name"]?this.$store.state.mqtt["openWB/vehicle/"+e+"/name"]:"Fahrzeug "+e}}},D={class:"optionalComponents"},L={name:"optionalComponentsForm"},I={key:0},F={key:1},q={key:0},T={key:0},V={key:1},S={key:2},A={key:0},C={key:0},E={key:1},N={key:2},P=["title","collapsed"],U={key:0},j={key:0},O={key:1};function R(e,t,Z,H,J,m){const u=p("openwb-base-alert"),b=p("openwb-base-button-group-input"),W=p("openwb-base-textarea"),v=p("openwb-base-card"),g=p("openwb-base-heading"),_=p("openwb-base-array-input"),z=p("openwb-base-submit-buttons");return o(),s("div",D,[l("form",L,[a(v,{title:"Identifikation"},{default:i(()=>[a(u,{subtype:"info"},{default:i(()=>t[4]||(t[4]=[r(" Die Identifikation kann zum Entsperren von Ladepunkten und/oder zur Zuordnung von Fahrzeugen genutzt werden und kann auf mehreren Wegen erfolgen: ",-1),l("ul",null,[l("li",null,"Über einen RFID-Reader (optional in der openWB verbaut, z.B. anhand des Lieferscheins prüfen)."),l("li",null," Durch die automatische Fahrzeugerkennung der openWB Pro/ Pro+ (in den Einstellungen der openWB Pro aktivieren). "),l("li",null,"Durch manuelle Eingabe einer ID an einer openWB mit Display.")],-1),r(" Bei openWB Pro/Pro+ werden RFID-Tags nur bei angestecktem Fahrzeug erfasst! ",-1)])),_:1,__:[4]}),a(b,{title:"Identifikation aktivieren","model-value":e.$store.state.mqtt["openWB/optional/rfid/active"],buttons:[{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],"onUpdate:modelValue":t[0]||(t[0]=n=>e.updateState("openWB/optional/rfid/active",n))},null,8,["model-value"]),e.$store.state.mqtt["openWB/general/extern"]===!0?(o(),s("div",I,[a(u,{subtype:"info"},{default:i(()=>t[5]||(t[5]=[r(' Weitere Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ',-1)])),_:1,__:[5]})])):(o(),s("div",F,[e.$store.state.mqtt["openWB/optional/rfid/active"]===!0?(o(),s("div",q,[a(W,{title:"Erkannte ID-Tags",readonly:"",disabled:"","model-value":m.idTagList.join(`
`)},null,8,["model-value"])])):c("",!0)]))]),_:1}),a(g,{class:"mt-0"},{default:i(()=>t[6]||(t[6]=[r(" Entsperren von Ladepunkten (gekoppelt an Ladepunkt-Profil) ",-1)])),_:1,__:[6]}),l("div",null,[a(v,{title:"Ladepunkt-Profile",collapsible:!0,collapsed:!0},{default:i(()=>[e.$store.state.mqtt["openWB/general/extern"]===!0?(o(),s("div",T,[a(u,{subtype:"info"},{default:i(()=>t[7]||(t[7]=[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet.',-1),l("br",null,null,-1),r(' Die Konfiguration zum Entsperren von Ladepunkten bitte auf der "primary" openWB durchführen. ',-1)])),_:1,__:[7]})])):e.$store.state.mqtt["openWB/optional/rfid/active"]===!1?(o(),s("div",V,[a(u,{subtype:"info"},{default:i(()=>t[8]||(t[8]=[r(" Diese Einstellungen sind nur verfügbar, wenn Identifikation aktiviert ist. ",-1)])),_:1,__:[8]})])):(o(),s("div",S,[a(u,{subtype:"info"},{default:i(()=>t[9]||(t[9]=[r(" Hier zugeordnete ID-Tags entsperren beim Scannen das jeweilige Ladepunkt-Profil. Der ID-Tag kann an jedem Ladepunkt genutzt werden, dem das entsprechende Ladepunkt-Profil zugeordnet wurde. ",-1)])),_:1,__:[9]}),(o(!0),s(k,null,B(m.chargePointTemplates,(n,d)=>(o(),s("div",{key:d},[a(g,{class:"mt-0"},{default:i(()=>[r(f(n.name),1)]),_:2},1024),e.$store.state.mqtt["openWB/optional/rfid/active"]===!0&&!e.installAssistantActive?(o(),s("div",A,[a(_,{title:"Zugeordnete ID-Tags","no-elements-message":'"'+n.name+'" sind keine ID-Tags zugeordnet.',"model-value":n.valid_tags,"onUpdate:modelValue":h=>e.updateState(d,h,"valid_tags")},null,8,["no-elements-message","model-value","onUpdate:modelValue"])])):c("",!0),a(b,{title:"Sperre nach Abstecken",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":n.disable_after_unplug,"onUpdate:modelValue":h=>e.updateState(d,h,"disable_after_unplug")},{help:i(()=>[r(f('Ist "Sperre nach Abstecken" aktiviert, wird der Ladepunkt mit Ladepunkt-Profil "'+n.name+'" nach Abstecken eines Fahrzeugs automatisch gesperrt. Ist die Funktion deaktiviert, bleibt der Ladepunkt entsperrt.'),1)]),_:2},1032,["model-value","onUpdate:modelValue"]),t[10]||(t[10]=l("br",null,null,-1))]))),128))]))]),_:1})]),a(g,{class:"mt-0"},{default:i(()=>t[11]||(t[11]=[r(" Zuordnung von Fahrzeugen ",-1)])),_:1,__:[11]}),l("div",null,[a(v,{subtype:"info",collapsible:!0,collapsed:e.$route.params.section!="vehicle"},{header:i(()=>t[12]||(t[12]=[r(" Fahrzeuge ",-1)])),default:i(()=>[e.$store.state.mqtt["openWB/general/extern"]===!0?(o(),s("div",C,[a(u,{subtype:"info"},{default:i(()=>t[13]||(t[13]=[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet.',-1),l("br",null,null,-1),r(' Die Konfiguration zur Fahrzeugzuordnung bitte auf der "primary" openWB durchführen. ',-1)])),_:1,__:[13]})])):e.$store.state.mqtt["openWB/optional/rfid/active"]===!1?(o(),s("div",E,[a(u,{subtype:"info"},{default:i(()=>t[14]||(t[14]=[r(" Diese Einstellungen sind nur verfügbar, wenn Identifikation aktiviert ist. ",-1)])),_:1,__:[14]})])):(o(),s("div",N,[a(u,{subtype:"info"},{default:i(()=>t[15]||(t[15]=[r(" Hier zugeordnete ID-Tags weisen dem Ladepunkt beim Scannen automatisch das jeweilige Fahrzeug zu. Ist bei Scannen des ID-Tags noch kein Fahrzeug angeschlossen muss dies zeitnah erfolgen, da der ID-Tag nach 5min verworfen wird. ",-1)])),_:1,__:[15]}),(o(!0),s(k,null,B(m.vehicleIndexes,n=>(o(),s("div",{key:n,title:m.getVehicleName(n),collapsible:!0,collapsed:!(e.$route.params.section=="vehicle"&&parseInt(e.$route.params.section_index)==n),subtype:"info"},[t[16]||(t[16]=l("br",null,null,-1)),a(g,{class:"mt-0"},{default:i(()=>[r(f(e.$store.state.mqtt["openWB/vehicle/"+n+"/name"]),1)]),_:2},1024),e.$store.state.mqtt["openWB/optional/rfid/active"]===!0&&!e.installAssistantActive?(o(),s("div",U,[a(_,{title:"Zugeordnete ID-Tags","no-elements-message":'"'+e.$store.state.mqtt["openWB/vehicle/"+n+"/name"]+'" sind keine ID-Tags zugeordnet.',"model-value":e.$store.state.mqtt["openWB/vehicle/"+n+"/tag_id"],"onUpdate:modelValue":d=>e.updateState("openWB/vehicle/"+n+"/tag_id",d)},null,8,["no-elements-message","model-value","onUpdate:modelValue"])])):c("",!0),a(b,{title:"Standard-Fahrzeug nach Abstecken zuordnen",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":e.$store.state.mqtt["openWB/vehicle/template/charge_template/"+e.$store.state.mqtt["openWB/vehicle/"+n+"/charge_template"]].load_default,"onUpdate:modelValue":d=>e.updateState("openWB/vehicle/template/charge_template/"+e.$store.state.mqtt["openWB/vehicle/"+n+"/charge_template"],d,"load_default")},{help:i(()=>[r(f('Ist diese Option aktiviert, wird am Ladepunkt nach Abstecken auf das Standard-Fahrzeug zurückgesetzt. Die Option ist im Lade-Profil "'+e.$store.state.mqtt["openWB/vehicle/template/charge_template/"+e.$store.state.mqtt["openWB/vehicle/"+n+"/charge_template"]].name+'" gespeichert.')+" ",1),e.$store.state.mqtt["openWB/vehicle/template/charge_template/"+e.$store.state.mqtt["openWB/vehicle/"+n+"/charge_template"]].load_default===!0?(o(),s("div",j,' "Standard-Fahrzeug nach Abstecken" ist für alle Fahrzeuge aktiviert, denen dieses Lade-Profil zugeordnet wurde. ')):(o(),s("div",O,' "Standard-Fahrzeug nach Abstecken" ist für alle Fahrzeuge deaktiviert, denen dieses Lade-Profil zugeordnet wurde. '))]),_:2},1032,["model-value","onUpdate:modelValue"])],8,P))),128))]))]),_:1},8,["collapsed"])]),a(z,{"form-name":"optionalComponentsForm",onSave:t[1]||(t[1]=n=>e.$emit("save")),onReset:t[2]||(t[2]=n=>e.$emit("reset")),onDefaults:t[3]||(t[3]=n=>e.$emit("defaults"))})])])}const ee=w(y,[["render",R],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/IdentificationConfig.vue"]]);export{ee as default};
