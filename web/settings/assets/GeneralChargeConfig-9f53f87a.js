import{_ as c,C as O}from"./index-7731ba98.js";import{_ as L}from"./dynamic-import-helper-be004503.js";import{_ as v,u as a,k as l,l as s,D as n,N as o,y as r,z as w,x as d,a0 as q,A as z,a1 as A,J as M,B as y}from"./vendor-a21b3a62.js";const U={props:{electricityTariff:{type:Object,required:!0}},emits:["update:configuration"],methods:{updateConfiguration(t,e=void 0){this.$emit("update:configuration",{value:t,object:e})}}},D=v(U,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/ElectricityTariffConfigMixin.vue"]]),F={name:"ElectricityTariffConfigFallback",mixins:[D]},N={class:"backup-cloud-fallback"};function I(t,e,g,B,W,p){const u=a("openwb-base-alert"),f=a("openwb-base-textarea");return l(),s("div",N,[n(u,{subtype:"warning"},{default:o(()=>[r(' Es wurde keine Konfigurationsseite für den Anbieter "'+w(t.electricityTariff.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),n(f,{title:"Konfiguration",subtype:"json","model-value":t.electricityTariff.configuration,"onUpdate:modelValue":e[0]||(e[0]=b=>t.updateConfiguration(b,"configuration"))},{help:o(()=>e[1]||(e[1]=[r(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ")])),_:1},8,["model-value"]),n(u,{subtype:"info"},{default:o(()=>[d("pre",null,w(JSON.stringify(t.electricityTariff.configuration,void 0,2)),1)]),_:1})])}const Z=v(F,[["render",I],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/OpenwbElectricityTariffConfigFallback.vue"]]),j={name:"OpenwbElectricityTariffProxy",props:{electricityTariff:{type:Object,required:!0}},emits:["update:configuration"],computed:{myComponent(){return console.debug(`loading electricity tariff cloud: ${this.electricityTariff.type}`),q({loader:()=>L(Object.assign({"./awattar/electricity_tariff.vue":()=>c(()=>import("./electricity_tariff-22a41d6f.js"),["assets/electricity_tariff-22a41d6f.js","assets/vendor-a21b3a62.js","assets/vendor-sortablejs-3016fed8.js","assets/vendor-aab9f734.css","assets/index-7731ba98.js","assets/vendor-fortawesome-41164876.js","assets/vendor-bootstrap-d0c3645c.js","assets/vendor-jquery-a5dbbab1.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-0e6de98a.js","assets/index-b3227821.css","assets/dynamic-import-helper-be004503.js"]),"./energycharts/electricity_tariff.vue":()=>c(()=>import("./electricity_tariff-9cd88804.js"),["assets/electricity_tariff-9cd88804.js","assets/vendor-a21b3a62.js","assets/vendor-sortablejs-3016fed8.js","assets/vendor-aab9f734.css","assets/index-7731ba98.js","assets/vendor-fortawesome-41164876.js","assets/vendor-bootstrap-d0c3645c.js","assets/vendor-jquery-a5dbbab1.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-0e6de98a.js","assets/index-b3227821.css","assets/dynamic-import-helper-be004503.js"]),"./rabot/electricity_tariff.vue":()=>c(()=>import("./electricity_tariff-d3251994.js"),["assets/electricity_tariff-d3251994.js","assets/vendor-a21b3a62.js","assets/vendor-sortablejs-3016fed8.js","assets/vendor-aab9f734.css","assets/index-7731ba98.js","assets/vendor-fortawesome-41164876.js","assets/vendor-bootstrap-d0c3645c.js","assets/vendor-jquery-a5dbbab1.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-0e6de98a.js","assets/index-b3227821.css","assets/dynamic-import-helper-be004503.js"]),"./tibber/electricity_tariff.vue":()=>c(()=>import("./electricity_tariff-55c8df75.js"),["assets/electricity_tariff-55c8df75.js","assets/vendor-a21b3a62.js","assets/vendor-sortablejs-3016fed8.js","assets/vendor-aab9f734.css","assets/index-7731ba98.js","assets/vendor-fortawesome-41164876.js","assets/vendor-bootstrap-d0c3645c.js","assets/vendor-jquery-a5dbbab1.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-0e6de98a.js","assets/index-b3227821.css","assets/dynamic-import-helper-be004503.js"]),"./voltego/electricity_tariff.vue":()=>c(()=>import("./electricity_tariff-322384b0.js"),["assets/electricity_tariff-322384b0.js","assets/vendor-a21b3a62.js","assets/vendor-sortablejs-3016fed8.js","assets/vendor-aab9f734.css","assets/index-7731ba98.js","assets/vendor-fortawesome-41164876.js","assets/vendor-bootstrap-d0c3645c.js","assets/vendor-jquery-a5dbbab1.js","assets/vendor-bootstrap-c4951098.css","assets/vendor-axios-0e6de98a.js","assets/index-b3227821.css","assets/dynamic-import-helper-be004503.js"])}),`./${this.electricityTariff.type}/electricity_tariff.vue`),errorComponent:Z})}},methods:{updateConfiguration(t){this.$emit("update:configuration",t)}}};function R(t,e,g,B,W,p){const u=a("openwb-base-heading");return l(),s(M,null,[n(u,null,{default:o(()=>[r(' Einstellungen für Modul "'+w(g.electricityTariff.name)+'" ',1)]),_:1}),(l(),z(A(p.myComponent),{"electricity-tariff":g.electricityTariff,"onUpdate:configuration":e[0]||(e[0]=f=>p.updateConfiguration(f))},null,40,["electricity-tariff"]))],64)}const G=v(j,[["render",R],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/electricity_tariffs/OpenwbElectricityTariffProxy.vue"]]),J={name:"OpenwbGeneralChargeConfigView",components:{OpenwbElectricityTariffProxy:G},mixins:[O],emits:["save","reset","defaults"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/general/chargemode_config/phase_switch_delay","openWB/general/chargemode_config/retry_failed_phase_switches","openWB/general/chargemode_config/unbalanced_load","openWB/general/chargemode_config/unbalanced_load_limit","openWB/general/prices/bat","openWB/general/prices/grid","openWB/general/prices/pv","openWB/optional/et/provider","openWB/optional/ocpp/config","openWB/system/configurable/electricity_tariffs"]}},computed:{electricityTariffList(){return this.$store.state.mqtt["openWB/system/configurable/electricity_tariffs"]}},methods:{getElectricityTariffDefaultConfiguration(t){const e=this.electricityTariffList.find(g=>g.value==t);return Object.prototype.hasOwnProperty.call(e,"defaults")?{...e.defaults}:(console.warn("no default configuration found for electricity tariff type!",t),{})},updateSelectedElectricityTariff(t){this.updateState("openWB/optional/et/provider",t,"type"),this.updateState("openWB/optional/et/provider",this.getElectricityTariffDefaultConfiguration(t))},updateConfiguration(t,e){console.debug("updateConfiguration",t,e),this.updateState(t,e.value,e.object)}}},x={class:"generalChargeConfig"},H={name:"generalChargeConfigForm"},K={key:0},Q={key:1},X={key:1},Y={key:2},ee={key:0},te={key:1},ne={key:0},ie={key:0};function re(t,e,g,B,W,p){const u=a("openwb-base-alert"),f=a("openwb-base-button-group-input"),b=a("openwb-base-range-input"),k=a("openwb-base-heading"),_=a("openwb-base-number-input"),h=a("openwb-base-card"),C=a("openwb-base-select-input"),E=a("openwb-electricity-tariff-proxy"),V=a("openwb-base-text-input"),T=a("openwb-base-submit-buttons");return l(),s("div",x,[d("form",H,[n(h,{title:"Allgemein"},{default:o(()=>[t.$store.state.mqtt["openWB/general/extern"]===!0?(l(),s("div",K,[n(u,{subtype:"info"},{default:o(()=>e[15]||(e[15]=[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ')])),_:1})])):(l(),s("div",Q,[n(f,{title:"Begrenzung der Schieflast",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load"],"onUpdate:modelValue":e[0]||(e[0]=i=>t.updateState("openWB/general/chargemode_config/unbalanced_load",i))},{help:o(()=>e[16]||(e[16]=[r(" Wenn diese Option aktiviert ist, werden nicht-dreiphasige Ladevorgänge so geregelt, dass am Netzanschlusspunkt (EVU-Zähler) die eingestellte Grenze für die Schieflast nicht überschritten wird. Hierfür muss der EVU-Zähler einzelne Phasenströme bereitstellen!"),d("br",null,null,-1),r(' Weiterhin müssen bei den Ladepunkten sowie Fahrzeugen sämtliche Angaben zur Anzahl angeschlossener/unterstützter Phasen und der Phasenrotation hinterlegt werden, damit der Regelung bekannt ist, welcher Ladevorgang welche Phase am Netzanschluss beeinflusst. siehe "Konfiguration - Ladepunkte -> elektrischer Anschluss - Phase 1" und "Konfiguration - Fahrzeuge -> Fahrzeug-Profile" ')])),_:1},8,["model-value"]),t.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load"]?(l(),z(b,{key:0,title:"Erlaubte Schieflast",min:10,max:32,step:1,unit:"A","model-value":t.$store.state.mqtt["openWB/general/chargemode_config/unbalanced_load_limit"],"onUpdate:modelValue":e[1]||(e[1]=i=>t.updateState("openWB/general/chargemode_config/unbalanced_load_limit",i))},{help:o(()=>e[17]||(e[17]=[r(" Hiermit wird festgelegt, welche Schieflast am Netzanschlusspunkt erlaubt ist. Bei Überschreitung werden gezielt einzelne Ladevorgänge in der Leistung begrenzt. ")])),_:1},8,["model-value"])):y("",!0),n(f,{title:"Phasenumschaltung wiederholt anstoßen",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":t.$store.state.mqtt["openWB/general/chargemode_config/retry_failed_phase_switches"],"onUpdate:modelValue":e[2]||(e[2]=i=>t.updateState("openWB/general/chargemode_config/retry_failed_phase_switches",i))},{help:o(()=>e[18]||(e[18]=[r(" Wenn diese Option aktiviert ist, werden bis zu drei Umschaltversuche vorgenommen, wenn die vorgegebene und genutzte Phasenzahl nicht übereinstimmen. Wird die Option deaktiviert, wird nur eine Umschaltung durchgeführt."),d("br",null,null,-1),r(" Die gezählten Fehlversuche werden mit dem Abstecken zurückgesetzt. ")])),_:1},8,["model-value"]),n(b,{title:"Verzögerung automat. Phasenumschaltung",min:0,max:14,step:1,labels:[{label:"1⇑ 15⇓ Min.",value:1},{label:"2⇑ 14⇓ Min.",value:2},{label:"3⇑ 13⇓ Min.",value:3},{label:"4⇑ 12⇓ Min.",value:4},{label:"5⇑ 11⇓ Min.",value:5},{label:"6⇑ 10⇓ Min.",value:6},{label:"7⇑ 9⇓ Min.",value:7},{label:"8⇑ 8⇓ Min.",value:8},{label:"9⇑ 7⇓ Min.",value:9},{label:"10⇑ 6⇓ Min.",value:10},{label:"11⇑ 5⇓ Min.",value:11},{label:"12⇑ 4⇓ Min.",value:12},{label:"13⇑ 3⇓ Min.",value:13},{label:"14⇑ 2⇓ Min.",value:14},{label:"15⇑ 1⇓ Min.",value:15}],"model-value":t.$store.state.mqtt["openWB/general/chargemode_config/phase_switch_delay"],"onUpdate:modelValue":e[3]||(e[3]=i=>t.updateState("openWB/general/chargemode_config/phase_switch_delay",i))},{help:o(()=>e[19]||(e[19]=[r(" Um zu viele Umschaltungen zu vermeiden, wird Anhand dieses Wertes definiert, wann die Umschaltung erfolgen soll. Ist für durchgehend x Minuten die Maximalstromstärke erreicht, wird auf mehrphasige Ladung ⇑ umgestellt. Ist die Ladung nur für ein Intervall unterhalb der Maximalstromstärke, beginnt das Intervall für die Umschaltung erneut. Ist die Ladung im mehrphasigen Modus für 16 - x Minuten auf der Minimalstromstärke, wird wieder auf einphasige Ladung ⇓ gewechselt."),d("br",null,null,-1),r(" Ist ausreichend Überschuss vorhanden, wird beim Ladestart die Umschaltverzögerung nicht abgewartet, sondern direkt mit mehrphasiger Ladung begonnen. ")])),_:1},8,["model-value"]),e[23]||(e[23]=d("hr",null,null,-1)),n(k,null,{help:o(()=>e[20]||(e[20]=[r(" Zur Berechnung der Ladekosten im Lade-Log werden stundenweise die Anteile der Stromquellen (Speicher, Netz, PV) berechnet und mit den hier angegebenen Preisen multipliziert."),d("br",null,null,-1),r(" Ist die Abrechnung über das Ladeprotokoll, z.B. mit dem Arbeitgeber, vereinbart, ist bei allen drei Feldern der vereinbarte Preis einzutragen. ")])),default:o(()=>[e[21]||(e[21]=r(" Berechnung der Ladekosten "))]),_:1}),t.$store.state.mqtt["openWB/optional/et/provider"]&&t.$store.state.mqtt["openWB/optional/et/provider"].type?(l(),s("div",X,[n(u,{subtype:"info"},{default:o(()=>e[22]||(e[22]=[r(" Für den Netzbezug wird der dynamische Strompreis des Anbieters für variable Stromtarife verwendet (stündliche Aktualisierung durch den Anbieter). ")])),_:1})])):(l(),s("div",Y,[n(_,{title:"Preis für Netzbezug",step:.001,precision:3,unit:"ct/kWh",required:"","model-value":t.$store.state.mqtt["openWB/general/prices/grid"]*1e5,"onUpdate:modelValue":e[4]||(e[4]=i=>t.updateState("openWB/general/prices/grid",parseFloat((i/1e5).toFixed(7))))},null,8,["model-value"])])),n(_,{title:"Preis für Speicherentladung",step:.001,precision:3,unit:"ct/kWh",required:"","model-value":t.$store.state.mqtt["openWB/general/prices/bat"]*1e5,"onUpdate:modelValue":e[5]||(e[5]=i=>t.updateState("openWB/general/prices/bat",parseFloat((i/1e5).toFixed(7))))},null,8,["model-value"]),n(_,{title:"Preis für PV-Strom",step:.001,precision:3,unit:"ct/kWh",required:"","model-value":t.$store.state.mqtt["openWB/general/prices/pv"]*1e5,"onUpdate:modelValue":e[6]||(e[6]=i=>t.updateState("openWB/general/prices/pv",parseFloat((i/1e5).toFixed(7))))},null,8,["model-value"])]))]),_:1}),n(h,{title:"Optional"},{default:o(()=>[t.$store.state.mqtt["openWB/general/extern"]===!0?(l(),s("div",ee,[n(u,{subtype:"info"},{default:o(()=>e[24]||(e[24]=[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ')])),_:1})])):(l(),s("div",te,[n(k,null,{default:o(()=>e[25]||(e[25]=[r(" Variable Stromtarife ")])),_:1}),n(u,{subtype:"info"},{default:o(()=>e[26]||(e[26]=[r(" Bei Sofort- und Zeitladen wird nur geladen, wenn der Strompreis unter dem maximalen angegeben Strompreis liegt. Für Zielladen wird die Ladedauer ermittelt und dann zu den günstigsten Stunden geladen."),d("br",null,null,-1),r(" Wenn keine Preise abgefragt werden können, wird bei Sofort- und Zeitladen immer geladen und bei Zielladen zunächst mit PV-Überschuss und zum Erreichen des Zieltermins mit Netzstrom. ")])),_:1}),n(C,{class:"mb-2",title:"Anbieter",options:p.electricityTariffList,"model-value":t.$store.state.mqtt["openWB/optional/et/provider"]?t.$store.state.mqtt["openWB/optional/et/provider"].type:"","onUpdate:modelValue":e[7]||(e[7]=i=>p.updateSelectedElectricityTariff(i))},null,8,["options","model-value"]),t.$store.state.mqtt["openWB/optional/et/provider"]&&t.$store.state.mqtt["openWB/optional/et/provider"].type?(l(),s("div",ne,[n(E,{"electricity-tariff":t.$store.state.mqtt["openWB/optional/et/provider"],"onUpdate:configuration":e[8]||(e[8]=i=>p.updateConfiguration("openWB/optional/et/provider",i))},null,8,["electricity-tariff"])])):y("",!0)]))]),_:1}),n(h,{title:"OCPP Anbindung"},{default:o(()=>{var i,P,S,$;return[n(f,{title:"OCPP aktivieren",buttons:[{buttonValue:!1,text:"Nein",class:"btn-outline-danger"},{buttonValue:!0,text:"Ja",class:"btn-outline-success"}],"model-value":(i=t.$store.state.mqtt["openWB/optional/ocpp/config"])==null?void 0:i.active,"onUpdate:modelValue":e[9]||(e[9]=m=>t.updateState("openWB/optional/ocpp/config",m,"active"))},null,8,["model-value"]),((P=t.$store.state.mqtt["openWB/optional/ocpp/config"])==null?void 0:P.active)===!0?(l(),s("div",ie,[n(u,{subtype:"info"},{default:o(()=>e[27]||(e[27]=[r(" Die Ladepunkte übermitteln den ID-Tag, Heartbeat und den Zählerstand zum Zeitpunkt des Ansteckens, Absteckens und alle 5 Minuten. Eine Steuerung per OCPP ist nicht möglich."),d("br",null,null,-1),r("Alle Ladepunkte, die ihre Daten an das OCPP-Backend übermitteln sollen, müssen zunächst im OCPP-Backend angelegt werden. Die dort eingetragene Chargebox ID muss in der openWB in den Einstellungen des Ladepunkts eingetragen werden. ")])),_:1}),n(V,{title:"URL des OCPP-Backends",subtype:"host","model-value":(S=t.$store.state.mqtt["openWB/optional/ocpp/config"])==null?void 0:S.url,"onUpdate:modelValue":e[10]||(e[10]=m=>t.updateState("openWB/optional/ocpp/config",m,"url"))},null,8,["model-value"]),n(C,{title:"Version","not-selected":"Bitte auswählen",options:[{value:"ocpp1.6",text:"OCPP 1.6"},{value:"ocpp2.0.1",text:"OCPP 2.0.1"}],"model-value":($=t.$store.state.mqtt["openWB/optional/ocpp/config"])==null?void 0:$.version,"onUpdate:modelValue":e[11]||(e[11]=m=>t.updateState("openWB/optional/ocpp/config",m,"version"))},null,8,["model-value"])])):y("",!0)]}),_:1}),n(T,{"form-name":"generalChargeConfigForm",onSave:e[12]||(e[12]=i=>t.$emit("save")),onReset:e[13]||(e[13]=i=>t.$emit("reset")),onDefaults:e[14]||(e[14]=i=>t.$emit("defaults"))})])])}const oe=v(J,[["render",re],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/GeneralChargeConfig.vue"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{D as E,ue as G};
