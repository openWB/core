import{F as V,l as W,g as F}from"./vendor-fortawesome-2rHPxBiM.js";import{C as A}from"./index-BGd6n0zH.js";import{_ as C,m as d,f as c,F as n,u as l,D as s,z as t,x as w,q as k,A as z,k as M,L as x,l as f}from"./vendor-BuEZ7_tV.js";import"./vendor-bootstrap-Bp8-4ina.js";import"./vendor-jquery-CEMonh9Y.js";import"./vendor-axios-t3FRgHRH.js";import"./vendor-sortablejs-DntTU6yg.js";W.add(F);const q={name:"OpenwbSupportView",components:{FontAwesomeIcon:V},mixins:[A],emits:["sendCommand"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/system/dataprotection_acknowledged","openWB/system/serial_number","openWB/system/device/+/config","openWB/system/device/+/component/+/config","openWB/vehicle/+/name","openWB/vehicle/+/info","openWB/system/current_commit","openWB/system/current_branch_commit"],showDeprecatedFirmwareModal:!1,email:void 0,components:void 0,subject:void 0,ticketNumber:void 0,vehicles:void 0,message:void 0,enableSendDebugButton:!0}},computed:{debugData(){return{email:this.email,subject:this.subject,ticketNumber:this.ticketNumber,serialNumber:this.$store.state.mqtt["openWB/system/serial_number"],installedComponents:this.installedComponents,vehicles:this.vehicleInfo,message:this.message}},installedComponents(){if(this.components!==void 0)return this.components;let r="";const e=this.getWildcardTopics("openWB/system/device/+/component/+/config");for(const a of Object.values(e)){const p=a.id,o=a.info?.manufacturer||"N/A",u=a.info?.model||"N/A";r+=`(${p}) Hersteller: ${o}, Modell: ${u}
`}return r.trim()},vehicleInfo(){if(this.vehicles!==void 0)return this.vehicles;let r="";const e=this.getWildcardTopics("openWB/vehicle/+/info");for(const[a,p]of Object.entries(e)){const o=parseInt(a.split("/")[2]);if(o!==0){const u=p.manufacturer||"N/A",m=p.model||"N/A";r+=`(${o}) Hersteller: ${u}, Modell: ${m}
`}}return r.trim()},updateAvailable(){return this.$store.state.mqtt["openWB/system/current_branch_commit"]&&this.$store.state.mqtt["openWB/system/current_branch_commit"]!=this.$store.state.mqtt["openWB/system/current_commit"]}},beforeMount(){this.sendSystemCommand("systemFetchVersions")},methods:{sendDebugMessage(){if(document.forms.supportForm.reportValidity())this.sendSystemCommand("sendDebug",this.debugData),this.enableSendDebugButton=!1;else{console.warn("form invalid");return}},checkFirmware(){this.updateAvailable?this.showDeprecatedFirmwareModal=!0:this.sendDebugMessage()},verifyModalInput(r){this.showDeprecatedFirmwareModal=!1,r=="confirm"&&this.sendDebugMessage()},sendSystemCommand(r,e={}){this.$emit("sendCommand",{command:r,data:e})}}},N={class:"support"},I={name:"supportForm"},T={key:1},U={key:0},j={class:"row justify-content-center"};function H(r,e,a,p,o,u){const m=d("router-link"),v=d("openwb-base-modal-dialog"),b=d("openwb-base-alert"),y=d("FontAwesomeIcon"),g=d("openwb-base-text-input"),h=d("openwb-base-textarea"),B=d("openwb-base-click-button"),S=d("openwb-base-card"),D=d("font-awesome-icon");return f(),c(x,null,[n(v,{show:o.showDeprecatedFirmwareModal,title:"Achtung: Veraltete Software!",subtype:"danger","prevent-close":!0,buttons:[{text:"Trotzdem versenden",event:"confirm",subtype:"danger"},{text:"Nicht versenden",event:"closeDialog"}],onModalResult:e[0]||(e[0]=i=>u.verifyModalInput(i))},{default:s(()=>[e[9]||(e[9]=t(" Möglicherweise wurde das Problem bereits behoben.",-1)),e[10]||(e[10]=l("br",null,null,-1)),e[11]||(e[11]=t(" Bitte führen Sie vor dem Absenden ein ",-1)),n(m,{to:"/System/SystemConfiguration"},{default:s(()=>[...e[8]||(e[8]=[t(" Update ",-1)])]),_:1}),e[12]||(e[12]=t(" durch.",-1)),e[13]||(e[13]=l("br",null,null,-1)),e[14]||(e[14]=t(" Falls ein Update nicht möglich ist, kann der Systembericht dennoch versendet werden. Falls kein Update gewünscht ist, bieten wir auch über unseren Partner WB Solution GmbH ",-1)),e[15]||(e[15]=l("a",{href:"https://wb-solution.de/produkt/support-token-aeltere-version/",target:"_blank",rel:"noopener noreferrer"},"Support für ältere Softwareversionen",-1)),e[16]||(e[16]=t(" an. ",-1))]),_:1},8,["show"]),l("div",N,[l("form",I,[r.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]!==!0?(f(),w(b,{key:0,subtype:"danger"},{default:s(()=>[e[18]||(e[18]=t(" Du musst der ",-1)),n(m,{to:"/System/LegalSettings"},{default:s(()=>[...e[17]||(e[17]=[t(" Datenschutzerklärung ",-1)])]),_:1}),e[19]||(e[19]=t(" zustimmen, um einen Systembericht senden zu können. ",-1))]),_:1})):(f(),c("div",T,[n(b,{subtype:"success"},{default:s(()=>[e[21]||(e[21]=t(" Du hast der ",-1)),n(m,{to:"/System/LegalSettings"},{default:s(()=>[...e[20]||(e[20]=[t(" Datenschutzerklärung ",-1)])]),_:1}),e[22]||(e[22]=t(" zugestimmt und kannst Systemberichte senden. ",-1))]),_:1}),n(S,{title:"Systembericht"},z({default:s(()=>[r.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]===!0?(f(),c("div",U,[n(b,{subtype:"danger"},{default:s(()=>[...e[23]||(e[23]=[t(' Vergewissere Dich, dass mindestens die aktuelle "Release" Version installiert ist. ',-1)])]),_:1}),n(b,{subtype:"info"},{default:s(()=>[l("ul",null,[l("li",null,[e[24]||(e[24]=t(" Lies bitte den Hilfetext, der durch Klick auf das ",-1)),n(y,{icon:["far","question-circle"]}),e[25]||(e[25]=t(" angezeigt wird. Nimm das Wiki zur Hilfe. ",-1))]),e[26]||(e[26]=l("li",null," Stelle beim Absenden des Berichtes die Fehlerkonditionen her. Lädt ein Fahrzeug nicht, sollte es angeschlossen und nicht voll geladen sein. Ist PV laden betroffen, sollte die Sonne auch scheinen. Der Systembericht muss dann versendet werden, wenn der Fehler aktuell vorliegt. ",-1)),e[27]||(e[27]=l("li",null," Stelle sicher, dass der richtige Lademodus gewählt ist und im Falle von nicht ladenden Fahrzeugen, dass der Ladepunkt auch entsperrt wurde. ",-1)),e[28]||(e[28]=l("li",null," Das Auslesen der Systemkonfiguration erfolgt direkt nach den Klick auf Absenden und kann einige Zeit in Anspruch nehmen. Du erhältst ca. 15 bis 30 Minuten nach Versand des Systemberichtes von uns automatisch eine E-Mail mit der Ticketnummer unter der die Anfrage bei uns registriert wurde. Wir melden uns bei Dir. Bitte kontrolliere daher immer auch den Spam Ordner auf eingehende Nachrichten. Erhältst Du trotzdem keine Ticketnummer, ist das Versenden des Systemberichtes vermutlich fehlgeschlagen. ",-1))])]),_:1}),n(g,{modelValue:o.email,"onUpdate:modelValue":e[1]||(e[1]=i=>o.email=i),title:"E-Mail",required:"",subtype:"email"},{help:s(()=>[...e[29]||(e[29]=[t(" Deine E-Mail-Adresse, an die der Support Dir antwortet. ",-1)])]),_:1},8,["modelValue"]),n(g,{modelValue:o.subject,"onUpdate:modelValue":e[2]||(e[2]=i=>o.subject=i),title:"Betreff",required:"",minlength:"15",maxlength:"100"},{help:s(()=>[...e[30]||(e[30]=[t(" Du kannst hier einen kurzen Titel für dein Problem angeben. ",-1)])]),_:1},8,["modelValue"]),n(g,{modelValue:o.ticketNumber,"onUpdate:modelValue":e[3]||(e[3]=i=>o.ticketNumber=i),title:"Bestehende Ticketnummer",maxlength:"8",pattern:"[1-9][0-9]{7}"},{help:s(()=>[...e[31]||(e[31]=[t(" Hier kann eine bereits bestehende Ticketnummer eingegeben werden, damit das Ticket schneller zugeordnet werden kann. ",-1)])]),_:1},8,["modelValue"]),n(g,{title:"openWB Seriennummer",required:"","model-value":r.$store.state.mqtt["openWB/system/serial_number"],"onUpdate:modelValue":e[4]||(e[4]=i=>r.updateState("openWB/system/serial_number",i))},{help:s(()=>[...e[32]||(e[32]=[t(" Die Seriennummer der openWB findest Du außen am, bei älteren Installationen innen im Gehäuse. Du kannst uns aber auch eine Bestellnummer oder Rechnungsnummer übermitteln. Das Gehäuse muss nicht extra geöffnet werden!",-1),l("br",null,null,-1),t(" Bei einer gekauften openWB wird die Seriennummer automatisch ermittelt. ",-1)])]),_:1},8,["model-value"]),n(h,{title:"Verwendete Komponenten",required:"",minlength:"3",maxlength:"500","model-value":u.installedComponents,"onUpdate:modelValue":e[5]||(e[5]=i=>o.components=i)},{help:s(()=>[e[34]||(e[34]=t(" Gib hier möglichst detailliert an, welche Anlagenkomponenten (EVU, PV, Speicher) angebunden sind.",-1)),e[35]||(e[35]=l("br",null,null,-1)),n(m,{to:"/HardwareInstallation"},{default:s(()=>[...e[33]||(e[33]=[t(" Die Angaben können auch direkt in der Konfiguration der Komponenten dauerhaft gespeichert werden. ",-1)])]),_:1})]),_:1},8,["model-value"]),n(h,{title:"Fahrzeuge",required:"",minlength:"3",maxlength:"500","model-value":u.vehicleInfo,"onUpdate:modelValue":e[6]||(e[6]=i=>o.vehicles=i)},{help:s(()=>[e[37]||(e[37]=t(" Gib hier an, welche Fahrzeuge geladen (Hersteller, Modell, Baujahr).",-1)),e[38]||(e[38]=l("br",null,null,-1)),n(m,{to:"/VehicleConfiguration"},{default:s(()=>[...e[36]||(e[36]=[t(" Die Angaben können auch direkt in der Konfiguration der Fahrzeuge dauerhaft gespeichert werden. ",-1)])]),_:1})]),_:1},8,["model-value"]),n(h,{modelValue:o.message,"onUpdate:modelValue":e[7]||(e[7]=i=>o.message=i),title:"Problembeschreibung",required:"",minlength:"20",maxlength:"500"},null,8,["modelValue"])])):k("",!0)]),_:2},[r.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]===!0?{name:"footer",fn:s(()=>[l("div",j,[n(B,{class:M(["col-4",o.enableSendDebugButton?"btn-success":"btn-outline-success"]),disabled:!o.enableSendDebugButton,onButtonClicked:u.checkFirmware},{default:s(()=>[...e[39]||(e[39]=[t(" Absenden ",-1)])]),_:1},8,["class","disabled","onButtonClicked"])])]),key:"0"}:void 0]),1024),o.enableSendDebugButton?k("",!0):(f(),w(b,{key:0,subtype:"success"},{default:s(()=>[e[40]||(e[40]=t(" Die Daten für den Fehlerbericht werden im Hintergrund zusammengestellt. Du kannst diese Seite jetzt verlassen. ",-1)),n(D,{icon:["fas","check"]})]),_:1}))]))])])],64)}const R=C(q,[["render",H],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/Support.vue"]]);export{R as default};
